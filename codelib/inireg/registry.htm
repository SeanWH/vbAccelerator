<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="Author" content="Steve McMahon">
<meta name="KeyWords"
content="VB, VB6, Visual Basic, Visual Basic 5, Visual Basic 6, Dynamic HTML, DHTML, IE4, Internet Explorer, Internet Explorer 4, Active X, Active X Controls, Visual Basic Controls">
<meta name="GENERATOR" content="Notepad">
<title>Complete Registry control</title>
</head>


<body topmargin="0" leftmargin="0" link="#660000" vlink="#999966" LEFTMARGIN="0" TOPMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0"  background="..\..\images\legacy.html">

<!-- AD:START -->
<table bgcolor="#336699" border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr>
<td width="468">
<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelad.png" width="468" height="60" 
border="0" alt="vbAccelerator - Faster VB and .NET Code" /></a>
</noscript>
</td>
<td>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelnew.png" width="125" height="60" 
border="0" alt="The new vbAccelerator Site - more VB and .NET Code and Controls" /></a>
</td>
</tr>
</table>
<!-- AD:END -->



<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#660000">
        <td width="100%" height="25">
        <font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
        <a name="sectop"></a>Source Code
        </strong>
        </font>
        </td>
        <td width="96">
        <font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
        <a title="Installation Instructions and Requirements" href="..\..\install.htm"><img src="..\..\images\install.gif" height="12" width="96" border="0" valign="center"></a>
        </strong>
        </font>
        </td>
        <td width="96">
        <font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
        <a title="Back to Source Code" href="..\..\overview.htm"><img src="..\..\images\srccode.gif" height="12" width="96" border="0" valign="center"></a>
        </strong>
        </font>
        </td>
</tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#6699CC">
        <td valign="top" width="32">
        <font color="#660000" face="verdana,arial,helvetica" size="6"><strong>3</strong></font>
        </td>
        <td>
        <font color="#660000" face="verdana,arial,helvetica" size="4"><strong>Code Libraries</strong></font>
        <font color="#660000" face="verdana,arial,helvetica" size="2">
        </font>
        </td>
        <td width="10">&nbsp</td>
</tr>
</table>

<!-- SUPERCEEDED:START -->
<br />
<table border="0" width="100%" cellspacing="0" cellpadding="5">
<tr>
<td width="66" bgcolor="#FFFFFF"><br /></td>
<td width="100%" bgcolor="#EEEEEE">
	<p>
	<font color="#666666" face="verdana,arial,helvetica" size="5">
	<b>&nbsp;NOTE:</b></font>
	<font color="#999999" face="verdana,arial,helvetica" size="2">this code has been superceded by the <a href="..\..\home\vb\code\libraries\registry_and_ini_files\complete_registry_control\article.html" target="_top">version at the new site</a>.
	</font>
	<br />
        </p>
</td>
<td width="66" bgcolor="#FFFFFF"><br /></td>
</tr>
</table>
<br />
<!-- SUPERCEDED:END -->

<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#FFFFFF">
	<td>&nbsp</td>
	<td>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<br>
	<p><b>Complete Registry control</b><br></p>
	<p><img src="..\..\images\cregedt.gif" alt="[VB Registry Editor Demo]" width="401" height="232"></p>

	<p><a href="creg.zip"><img src="..\..\images\vbdnload.gif" width="16" height="16" border="0" hspace="4">Download the cRegistry Class (5kb)</a><br>
	<a href="regedit.zip"><img src="..\..\images\vbdnload.gif" width="16" height="16" border="0" hspace="4">Download the RegEdit Demo Application (66kb)</a></p>

	</font>
	<p>
	<table>
	<tr>
		<td width="20">&nbsp</td>
		<td colspan="2" bgcolor="#EEEEEE">
		<font color="#000000" face="verdana,arial,helvetica" size="1">
		<img src="..\..\images\update.gif" height="11" width="23" border="0" alt="Updated" hspace="2"><b>Updated!</b> <i>21 March 2000</i>
		</font>
		</td>
		<td width="30">&nbsp</td>
	</tr>
	<tr>
		<td width="20">&nbsp</td>
		<td valign="top"><img src="..\..\images\bullet.gif" border="0" hspace="2" width="8" height="8"></td>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="1">
		Modified the <i>CreateExeAssociation</i> and <i>CreateAdditionalExeAssociations</i>
	    methods to update the HKEY_LOCAL_MACHINE\SOFTWARE\Classes sections as well as the default HKEY_CLASSES_ROOT.
		</font>
		</td>
		<td>&nbsp</td>
	</tr>
	<tr>
		<td width="20">&nbsp</td>
		<td colspan="2" bgcolor="#EEEEEE">
		<font color="#000000" face="verdana,arial,helvetica" size="1">
		<img src="..\..\images\update.gif" height="11" width="23" border="0" alt="Updated" hspace="2"><b>Updated!</b> <i>2 January 1999</i>
		</font>
		</td>
		<td width="30">&nbsp</td>
	</tr>
	<tr>
		<td width="20">&nbsp</td>
		<td valign="top"><img src="..\..\images\bullet.gif" border="0" hspace="2" width="8" height="8"></td>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="1">
	Fixed a bug with the <i>CreateExeAssociation</i> method.  If you did not
	provide the optional document default icon parameter the association was not set up correctly.<br>
	The CreateExeAssociation method now allows Print,Install and New associations to be created and
	also allows the menu text to be customised.<br>
	A further method, <i>CreateAdditionalExeAssociations</i> allows you to create customised items.
	See the <a href="..\ssubtmr\startup.htm">Passing Command Line Parameters</a> article for
	more details on this.
		</font>
		</td>
		<td>&nbsp</td>
	</tr>
	</table>
	</p>
	<font color="#000000" face="verdana,arial,helvetica" size="2">


	<br><br>
	<b>Introduction</b><br>
	The cRegistry class is an easy, self-contained way to get complete access to the Windows registry.  Simple
	methods allow you to create, enumerate and delete keys and values in the registry, without restriction.  You
	can even read/write binary data to the registry.
	To see how powerful this library is, download the demonstration Registry Editor, written entirely in VB.
	It runs at about the same speed as RegEdit shipped with Windows (although in my version not all the features are finished!)
	The demo also demonstrates my simple <a href="..\gfx\splitter.htm">splitter class</a>.
	<br><br>
	<b>Usage</b><br>
	Here is a brief summary of typical uses of the class:
	<br>
	<br>
	<b>To get a String Value from the Registry</b>
	</p>
	</font>
<font face="Lucida Console,courier new" size="2">
<p>
&nbsp &nbsp Dim c As New cRegistry <br>
&nbsp &nbsp With c <br>
&nbsp &nbsp &nbsp &nbsp .ClassKey = HKEY_LOCAL_MACHINE <br>
&nbsp &nbsp &nbsp &nbsp .SectionKey = "Software\MyApp\Tips" <br>
&nbsp &nbsp &nbsp &nbsp .ValueKey = "Tip1" <br>
&nbsp &nbsp &nbsp &nbsp .ValueType = REG_SZ <br>
&nbsp &nbsp &nbsp &nbsp sTip = .Value <br>
&nbsp &nbsp End With
 <br>
</font>
</p>
<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p>
	<b>To get a Numeric Value from the Registry</b>
	</p>
	</p>
	</font>
<font face="Lucida Console,courier new" size="2">
<p>
&nbsp &nbsp Dim c As New cRegistry <br>
&nbsp &nbsp With c <br>
&nbsp &nbsp &nbsp &nbsp .ClassKey = HKEY_LOCAL_MACHINE <br>
&nbsp &nbsp &nbsp &nbsp .SectionKey = "Software\MyApp\Tips" <br>
&nbsp &nbsp &nbsp &nbsp .ValueKey = "TipCount" <br>
&nbsp &nbsp &nbsp &nbsp .ValueType = REG_DWORD <br>
&nbsp &nbsp &nbsp &nbsp lTipCount = .Value <br>
&nbsp &nbsp End With
 <br>
</p>
</font>
<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p>
	<b>To Save a Form's position to the Registry</b>
	</p>
	</p>
	</font>
<font face="Lucida Console,courier new" size="2">
<p>
&nbsp &nbsp Dim c As New cRegistry <br>
&nbsp &nbsp With c <br>
&nbsp &nbsp &nbsp &nbsp .ClassKey = HKEY_CURRENT_USER <br>
&nbsp &nbsp &nbsp &nbsp ' You don't need to check if this key already exists<br>
&nbsp &nbsp &nbsp &nbsp ' - the class will create it for you<br>
&nbsp &nbsp &nbsp &nbsp .SectionKey = "Software\" & App.ExeName & "\" & frmThis.Name<br>
&nbsp &nbsp &nbsp &nbsp .ValueKey = "Maximized" <br>
&nbsp &nbsp &nbsp &nbsp .ValueType = REG_DWORD <br>
&nbsp &nbsp &nbsp &nbsp .Value = (frmThis.WindowState = vbMaximized) <br>
&nbsp &nbsp &nbsp &nbsp If (frmThis.WindowState <> vbMaximized) <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp .ValueKey = "Left" <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp .Value = frmThis.Left <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp .ValueKey = "Top" <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp .Value = frmThis.Top <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp .ValueKey = "Width" <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp .Value = frmThis.Width <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp .ValueKey = "Height" <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp .Value = frmThis.Height <br>
&nbsp &nbsp &nbsp &nbsp End If <br>
&nbsp &nbsp End With
 <br>
</p>
</font>
<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p>
	<b>To Get All The SubKeys of a Key</b><br>
	Getting all the values with a key is achieved in a similar way, except you use EnumerateValues instead
	of EnumerateSections<br>
	</p>
	</p>
	</font>
<font face="Lucida Console,courier new" size="2">
<p>
&nbsp &nbsp Dim c As New cRegistry <br>
&nbsp &nbsp Dim sKeys() As String, iKeyCount As Long <br>
<br>
&nbsp &nbsp With c <br>
&nbsp &nbsp &nbsp &nbsp .ClassKey = HKEY_LOCAL_MACHINE <br>
&nbsp &nbsp &nbsp &nbsp .SectionKey = "Software"<br>
&nbsp &nbsp &nbsp &nbsp .EnumerateSections(sKeys(), iKeyCount)<br>
&nbsp &nbsp &nbsp &nbsp For iKey = 1 To iKeyCount<br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp Debug.Print sKeys(iKey)<br>
&nbsp &nbsp &nbsp &nbsp Next iKey<br>
&nbsp &nbsp End With
 <br>
</p>
</font>
<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p>
	<b>To Delete a Key</b>
	</p>
	</p>
	</font>
<font face="Lucida Console,courier new" size="2">
<p>
&nbsp &nbsp Dim c As New cRegistry <br>
&nbsp &nbsp With c <br>
&nbsp &nbsp &nbsp &nbsp .ClassKey = HKEY_LOCAL_MACHINE <br>
&nbsp &nbsp &nbsp &nbsp .SectionKey = "Software\MyApp\Tips" <br>
&nbsp &nbsp &nbsp &nbsp .DeleteKey <br>
&nbsp &nbsp End With
 <br>
</p>
</font>
<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p>
	<b>To Associate a File of type .CCD with your executable</b>
	</p>
	</p>
	</font>
<font face="Lucida Console,courier new" size="2">
<p>
&nbsp &nbsp Dim c As New cRegistry <br>
&nbsp &nbsp With c <br>
&nbsp &nbsp &nbsp &nbsp .CreateEXEAssociation _<br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp App.Path & "\" & App.ExeName, _<br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp "CCarDesign.Project", _<br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp "Custom Car Designer Project", _<br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp "CCD"<br>
&nbsp &nbsp End With
 <br>
</p>
</font>
<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p>
	<b>To Delete a Value</b>
	</p>
	</font>
<font face="Lucida Console,courier new" size="2">
<p>
&nbsp &nbsp Dim c As New cRegistry <br>
&nbsp &nbsp With c <br>
&nbsp &nbsp &nbsp &nbsp .ClassKey = HKEY_LOCAL_MACHINE <br>
&nbsp &nbsp &nbsp &nbsp .SectionKey = "Software\MyApp\Tips" <br>
&nbsp &nbsp &nbsp &nbsp .SectionKey = "Tip1" <br>
&nbsp &nbsp &nbsp &nbsp .DeleteValue <br>
&nbsp &nbsp End With
 <br>
</p>
</font>
<font color="#000000" face="verdana,arial,helvetica" size="2">
<p>
	<p>
	<b>To Read BINARY values from the registry</b><br>
	Binary values are returned as a variant of type byte array.  This code demonstrates how
	to format the returned value into a string of hexadecimal values, similar to the display
	provided in RegEdit:
	</p>
	</font>
<font face="Lucida Console,courier new" size="2">
<p>
&nbsp &nbsp Dim cR As New cRegistry<br>
&nbsp &nbsp Dim iByte As Long<br>
&nbsp &nbsp Dim vR as Variant<br>
 <br>
&nbsp &nbsp With cR<br>
&nbsp &nbsp &nbsp &nbsp     .ClassKey = HKEY_CURRENT_USER<br>
&nbsp &nbsp &nbsp &nbsp     .SectionKey = "Control Panel\Appearance"<br>
&nbsp &nbsp &nbsp &nbsp     .ValueKey = "CustomColors"<br>
&nbsp &nbsp &nbsp &nbsp     vR = .Value<br>
 <br>
&nbsp &nbsp &nbsp &nbsp     If .ValueType =  REG_BINARY Then<br>
&nbsp &nbsp &nbsp &nbsp         ' Read through the byte array and output it as a series of hex values:<br>
&nbsp &nbsp &nbsp &nbsp         For iByte = LBound(vR) To UBound(vR)<br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp             sOut = sOut & "&H"<br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp             If (iByte<&H10) Then<br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp                 sOut = sOut & "0"<br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp             End If<br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp             sOut = sOut & Hex$(vR(iByte)) & " " <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp         Next iByte<br>
&nbsp &nbsp &nbsp &nbsp     Else<br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp         sOut = vR<br>
&nbsp &nbsp &nbsp &nbsp     End If<br>
    <br>
&nbsp &nbsp &nbsp &nbsp     Debug.Print sOut<br>
&nbsp &nbsp End With<br>
<br>
</p>
</font>
<font color="#000000" face="verdana,arial,helvetica" size="2">
<p>
	<b>To Set BINARY values from the registry</b><br>
	Similarly, to store binary values in the registry, cRegistry.cls expects a byte array
	of the binary values you wish to store. This example (rather uselessly!) stores all the 
	Red, Green, Blue values of each of VB's QBColors into a binary array:
	</p>
	</font>
<font face="Lucida Console,courier new" size="2">
<p>
&nbsp &nbsp Dim cR As New cRegistry<br>
&nbsp &nbsp Dim i As Long<br>
&nbsp &nbsp Dim lC As Long<br>
&nbsp &nbsp Dim bR As Byte<br>
&nbsp &nbsp Dim bG As Byte<br>
&nbsp &nbsp Dim bB As Byte<br>
&nbsp &nbsp Dim bOut() As Byte<br>
 <br>
&nbsp &nbsp ' Create a binary array containing all the Red,Green,Blue values of the QBColors:<br>
&nbsp &nbsp ReDim bOut(0 To 15 * 3 - 1) As Byte<br>
&nbsp &nbsp For i = 1 To 15<br>
&nbsp &nbsp &nbsp &nbsp     ' Get the Red, Green, Blue for the QBColor at index i:<br>
&nbsp &nbsp &nbsp &nbsp     lC = QBColor(i)<br>
&nbsp &nbsp &nbsp &nbsp     bR = (lC And &HFF&)<br>
&nbsp &nbsp &nbsp &nbsp     bG = ((lC And &HFF00&) \ &H100&)<br>
&nbsp &nbsp &nbsp &nbsp     bB = ((lC And &HFF0000) \ &H10000)<br>
&nbsp &nbsp     <br>
&nbsp &nbsp &nbsp &nbsp     ' Add Red, Green, Blue to the byte array to store:<br>
&nbsp &nbsp &nbsp &nbsp     bOut((i - 1) * 3) = bR<br>
&nbsp &nbsp &nbsp &nbsp     bOut((i - 1) * 3 + 1) = bG<br>
&nbsp &nbsp &nbsp &nbsp     bOut((i - 1) * 3 + 2) = bB<br>
&nbsp &nbsp Next i<br>
 <br>
&nbsp &nbsp ' Store it:<br>
&nbsp &nbsp With cR<br>
&nbsp &nbsp &nbsp &nbsp     .ClassKey = HKEY_CURRENT_USER<br>
&nbsp &nbsp &nbsp &nbsp     .SectionKey = "software\vbaccelerator\cRegistry\Binary Test"<br>
&nbsp &nbsp &nbsp &nbsp     .ValueKey = "QBColors"<br>
&nbsp &nbsp &nbsp &nbsp     .ValueType = REG_BINARY<br>
&nbsp &nbsp &nbsp &nbsp     .Value = bOut()<br>
&nbsp &nbsp End With<br>
<br>
</p>
</font>
<font color="#000000" face="verdana,arial,helvetica" size="2">

        <br><br>

        <p><a href="#sectop"><img src="..\..\images\top.gif" border="0" width="8" height="12" hspace="4" alt="Top"></a>Back to <a href="#sectop">top</a></p>
        <p><a href="..\..\overview.htm"><img src="..\..\images\sc.gif" border="0" width="8" height="12" hspace="4" alt="Source Code - What We're About!"></a>Back to <a href="..\..\overview.htm">Source Code</a></p>

        </font>


        </td>
        <td>&nbsp</td>
</tr>
</table>

<!-- BODY:END -->

<!-- FOOTER:START -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 1998-2000, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 21 March 2000</font></p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>

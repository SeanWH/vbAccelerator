<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="Author" content="Steve McMahon">
<meta name="KeyWords"
content="VB, VB6, Visual Basic, Visual Basic 5, Visual Basic 6, Dynamic HTML, DHTML, IE4, Internet Explorer, Internet Explorer 4, Active X, Active X Controls, Visual Basic Controls">
<meta name="GENERATOR" content="Notepad">
<title>Sophisticated Control Over Window Sizing and Moving</title>
</head>


<body topmargin="0" leftmargin="0" link="#660000" vlink="#999966" LEFTMARGIN="0" TOPMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0"  background="..\..\images\legacy.html">

<!-- AD:START -->
<table bgcolor="#336699" border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr>
<td width="468">
<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelad.png" width="468" height="60" 
border="0" alt="vbAccelerator - Faster VB and .NET Code" /></a>
</noscript>
</td>
<td>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelnew.png" width="125" height="60" 
border="0" alt="The new vbAccelerator Site - more VB and .NET Code and Controls" /></a>
</td>
</tr>
</table>
<!-- AD:END -->



<a name="sectop"></a>
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#660000">
        <td width="100%" height="25">
        <font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
        &nbsp;Source Code
        </strong>
        </font>
        </td>
        <td width="96">
        <font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
        <a title="Installation Instructions and Requirements" href="..\..\install.htm"><img src="..\..\images\install.gif" height="12" width="96" border="0" valign="center"></a>
        </strong>
        </font>
        </td>
        <td width="96">
        <font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
        <a title="Back to Source Code" href="..\..\overview.htm"><img src="..\..\images\srccode.gif" height="12" width="96" border="0" valign="center"></a>
        </strong>
        </font>
        </td>
</tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#6699CC">
        <td valign="top" width="32">
        &nbsp;<font color="#660000" face="verdana,arial,helvetica" size="6"><strong>3&nbsp;</strong></font>
        </td>
        <td valign="center" width="100%">
        <font color="#660000" face="verdana,arial,helvetica" size="4"><strong>Code Libraries</strong></font>
        </td>
        <td width="10">&nbsp</td>
</tr>
</table>

<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#EEEEEE">
        <td valign="top">
	<p>
        <font color="#000000" face="verdana,arial,helvetica" size="2">
	<b>&nbsp;Sophisticated Control Over Window Sizing and Moving</b>
        </font>
	</p>
	</td>
</tr>
<tr>
        <td valign="top">
	<p>
        <font color="#6699CC" face="verdana,arial,helvetica" size="1">
	&nbsp;Dynamically control the full-drag property, and take full control over sizing and moving.
        </font>
	</p>
	</td>
</tr>
</table>

<!-- SUPERCEEDED:START -->
<br />
<table border="0" width="100%" cellspacing="0" cellpadding="5">
<tr>
<td width="66" bgcolor="#FFFFFF"><br /></td>
<td width="100%" bgcolor="#EEEEEE">
	<p>
	<font color="#666666" face="verdana,arial,helvetica" size="5">
	<b>&nbsp;NOTE:</b></font>
	<font color="#999999" face="verdana,arial,helvetica" size="2">this code has been superceded by the <a href="..\..\home\vb\code\libraries\subclassing\sophisticated_control_over_window_sizing_and_moving\article.html" target="_top">version at the new site</a>.
	</font>
	<br />
        </p>
</td>
<td width="66" bgcolor="#FFFFFF"><br /></td>
</tr>
</table>
<br />
<!-- SUPERCEDED:END -->

<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#FFFFFF">
        <td>&nbsp</td>
        <td>
        <font color="#000000" face="verdana,arial,helvetica" size="2">
	<br>
        <p><img src="..\..\images\ctrlres.gif" width="363" height="170" alt="Sizing and Moving sample" border="0"></p>
        <p><a href="ctrlres.zip"><img src="..\..\images\vbdnload.gif" width="16" height="16" border="0" hspace="4">Download the Sizing and Moving control source code (16kb)</a></p>
        </font>
        <p>
        <table cellspacing="0" cellpadding="0" border="0">
        <tr>
                <td>&nbsp</td>
                <td colspan="2" bgcolor="#EEEEEE">
                <font color="#000000" face="verdana,arial,helvetica" size="1">
                <b>Before you Begin</b>
                </font>
                </td>
                <td>&nbsp</td>
        </tr>
        <tr>
                <td>&nbsp</td>
                <td valign="top"><img src="..\..\images\bullet.gif" border="0" hspace="2" width="8" height="8"></td>
                <td valign="top">
                <font color="#000000" face="verdana,arial,helvetica" size="1">
                This project requires the <a href="ssubtmr.htm">SSubTmr.DLL component</a>.  Make sure you have loaded and <a href="..\..\insprob.htm#secreg">registered</a> this before trying the project.
                </font>
                </td>
                <td>&nbsp</td>
        </tr>
        </table>
        </p>
        <p>
        <font color="#000000" face="verdana,arial,helvetica" size="2">
	<b>Introduction</b><br>
	VB's control over moving and sizing isn't much - basically you have the <i>Resize</i> event,
	as has been the case since VB1.  Windows gives you a lot more control over moving and sizing
	forms if you need it though.  For example, try resizing an undocked tool window in MS Office.
	You will see that the size snaps so groups of buttons or controls are kept on the same
	line.
	<br><br>
	This sample demonstrates how to get access to all the more sophisticated moving and sizing
	messages, and how to use them to control your window's resize without the flickering and
	jumping to position you get if you try to change size during VB's <i>Resize</i> event.
	<br><br>
	<b>Return To Sender</b><br>
	Windows sends the following messages associated with moving and sizing which VB ignores :
	<ul>
	<li>WM_SIZING = &H214<br>
	This message is fired whilst the window is being resized.  The <i>lParam</i> of the message
	points to a <i>RECT</i> structure containing the desired position of the window.  Any modifications 
	you make to this rectangle are passed back to Windows, which moves or sizes the window directly to 
	the size and position you specify.
	<li>WM_MOVING = &H216<br>
	This message works the same way as <i>WM_SIZING</i> except it is fired whilst the window
	is being moved.
	<li>WM_ENTERSIZEMOVE = &H231<br>
	This message is fired when your window is about to start moving or sizing.
	<li>WM_EXITSIZEMOVE = &H232<br>
	This message is fired when a moving or sizing operation on your window has completed.
	<li>WM_SIZE = &H5<br>
	This message is fired whenever your window has its size changed by the <i>SetWindowPos</i>
	function, for example when windows minimizes, maximizes or restores your window, or when
	you call a VB function which changes the size of the window.
	</ul>
	The sample application shows how you can subclass these messages for a window and respond
	correctly to them, providing the following new events for a window:
	<ul>
	<li>Activate
	<li>Deactivate
	<li>EnterSizeMove
	<li>ExitSizeMove
	<li>Moving
	<li>Sizing
	</ul>
	<b>Controlling FullDrag State</b><br>
	The Full Window drag setting is a nice option in Windows, but for highly animated or
	dynamic windows	it can cause moving and sizing to be slow.  Luckily there is a way
	to control it on a window by window basis.  You achieve this by subclassing for the
	<i>WM_ACTIVATE</i> message to determine when the window you want to change the state
	for is activate or not.  When the window is activated, you can then call the
	<i>SystemParametersInfo</i> function to turn off full-drag if it is enabled.  When
	the window is deactivated again, you simply reset the state to its original value.
	<br><br>
	Here is the code for checking and setting the full drag state:
	<br><br>
	</font>
<font color="#000000" face="Lucida Console,Courier New" size="1">
Private Const SPI_GETDRAGFULLWINDOWS = 38<br>
Private Const SPI_SETDRAGFULLWINDOWS = 37<br>
Private Const SPIF_SENDWININICHANGE = &H2<br>
Private Const SPIF_UPDATEINIFILE = &H1<br>
Private Declare Function SystemParametersInfo Lib &quot;user32&quot; Alias &quot;SystemParametersInfoA&quot; _<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ByVal uAction As Long, ByVal uParam As Long, lpvParam As Any, ByVal fuWinIni As Long) As Long<br>
<br>
Private m_bSwitchOff As Boolean<br>
<br>
Private Sub pTurnOffFullDrag()<br>
&nbsp;&nbsp;&nbsp;Dim lR As Long<br>
&nbsp;&nbsp;&nbsp;<font color="#999999" face="Lucida Console,Courier New" size="1">' Get the full-drag state:</font><font color="#000000" face="Lucida Console,Courier New" size="1"><br>
&nbsp;&nbsp;&nbsp;If Not (SystemParametersInfo(SPI_GETDRAGFULLWINDOWS, 0&, lR, 0) = 0) Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Not lR = 0 Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#999999" face="Lucida Console,Courier New" size="1">' Store the fact we are changing:</font><font color="#000000" face="Lucida Console,Courier New" size="1"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_bSwitchOff = True<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#999999" face="Lucida Console,Courier New" size="1">' Set the full-drag state:</font><font color="#000000" face="Lucida Console,Courier New" size="1"><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lR = SystemParametersInfo(SPI_SETDRAGFULLWINDOWS, 0&, ByVal 0&, SPIF_SENDWININICHANGE)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If<br>
&nbsp;&nbsp;&nbsp;End If<br>
End Sub<br>
<br>
Private Sub pResetFullDrag()<br>
&nbsp;&nbsp;&nbsp;If m_bSwitchOff Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SystemParametersInfo SPI_SETDRAGFULLWINDOWS, 1&, ByVal 0&, SPIF_SENDWININICHANGE<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_bSwitchOff = False<br>
&nbsp;&nbsp;&nbsp;End If<br>
End Sub<br>
<br>

</font>
</p>
<font color="#000000" face="verdana,arial,helvetica" size="2">	

	</font></td>
	<td></td>
	</tr>
	</table>
	</p>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p>
		
	</p>	
	<br><br>
        <p><a href="#sectop"><img src="..\..\images\top.gif" border="0" width="8" height="12" hspace="4" alt="Top"></a>Back to <a href="#sectop">top</a><br>
	<a href="..\..\overlib.htm"><img src="..\..\images\back.gif" border="0" width="8" height="12" hspace="4" alt="Source Code Library"></a>Back to <a href="..\..\overlib.htm">Code Libraries</a><br>
	<a href="..\..\overview.htm"><img src="..\..\images\sc.gif" border="0" width="8" height="12" hspace="4" alt="Source Code - What We're About!"></a>Back to <a href="..\..\overview.htm">Source Code</a></p>
        </font>

        </td>
        <td>&nbsp</td>
</tr>
</table>

<!-- BODY:END -->

<!-- FOOTER:START -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 1998-1999, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 25 August 1999</font></p>
        </td>	
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>

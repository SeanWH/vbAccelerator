<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="Author" content="Steve McMahon">
<meta name="KeyWords"
content="VB, VB6, Visual Basic, Visual Basic 5, Visual Basic 6, Dynamic HTML, DHTML, IE4, Internet Explorer, Internet Explorer 4, Active X, Active X Controls, Visual Basic Controls">
<meta name="GENERATOR" content="Notepad">
<title>Owner-Draw Pop-up Menus</title>
</head>

<body bgcolor="#FFFFFF" topmargin="0" leftmargin="0" link="#660000" vlink="#999966" LEFTMARGIN="0" TOPMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0" background="..\..\images\legacy.html">

<!-- AD:START -->
<table bgcolor="#336699" border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr>
<td width="468">
<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelad.png" width="468" height="60" 
border="0" alt="vbAccelerator - Faster VB and .NET Code" /></a>
</noscript>
</td>
<td>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelnew.png" width="125" height="60" 
border="0" alt="The new vbAccelerator Site - more VB and .NET Code and Controls" /></a>
</td>
</tr>
</table>
<!-- AD:END -->



<a name="sectop"></a>

<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#660000">
	<td width="100%" height="25">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	Source Code
	</strong>
	</font>
	</td>
	<td width="96">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	<a title="Installation Instructions and Requirements" href="..\..\install.htm"><img src="..\..\images\install.gif" height="12" width="96" border="0" valign="center"></a>
	</strong>
	</font>
	</td>
	<td width="96">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	<a title="Back to Source Code" href="..\..\overview.htm"><img src="..\..\images\srccode.gif" height="12" width="96" border="0" valign="center"></a>
	</strong>
	</font>
	</td>
</tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#FFCC00">
	<td valign="bottom" width="32">
	<font color="#666666" face="verdana,arial,helvetica" size="6"><strong>1</strong></font>
	</td>
	<td valign="center">
	<font color="#666666" face="verdana,arial,helvetica" size="4"><strong>VB 5 Custom Controls</strong></font>
	</td>
	<td width="10">&nbsp</td>
</tr>
</table>

<!-- SUPERCEEDED:START -->
<br />
<table border="0" width="100%" cellspacing="0" cellpadding="5">
<tr>
<td width="66" bgcolor="#FFFFFF"><br /></td>
<td width="100%" bgcolor="#EEEEEE">
	<p>
	<font color="#666666" face="verdana,arial,helvetica" size="5">
	<b>&nbsp;NOTE:</b></font>
	<font color="#999999" face="verdana,arial,helvetica" size="2">this code has been superceded by the <a href="..\..\home\vb\code\controls\menus\popupmenu_-_ownerdraw_menu_items\article.html" target="_top">version at the new site</a>.
	</font>
	<br />
        </p>
</td>
<td width="66" bgcolor="#FFFFFF"><br /></td>
</tr>
</table>
<br />
<!-- SUPERCEDED:END -->

<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#FFFFFF">
	<td>&nbsp</td>
	<td colspan="3">
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<br>
	<p><b>Owner-Draw Pop-up Menus</b><br>
	<p><img src="..\..\images\odmenup.gif" alt="Owner-Draw Popup Menu Demonstration" width="266" height="210"></p>
	<p><a href="odpmenu.zip"><img src="..\..\images\vbdnload.gif" width="16" height="16" border="0" hspace="4">Download the Owner-Draw Popup Menu demonstration project (22kb)</a></p>
	</font>
	<p> 
	<table>
	<tr>
		<td>&nbsp</td>
		<td colspan="2" bgcolor="#EEEEEE">
		<font color="#000000" face="verdana,arial,helvetica" size="1">
		<b>Before you Begin</b>
		</font>
		</td>
		<td>&nbsp</td>
	</tr>
	<tr>
		<td>&nbsp</td>
		<td valign="top"><img src="..\..\images\bullet.gif" border="0" hspace="2" width="8" height="8"></td>
		<td valign="top">
		<font color="#000000" face="verdana,arial,helvetica" size="1">
		This project requires the <a href="cnewmenu.htm">cNewMenu.DLL component</a>.  Make sure you have loaded and registered this before trying any project.
		</font>
		</td>
		<td>&nbsp</td>
	</tr>
	<tr>
		<td>&nbsp</td>
		<td valign="top"><img src="..\..\images\bullet.gif" border="0" hspace="2" width="8" height="8"></td>
		<td valign="top">
		<font color="#000000" face="verdana,arial,helvetica" size="1">
		This project requires the <a href="..\ssubtmr\ssubtmr.htm">SSubTmr.DLL component</a>.  Make sure you have loaded and registered this before trying any project.
		</font>
		</td>
		<td>&nbsp</td>
	</tr>
	</table>
	</p>
	</font>
	<font color="#000000" face="verdana,arial,helvetica" size="2">

	<p><b>Overview</b><br>
	This project provides sample code for creating completely owner-drawn pop-up menu
	items using the <a href="cnewmenu.htm">cNewMenu ActiveX DLL</a>.  If you want to
	create a drop-down list of items from your control, and the number of items will fit
	onto the screen, then using this DLL to manage all the drop-down functions except
	drawing the items themselves can make the task easier.
	<br><br>
	This project demonstrates two customised menu types:
	<ol>
	<li>A line style picker
	<li>A colour picker
	</ol>
	<b>Owner-Drawn Menu Items</b><br>
	Owner drawing menu items involves the following:
	<ol>
	<li>Setting the <i>OwnerDraw</i> property to True for the menu items you want to
	draw yourself.
	<li>Responding to the <i>MeasureItem</i> event.<br>This is fired just before a menu item is
	going to be displayed and is used to determine the width and height of the menu items.  The
	DLL will automatically calcuate the size of the menu item based on the text entered for the
	item, however if your item is graphical you will want to override the default width and height
	with your own values.  The overall width of the drop-down menu will automatically set to the
	width of the largest item in the menu.  Each item can have any height you want.  The parameters
	to this method are:
	<ul>
	<li>lMenuIndex: The menu item which should be measured (read-only).
	<li>lWidth: The width of the menu item in pixels (read-write).
	<li>lHeight: The height of the menu item in pixels (read-write).
	</ul>
	<li>Responding to the <i>DrawItem</i> event.<br>This event is fired whenever a menu item needs
	to be redrawn (for example, when it is first shown, or when it needs to be highlighed or un-highlighted).
	This method passes you the index of the item to be drawn, the device context to draw on, the 
	bounding rectangle of the item and various flags telling you the state of the item, as follows:
	<ul>
	<li>hdc : handle of the device context to draw on (read-only).
	<li>lMenuIndex: the menu item which should be drawn (read-only).
	<li>lLeft: the left point of the menu item to be drawn in the DC, in pixels (read-write)
	<li>lTop: the top point.
	<li>lRight: the right point.
	<li>lBottom: the bottom point.
	<li>bSelected: Whether the item is selected (read-only)
	<li>bChecked: Whether the item is checked (read-only)
	<li>bDisabled: Whether the item is disabled (read-only)
	<li>bDoDefault: A boolean flag indicating whether the default drawing method should be done
	after you have finished handling the event.  Set to True to perform the default drawing method.
	See <a href="icqmenu.htm">Start Menu/ICQ Style Pop-up Menus</a> for a demonstration of how to use
	this.
	</ul>
	You have two options for drawing the menu item.  You can either draw directly onto the DC passing
	using GDI methods, or you can use to VB drawing methods to draw onto a hidden picture box with
	<i>AutoRedraw</i> set to True, and use the <i>BitBlt</i> GDI function to transfer what you have
	drawn into the menu's DC.  The demonstration code shows how to use the GDI methods to do this.
	</ol>
	Note that there is no problem mixing owner-draw and standard items in the same menu.  So if
	the way separators draw in the default menu suits your owner-draw menu, you just leave the
	<i>OwnerDraw</i> property False for any separators.
	</p>
	</font>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<br><br><br>
	<p><a href="#sectop"><img src="..\..\images\top.gif" border="0" width="8" height="12" hspace="4" alt="Top"></a>Back to <a href="#sectop">top</a></p>
	<p><a href="..\..\overview.htm"><img src="..\..\images\sc.gif" border="0" width="8" height="12" hspace="4" alt="Source Code - What We're About!"></a>Back to <a href="..\..\overview.htm">Source Code</a></p>
	</font>
	</td>
	<td>&nbsp</td>
</tr>
</table>	


<!-- SUPERCEEDED:START -->
<br />
<table border="0" width="100%" cellspacing="0" cellpadding="5">
<tr>
<td width="66" bgcolor="#FFFFFF"><br /></td>
<td width="100%" bgcolor="#EEEEEE">
	<p>
	<font color="#666666" face="verdana,arial,helvetica" size="5">
	<b>&nbsp;NOTE:</b></font>
	<font color="#999999" face="verdana,arial,helvetica" size="2">this code has been superceded by the <a href="..\..\home\vb\code\controls\menus\popupmenu_-_ownerdraw_menu_items\article.html" target="_top">version at the new site</a>.
	</font>
	<br />
        </p>
</td>
<td width="66" bgcolor="#FFFFFF"><br /></td>
</tr>
</table>
<br />
<!-- SUPERCEDED:END -->

<img src="..\..\images\bpixel.gif" height="1" width="100%" border="0">

<!-- BODY:END -->

<!-- FOOTER:START -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 1998-1999, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 13 February 1999
	</font>
	</p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>


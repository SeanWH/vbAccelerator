<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="Author" content="Steve McMahon">
<meta name="KeyWords"
content="VB, VB6, Visual Basic, Visual Basic 5, Visual Basic 6, Dynamic HTML, DHTML, IE4, Internet Explorer, Internet Explorer 4, Active X, Active X Controls, Visual Basic Controls">
<meta name="GENERATOR" content="Notepad">
<title>Customising the ListView Control</title>
</head>

<body topmargin="0" leftmargin="0" link="#660000" vlink="#999966" LEFTMARGIN="0" TOPMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0"  background="..\..\images\legacy.html">

<!-- AD:START -->
<table bgcolor="#336699" border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr>
<td width="468">
<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelad.png" width="468" height="60" 
border="0" alt="vbAccelerator - Faster VB and .NET Code" /></a>
</noscript>
</td>
<td>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelnew.png" width="125" height="60" 
border="0" alt="The new vbAccelerator Site - more VB and .NET Code and Controls" /></a>
</td>
</tr>
</table>
<!-- AD:END -->



<a name="sectop"></a>
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#660000">
	<td width="100%" height="25">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	Source Code
	</strong>
	</font>
	</td>
	<td width="96">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	<a title="Installation Instructions and Requirements" href="..\..\install.htm"><img src="..\..\images\install.gif" height="12" width="96" border="0" valign="center"></a>
	</strong>
	</font>
	</td>
	<td width="96">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	<a title="Back to Source Code" href="..\..\overview.htm"><img src="..\..\images\srccode.gif" height="12" width="96" border="0" valign="center"></a>
	</strong>
	</font>
	</td>
</tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#006666">
	<td valign="top" width="32">
	<font color="#99CC33" face="verdana,arial,helvetica" size="6"><strong>2</strong></font>
	</td>
	<td valign="center">
	<font color="#99CC33" face="verdana,arial,helvetica" size="4"><strong>Common Controls Library</strong></font>
	</td>
	<td>&nbsp</td>
</tr>
</table>

<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#FFFFFF">
	<td>&nbsp</td>
	<td>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<br>
	<p><b>Customising the ListView Control</b><br>
	There are a large number of new features you can take advantage of with the ListView control.  
	This sample gives a brief overview of all the things you can do to make your application stand out.
	<p>
	<p><img src="..\..\images\lviewdm.gif" alt="Customised ListView" width="213" height="126"></p>
	<p>
	<img src="..\..\images\update.gif" height="11" width="23" border="0" alt="Updated" hspace="2"><b>Updated!</b><br>
	<i>2 January 1999</i>: Added a method to remove the buttons from the ListView header, and tidied up the code a little bit.
	</p>

	<p><a href="lvplay.zip"><img src="..\..\images\vbdnload.gif" width="16" height="16" border="0" hspace="4">Download the LVPlay project files (44kb)</a></p>
	<p>This sample requires the <a href="..\ssubtmr\ssubtmr.htm">SSubTmr.DLL component</a>.  Make sure you have loaded and registered this before trying the LVPlay project.</p>
	<p>
	The options which you can set depend on which version of the Common Controls DLL (COMCTL32.DLL) is available on the target machine.
	The most advanced features are only available if you have the version of COMCTL32.DLL installed with
	IE4.0.  This DLL  can also be <a href="javascript:window.alert(&quot;http://www.microsoft.com/msdn/downloads/files/40comupd.htm\nThis link was not retrieved.&quot;)">downloaded separately</a> from the
	Microsoft site.  (Note you must register with <a href="..\..\linx.htm#secmsdn">MSDN</a> to follow this link, but it is free!).
	<br>
	With all versions you can:
	<ul>
	<li>Implement a customised sorting procedure using a Callback function.  The sample code includes a generic routine
	which allows you to sort correctly according by text, number and date in either ascending or descending order.  This is
	a very powerful feature, the only slight disadvantage which arises when you use it is that the Visual Basic ListItem Indexes
	are not re-sorted so they no longer run in the order seen in the control.  This isn't too much of a problem
	normally since the Index still refers to the correct item, its just that you can't use it to determine whereabouts the item
	is in the control.  The source code shows some API techniques you can use to determine what order the items are actually in.
	</ul>
	<br>
	With version 4.70 (shipped with IE3.0+) you can:
	<ul>
	<li>Add Check Boxes to each ListView item (note that although this works, the check boxes are drawn too small unless you have version 4.71 of COMCTL32.DLL).
	You can set/get the check state for each item in code.
	<li>Set the control to automatically select items when the mouse moves over them (a feature called 'Track Select' which can be surprisingly irritating!)
	<li>Make items highlight as the mouse moves over them (hot tracking) (Good)
	<li>Customise the spacing between icons in Large Icons view
	<li>Show Grid Lines in the Detail view
	<li>Allow the Detail view Column Headers to be reordered, either in code or by Drag-Drop (Good)
	<li>Make the Detail view Column Headers highlight when the mouse moves over them (Good)
	<li>Extend the selection highlight so it covers the entire row in Detail view (Good)
	<li>Add icons to the Column Headers of the ListView (unfortunately the icons seem to adopt the wrong colour in their transparent parts, coloured the same colour as the list view background rather than the header background.  Otherwise this is a great feature.  I'm working on how to avoid this.)
	<li>Set the indentation of items in Detail View (Good)
	<li>Add icons to columns other than the first column of the Detail View (Excellent)
	</ul>
	<br>
	With version 4.71 (shipped with IE4.0+) you can:
	<ul>
	<li>Adjust the scroll bars so they display as <a href="flatsbar.htm" target="vbamain">flat scroll bars</a> (as seen in Full Screen view of IE4.0 - Good)
	<li>Set all items to be Underlined (Why?!)
	<li>Set 'Working Areas' in the control.  This allows you to divide the control into different areas and set 
	which area a list item appears in.  The intention of this is to physically separate out items which have
	different attributes.  An example of how this could be used is to set up two Working Areas, and have read only
	files in the right hand area and normal files in the left hand area.  Dragging a file from the right area to the
	left would then reset the read only flag, and vice-versa.
	<li>Change the background of the ListView to a bitmap (which is asynchronously downloaded - Excellent!)
	<li>Change the time it takes before an item is selected when Track Select is on (you need this if you intend to use Track Select because the default time is the Start Menu Popup time - which advanced users have been known to set very short!  Actually, even worse is when you work for a company with a pile of hopeless hackers in the 
	desktop support department, who make sure everybody's computer has a menu select time of 0.01 microseconds, resulting in major hangs and agro whilst trying to navigate your Start Menu when they've messed up the Network again...)
	</ul>
	</p>

	<p>
	Download the source code, have fun, and make your application look better with very little effort!
	</p>

	<br>
	<p><a href="#sectop"><img src="..\..\images\top.gif" border="0" width="8" height="12" hspace="4" alt="Top"></a>Back to <a href="#sectop">top</a><br>
	<a href="..\..\overview.htm"><img src="..\..\images\sc.gif" border="0" width="8" height="12" hspace="4" alt="Source Code - What We're About!"></a>Back to <a href="..\..\overview.htm">Source Code</a></p>
	</font>


	</td>
	<td>&nbsp</td>
</tr>
</table>

<!-- BODY:END -->

<!-- FOOTER:START -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 1998-1999, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 2 January 1999</font></p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>

<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="Author" content="Steve McMahon">
<meta name="KeyWords"
content="VB, VB6, Visual Basic, Visual Basic 5, Visual Basic 6, Dynamic HTML, DHTML, IE4, Internet Explorer, Internet Explorer 4, Active X, Active X Controls, Visual Basic Controls">
<meta name="GENERATOR" content="Notepad">
<title>Hue Lightness and Saturation (HLS) Model and Manipulating Colours</title>
</head>

<body topmargin="0" leftmargin="0" link="#660000" vlink="#999966" LEFTMARGIN="0" TOPMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0"  background="..\..\images\legacy.html">

<!-- AD:START -->
<table bgcolor="#336699" border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr>
<td width="468">
<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelad.png" width="468" height="60" 
border="0" alt="vbAccelerator - Faster VB and .NET Code" /></a>
</noscript>
</td>
<td>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelnew.png" width="125" height="60" 
border="0" alt="The new vbAccelerator Site - more VB and .NET Code and Controls" /></a>
</td>
</tr>
</table>
<!-- AD:END -->


<a name="sectop">
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#660000">
	<td width="100%" height="25">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	Source Code
	</strong>
	</font>
	</td>
	<td width="96">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	<a title="Installation Instructions and Requirements" href="..\..\install.htm"><img src="..\..\images\install.gif" height="12" width="96" border="0" valign="center"></a>
	</strong>
	</font>
	</td>
	<td width="96">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	<a title="Back to Source Code" href="..\..\overview.htm"><img src="..\..\images\srccode.gif" height="12" width="96" border="0" valign="center"></a>
	</strong>
	</font>
	</td>
</tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#999966">
	<td valign="top"  width="32">
	<font color="#993300" face="verdana,arial,helvetica" size="6"><strong>4</strong></font>
	</td>
	<td>
	<font color="#993300" face="verdana,arial,helvetica" size="4"><strong>vb<I>Media</I></strong></font>
	</td>
	<td>&nbsp</td>
</tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#EEEEEE">
	<td>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	&nbsp;<b>Hue Lightness and Saturation (HLS) Model and Manipulating Colours</b>
	</font>
	</td>
</tr>
<tr>
	<td>
	<font color="#999966" face="verdana,arial,helvetica" size="1">
	&nbsp;Pick colours and manipulate colours more easily
	</font>
	</td>	
</tr>
</table>

<!-- SUPERCEEDED:START -->
<br />
<table border="0" width="100%" cellspacing="0" cellpadding="5">
<tr>
<td width="66" bgcolor="#FFFFFF"><br /></td>
<td width="100%" bgcolor="#EEEEEE">
	<p>
	<font color="#666666" face="verdana,arial,helvetica" size="5">
	<b>&nbsp;NOTE:</b></font>
	<font color="#999999" face="verdana,arial,helvetica" size="2">this code has been superceded by the <a href="..\..\home\vb\code\vbmedia\image_processing\hue__luminance_and_saturation\article.html" target="_top">version at the new site</a>.
	</font>
	<br />
        </p>
</td>
<td width="66" bgcolor="#FFFFFF"><br /></td>
</tr>
</table>
<br />
<!-- SUPERCEDED:END -->


<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#FFFFFF">
	<td>&nbsp</td>
	<td>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<br>
	<p><img src="..\..\images\hlsdemo.gif" alt="HLS Demo Application" width="198" height="154"></p>
	<p><a href="hlsdemo.zip"><img src="..\..\images\vbdnload.gif" width="16" height="16" border="0" hspace="4">Download the Simple HLS Demo (11kb)</a></p>
	<p>This is a supporting article describing in more detail the Hue Lightness and Saturation
	colour model used in the <a href="imgproc2.htm">vbAccelerator Image Processor</a>.	
	<br><br>
	<b>The Hue Lightness Saturation Model</b><br>
	Normally in computers colours are described in terms of their Red, Green and Blue components.
	Whilst you can specify all displayable colours this way, it leaves something to be desired
	when it comes to picking a colour.  For example, most people find it very difficult to 
	determine what RGB values you would use to create a Pink or Brown colour (try it!). <br><br>
	There are numerous colour models which attempt to work around this limitation and provide
	a more intuitive way of getting to the colour you want.  One of them is the Hue Lightness and
	Saturation (HLS) Model.<br><br>
	This HLS model describes colours in the following terms:
	<ul>
	<li>Hue, which is the horizontal axis of square box in the
	picture above, and varies from magenta - red - yellow - green - cyan - blue - magenta.  
	<li>Saturation, which is the vertical axis of the square box, and describes how "grey" the colour.
	<li>Lightness, which is the second picture box and varies from black through the colour to white.
	</ul>
	With this model it is easier to pick the correct colour.  The model also allows you to do some
	things in code which you can't really achieve with RGB, such as determining what a lighter or
	darker tone of a given RGB colour is.	
	<br><br>
	<b>Coding the HLS Model</b><br>
	Normally Hue is expressed as an angle between 0-360 to describe the colour and a value
	between 0 and 1 to describe Hue and Saturation.  I have missed out the conversion to an angle
	in this implementation so the Hue works as follows:
	</p>
	</font>
	<p>
	<table border="1" cellspacing="0" cellpadding="2">
	<tr bgcolor="#CCCCCC">
		<td><font color="#000000" face="verdana,arial,helvetica" size="2"><b>Hue Value</b></font></td>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2"><b>Colour</b></font></td>
	</tr>
	<tr>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2">-1</font></td>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2">Magenta</font></td>
	</tr>
	<tr>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2">0</font></td>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2">Red</font></td>
	</tr>
	<tr>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2">1</font></td>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2">Yellow</font></td>
	</tr>
	<tr>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2">2</font></td>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2">Green</font></td>
	</tr>
	<tr>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2">3</font></td>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2">Aqua</font></td>
	</tr>
	<tr>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2">4</font></td>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2">Blue</font></td>
	</tr>
	<tr>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2">5</font></td>
		<td><font color="#000000" face="verdana,arial,helvetica" size="2">Magenta</font></td>
	</tr>
	</table>
	</p>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p>
	Here is the code to do a conversion between HLS and RGB and vice-versa:
	</p>
<p>
<font color="#000000" face="Lucida Console,courier new" size="1">
Public Sub RGBToHLS( _ <br>
&nbsp &nbsp   ByVal r As Long, ByVal g As Long, ByVal b As Long, _ <br>
&nbsp &nbsp   h As Single, s As Single, l As Single _ <br>
&nbsp &nbsp ) <br>
Dim Max As Single <br>
Dim Min As Single <br>
Dim delta As Single <br>
Dim rR As Single, rG As Single, rB As Single <br>
 <br>
&nbsp &nbsp rR = r / 255: rG = g / 255: rB = b / 255 <br>
 <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
'{Given: rgb each in [0,1]. <br>
' Desired: h in [0,360] and s in [0,1], except if s=0, then h=UNDEFINED.} <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp Max = Maximum(rR, rG, rB) <br>
&nbsp &nbsp &nbsp &nbsp Min = Minimum(rR, rG, rB) <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp l = (Max + Min) / 2'{This is the lightness} <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp '{Next calculate saturation} <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp If Max = Min Then <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp 'begin {Acrhomatic case} <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp s = 0 <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp h = 0 <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp 'end {Acrhomatic case} <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp Else <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp 'begin {Chromatic case} <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp '{First calculate the saturation.} <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp If l <= 0.5 Then <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp s = (Max - Min) / (Max + Min) <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp Else <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp s = (Max - Min) / (2 - Max - Min) <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp End If <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp '{Next calculate the hue.} <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp delta = Max - Min <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp If rR = Max Then <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp h = (rG - rB) / delta'{Resulting color is between yellow and magenta} <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp ElseIf rG = Max Then <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp h = 2 + (rB - rR) / delta '{Resulting color is between cyan and yellow} <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp ElseIf rB = Max Then <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp h = 4 + (rR - rG) / delta '{Resulting color is between magenta and cyan} <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp End If <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp 'end {Chromatic Case} <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp   End If <br>
End Sub <br>
 <br>
Public Sub HLSToRGB( _ <br>
&nbsp &nbsp   ByVal h As Single, ByVal s As Single, ByVal l As Single, _ <br>
&nbsp &nbsp   r As Long, g As Long, b As Long _ <br>
&nbsp &nbsp ) <br>
Dim rR As Single, rG As Single, rB As Single <br>
Dim Min As Single, Max As Single <br>
 <br>
&nbsp &nbsp If s = 0 Then <br>
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
  ' Achromatic case: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp   rR = l: rG = l: rB = l <br>
&nbsp &nbsp Else <br>
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
  ' Chromatic case: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
  ' delta = Max-Min <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp   If l <= 0.5 Then <br>
&nbsp &nbsp &nbsp &nbsp  's = (Max - Min) / (Max + Min) <br>
&nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
 ' Get Min value: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp  Min = l * (1 - s) <br>
&nbsp &nbsp   Else <br>
&nbsp &nbsp &nbsp &nbsp  's = (Max - Min) / (2 - Max - Min) <br>
&nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
 ' Get Min value: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp  Min = l - s * (1 - l) <br>
&nbsp &nbsp   End If <br>
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
  ' Get the Max value: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp   Max = 2 * l - Min <br>
&nbsp &nbsp    <br>
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
  ' Now depending on sector we can evaluate the h,l,s: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp   If (h < 1) Then <br>
&nbsp &nbsp &nbsp &nbsp  rR = Max <br>
&nbsp &nbsp &nbsp &nbsp  If (h < 0) Then <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp rG = Min <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp rB = rG - h * (Max - Min) <br>
&nbsp &nbsp &nbsp &nbsp  Else <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp rB = Min <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp rG = h * (Max - Min) + rB <br>
&nbsp &nbsp &nbsp &nbsp  End If <br>
&nbsp &nbsp   ElseIf (h < 3) Then <br>
&nbsp &nbsp &nbsp &nbsp  rG = Max <br>
&nbsp &nbsp &nbsp &nbsp  If (h < 2) Then <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp rB = Min <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp rR = rB - (h - 2) * (Max - Min) <br>
&nbsp &nbsp &nbsp &nbsp  Else <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp rR = Min <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp rB = (h - 2) * (Max - Min) + rR <br>
&nbsp &nbsp &nbsp &nbsp  End If <br>
&nbsp &nbsp   Else <br>
&nbsp &nbsp &nbsp &nbsp  rB = Max <br>
&nbsp &nbsp &nbsp &nbsp  If (h < 4) Then <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp rR = Min <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp rG = rR - (h - 4) * (Max - Min) <br>
&nbsp &nbsp &nbsp &nbsp  Else <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp rG = Min <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp rR = (h - 4) * (Max - Min) + rG <br>
&nbsp &nbsp &nbsp &nbsp  End If <br>
&nbsp &nbsp &nbsp &nbsp   <br>
&nbsp &nbsp   End If <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp  <br>
&nbsp &nbsp End If <br>
&nbsp &nbsp r = rR * 255: g = rG * 255: b = rB * 255 <br>
End Sub <br>
Private Function Maximum(rR As Single, rG As Single, rB As Single) As Single <br>
&nbsp &nbsp If (rR > rG) Then <br>
&nbsp &nbsp   If (rR > rB) Then <br>
&nbsp &nbsp &nbsp &nbsp  Maximum = rR <br>
&nbsp &nbsp   Else <br>
&nbsp &nbsp &nbsp &nbsp  Maximum = rB <br>
&nbsp &nbsp   End If <br>
&nbsp &nbsp Else <br>
&nbsp &nbsp   If (rB > rG) Then <br>
&nbsp &nbsp &nbsp &nbsp  Maximum = rB <br>
&nbsp &nbsp   Else <br>
&nbsp &nbsp &nbsp &nbsp  Maximum = rG <br>
&nbsp &nbsp   End If <br>
&nbsp &nbsp End If <br>
End Function <br>
Private Function Minimum(rR As Single, rG As Single, rB As Single) As Single <br>
&nbsp &nbsp If (rR < rG) Then <br>
&nbsp &nbsp   If (rR < rB) Then <br>
&nbsp &nbsp &nbsp &nbsp  Minimum = rR <br>
&nbsp &nbsp   Else <br>
&nbsp &nbsp &nbsp &nbsp  Minimum = rB <br>
&nbsp &nbsp   End If <br>
&nbsp &nbsp Else <br>
&nbsp &nbsp   If (rB < rG) Then <br>
&nbsp &nbsp &nbsp &nbsp  Minimum = rB <br>
&nbsp &nbsp   Else <br>
&nbsp &nbsp &nbsp &nbsp  Minimum = rG <br>
&nbsp &nbsp   End If <br>
   End If <br>
End Function <br>
 <br>
 <br>
</font>
</p>
<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p>
	<b>Limitations of the HLS Model</b><br>
	Whilst the HLS Model is simple to implement, and gives a relatively easy colour picking interface,
	it is not a physically accurate model.  That is to say, linear changes in lightness, hue or
	saturation do not correspond to the a linear change to the eye.  More accurate models which
	overcome these limitations exist, such as the CIE scheme, but I've yet to understand these
	enough to work them out!  Anyway, HLS works well enough unless you are interested in exact colour
	matching and processing between different display devices.
	</p>			
	<p>

	<br><br>

	<p><a href="#sectop"><img src="..\..\images\top.gif" border="0" width="8" height="12" hspace="4" alt="Top"></a>Back to <a href="#sectop">top</a><br>
	<a href="imgproc2.htm"><img src="..\..\images\back.gif" border="0" width="8" height="12" hspace="4" alt="Back"></a>Back to <a href="imgproc2.htm" target="vbamain">Image Processing Using DIB Sections</a><br>
	<a href="..\..\overview.htm"><img src="..\..\images\sc.gif" border="0" width="8" height="12" hspace="4" alt="Source Code - What We're About!"></a>Back to <a href="..\..\overview.htm" target="vbamain">Source Code Overview</a>
	</p>
	</font>

	</td>
	<td>&nbsp</td>
</tr>
</table>


<!-- BODY:END -->

<!-- FOOTER:START -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 1998-1999, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 25 August 1999</p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>
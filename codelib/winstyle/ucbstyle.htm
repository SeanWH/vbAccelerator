<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="Author" content="Steve McMahon">
<meta name="KeyWords"
content="VB, VB6, Visual Basic, Visual Basic 5, Visual Basic 6, Dynamic HTML, DHTML, IE4, Internet Explorer, Internet Explorer 4, Active X, Active X Controls, Visual Basic Controls">
<meta name="GENERATOR" content="Notepad">
<title>Set UserControl's BorderStyle property outside UserControl design time</title>
</head>

<body topmargin="0" leftmargin="0" link="#660000" vlink="#999966" LEFTMARGIN="0" TOPMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0"  background="..\..\images\legacy.html">

<!-- AD:START -->
<table bgcolor="#336699" border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr>
<td width="468">
<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelad.png" width="468" height="60" 
border="0" alt="vbAccelerator - Faster VB and .NET Code" /></a>
</noscript>
</td>
<td>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelnew.png" width="125" height="60" 
border="0" alt="The new vbAccelerator Site - more VB and .NET Code and Controls" /></a>
</td>
</tr>
</table>
<!-- AD:END -->
able border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#660000">
        <td width="100%" height="25">
        <font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
        <a name="sectop"></a>Source Code
        </strong>
        </font>
        </td>
        <td width="96">
        <font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
        <a title="Installation Instructions and Requirements" href="..\..\install.htm"><img src="..\..\images\install.gif" height="12" width="96" border="0" valign="center"></a>
        </strong>
        </font>
        </td>
        <td width="96">
        <font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
        <a title="Back to Source Code" href="..\..\overview.htm"><img src="..\..\images\srccode.gif" height="12" width="96" border="0" valign="center"></a>
        </strong>
        </font>
        </td>
</tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#6699CC">
        <td valign="top" width="32">
        <font color="#660000" face="verdana,arial,helvetica" size="6"><strong>3</strong></font>
        </td>
        <td>
        <font color="#660000" face="verdana,arial,helvetica" size="4"><strong>Code Libraries</strong></font>
        <font color="#660000" face="verdana,arial,helvetica" size="2">
        </font>
        </td>
        <td width="10">&nbsp</td>
</tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#EEEEEE">
	<td>&nbsp</td>
	<td>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p><b>Setting a UserControl's BorderStyle</b></p>
	</font>
	</td>
	<td>&nbsp;</td>
</tr>
<tr>
	<td>&nbsp;</td>
	<td>
	<font color="#660000" face="verdana,arial,helvetica" size="1">
	<p>Provide unique border style options by modifying the WindowStyle directly with this drop-in code</p>
	</font>	
	</td>
	<td>&nbsp;</td>
</tr>
</table>



<tr bgcolor="#FFFFFF">
	<td>&nbsp</td>
	<td>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p><img src="..\..\images\clrbdr.gif" alt="[BorderStyle Tester]" width="305" height="190"></p>
        <p><a href="bdrstyle.zip"><img src="..\..\images\vbdnload.gif" width="16" height="16" border="0" hspace="4"><img src="..\..\images\vbdnld6.gif" width="16" height="16" border="0" hspace="4">Download the BorderStyle control code (5kb)</a></p>

	This article provides you with drop-in code to supply <i>Appearance</i> and <i>BorderStyle</i>
	properties to any UserControl (or, in fact, any other object with a window handle) so you
	can set flat or 3D borders and you can choose no border, thin, 3D raised or 3D sunken border
	styles.
	<br><br>
	<p>VB creates a border on a UserControl through an extended Window Style provided in Win32,
	<i>WS_EX_CLIENTEDGE</i>.  You can see this by using the SPY++ program provided with various Microsoft
	Development products (on the VB Enterprise CD it can be found in the Tools directory).  Start
	SPY++ and use the Window Finder tool to point at a VB User Control with BorderStyle set
	to 1.  You will see <i>WS_EX_CLIENTEDGE</i> in the list of WindowStyles for that window.
	When this style is set, Windows automatically draws a border around the window and
	resets the client region of the window to leave out the border.
	<br><br>
	You can set other styles for a controls border by using the API <i>SetWindowLong</i>
	function.  The extended style <i>WS_EX_STATICEDGE</i> provides a thin, sunken border whilst 
	the extended style <i>WS_EX_WINDOWEDGE</i> in combination with the standard styles
	<i>WS_BORDER</i> and <i>WS_THICKFRAME</i> provides a raised edge.
	<br><br>
	The code in the control in the download provides you all you need to add these styles to
	your own user control.  It's easy!  And you don't have to change any of your resizing code
	or drawing code to add it, because VB's <i>ScaleWidth</i> and <i>ScaleHeight</i> properties
	use the underlying <i>GetClientRect</i> API and hence take account of the differing border
	styles.
	<br>
	</p>
	
	<br><br><br>

	<p>Back to <a href="#sectop">top</a></p>
	<p>Back to <a href="..\..\overview.htm" target="vbamain">Source Code Overview</a>


	</font>


	</td>
	<td>&nbsp</td>
</tr>
</table>

<!-- BODY:END -->

<!-- FOOTER:START -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 1998-2000, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 21 March 2000
	</font></p>
        </td>
    </tr>
</table>

<!-- FOOTER:END -->

</body>
</html>

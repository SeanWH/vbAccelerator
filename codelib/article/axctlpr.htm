<HTML>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="Author" content="Steve McMahon">
<meta name="KeyWords"
content="VB, VB6, Visual Basic, Visual Basic 5, Visual Basic 6, Dynamic HTML, DHTML, IE4, Internet Explorer, Internet Explorer 4, Active X, Active X Controls, Visual Basic Controls">
<meta name="GENERATOR" content="Notepad">
<title>VB Problem with Multiple UserControls in Binary Compatible Packages</title>
</head>

<body bgcolor="#FFFFFF" topmargin="0" leftmargin="0" link="#660000" vlink="#999966"  LEFTMARGIN="0" TOPMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0">

<!-- AD:START -->
<table bgcolor="#336699" border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr>
<td width="468">
<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelad.png" width="468" height="60" 
border="0" alt="vbAccelerator - Faster VB and .NET Code" /></a>
</noscript>
</td>
<td>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelnew.png" width="125" height="60" 
border="0" alt="The new vbAccelerator Site - more VB and .NET Code and Controls" /></a>
</td>
</tr>
</table>
<!-- AD:END -->
<a name="sectop"></a>	
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#CCCC33">
	<td valign="center" height="25" width="100%">
	<p><font color="#FFFFCC" face="verdana,arial,helvetica" size="4"><strong> Articles</strong></font></p>
	</td>
	<td width="10">&nbsp</td>
</tr>
<tr bgcolor="#EEEEEE">
	<td>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p><b>VB Problem with Multiple UserControls in Binary Compatible Package</b></p>
	</font>
	</td>
	<td>&nbsp;</td>
</tr>
<tr>
	<td width="100%">
	<font color="#666666" face="verdana,arial,helvetica" size="1">
	A word of warning!
	</font>
	</td>
	<td width="10"></td>
</tr>
</table>
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr>
	<td>&nbsp;</td>
	<td>
	<br>
	<img src="..\..\images\usctlpr.gif" alt="Problems..." width="217" height="144">
	</font>
	</td>
	<td>&nbsp;</td>
	</tr>
</table>

<!-- BODY:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor>
	<td>&nbsp</td>
	<table border="0" cellspacing="2" cellpadding="2" width="100%">
	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>Overview</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">	
		<p>
	VB can have problems trying to build ActiveX controls under certain circumstances.  The 
	circumstance I discovered is that VB cannot build a binary compatible control which:
	<ol>
	<li>Contains more than one UserControl
	<li>Two or more UserControls refer to each other (for example, one control is a child of another)
	<li>One UserControl contains the <i>Implements</i> statement.
	</ol>
	I discovered this problem when trying to rebuild my <a href="..\listbar\listbar.htm">ListBar component</a>.  
	This control consists of a main container control which provides bar selection buttons and a child ListView 
	control which provides the sheets themselves.  It seemed to be a sensible design decision to code the 
	ListView control into the ListBar component itself, and to hide the control from external users by making it
	private.  Then the ListView control would be self-contained, responding to its own keyboard and mouse events 
	and raising events to its parent control.  Easy.  Unfortunately, whilst this approach works the first time
	around, once the binary compatible flag has been set for the ActiveX control, it is impossible to ever compile
	a new version of the control without breaking the binary compatiblity.
		<br><br>
		</p>
		</font>
	</tr>
	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>In Detail</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">	
		<p>
	Normally, this problem does not come about.  How often do you need to create multiple UserControls
	and implement a library?  The reason it occurs in my controls is because 

	You can cause this problem to occur yourself using either VB5 or VB6.  Simply create a 
	component with 	
		</p>
		</font>
	</tr>
	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>How to Fix it</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">	
		<p>
		
		</p>
		</font>
	</tr>


	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">	
		<p>
	<br><br><br>
	<p><a href="#sectop"><img src="..\..\images\top.gif" border="0" width="8" height="12" hspace="4" alt="Top"></a>Back to <a href="#sectop">top</a><br>
	<a href="..\..\howto.htm"><img src="..\..\images\sc.gif" border="0" width="8" height="12" hspace="4" alt="Articles"></a>Back to <a href="..\..\howto.htm">Articles</a>
		</p>	
		</font>
		</td>
	</tr>
	</table>
	</p>
	</tr>
	<td>&nbsp</td>
</tr>
</table>	

<!-- BODY:END -->

<!-- FOOTER:START -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 1998-1999, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 15 November 1999</font></p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>
llspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 1998-1999, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 15 November 1999</font></p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>

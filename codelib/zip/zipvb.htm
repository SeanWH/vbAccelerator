<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="Author" content="Steve McMahon">
<meta name="KeyWords"
content="VB, VB6, Visual Basic, Visual Basic 5, Visual Basic 6, Dynamic HTML, DHTML, IE4, Internet Explorer, Internet Explorer 4, Active X, Active X Controls, Visual Basic Controls">
<meta name="GENERATOR" content="Notepad">
<title>Introduction to the freeware Info-ZIP libraries</title>
</head>


<body topmargin="0" leftmargin="0" link="#660000" vlink="#999966" LEFTMARGIN="0" TOPMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0"  background="..\..\images\legacy.html">

<!-- AD:START -->
<table bgcolor="#336699" border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr>
<td width="468">
<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelad.png" width="468" height="60" 
border="0" alt="vbAccelerator - Faster VB and .NET Code" /></a>
</noscript>
</td>
<td>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelnew.png" width="125" height="60" 
border="0" alt="The new vbAccelerator Site - more VB and .NET Code and Controls" /></a>
</td>
</tr>
</table>
<!-- AD:END -->
<a name="sectop"></a>	

<!-- SECTION:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#660000">
	<td width="100%" height="25">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	&nbsp;Source Code
	</strong>
	</font>
	</td>
	<td width="96">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	<a title="Installation Instructions and Requirements" href="..\..\install.htm"><img src="..\..\images\install.gif" height="12" width="96" border="0" valign="center"></a>
	</strong>
	</font>
	</td>
	<td width="96">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	<a title="Back to Source Code" href="..\..\overview.htm"><img src="..\..\images\srccode.gif" height="12" width="96" border="0" valign="center"></a>
	</strong>
	</font>
	</td>
</tr>
</table>
<!-- SECTION:END -->

<!-- AREA:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#6699CC">
	<td valign="top" width="32">
	&nbsp;<font color="#660000" face="verdana,arial,helvetica" size="6"><strong>3&nbsp;</strong></font>
	</td>
	<td>
	<font color="#660000" face="verdana,arial,helvetica" size="4"><strong>Code Libraries</strong></font>
	</td>
	<td width="10">&nbsp</td>
</tr>
</table>
<!-- AREA:END -->

<!-- TITLE:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#EEEEEE">
	<td>&nbsp</td>
	<td>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p><b>Introduction to the freeware Info-ZIP libraries</b></p>
	</font>
	</td>
	<td>&nbsp;</td>
</tr>
</table>
<!-- TITLE:END -->

<!-- SPLASH:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr>
	<td>&nbsp;</td>
	<td>
	<font color="#660000" face="verdana,arial,helvetica" size="1">
	<p>Add the ability to read and write ZIP files to your application without third-party controls</p>
	</font>	
	</td>
	<td>&nbsp;</td>
</tr>
</table>
<!-- SPLASH:END -->


<!-- SUPERCEEDED:START -->
<br />
<table border="0" width="100%" cellspacing="0" cellpadding="5">
<tr>
<td width="66" bgcolor="#FFFFFF"><br /></td>
<td width="100%" bgcolor="#EEEEEE">
	<p>
	<font color="#666666" face="verdana,arial,helvetica" size="5">
	<b>&nbsp;NOTE:</b></font>
	<font color="#999999" face="verdana,arial,helvetica" size="2">this code has been superceded by the <a href="..\..\home\vb\code\libraries\compression\introduction_to_the_info-zip_libraries\article.html" target="_top">version at the new site</a>.
	</font>
	<br />
        </p>
</td>
<td width="66" bgcolor="#FFFFFF"><br /></td>
</tr>
</table>
<br />
<!-- SUPERCEDED:END -->

<!-- INFO:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr>
	<td>&nbsp;</td>
	<td>
	<br>
	<img src="..\..\images\unzip.gif" alt="Unzip Demonstration Project" width="366" height="217">
	</p>
	</td>
	<td>&nbsp;</td>
</tr>
</table>
<!-- INFO:END -->

<!-- BODY:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor>
	<td>&nbsp</td>
	<td>
	<p>
	<table border="0" cellspacing="2" cellpadding="2" width="100%">
	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>Overview</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">	
	This project started when I was trying to build up the indexes for the vbAccelerator site.
	I had a program to search through all the HTML files which make up the site, and
	this could pick out the ZIP files linked to by the pages.  But how to determine which 
	projects these ZIP files contained?  You need a way to read ZIP files.  As usual with VB
	there are no library routines or standard controls available for ZIP files, so you need
	another way.
		<br><br>
	Luckily there is one, and its free! If you have a look at the Acknowledgements in the
	WinZip helpfile, you will find that the compression code for ZIP files is actually implemented 
	using free code from the <a href="..\..\linxref.htm#secinfozip">Info-ZIP</a> group:
		</font>
		
		<p align="center">
		<table border="0" width="100%">
		<tr>
		<td width="32">&nbsp;</td>
		<td><font color="#000000" face="verdana,arial,helvetica" size ="1">
		&quot;WinZip incorporates compression code by the Info-ZIP group, which is used with their permission.  Special thanks to the entire Info-Zip group, in particular to Jean-loup Gailly, Greg Roelofs, and Mark Adler. The original Info-Zip sources are freely available from CompuServe in the pcprog forum and by anonymous ftp from the Internet site ftp.uu.net:/pub/archiving/zip. We will also, upon request, mail you the Info-Zip sources if you send a self-addressed stamped envelope to the address in the WinZip &quot;About&quot; dialog box.&quot;
		</font></td>
		<td width="32">&nbsp;</td>
		</tr>
		</table>
		</p>
		</font>
	
		<font color="#000000" face="verdana,arial,helvetica" size="2">	
	Info-ZIP's purpose is to &quot;provide free, portable, high-quality versions of the Zip and UnZip compressor-archiver utilities that are compatible with the DOS-based PKZIP by PKWARE, Inc.&quot; - 
	and they do an excellent job at it.  Their code runs on almost every OS ever devised (Tandem NSK?) and is
	also part of many products such as WinZip, PGP, the third party ActiveX control DynaZip and so on.
	The licensing arrangment for this DLL is classic freeware too: you cannot sell the product,
	but you are free to use it as you wish provided that (1) the customer does not believe Unzip is
	being sold and (2) the customer receives all normal documentation.	
		<br><br>
		</font>
		</td>
	</tr>
	<tr>
	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>Using the Info-ZIP Unzip DLL from VB</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">	
	The task of using Info-ZIP in VB is greatly assisted by two things:
	<ol>
	<li>Info-ZIP being good enough to package their code into precompiled Win32 DLLs (note that
	these aren't ActiveX DLLs).
	<li>the work of coders Raymond L. King, Christian Spieler, Mike Le Voi and Mike White 
	who contributed  Visual Basic modules to the Info-ZIP project. 
	</ol>
	Unfortunately, there are two problems directly related to this. The first is
	that the Win32 DLLs from Info-ZIP have a habit of mutating radically and incompatibly 
	between versions. The second is that the VB modules supplied, although useful, are 
	very difficult to reuse because you have to pick out the code from the presentation
	in the sample.
		<br><br>
	Which is where vbAccelerator comes in!  Luckily we can deal with both of these problems.		<br><br>
		</font>
		</td>
	</tr>

	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>1) The Curious Case of the Mad DLLs</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">
	One problem with using the Info-ZIP compiled DLL as-is is that the precompiled binaries 
	supplied by the Info-ZIP group are for courtesy only, and the Win32 rules for DLL have
	not been followed, i.e. if you create a DLL which is not
	compatible with the previous version then you should change the name so you don't stop
	existing applications from working.  
		<br><br>
	For example, the function for unzipping files was actually
	<font color="#333399"><b>renamed</b><font color="#000000"> from <i>windll_unzip</i> to 
	<i>Wiz_SingleEntryUnzip</i> between versions!  No doubt Info-ZIP have their reasons for
	this but if you had production code out there that used the older version then you would 
	be stuffed - there would be no choice but to ship an entirely new version of your code.
		<br><br>
	You can prevent this happening to you by simply renaming the DLLs downloaded from
	the Info-ZIP site.  In this case, I've renamed the latest versions of the Info-ZIP DLLs 
	as follows:
		<p>
		<menu>
		<table cellspacing="0" cellpadding="0" border="0">
		<tr height="1"><td colspan="3" height="1"><img src="..\..\images\grpixel.gif" height="1" width="100%" border="0" alt=""></td></tr>
		<tr bgcolor="#FFFFCC">
			<td><p align="left"><font color="#000000" face="verdana,arial,helvetica" size="2"><b>Original&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b></font></p></td>
			<td><p align="left"><font color="#000000" face="verdana,arial,helvetica" size="2"><b>Version&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b></font></p></td>
			<td><p align="left"><font color="#000000" face="verdana,arial,helvetica" size="2"><b>Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b></font></p></td>
		</tr>
		<tr height="1">
			<td colspan="3" height="1"><img src="..\..\images\grpixel.gif" height="1" width="100%" border="0" alt=""></td>
		</tr>
		<tr>
			<td><font color="#000000" face="verdana,arial,helvetica" size="2">zip32.dll</font></td>
			<td><font color="#000000" face="verdana,arial,helvetica" size="2">2.30</font></td>
			<td><font color="#000000" face="verdana,arial,helvetica" size="2">vbzip10.dll</font></td>
		</tr>
		<tr>
			<td halign="left"><font color="#000000" face="verdana,arial,helvetica" size="2">unzip32.dll&nbsp;&nbsp;&nbsp;</font></td>
			<td halign="left"><font color="#000000" face="verdana,arial,helvetica" size="2">5.40</font></td>
			<td halign="left"><font color="#000000" face="verdana,arial,helvetica" size="2">vbuzip10.dll&nbsp;&nbsp;&nbsp;</font></td>
		</tr>
		<tr height="1">
			<td colspan="3" height="1"><img src="..\..\images\grpixel.gif" height="1" width="100%" border="0" alt=""></td>
		</tr>
		</table>
		</menu>
		</p>		
	When/if future versions appear, and it requires code to be changed, I will create new
	versions of the classes and rename the new versions of the DLL to the next number in the
	sequence, for example, <i>vbuzip11.dll</i>.
		<br><br>
	Note that because these DLLs are Win32 DLLs and not ActiveX DLLs, they should be installed
	into the <i>Windows\System</i> directory of the target machine.
		<br><br>
		</font>
		</td>
	</tr>

	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>2) Code for Tommorrow - Building for Reuse</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">
	The Info-ZIP DLLs are somewhat alarming in that they have that C-coders &quot;less is more&quot;
	type of interface.  For example, the Unzip DLL really has only one method, although this
	is complemented by some nasty callback functions, a structure with lots of members
	to fill in and 6 or seven parameters to cover all cases.  Whilst this succinct model 
	provides access to everything you need, its not so easy to use.
		<br><br>
	An easy way to manage this sort of functionality is to write a class wrapper which 
	exposes the items in a more verbose but clearer manner.  The result is a class
	with 4 events, 25 properties and 3 methods.
		<br><br>		
		</font>
		</td>
	</tr>



	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>Try the Code</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<ul>
			<li><a href="unzip.htm">Unzipping files, with a complete unzip application</a>
			<li><a href="zip.htm">Zipping files</a>
			<li><a href="zipthread.htm">In-process Free-threaded Unzipping and Zipping libraries</a> 
		</ul>
		</font>
		</td>
	</tr>


	<tr>
		<td>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p>
	<br><br><br>
	<p><a href="#sectop"><img src="..\..\images\top.gif" border="0" width="8" height="12" hspace="4" alt="Top"></a>Back to <a href="#sectop">top</a><br>
	<a href="..\..\overlib.htm"><img src="..\..\images\sc.gif" border="0" width="8" height="12" hspace="4" alt="Source Code - What We're About!"></a>Back to <a href="..\..\overlib.htm">Library Source Code</a><br>
	<a href="..\..\overview.htm"><img src="..\..\images\sc.gif" border="0" width="8" height="12" hspace="4" alt="Source Code - What We're About!"></a>Back to <a href="..\..\overview.htm">Source Code</a></p>
	</font>
		</td>
	</tr>
	</table>
	</p>
	</td>
	<td>&nbsp</td>
</tr>
</table>	

<!-- BODY:END -->

<!-- FOOTER:START -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 2000, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 1 January 2000</font></p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>

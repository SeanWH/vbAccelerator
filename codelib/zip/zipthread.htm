<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="Author" content="Steve McMahon">
<meta name="KeyWords"
content="VB, VB6, Visual Basic, Visual Basic 5, Visual Basic 6, Dynamic HTML, DHTML, IE4, Internet Explorer, Internet Explorer 4, Active X, Active X Controls, Visual Basic Controls">
<meta name="GENERATOR" content="Notepad">
<title>In-process Free-threaded Unzipping and Zipping libraries </title>
</head>

<body bgcolor="#FFFFFF" topmargin="0" leftmargin="0" link="#660000" vlink="#999966">

<!-- AD:START -->
<table bgcolor="#336699" border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr>
<td width="468">
<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelad.png" width="468" height="60" 
border="0" alt="vbAccelerator - Faster VB and .NET Code" /></a>
</noscript>
</td>
<td>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelnew.png" width="125" height="60" 
border="0" alt="The new vbAccelerator Site - more VB and .NET Code and Controls" /></a>
</td>
</tr>
</table>
<!-- AD:END -->
 name="sectop"></a>	

<!-- SECTION:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#660000">
	<td width="100%" height="25">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	&nbsp;Source Code
	</strong>
	</font>
	</td>
	<td width="96">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	<a title="Installation Instructions and Requirements" href="..\..\install.htm"><img src="..\..\images\install.gif" height="12" width="96" border="0" valign="center"></a>
	</strong>
	</font>
	</td>
	<td width="96">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	<a title="Back to Source Code" href="..\..\overview.htm"><img src="..\..\images\srccode.gif" height="12" width="96" border="0" valign="center"></a>
	</strong>
	</font>
	</td>
</tr>
</table>
<!-- SECTION:END -->

<!-- AREA:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#6699CC">
	<td valign="top" width="32">
	&nbsp;<font color="#660000" face="verdana,arial,helvetica" size="6"><strong>3&nbsp;</strong></font>
	</td>
	<td>
	<font color="#660000" face="verdana,arial,helvetica" size="4"><strong>Code Libraries</strong></font>
	</td>
	<td width="10">&nbsp</td>
</tr>
</table>
<!-- AREA:END -->

<!-- TITLE:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#EEEEEE">
	<td>&nbsp</td>
	<td>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p><b>In-process Free-threaded Unzipping and Zipping libraries</b></p>
	</font>
	</td>
	<td>&nbsp;</td>
</tr>
</table>
<!-- TITLE:END -->

<!-- SPLASH:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr>
	<td>&nbsp;</td>
	<td>
	<font color="#660000" face="verdana,arial,helvetica" size="1">
	<p>Add the ability to use ZIP asynchronously to your application without needing third-party controls</p>
	</font>	
	</td>
	<td>&nbsp;</td>
</tr>
</table>
<!-- SPLASH:END -->

<!-- INFO:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr>
	<td>&nbsp;</td>
	<td>
	<br>
	<img src="..\..\images\unzip.gif" alt="Unzip Demonstration Project" width="366" height="217">
	</p>
	</font>
	<p>
	<table border="0" cellspacing="2" cellpadding="2" width="100%">
	<tr>
		<td colspan="2" bgcolor="#99CCFF">
		<font color="#000000" face="verdana,arial,helvetica" size="1">
		<b>Download Code</b>
		</font>
		</td>
	</tr>
	<tr>
	<td><a href="unzip.html"><img src="..\..\images\vbdnload.gif" width="16" height="16" border="0" hspace="4" alt="VB5 code"></a></td>
	<td width="100%"><font color="#000000" face="verdana,arial,helvetica" size="2"><a href="unzip.html">Download the Unzip Sample project (83kb)</a></font></td>
	</tr>
	<tr>
	<td><a href="vbuzip10.zip"><img src="..\..\images\vbdnload.gif" width="16" height="16" border="0" hspace="4" alt="VB5 code"></a></td>
	<td width="100%"><font color="#000000" face="verdana,arial,helvetica" size="2"><a href="vbuzip10.zip">Download the Info-ZIP Unzip DLL (renamed to vbuzip10.dll prevent clashes with other versions) (64kb)</a></font></td>
	</tr>
	</table>
	<br>
	<table>
	<tr>
		<td>&nbsp</td>
		<td colspan="2" bgcolor="#EEEEEE">
		<font color="#000000" face="verdana,arial,helvetica" size="1">
		<b>Before you Begin</b>
		</font>
		</td>
		<td>&nbsp</td>
	</tr>
	<tr>
		<td>&nbsp</td>
		<td valign="top"><img src="..\..\images\bullet.gif" border="0" hspace="2" width="8" height="8"></td>
		<td valign="top">
		<font color="#000000" face="verdana,arial,helvetica" size="1">
		This project requires <i>vbuzip10.dll</i> to be placed in your <i>Windows\System</i> directory.
		vbuzip10.dll is Info-ZIP's unzip32.dll version 5.40, which has been renamed.
		You can download the original from this link:
		<a href="javascript:window.alert(&quot;ftp://ftp.cdrom.com/pub/infozip/WIN32/\nThis link was not retrieved.&quot;)">ftp://ftp.cdrom.com/pub/infozip/WIN32/</a>.
		Make sure you have visited <a href="..\..\linxref.htm#secinfozip">Info-ZIP's website</a>
		and read their licensing conditions and requirements before using this DLL.
		</font>
		</td>
		<td>&nbsp</td>
	</tr>
	<tr>
		<td>&nbsp</td>
		<td valign="top"><img src="..\..\images\bullet.gif" border="0" hspace="2" width="8" height="8"></td>
		<td valign="top">
		<font color="#000000" face="verdana,arial,helvetica" size="1">
		This project requires the <a href="..\cmdlgd\fdrbrws.htm">vbAccelerator Folder Browse Component.</a>.  Make sure you have loaded and registered this before trying the project.
		</font>
		</td>
		<td>&nbsp</td>
	</tr>
	</table>
	<br>
	</p>
	</td>
	<td>&nbsp;</td>
	</tr>
</table>
<!-- INFO:END -->

<!-- BODY:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor>
	<td>&nbsp</td>
	<td>
	<p>
	<table border="0" cellspacing="2" cellpadding="2" width="100%">
	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>Overview</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">	
	This project started when I was trying to build up the indexes for the vbAccelerator site.
	I had a program to search through all the HTML files which make up the site, and
	this could pick out the ZIP files linked to by the pages.  But how to determine which 
	projects these ZIP files contained?  You need a way to read ZIP files.  As usual with VB
	there are no library routines or even controls available for ZIP files, so you need
	another way.
		<br><br>
	Luckily there is one, and its free! If you have a look at the Acknowledgements in the
	WinZip helpfile, you will find that the compression code for ZIP files is actually implemented 
	using free code from the <a href="..\..\linxref.htm#secinfozip">Info-ZIP</a> group:
		</font>
		
		<p align="center">
		<table border="0" width="100%">
		<tr>
		<td width="32">&nbsp;</td>
		<td><font color="#000000" face="verdana,arial,helvetica" size ="1">
		&quot;WinZip incorporates compression code by the Info-ZIP group, which is used with their permission.  Special thanks to the entire Info-Zip group, in particular to Jean-loup Gailly, Greg Roelofs, and Mark Adler. The original Info-Zip sources are freely available from CompuServe in the pcprog forum and by anonymous ftp from the Internet site ftp.uu.net:/pub/archiving/zip. We will also, upon request, mail you the Info-Zip sources if you send a self-addressed stamped envelope to the address in the WinZip &quot;About&quot; dialog box.&quot;
		</font></td>
		<td width="32">&nbsp;</td>
		</tr>
		</table>
		</p>
		</font>
	
		<font color="#000000" face="verdana,arial,helvetica" size="2">	
	Info-ZIP's purpose is to &quot;provide free, portable, high-quality versions of the Zip and UnZip compressor-archiver utilities that are compatible with the DOS-based PKZIP by PKWARE, Inc.&quot; - 
	and they do an excellent job at it.  Their code runs on almost every OS ever devised (Tandem NSK?) and is
	also part of many products such as WinZip, PGP, the third party ActiveX control DynaZip and so on.
	The licensing arrangment for this DLL is classic freeware too: you cannot sell the product,
	but you are free to use it as you wish provided that (1) the customer does not believe Unzip is
	being sold and (2) the customer receives all normal documentation.	
		<br><br>
		</font>
		</td>
	</tr>
	<tr>
	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>Using the Info-ZIP Unzip DLL from VB</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">	
	The task of using Info-ZIP in VB is greatly assisted by the work of VB coders
	Raymond L. King, Christian Spieler, Mike Le Voi and Mike White who contributed 
	to the <i>vbunzip.bas</i> module in the download.  Whilst this module demonstrates 
	the use of the functions and provides useful declares for using them, the
	code is not at all easy to reuse because the unzipping is embedded within the 
	logic to present the information in the sample.
		<br><br>
	This sample fixes that problem by providing a class module, <i>cUnzip.cls</i>,
	which exposes all of the options and parameters as named class members as well wrapping
	up directory listing of zips with simple calls.
		<br><br>
		</font>
		</td>
	</tr>
	<tr>
	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>Make Sure You Keep Running</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">
	One problem with using the Info-ZIP compiled DLL as-is is that the precompiled binaries 
	supplied by the Info-ZIP group are for courtesy only, and the Win32 rules for DLL have
	not been followed, i.e. if you create a DLL which is not
	compatible with the previous version then you should change the name so you don't stop
	existing applications from working.  
		<br><br>
	For example, the function for unzipping files was actually
	<font color="#333399"><b>renamed</b><font color="#000000"> from <i>windll_unzip</i> to 
	<i>Wiz_SingleEntryUnzip</i> between versions!  No doubt Info-ZIP have their reasons for
	this but if you had production code out there that used the older version then you would 
	be stuffed - there would be no choice but to ship an entirely new version of your code.
		<br><br>
	You can prevent this happening to you by simply renaming the DLLs downloaded from
	the Info-Zip site.  In this case, I've renamed <i>unzip32.dll</i> to <i>vbuzip10.dll</i>.
	When/if another version appears and it requires code to be changed, I will call this 
	new version <i>vbuzip11.dll</i>, and so on.
		<br><br>
		</font>
		</td>
	</tr>
	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>Reusing the VB code</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">
	The demonstration application for download implements a fully featured unzip
	application.  However, this code is based around a reusable class and a supporting
	module:
		<ul>
		<li><i>cUnzip.cls</i>
		<li><i>mUnzip.bas</i>
		</ul>
	To use this in your application, declare a <i>WithEvents</i> instance of the <i>cUnzip</i> class:
		<br><br>
		</font>
<font color="#000000" face="Lucida Console,Courier New" size="1">
&nbsp;&nbsp;&nbsp;Private WithEvents m_cUnzip As cUnzip<br>
		<br><br>
		</font>
		<font color="#000000" face="verdana,arial,helvetica" size="2">
	The simplest operation is to open and unzip a zip without password encryption.  
	This is all you need to do:
		<br><br>
		</font>
&nbsp;&nbsp;&nbsp;<font color="#999999" face="Lucida Console,Courier New" size="1">' Set the zip file:</font><font color="#000000" face="Lucida Console,Courier New" size="1"><br>
&nbsp;&nbsp;&nbsp;m_cUnzip.ZipFile = sFIle<br>
<br>
&nbsp;&nbsp;&nbsp;<font color="#999999" face="Lucida Console,Courier New" size="1">' Set the base folder to unzip to:</font><font color="#000000" face="Lucida Console,Courier New" size="1"><br>
&nbsp;&nbsp;&nbsp;m_cUnzip.UnzipFolder = sFolder<br>
<br>
&nbsp;&nbsp;&nbsp;<font color="#999999" face="Lucida Console,Courier New" size="1">' Unzip the file!</font><font color="#000000" face="Lucida Console,Courier New" size="1"><br>
&nbsp;&nbsp;&nbsp;m_cUnzip.Unzip<br>
<br>
</font>
		<font color="#000000" face="verdana,arial,helvetica" size="2">
	If you want to get a directory listing of files within the zip, use the <i>Directory</i>
	method.  When this returns, you can use the <i>FileCount</i> property to get the number
	of files in the zip, and the <i>FileCompressionMethod</i>, <i>FileCompressionRatio</i>,
	<i>FileCRC</i>, <i>FileDate</i>, <i>FileDirectory</i>, <i>FileEncrypted</i>, <i>FilePackedSize</i>,
	and <i>FileSize</i> methods to display information about the files.
	To restrict which files are extracted, set the <i>FileSelected</i> property to <i>False</i>
	for the files you don't want to extract.
		<br><br>
	As Directory listings and Unzip operations are performed, the DLL will raise the 
	<i>Progress</i> event, which you can use to display status messages about the 
	directory operation, and <i>Cancel</i> events, which allow you to stop the directory.
		<br><br>
	The <i>PasswordRequest</i> event is raised when you attempt to extract a file from an
	encrypted ZIP.  Here you can supply the password and optionally cancel the extract operation.
	If you set the <i>PromptToOverwrite</i> option, you will also get <i>OverwritePrompt</i>
	events to respond to.
		<br><br>
	The remainder of the properties of the class allow you to set unzipping options, such as
	<i>UseFolderNames</i>.
		</font>
		</td>
	</tr>
	<tr>
		<td>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p>
	<br><br><br>
	<p><a href="#sectop"><img src="..\..\images\top.gif" border="0" width="8" height="12" hspace="4" alt="Top"></a>Back to <a href="#sectop">top</a><br>
	<a href="..\..\overlib.htm"><img src="..\..\images\sc.gif" border="0" width="8" height="12" hspace="4" alt="Source Code - What We're About!"></a>Back to <a href="..\..\overlib.htm">Library Source Code</a><br>
	<a href="..\..\overview.htm"><img src="..\..\images\sc.gif" border="0" width="8" height="12" hspace="4" alt="Source Code - What We're About!"></a>Back to <a href="..\..\overview.htm">Source Code</a></p>
	</font>
		</td>
	</tr>
	</table>
	</p>
	</td>
	<td>&nbsp</td>
</tr>
</table>	

<!-- BODY:END -->

<!-- FOOTER:START -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 2000, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 1 January 2000</font></p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>
="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 2000, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 1 January 2000</font></p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>

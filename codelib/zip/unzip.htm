<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="Author" content="Steve McMahon">
<meta name="KeyWords"
content="VB, VB6, Visual Basic, Visual Basic 5, Visual Basic 6, Dynamic HTML, DHTML, IE4, Internet Explorer, Internet Explorer 4, Active X, Active X Controls, Visual Basic Controls">
<meta name="GENERATOR" content="Notepad">
<title>Unzipping files using the free Info-Zip Unzip DLL with VB</title>
</head>


<body topmargin="0" leftmargin="0" link="#660000" vlink="#999966" LEFTMARGIN="0" TOPMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0"  background="..\..\images\legacy.html">

<!-- AD:START -->
<table bgcolor="#336699" border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr>
<td width="468">
<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelad.png" width="468" height="60" 
border="0" alt="vbAccelerator - Faster VB and .NET Code" /></a>
</noscript>
</td>
<td>
<a href="..\..\home\index.html"><img src="..\..\home\res\vbaccelnew.png" width="125" height="60" 
border="0" alt="The new vbAccelerator Site - more VB and .NET Code and Controls" /></a>
</td>
</tr>
</table>
<!-- AD:END -->
<a name="sectop"></a>	

<!-- SECTION:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#660000">
	<td width="100%" height="25">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	&nbsp;Source Code
	</strong>
	</font>
	</td>
	<td width="96">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	<a title="Installation Instructions and Requirements" href="..\..\install.htm"><img src="..\..\images\install.gif" height="12" width="96" border="0" valign="center"></a>
	</strong>
	</font>
	</td>
	<td width="96">
	<font color="#FFFFFF" face="verdana,arial,helvetica" size="2"><strong>
	<a title="Back to Source Code" href="..\..\overview.htm"><img src="..\..\images\srccode.gif" height="12" width="96" border="0" valign="center"></a>
	</strong>
	</font>
	</td>
</tr>
</table>
<!-- SECTION:END -->

<!-- AREA:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#6699CC">
	<td valign="top" width="32">
	&nbsp;<font color="#660000" face="verdana,arial,helvetica" size="6"><strong>3&nbsp;</strong></font>
	</td>
	<td>
	<font color="#660000" face="verdana,arial,helvetica" size="4"><strong>Code Libraries</strong></font>
	</td>
	<td width="10">&nbsp</td>
</tr>
</table>
<!-- AREA:END -->

<!-- TITLE:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor="#EEEEEE">
	<td>&nbsp</td>
	<td>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p><b>Unzipping files using the free Info-Zip Unzip DLL with VB</b></p>
	</font>
	</td>
	<td>&nbsp;</td>
</tr>
</table>
<!-- TITLE:END -->

<!-- SPLASH:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr>
	<td>&nbsp;</td>
	<td>
	<font color="#660000" face="verdana,arial,helvetica" size="1">
	<p>Add the ability to interpret ZIP files to your application without needing third-party controls</p>
	</font>	
	</td>
	<td>&nbsp;</td>
</tr>
</table>
<!-- SPLASH:END -->

<!-- SUPERCEEDED:START -->
<br />
<table border="0" width="100%" cellspacing="0" cellpadding="5">
<tr>
<td width="66" bgcolor="#FFFFFF"><br /></td>
<td width="100%" bgcolor="#EEEEEE">
	<p>
	<font color="#666666" face="verdana,arial,helvetica" size="5">
	<b>&nbsp;NOTE:</b></font>
	<font color="#999999" face="verdana,arial,helvetica" size="2">this code has been superceded by the <a href="..\..\home\vb\code\libraries\compression\unzipping_files\article.html" target="_top">version at the new site</a>.
	</font>
	<br />
        </p>
</td>
<td width="66" bgcolor="#FFFFFF"><br /></td>
</tr>
</table>
<br />
<!-- SUPERCEDED:END -->

<!-- INFO:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr>
	<td>&nbsp;</td>
	<td>
	<br>
	<img src="..\..\images\unzip.gif" alt="Unzip Demonstration Project" width="366" height="217">
	</p>
	</font>
	<p>
	<table border="0" cellspacing="2" cellpadding="2" width="100%">
	<tr>
		<td colspan="2" bgcolor="#99CCFF">
		<font color="#000000" face="verdana,arial,helvetica" size="1">
		<b>Download Code</b>
		</font>
		</td>
	</tr>
	<tr>
	<td><a href="vbunzip.zip"><img src="..\..\images\vbdnload.gif" width="16" height="16" border="0" hspace="4" alt="VB5 code"><img src="..\..\images\vbdnld6.gif" width="16" height="16" border="0" hspace="4" alt="VB6 code"></a></td>
	<td width="100%"><font color="#000000" face="verdana,arial,helvetica" size="2"><a href="vbunzip.zip">Download the Unzip Sample project (83kb)</a></font></td>
	</tr>
	<tr>
	<td><a href="vbuzip10.zip"><img src="..\..\images\vbdnload.gif" width="16" height="16" border="0" hspace="4" alt="VB5 code"><img src="..\..\images\vbdnld6.gif" width="16" height="16" border="0" hspace="4" alt="VB6 code"></a></td>
	<td width="100%"><font color="#000000" face="verdana,arial,helvetica" size="2"><a href="vbuzip10.zip">Download the Info-ZIP Unzip DLL (renamed to vbuzip10.dll prevent clashes with other versions) (64kb)</a></font></td>
	</tr>
	</table>
	<br>
	<table>
	<tr>
		<td>&nbsp</td>
		<td colspan="2" bgcolor="#EEEEEE">
		<font color="#000000" face="verdana,arial,helvetica" size="1">
		<b>Before you Begin</b>
		</font>
		</td>
		<td>&nbsp</td>
	</tr>
	<tr>
		<td>&nbsp</td>
		<td valign="top"><img src="..\..\images\bullet.gif" border="0" hspace="2" width="8" height="8"></td>
		<td valign="top">
		<font color="#000000" face="verdana,arial,helvetica" size="1">
		This project requires <i>vbuzip10.dll</i> to be placed in your <i>Windows\System</i> directory.
		vbuzip10.dll is Info-ZIP's unzip32.dll version 5.40, which has been renamed.
		You can download the original from this link:
		<a href="javascript:window.alert(&quot;ftp://ftp.cdrom.com/pub/infozip/WIN32/\nThis link was not retrieved.&quot;)">ftp://ftp.cdrom.com/pub/infozip/WIN32/</a>.
		Make sure you have visited <a href="..\..\linxref.htm#secinfozip">Info-ZIP's website</a>
		and read their licensing conditions and requirements before using this DLL.
		</font>
		</td>
		<td>&nbsp</td>
	</tr>
	<tr>
		<td>&nbsp</td>
		<td valign="top"><img src="..\..\images\bullet.gif" border="0" hspace="2" width="8" height="8"></td>
		<td valign="top">
		<font color="#000000" face="verdana,arial,helvetica" size="1">
		This project requires the <a href="..\cmdlgd\fdrbrws.htm">vbAccelerator Folder Browse Component.</a>.  Make sure you have loaded and registered this before trying the project.
		</font>
		</td>
		<td>&nbsp</td>
	</tr>
	</table>
	<br>
	</p>
	</td>
	<td>&nbsp;</td>
	</tr>
</table>
<!-- INFO:END -->

<!-- BODY:START -->
<table border="0" width="100%" cellspacing="0" cellpadding="0">
<tr bgcolor>
	<td>&nbsp</td>
	<td>
	<p>
	<table border="0" cellspacing="2" cellpadding="2" width="100%">
	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>Overview</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">	
	This article provides a fully featured unzip application written in VB, using the
	capabilities of the <a href="zipvb.htm">Info-ZIP Unzip DLL</a>.  The zip application
	demonstrates the abilities of the unzip DLL to handle all aspects of unzip operations -
	password protection, directory listing, including directories whilst unzipping, 
	prompts for overwriting files - in face everything you've come to expect when using
	tools like WinZIP (which isn't surprising, because WinZIP uses the same base
	code!) The code also demonstrates some nice features such as 
	<a href="..\cmdlgd\fdrbrws.htm">capturing 
	the Shell Browse for Folder Dialog</a> to provide a powerful and user-friendly method for
	picking folders and using the <a href="..\inireg\registry.htm">Registry</a> to store
	<a href="..\filemru\filemru.htm">Most-Recently Used File Lists</a>.  
		<br><br>
	More usefully, perhaps, the unzipping code is wrapped up into a reusable class which
	you can incorporate into your own projects.  So, without further ado...
		</font>
		<br><br>
		</td>
	</tr>

	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>Reusing the VB code - Quick Start</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">
	To get the simplest overview of the code, extract these two files from the Unzip Sample
	project:
		<ul>
		<li><i>cUnzip.cls</i>
		<li><i>mUnzip.bas</i>
		</ul>
	Add these two files to a new project in VB, and then declare a 
	<i>WithEvents</i> instance of the <i>cUnzip</i> class:
		<br><br>
		</font>
<font color="#000000" face="Lucida Console,Courier New" size="1">
&nbsp;&nbsp;&nbsp;Private WithEvents m_cUnzip As cUnzip<br>
		<br><br>
		</font>
		<font color="#000000" face="verdana,arial,helvetica" size="2">
	The simplest operation is to open and unzip a zip without password encryption.  
	This is all you need to do:
		<br><br>
		</font>
&nbsp;&nbsp;&nbsp;<font color="#999999" face="Lucida Console,Courier New" size="1">' Set the zip file:</font><font color="#000000" face="Lucida Console,Courier New" size="1"><br>
&nbsp;&nbsp;&nbsp;m_cUnzip.ZipFile = sFIle<br>
<br>
&nbsp;&nbsp;&nbsp;<font color="#999999" face="Lucida Console,Courier New" size="1">' Set the base folder to unzip to:</font><font color="#000000" face="Lucida Console,Courier New" size="1"><br>
&nbsp;&nbsp;&nbsp;m_cUnzip.UnzipFolder = sFolder<br>
<br>
&nbsp;&nbsp;&nbsp;<font color="#999999" face="Lucida Console,Courier New" size="1">' Unzip the file!</font><font color="#000000" face="Lucida Console,Courier New" size="1"><br>
&nbsp;&nbsp;&nbsp;m_cUnzip.Unzip<br>
<br>
		</font>
		<br><br>
		</td>
	</tr>
	

	<tr>
		<td bgcolor="#FFFFFF">
		<font color="#000000" face="verdana,arial,helvetica" size="2">
		<b>In More Detail</b>
		</font>
		</td>
	</tr>
	<tr>
		<td>
		<font color="#000000" face="verdana,arial,helvetica" size="2">


		<font color="#000000" face="verdana,arial,helvetica" size="2">
	<font color="#3366FF">Directory Listings<font color="#000000"><br>
	To get a directory of files within the zip, use the <i>Directory</i>
	method.  When this returns, you can use the <i>FileCount</i> property to get the number
	of files in the zip, and the <i>FileCompressionMethod</i>, <i>FileCompressionRatio</i>,
	<i>FileCRC</i>, <i>FileDate</i>, <i>FileDirectory</i>, <i>FileEncrypted</i>, <i>FilePackedSize</i>,
	and <i>FileSize</i> methods to display information about the files.
	You can restrict which files are extracted in an <i>Unzip</i> operation using the
	<i>FileSelected</i> property.  By default, this property is set to <i>True</i> for all files, just
	set it to <i>False</i> for the files you don't want to extract.
		<br><br>
	<font color="#3366FF">Progress and Cancel<font color="#000000"><br>		
	As Directory listings and Unzip operations are performed, the DLL will raise the 
	<i>Progress</i> event, which you can use to display status messages about the 
	directory operation, and <i>Cancel</i> events, which allows you to stop the directory or unzip
	operation.
		<br><br>
	<font color="#3366FF">Dealing With Password Protected Zips<font color="#000000"><br>		
	The <i>PasswordRequest</i> event is raised when you attempt to extract a file from an
	encrypted ZIP.  Here you can supply the password and optionally cancel the extract operation.
		<br><br>
		
	<font color="#3366FF">Overwrite Prompts<font color="#000000"><br>		
	If you set the <i>PromptToOverwrite</i> option, you will also get <i>OverwritePrompt</i>
	events to respond to whenever the ZIP DLL encounters an existing file.  Through this method
	you can decide whether to overwrite a given file or not and also whether the same response 
	should be applied to all other files in the ZIP.
		<br><br>
	The remainder of the properties of the class allow you to set unzipping options, such as
	<i>UseFolderNames</i>, <i>ExtractOnlyNewer</i> and <i>OverwriteExisting</i>.
		</font>
		<br><br>
		</td>
	</tr>
	<tr>
		<td>
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p>
	<br><br><br>
	<p><a href="#sectop"><img src="..\..\images\top.gif" border="0" width="8" height="12" hspace="4" alt="Top"></a>Back to <a href="#sectop">top</a><br>
	<a href="..\..\overlib.htm"><img src="..\..\images\sc.gif" border="0" width="8" height="12" hspace="4" alt="Source Code - What We're About!"></a>Back to <a href="..\..\overlib.htm">Library Source Code</a><br>
	<a href="..\..\overview.htm"><img src="..\..\images\sc.gif" border="0" width="8" height="12" hspace="4" alt="Source Code - What We're About!"></a>Back to <a href="..\..\overview.htm">Source Code</a></p>
	</font>
		</td>
	</tr>
	</table>
	</p>
	</td>
	<td>&nbsp</td>
</tr>
</table>	

<!-- BODY:END -->

<!-- FOOTER:START -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 2000, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 21 March 2000</font></p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>

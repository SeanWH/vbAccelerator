<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: cPickItems.cls</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: cPickItems.cls" /><link rel="stylesheet" href="..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\index.html"><img width="125" height="25" src="..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\index.html">Resources</a>&#160;.&#160;<a href="..\index.asp\index.html">Babbage</a>&#160;.&#160;<a href="article.html">(Incomplete) Menus From First Principles</a>&#160;.&#160;<a href="menu_picker.html">Menu Picker</a>&#160;.&#160;cPickItems.cls</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="menu_picker.html"><img src="..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Menu Picker</a> (35K)</p><br /><br /><img src="..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:12405</p><p class="nav">&#160;&#160;<a href="..\..\..\..\linkto_asp\id=12405&type=zip&title=menu_20picker_2ezip_5fcpickitems.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\res\update.png" width="8" height="8" alt="Update" />26 Jun 2003<br />First Posted</p><br /><br /><img src="..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\vb\code\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\vb\code\controls\imagelist\vbaccelerator_image_list_control\article.html">vbAccelerator ImageList Control and Class v2.0</a></p><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\vb\type_libraries\ishellfolder\article.html">IShellFolder Extended Type Library Version 1.2 (ISHF_Ex.Tlb)</a></p><br /><br /><img src="..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\the_site\newsite\article.html"><img src="..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: cPickItems.cls</h1><pre>VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "cPickItems"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = True
Option Explicit

Private m_hWnd As Long

Friend Sub fInit(ByVal hWnd As Long)
   m_hWnd = hWnd
End Sub
Private Function pbVerify(ctl As vbalPicker) As Boolean
   If gbValidOwner(m_hWnd, ctl) Then
      pbVerify = True
   End If
End Function

Public Sub Clear()
Dim ctl As vbalPicker
   If pbVerify(ctl) Then
      ctl.fClear
   End If
End Sub

Public Sub Remove(Index As Variant)
Dim ctl As vbalPicker
   If pbVerify(ctl) Then
      ctl.fRemoveItem Index
   End If
End Sub

Public Function Add( _
      Optional Before As Variant, _
      Optional Key As Variant, _
      Optional Style As EVPLPickItemTypes = evplIcon, _
      Optional Caption As String = "", _
      Optional Icon As Long = -1 _
   ) As cPickItem
Dim ctl As vbalPicker
Dim lID As Long
Dim lPtr As Long
Dim cI As pcItem
Dim sKeyBefore As String

   If pbVerify(ctl) Then
      
      ' Key:
      lID = gNewID()
      If IsMissing(Key) Then
         Key = "C" &amp; lID
      Else
         If Not ctl.fCheckNewKey(Key) Then
            Exit Function
         End If
      End If
      
      ' Before:
      If Not IsMissing(Before) Then
         If ctl.fGetItem(Before, lPtr, cI) Then
            sKeyBefore = cI.Key
         End If
      End If
      
      Dim cR As New cPickItem
      lPtr = ctl.fAddItem(sKeyBefore, Key, lID, Style, Caption, Icon, cR)
      If Not (lPtr = 0) Then
         Set Add = cR
      End If
   End If
End Function

Public Sub AddOfficeColours(Optional KeyPrefix As Variant, Optional ByVal
 bLargePalette As Boolean = False)
Dim sKey As String
Dim bGenKey As Boolean
Dim nIndexEnd As Long
Dim i As Long
Dim itmX As cPickItem
   
   bGenKey = (Not IsMissing(KeyPrefix))
   If bGenKey Then
      sKey = KeyPrefix
   End If
   If bLargePalette Then
      nIndexEnd = 40
   Else
      nIndexEnd = 16
   End If
   For i = 1 To nIndexEnd
      If bGenKey Then
         Set itmX = Add(, KeyPrefix &amp; i, evplColour)
      Else
         Set itmX = Add(, , evplColour)
      End If
      itmX.Color = pOfficeColour(bLargePalette, i)
   Next i
End Sub

Private Function pOfficeColour(ByVal bLargePalette As Boolean, ByVal nIndex As
 Long) As OLE_COLOR
   If bLargePalette Then
      Select Case nIndex
      Case 1: pOfficeColour = &amp;H0&amp;
      Case 2: pOfficeColour = &amp;H3399&amp;
      Case 3: pOfficeColour = &amp;H3333&amp;
      Case 4: pOfficeColour = &amp;H3300&amp;
      Case 5: pOfficeColour = &amp;H663300
      Case 6: pOfficeColour = &amp;H800000
      Case 7: pOfficeColour = &amp;H993333
      Case 8: pOfficeColour = &amp;H333333
      
      Case 9: pOfficeColour = &amp;H80&amp;
      Case 10: pOfficeColour = &amp;H66FF&amp;
      Case 11: pOfficeColour = &amp;H8080&amp;
      Case 12: pOfficeColour = &amp;H8000&amp;
      Case 13: pOfficeColour = &amp;H808000
      Case 14: pOfficeColour = &amp;HFF0000
      Case 15: pOfficeColour = &amp;H996666
      Case 16: pOfficeColour = &amp;H808080
      
      Case 17: pOfficeColour = &amp;HFF&amp;
      Case 18: pOfficeColour = &amp;H99FF&amp;
      Case 19: pOfficeColour = &amp;HCC99&amp;
      Case 20: pOfficeColour = &amp;H669933
      Case 21: pOfficeColour = &amp;HCCCC33
      Case 22: pOfficeColour = &amp;HFF6633
      Case 23: pOfficeColour = &amp;H800080
      Case 24: pOfficeColour = &amp;H999999
      
      Case 25: pOfficeColour = &amp;HFF00FF
      Case 26: pOfficeColour = &amp;HCCFF&amp;
      Case 27: pOfficeColour = &amp;HFFFF&amp;
      Case 28: pOfficeColour = &amp;HFF00&amp;
      Case 29: pOfficeColour = &amp;HFFFF00
      Case 30: pOfficeColour = &amp;HFFCC00
      Case 31: pOfficeColour = &amp;H663399
      Case 32: pOfficeColour = &amp;HC0C0C0
      
      Case 33: pOfficeColour = &amp;HCC99FF
      Case 34: pOfficeColour = &amp;H99CCFF
      Case 35: pOfficeColour = &amp;H99FFFF
      Case 36: pOfficeColour = &amp;HCCFFCC
      Case 37: pOfficeColour = &amp;HFFFFCC
      Case 38: pOfficeColour = &amp;HFFCC99
      Case 39: pOfficeColour = &amp;HFF99CC
      Case 40: pOfficeColour = &amp;HFFFFFF
      End Select
   Else
      Select Case nIndex
      Case 1: pOfficeColour = &amp;H0&amp;
      Case 2: pOfficeColour = &amp;H808080
      Case 3: pOfficeColour = &amp;H80&amp;
      Case 4: pOfficeColour = &amp;H8080&amp;
      Case 5: pOfficeColour = &amp;H8000&amp;
      Case 6: pOfficeColour = &amp;H808000
      Case 7: pOfficeColour = &amp;H800000
      Case 8: pOfficeColour = &amp;H800080
      
      Case 9: pOfficeColour = &amp;HFFFFFF
      Case 10: pOfficeColour = &amp;HC0C0C0
      Case 11: pOfficeColour = &amp;HFF&amp;
      Case 12: pOfficeColour = &amp;HFFFF&amp;
      Case 13: pOfficeColour = &amp;HFF00&amp;
      Case 14: pOfficeColour = &amp;HFFFF&amp;
      Case 15: pOfficeColour = &amp;HFF0000
      Case 16: pOfficeColour = &amp;HFF00FF
      End Select
   End If
End Function

Public Property Get Item(Index As Variant) As cPickItem
Attribute Item.VB_UserMemId = 0
Dim ctl As vbalPicker
Dim cI As pcItem
Dim lPtr As Long
   
   If pbVerify(ctl) Then
      If ctl.fGetItem(Index, lPtr, cI) Then
         Dim cR As New cPickItem
         cR.fInit m_hWnd, lPtr, cI.Key
         Set Item = cR
      End If
   End If
   
End Property

Public Property Get Count() As Long
Dim ctl As vbalPicker
   If pbVerify(ctl) Then
      Count = ctl.fItemCount
   End If
End Property

</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\vb\code\vbmedia\using_gdi_plus\index.html" ><IMG SRC="..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\index.html"><img width="125" height="25" src="..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\index.html">Resources</a>&#160;.&#160;<a href="..\index.asp\index.html">Babbage</a>&#160;.&#160;<a href="article.html">(Incomplete) Menus From First Principles</a>&#160;.&#160;<a href="menu_picker.html">Menu Picker</a>&#160;.&#160;cPickItems.cls</p><br /><p class="nav"><a href="..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 1 July 2003</p></td><td></td></tr></table>
</body></html>
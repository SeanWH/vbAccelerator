<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: cPickItem.cls</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: cPickItem.cls" /><link rel="stylesheet" href="..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\index.html"><img width="125" height="25" src="..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\index.html">Resources</a>&#160;.&#160;<a href="..\index.asp\index.html">Babbage</a>&#160;.&#160;<a href="article.html">(Incomplete) Menus From First Principles</a>&#160;.&#160;<a href="menu_picker.html">Menu Picker</a>&#160;.&#160;cPickItem.cls</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="menu_picker.html"><img src="..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Menu Picker</a> (35K)</p><br /><br /><img src="..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:12405</p><p class="nav">&#160;&#160;<a href="..\..\..\..\linkto_asp\id=12405&type=zip&title=menu_20picker_2ezip_5fcpickitem.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\res\update.png" width="8" height="8" alt="Update" />26 Jun 2003<br />First Posted</p><br /><br /><img src="..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\vb\code\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\vb\code\controls\imagelist\vbaccelerator_image_list_control\article.html">vbAccelerator ImageList Control and Class v2.0</a></p><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\vb\type_libraries\ishellfolder\article.html">IShellFolder Extended Type Library Version 1.2 (ISHF_Ex.Tlb)</a></p><br /><br /><img src="..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\the_site\newsite\article.html"><img src="..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: cPickItem.cls</h1><pre>VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "cPickItem"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = True
Option Explicit

Private m_hWnd As Long
Private m_lPtr As Long
Private m_sKey As String

Friend Function fInit(ByVal hwnd As Long, ByVal lPtr As Long, ByVal sKey As
 String)
   m_hWnd = hwnd
   m_lPtr = lPtr
   m_sKey = sKey
End Function

Private Function pbVerify(ByRef cI As pcItem, ByRef ctl As vbalPicker) As
 Boolean
   If gbValidOwner(m_hWnd, ctl) Then
      If Not m_lPtr = 0 Then
         If ctl.fIsValid(m_sKey, m_lPtr) Then
            Set cI = ObjectFromPtr(m_lPtr)
            pbVerify = True
         End If
      End If
   End If
End Function

Public Property Get DropDown() As vbalPicker
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      Dim lhWnd As Long, ctlDropDown As vbalPicker
      Dim lErr As Long
      lhWnd = c.hWndDropDown
      On Error Resume Next
      gbValidOwner lhWnd, ctlDropDown
      lErr = Err.Number
      On Error GoTo 0
      If (lErr = 0) Then
         Set DropDown = ctlDropDown
      End If
   End If
End Property
Public Property Let DropDown(ByVal ctlPicker As vbalPicker)
   pSetDropDown ctlPicker
End Property
Public Property Set DropDown(ByVal ctlPicker As vbalPicker)
   pSetDropDown ctlPicker
End Property

Private Sub pSetDropDown(ctlPicker As vbalPicker)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      Dim lhWnd As Long
      lhWnd = ctlPicker.hwnd
      Dim ctlCheck As vbalPicker
      If (gbValidOwner(lhWnd, ctlCheck)) Then
         c.hWndDropDown = lhWnd
      End If
   End If
End Sub

Public Property Get Key() As String
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      Key = c.Key
   End If
End Property

Public Property Get DropDownStyle() As EVPLPickItemDropDrownStyle
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      DropDownStyle = c.DropDownStyle
   End If
End Property
Public Property Let DropDownStyle(ByVal eAlign As EVPLPickItemDropDrownStyle)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.DropDownStyle = eAlign
      ctl.fUpdatedItem c
   End If
End Property

Public Property Get Alignment() As EVPLPickItemAlignment
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      Alignment = c.Alignment
   End If
End Property
Public Property Let Alignment(ByVal eAlign As EVPLPickItemAlignment)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.Alignment = eAlign
      ctl.fUpdatedItem c
   End If
End Property
Public Property Get ShowCaption() As Boolean
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      ShowCaption = c.ShowCaption
   End If
End Property
Public Property Let ShowCaption(ByVal bShowCaption As Boolean)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.ShowCaption = bShowCaption
      ctl.fUpdatedItem c
   End If
End Property
Public Property Get Enabled() As Boolean
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      Enabled = c.Enabled
   End If
End Property
Public Property Let Enabled(ByVal bEnabled As Boolean)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.Enabled = bEnabled
      ctl.fUpdatedItem c
   End If
End Property
Public Property Get Checked() As Boolean
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      Checked = c.Checked
   End If
End Property
Public Property Let Checked(ByVal bChecked As Boolean)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.Checked = bChecked
      ctl.fUpdatedItem c
   End If
End Property
Public Property Get HelpText() As String
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      HelpText = c.HelpText
   End If
End Property
Public Property Let HelpText(ByVal sHelpText As String)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.HelpText = sHelpText
   End If
End Property
Public Property Get Caption() As String
Attribute Caption.VB_UserMemId = 0
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      Caption = c.Caption
   End If
End Property
Public Property Let Caption(ByVal sCaption As String)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.Caption = sCaption
      ctl.fUpdatedItem c, True
   End If
End Property
Public Property Get ToolTipText() As String
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      ToolTipText = c.ToolTipText
   End If
End Property
Public Property Let ToolTipText(ByVal sToolTipText As String)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.ToolTipText = sToolTipText
   End If
End Property
Public Property Get ShortCut() As String
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      ShortCut = c.ShortCut
   End If
End Property
Public Property Let ShortCut(ByVal sShortCut As String)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.ShortCut = sShortCut
      ctl.fUpdatedItem c, True
   End If
End Property


Public Property Get Tag() As String
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      Tag = c.Tag
   End If
End Property
Public Property Let Tag(ByVal sTag As String)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.Tag = sTag
      ctl.fUpdatedItem c
   End If
End Property
Public Property Get ItemData() As Long
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      ItemData = c.ItemData
   End If
End Property
Public Property Let ItemData(ByVal lItemData As Long)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.ItemData = lItemData
   End If
End Property
Public Property Get Icon() As Long
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      Icon = c.Icon
   End If
End Property
Public Property Let Icon(ByVal lIcon As Long)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.Icon = lIcon
      ctl.fUpdatedItem c
   End If
End Property
Public Property Get LineWidth() As Long
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      LineWidth = c.LineWidth
   End If
End Property
Public Property Let LineWidth(ByVal lLineWidth As Long)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.LineWidth = lLineWidth
      ctl.fUpdatedItem c
   End If
End Property
Public Property Get LineStyle() As Long
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      LineStyle = c.LineStyle
   End If
End Property
Public Property Let LineStyle(ByVal lLineStyle As Long)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.LineStyle = lLineStyle
      ctl.fUpdatedItem c
   End If
End Property
Public Property Get Style() As EVPLPickItemTypes
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      Style = c.Style
   End If
End Property
Public Property Let Style(ByVal eStyle As EVPLPickItemTypes)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.Style = eStyle
      ctl.fUpdatedItem c, True
   End If
End Property
Public Property Get Color() As OLE_COLOR
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      Color = c.Colour
   End If
End Property
Public Property Let Color(ByVal eColor As OLE_COLOR)
Dim c As pcItem, ctl As vbalPicker
   If pbVerify(c, ctl) Then
      c.Colour = eColor
      ctl.fUpdatedItem c
   End If
End Property
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\vb\code\vbmedia\using_gdi_plus\index.html" ><IMG SRC="..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\index.html"><img width="125" height="25" src="..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\index.html">Resources</a>&#160;.&#160;<a href="..\index.asp\index.html">Babbage</a>&#160;.&#160;<a href="article.html">(Incomplete) Menus From First Principles</a>&#160;.&#160;<a href="menu_picker.html">Menu Picker</a>&#160;.&#160;cPickItem.cls</p><br /><p class="nav"><a href="..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 1 July 2003</p></td><td></td></tr></table>
</body></html>
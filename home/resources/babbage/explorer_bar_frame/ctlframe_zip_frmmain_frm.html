<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: frmMain.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmMain.frm" /><link rel="stylesheet" href="..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\index.html"><img width="125" height="25" src="..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\index.html">Resources</a>&#160;.&#160;<a href="..\index.asp\index.html">Babbage</a>&#160;.&#160;<a href="article.html">(Incomplete) IExplorer Bar Frame Control</a>&#160;.&#160;<a href="ctlframe.html">ctlFrame</a>&#160;.&#160;frmMain.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="ctlframe.html"><img src="..\..\..\res\get.png" width="8" height="8" alt="Download Page" />ctlFrame</a> (38K)</p><br /><br /><img src="..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:12341</p><p class="nav">&#160;&#160;<a href="..\..\..\..\linkto_asp\id=12341&type=zip&title=ctlframe_2ezip_5ffrmmain.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\res\update.png" width="8" height="8" alt="Update" />26 Jun 2003<br />First Posted</p><br /><br /><img src="..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><br /><br /><img src="..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\the_site\newsite\article.html"><img src="..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmMain.frm</h1><pre>VERSION 5.00
Object = "{C9E5D1F8-C181-11D3-8E24-44910FC10000}#4.0#0"; "ctlFrame.ocx"
Begin VB.Form frmMain 
   Caption         =   "Active Frame Control Tester"
   ClientHeight    =   7065
   ClientLeft      =   3675
   ClientTop       =   2220
   ClientWidth     =   9240
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmMain.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   7065
   ScaleWidth      =   9240
   Begin ctlFrame.ActiveFrame ActiveFrame3 
      Height          =   1995
      Left            =   1860
      TabIndex        =   3
      Top             =   0
      Width           =   4035
      _ExtentX        =   7117
      _ExtentY        =   3519
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      CaptionVisible  =   0   'False
      BackColor       =   -2147483633
   End
   Begin VB.TextBox Text1 
      BorderStyle     =   0  'None
      Height          =   795
      Left            =   1920
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertical
      TabIndex        =   2
      Text            =   "frmMain.frx":014A
      Top             =   2700
      Width           =   1965
   End
   Begin ctlFrame.ActiveFrame ActiveFrame2 
      Height          =   1395
      Left            =   1860
      TabIndex        =   1
      Top             =   5640
      Width           =   7365
      _ExtentX        =   12991
      _ExtentY        =   2461
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "Add-In"
      CaptionAlign    =   3
      BackColor       =   -2147483633
   End
   Begin ctlFrame.ActiveFrame ActiveFrame1 
      Height          =   7065
      Left            =   0
      TabIndex        =   0
      Top             =   0
      Width           =   1845
      _ExtentX        =   3254
      _ExtentY        =   12462
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Caption         =   "Folders"
   End
   Begin VB.Image Image1 
      Height          =   3090
      Left            =   4440
      Picture         =   "frmMain.frx":0647
      Stretch         =   -1  'True
      Top             =   540
      Width           =   4500
   End
   Begin VB.Menu mnuViewTOP 
      Caption         =   "&amp;View"
      Begin VB.Menu mnuView 
         Caption         =   "&amp;Left"
         Checked         =   -1  'True
         Index           =   0
      End
      Begin VB.Menu mnuView 
         Caption         =   "&amp;Bottom"
         Checked         =   -1  'True
         Index           =   1
      End
   End
End
Attribute VB_Name = "frmMain"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Type RECT
   left As Long
   top As Long
   right As Long
   bottom As Long
End Type
Private Declare Function SendMessage Lib "user32" Alias "SendMessageA" (ByVal
 hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long
Private Const EM_GETRECT = &amp;HB2
Private Const EM_SETRECT = &amp;HB3
Private Declare Function GetClientRect Lib "user32" (ByVal hwnd As Long, lpRect
 As RECT) As Long
Private Declare Function InflateRect Lib "user32" (lpRect As RECT, ByVal X As
 Long, ByVal Y As Long) As Long

Private Sub ActiveFrame1_QueryUnload()
   ActiveFrame1.Visible = False
   Form_Resize
End Sub

Private Sub ActiveFrame2_QueryUnload()
   ActiveFrame2.Visible = False
   Form_Resize
End Sub

Private Sub Form_Load()
   
   ' ActiveFrame1 is the LHS frame:
   ActiveFrame1.Pane = Text1
   ' ActiveFrame3 only has a border, no button:
   ActiveFrame3.Pane = Image1
   ' ActiveFrame2, the bottom frame, is left empty for this demo
      
End Sub

Private Sub Form_Resize()
Dim lL As Long
Dim lH As Long
Dim tR As RECT
On Error Resume Next
   
   ' Note we only resize the frames - any child is auto-sized to fit
   ActiveFrame1.Move Screen.TwipsPerPixelX, Screen.TwipsPerPixelY,
    ActiveFrame1.Width, Me.ScaleHeight - 2 * Screen.TwipsPerPixelY
   ' A trick to make a borderless text box look better:
   SendMessage Text1.hwnd, EM_GETRECT, 0, tR
   tR.left = 2
   tR.top = 2
   SendMessage Text1.hwnd, EM_SETRECT, 0, tR
   
   lL = (ActiveFrame1.left + ActiveFrame1.Width + 4 * Screen.TwipsPerPixelX) *
    -ActiveFrame1.Visible
   lH = (ActiveFrame2.Height + Screen.TwipsPerPixelY) * -ActiveFrame2.Visible
   ActiveFrame2.Move lL, Me.ScaleHeight - lH, Me.ScaleWidth - lL -
    Screen.TwipsPerPixelY
   If ActiveFrame2.Visible Then
      lH = lH + 4 * Screen.TwipsPerPixelY
   End If
   ActiveFrame3.Move ActiveFrame2.left, ActiveFrame1.top, ActiveFrame2.Width,
    Me.ScaleHeight - lH - Screen.TwipsPerPixelY * 2
   
End Sub


Private Sub mnuView_Click(Index As Integer)
Dim bS As Boolean
   bS = Not (mnuView(Index).Checked)
   mnuView(Index).Checked = bS
   Select Case Index
   Case 0
      ActiveFrame1.Visible = bS
   Case 1
      ActiveFrame2.Visible = bS
   End Select
   Form_Resize
End Sub

Private Sub mnuViewTOP_Click()
   mnuView(0).Checked = ActiveFrame1.Visible
   mnuView(1).Checked = ActiveFrame2.Visible
End Sub

</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\index.html" ><IMG SRC="..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\index.html"><img width="125" height="25" src="..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\index.html">Resources</a>&#160;.&#160;<a href="..\index.asp\index.html">Babbage</a>&#160;.&#160;<a href="article.html">(Incomplete) IExplorer Bar Frame Control</a>&#160;.&#160;<a href="ctlframe.html">ctlFrame</a>&#160;.&#160;frmMain.frm</p><br /><p class="nav"><a href="..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 1 July 2003</p></td><td></td></tr></table>
</body></html>
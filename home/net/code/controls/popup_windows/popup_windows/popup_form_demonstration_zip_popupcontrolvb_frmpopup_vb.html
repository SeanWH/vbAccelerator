<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: PopupControlVB_frmPopup.vb</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: PopupControlVB_frmPopup.vb" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">NET</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Popup Windows</a>&#160;.&#160;<a href="article.html">Use .NET Forms as Popup Windows</a>&#160;.&#160;<a href="popup_form_demonstration.html">Popup Form Demonstration</a>&#160;.&#160;PopupControlVB_frmPopup.vb</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="popup_form_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Popup Form Demonstration</a> (62K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:13311</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=13311&type=zip&title=popup_20form_20demonstration_2ezip_5fpopupcontrolvb_5ffrmpopup.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;.NET</p><p class="nav">&#160;&#160;C#</p><p class="nav">&#160;&#160;VB.NET</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav"><a href="bugtrak.html">BugTrak</a></p><p class="nav"><a href="bugtrak.html#bugs"><img src="..\..\..\..\..\res\btbug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 1 / 1</p><p class="nav"><a href="bugtrak.html#issues"><img src="..\..\..\..\..\res\btissue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 0 / 0</p><p class="nav"><a href="bugtrak.html#questions"><img src="..\..\..\..\..\res\btquestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:8 January 2004</p>
<br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />1 Nov 2003<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\windows_messages\mouse_gestures\article.html">Adding Mouse Gesture Support to .NET Windows Applications</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\windows_messages\subclassing_in__net\article.html">Subclassing In .NET</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\..\vb\code\controls\drop_down_tool_windows\drop_down_form_control\article.html">vbAccelerator Drop-Down and Popup Form Control</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: PopupControlVB_frmPopup.vb</h1><pre>Public Class frmPopup
    Inherits System.Windows.Forms.Form

    '/// &lt;summary&gt;
    '/// The selected item in the ListView
    '/// &lt;/summary&gt;
    Private m_selectedItem As String = ""


#Region " Windows Form Designer generated code "

    Public Sub New()
        MyBase.New()

        'This call is required by the Windows Form Designer.
        InitializeComponent()

        'Add any initialization after the InitializeComponent() call
        Dim i As Integer
        For i = 0 To 19
            Dim item As ListViewItem = New ListViewItem(String.Format("Test
             {0}", i))
            item.SubItems.Add(String.Format("{0:d}", DateTime.Now))
            lvwDemo.Items.Add(item)
        Next i

        Me.Size = New Size(lvwDemo.Right + lvwDemo.Left, btnFind.Bottom +
         lvwDemo.Left)

        lvwDemo.Select()

    End Sub

    'Form overrides dispose to clean up the component list.
    Protected Overloads Overrides Sub Dispose(ByVal disposing As Boolean)
        If disposing Then
            If Not (components Is Nothing) Then
                components.Dispose()
            End If
        End If
        MyBase.Dispose(disposing)
    End Sub

    'Required by the Windows Form Designer
    Private components As System.ComponentModel.IContainer

    'NOTE: The following procedure is required by the Windows Form Designer
    'It can be modified using the Windows Form Designer.  
    'Do not modify it using the code editor.
    Friend WithEvents txtFind As System.Windows.Forms.TextBox
    Friend WithEvents colName As System.Windows.Forms.ColumnHeader
    Friend WithEvents btnFind As System.Windows.Forms.Button
    Friend WithEvents lvwDemo As System.Windows.Forms.ListView
    Friend WithEvents colDate As System.Windows.Forms.ColumnHeader
    &lt;System.Diagnostics.DebuggerStepThrough()&gt; Private Sub InitializeComponent()
        Me.txtFind = New System.Windows.Forms.TextBox()
        Me.colName = New System.Windows.Forms.ColumnHeader()
        Me.btnFind = New System.Windows.Forms.Button()
        Me.lvwDemo = New System.Windows.Forms.ListView()
        Me.colDate = New System.Windows.Forms.ColumnHeader()
        Me.SuspendLayout()
        '
        'txtFind
        '
        Me.txtFind.Location = New System.Drawing.Point(6, 231)
        Me.txtFind.Name = "txtFind"
        Me.txtFind.Size = New System.Drawing.Size(224, 21)
        Me.txtFind.TabIndex = 4
        Me.txtFind.Text = ""
        '
        'colName
        '
        Me.colName.Width = 128
        '
        'btnFind
        '
        Me.btnFind.Location = New System.Drawing.Point(238, 231)
        Me.btnFind.Name = "btnFind"
        Me.btnFind.Size = New System.Drawing.Size(48, 24)
        Me.btnFind.TabIndex = 5
        Me.btnFind.Text = "&amp;Find..."
        '
        'lvwDemo
        '
        Me.lvwDemo.AllowColumnReorder = True
        Me.lvwDemo.Columns.AddRange(New System.Windows.Forms.ColumnHeader()
         {Me.colName, Me.colDate})
        Me.lvwDemo.FullRowSelect = True
        Me.lvwDemo.HideSelection = False
        Me.lvwDemo.Location = New System.Drawing.Point(6, 11)
        Me.lvwDemo.MultiSelect = False
        Me.lvwDemo.Name = "lvwDemo"
        Me.lvwDemo.Size = New System.Drawing.Size(280, 216)
        Me.lvwDemo.TabIndex = 3
        Me.lvwDemo.View = System.Windows.Forms.View.Details
        '
        'colDate
        '
        Me.colDate.Width = 96
        '
        'frmPopup
        '
        Me.AutoScaleBaseSize = New System.Drawing.Size(5, 14)
        Me.ClientSize = New System.Drawing.Size(292, 266)
        Me.ControlBox = False
        Me.Controls.AddRange(New System.Windows.Forms.Control() {Me.txtFind,
         Me.btnFind, Me.lvwDemo})
        Me.Font = New System.Drawing.Font("Tahoma", 8.25!,
         System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point,
         CType(0, Byte))
        Me.FormBorderStyle = System.Windows.Forms.FormBorderStyle.None
        Me.MaximizeBox = False
        Me.MinimizeBox = False
        Me.Name = "frmPopup"
        Me.ShowInTaskbar = False
        Me.TopMost = True
        Me.ResumeLayout(False)

    End Sub

#End Region

    Protected Overrides Sub OnPaint(ByVal e As
     System.Windows.Forms.PaintEventArgs)
        MyBase.OnPaint(e)
        Dim borderRect As Rectangle = New Rectangle(ClientRectangle.Location,
         ClientRectangle.Size)
        borderRect.Width -= 1
        borderRect.Height -= 1
        e.Graphics.DrawRectangle(SystemPens.ControlDark, borderRect)
    End Sub


    Private Sub btnFind_Click(ByVal sender As Object, ByVal e As
     System.EventArgs) Handles btnFind.Click
        MessageBox.Show(Me, "Perform a find on the text here.", Me.Text,
         MessageBoxButtons.OK, MessageBoxIcon.Information)
    End Sub

    Private Sub selectItem()
        If (lvwDemo.SelectedItems.Count &gt; 0) Then
            selectedItem = lvwDemo.Items(lvwDemo.SelectedIndices(0)).Text
            Close()
        End If
    End Sub

    Public Property SelectedItem() As String
        Get
            Return m_selectedItem
        End Get
        Set(ByVal Value As String)
            m_selectedItem = Value
        End Set
    End Property

    Private Sub lvwDemo_Click(ByVal sender As Object, ByVal e As
     System.EventArgs) Handles lvwDemo.Click
        selectItem()
    End Sub


    Private Sub lvwDemo_KeyDown(ByVal sender As Object, ByVal e As
     System.Windows.Forms.KeyEventArgs) Handles lvwDemo.KeyDown
        '// If an item is selected and we get a return, then close
        If (e.KeyCode = Keys.Return) Then
            selectItem()
        End If
    End Sub

    Private Sub frmPopup_Load(ByVal sender As Object, ByVal e As
     System.EventArgs) Handles MyBase.Load

        Dim itm As ListViewItem
        For Each itm In lvwDemo.Items
            If (itm.Text.Equals(SelectedItem)) Then
                itm.Selected = True
                itm.EnsureVisible()
                Return
            End If
        Next

    End Sub
End Class
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\..\index.html" ><IMG SRC="..\..\..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">NET</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Popup Windows</a>&#160;.&#160;<a href="article.html">Use .NET Forms as Popup Windows</a>&#160;.&#160;<a href="popup_form_demonstration.html">Popup Form Demonstration</a>&#160;.&#160;PopupControlVB_frmPopup.vb</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 2 November 2003</p></td><td></td></tr></table>
</body></html>
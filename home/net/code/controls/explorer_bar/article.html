<html lang="en" >
<head>

<title>vbAccelerator - .NET ExplorerBar Control</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="
The vbAccelerator .NET Explorer Bar control is a .NET implementation of the 
VB Explorer Bar Control
which provides a user interface like the one in Windows Explorer under XP. You can 
use it to create handy lists of shortcuts and informational panels, or you can 
incorporate controls into the panels to provide flexible and configurable complex user 
interface panels. The code allows you to use the inbuilt XP styles when available 
or to draw using an emulation otherwise. 
" /><link rel="stylesheet" href="..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\res\print.css" media="PRINT" /><link rel="SHORTCUT ICON" href="/home/res/vbaccel.ico" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\index.html">NET</a>&#160;.&#160;<a href="..\..\index.html">Code</a>&#160;.&#160;<a href="..\index.html">Controls</a>&#160;.&#160;.NET ExplorerBar Control</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="explorerbar_control_binary.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />ExplorerBar Control Binary</a> (40K)</p><p class="nav"><a href="explorerbar_control_demonstration.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />ExplorerBar Control Demonstration</a> (47K)</p><p class="nav"><a href="explorerbar_control_documentation.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />ExplorerBar Control Documentation</a> (265K)</p><p class="nav"><a href="explorerbar_control_source_code.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />ExplorerBar Control Source Code</a> (201K)</p><br /><br /><img src="..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:14441</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\linkto_asp\id=14441&type=article&title=_2enet_20explorerbar_20control.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;C#</p><p class="nav">&#160;&#160;VB.NET</p><p class="nav">&#160;&#160;.NET</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\res\update.png" width="8" height="8" alt="Update" />17 Apr 2004<br />First Posted</p><br /><br /><img src="..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\vb\code\controls\explorer_bar_control\article.html">vbAccelerator Explorer Bar Control</a></p><p class="nav"><img src="..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\libraries\graphics\reading_exif_tags_from_jpg_files\article.html">Reading EXIF Tags From JPEG Files</a></p><br /><br /><img src="..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>.NET ExplorerBar Control</h1><p class="splash">Create highly customisable XP Style Explorer user interfaces on all versions of Windows</p><img src="explorerbar.png" width="425" height="450" alt="Explorer Bar Control Demonstration" /><p /><p>
The vbAccelerator .NET Explorer Bar control is a .NET implementation of the 
<a href="..\..\..\..\vb\code\controls\explorer_bar_control\article.html">VB Explorer Bar Control</a>
which provides a user interface like the one in Windows Explorer under XP. You can 
use it to create handy lists of shortcuts and informational panels, or you can 
incorporate controls into the panels to provide flexible and configurable complex user 
interface panels. The code allows you to use the inbuilt XP styles when available 
or to draw using an emulation otherwise. 
</p><h2>About The Downloads</h2><p>There are three downloads provided with this article. </p><ul><li>The <strong>Binary</strong> download provides the official vbAccelerator strong-named 
signed assembly for the control, <span class="i">acclExplorerBar.Dll</span>. This assembly 
can be registered into the Global Assembly Cache (GAC).</li><li>The <strong>Demonstration</strong> download uses the signed assembly. You need to 
have the signed control to run the demonstration; it can either by registed into the 
GAC or placed into the demonstration executable directory.</li><li>The <strong>Source</strong> download provides the projects used to develop and release 
the control. You can copy the ExplorerBar control source into your own project from here, or build 
your own version if you provide a new strong-name key pair.</li></ul><p>
The control itself requires permissions to run <strong>Unmanaged</strong> and <strong>Unsafe</strong>
code.  Unmanaged code permissions are needed for the Windows API calls used internally by the control
to draw the XP appearance, and unsafe permission is needed for the image processing routines used
internally.  A simplified version of the control which does not require these permissions is
being researched.
</p><h2>Control API</h2><p>
The top level interface of the ExplorerBar control is based around two collections:
the <span class="code">ExplorerBarCollection</span>, which maintains the list of bars
in the control, and the <span class="code">ExplorerBarItemsCollection</span>, which 
contains the items held within a particular bar.  Bars and items both implement the
<span class="code">IExplorerBarControlItem</span> interface, which provides the
mechanism by which user actions interact with the objects in the control.  This API
is shown in the UML diagram below:
</p><img src="explorerbarmainmodel.png" width="474" height="457" alt="Explorer Bar UML Main Class Model" /><p class="caption">Explorer Bar Main Class Model</p><p>
The <span class="code">ExplorerBarItem</span> class is <span class="code">abstract</span> 
because there are several implementing subclasses with specific behaviour.  There are
three main types:
</p><ol><li>Items with text and optionally an icon or image.  This type is divided into text-only items,
hyper-link type items and check and radio buttons.</li><li>Items which hold controls.</li><li>Items which display an image.</li></ol><p>
The class diagram for items is shown in this UML diagram:
</p><img src="explorerbaritemmodel.png" width="494" height="452" alt="Explorer Bar Item UML Class Model" /><p class="caption">Explorer Bar Item Class Model</p><h2>Using the Control</h2><p>
This section walks through the control and describes the features, methods and properties of the
control.  The following areas are covered:
</p><ol><li><a href="#adding">Adding the Control to your project</a></li><li><a href="#configuring">Initialising and Configuring the Control</a></li><li><a href="#barsAndItems">Adding Bars and Items</a></li><li><a href="#events">Responding to Events</a></li></ol><a name="adding" /><h3>1. Adding the Control to your project</h3><p>If you are using the control binary, then add a reference to <span class="i">acclExplorerBar.DLL</span>
to your project.  If you use the form designer to draw the form then you'll aslo need to use the
Customise Toolbox dialog in VS.NET to pick the control again so it appears in the toolbox, otherwise
just declare an instance of the control in your form:
</p><pre>
using vbAccelerator.Components.Controls;
using System.Windows.Forms;

private acclExplorerBar barOptions;

   barOptions = new acclExplorerBar();
   barOptions.Name = "barOptions";
   barOptions.Dock = DockStyle.Left;
   barOptions.Width = 240;
   Controls.AddRange(new Control[] barOptions);
</pre><a name="configuring" /><h3>2. Initialising and Configuring the Control</h3><p>The ExplorerBar control has two modes: the <span class="code">Default</span> mode, in
which each bar in the control has its own single line title and appears distinct from
the others, and the <span class="code">Search</span> mode, in which bars all appear in the
same container:
</p><img src="explorerbarmodes.png" width="444" height="391" alt="Default and Search Explorer Bar Modes" /><p class="caption">Default and Search ExplorerBar Modes</p><p>
Icons for bars and items are typically sourced from <span class="code">ImageList</span> objects.
The <span class="code">TitleImageList</span> specifies the source of icons for the titles of
bars in the control, whereas the <span class="code">ImageList</span> property is for the items.
The control can display tooltips if you associate a <span class="code">ToolTip</span>
with it.
</p><p>
Finally, you can choose the drawing style of the control.  This is one of the 
<span class="code">ExplorerBarDrawingStyle</span> enumerated values:
</p><ol><li><span class="code">System</span> - use the current system style for the bar.</li><li><span class="code">XP</span> - always use XP style; emulating if necessary.</li><li><span class="code">Classic</span> - always use classic style.</li><li><span class="code">Custom</span> - use emulated XP style and allow customised colours.</li></ol><a name="barsAndItems" /><h3>3. Adding Bars and Items</h3><p>
Adding a bar is performed through the <span class="code">Add</span> method of the control's
<span class="code">Bars</span> collection.  Normally, you will want to create a new bar
and add all of the items to it before adding it to the collection, as this prevents the
control performing so many updates (although you can also prevent updates by setting the
control's <span class="code">Redraw</span> property).  Bars have the following properties:
</p><ul><li><span class="code">Text</span> - the title to display in the bar.</li><li><span class="code">ToolTipText</span> - text to display in a tooltip when the mouse hovers over the bar.</li><li><span class="code">IconIndex</span> - an optional index to an icon in the <span class="code">TitleImageList</span> associated with the bar.  If this is set the bar will draw the icon at
the near-edge of the title.</li><li><span class="code">IsSpecial</span> - special bars are used to highlight bars in the control and
render with different colours. In Windows Explorer this feature is used to highlight specific tasks, 
for example, image specific tasks in the My Pictures folder.</li><li><span class="code">Watermark</span> - an optional image to display behind the items in the bar.  By
default, the control will image process this bitmap so it matches the colours of the bar.  This allows
you to use any image with low contrast and it will match the control regardless of the colour scheme.
However, you can also display it directly using the <span class="code">WatermarkMode</span> property.
The alignment of the image in the bar can be modified using the <span class="code">WatermarkHAlign</span> and 
<span class="code">WatermarkVAlign</span> properties; by default it appears at the bottom far corner
of the bar.</li><li><span class="code">CanExpand</span> - by default bars can be expanded and collapsed, however, you 
can create bars which are always open by setting this property to <span class="code">false</span>.  If
you do not set any title <span class="code">Text</span> then the resulting bar will not have a title
at all and the items will display from the top of the bar.</li><li><span class="code">State</span> - gets/sets whether the bar is expanded or collapsed.</li></ul><p>Sample code:</p><pre>
ExplorerBar bar = new ExplorerBar();
bar.Text = "File and Folder Tasks";
bar.ToolTipText = "These tasks apply to files and folders you select";
// Add items here

barOptions.Bars.Add(bar);
</pre><p>
Adding items to the bar is accomplished through the bar's <span class="code">Items</span> property.
As with bars, you can create new items, set their properties and then add them to the bar afterwards.
As noted before, there are six concrete subclasses of <span class="code">ExplorerBarItem</span> 
that can be added (and you can derive your own too):  
</p><ol><li><span class="code">ExplorerBarLinkItem</span> - an item with text and optional icon that 
highlights when the mouse moves over and can be clicked.</li><li><span class="code">ExplorerBarTextItem</span>  - same as a link item except the item
does not highlight or respond to clicks.</li><li><span class="code">ExplorerBarCheckBoxItem</span> - same as a link item but displays a 
check box instead of an icon.</li><li><span class="code">ExplorerBarRadioItem</span> - same as a link item but displays a radio
button instead of an icon.  Only one radio item can be selected within an individual bar.</li><li><span class="code">ExplorerBarControlHolderItem</span> - an item which is a placeholder for
any other <span class="code">Control</span>.</li><li><span class="code">ExplorerBarImageItem</span> - an item which displays a centred 
<span class="code">Image</span>.</li></ol><p>Each subclass has its own properties depending
on the capabilities of the item.  The most commonly used items are Link items and Text items, which
are identical except for the way they respond to user input.  These have the following properties:
</p><ul><li><span class="code">Text</span> - the text to display for the item.</li><li><span class="code">ToolTipText</span> - text to display in a tooltip when the mouse hovers over the bar.</li><li><span class="code">IconIndex</span> - optional index of an icon to display next to the item from
the <span class="code">ImageList</span> associated with the control.</li><li><span class="code">Font</span> - optional specific font to use for this item. If not specified or
set to <span class="code">null</span> the font of the control will be used.</li><li><span class="code">Bold</span> - if set to <span class="code">true</span> this item will use
a bold version of the font when drawn.</li><li><span class="code">ForeColor</span> and <span class="code">ForeColorHot</span> - properties to
override the default text colour of the item.  If set to <span class="code">Color.Empty</span> (the
default) then the standard colours are used.</li></ul><p>Sample code:</p><pre>
ExplorerBarLinkItem item = new ExplorerBarLinkItem();
item.Text = "My Computer";
item.IconIndex = 5;
item.ToolTipText = "Shows the disks and harddrives connected to this computer";

bar.Items.Add(item);
</pre><p>
The Radio and Check items are very similar, except they have a <span class="code">Checked</span>
property rather than an icon index.
</p><p>
Control holder items have only one property: <span class="code">Control</span>.  Setting this
property will cause the control to be made a child of the ExplorerBar control.  Note that
it will also disable animations if the bar is expanded or collapsed, since the current Windows
implementation does not efficiently allow animations of Windows.
</p><p>
Image items also have only one property, the <span class="code">Image</span>.  Although an Image
item will scale the image to fit the available space in the bar, for performance you should create
 a thumbnail for large images first and then assign that to the control (this task can also be performed
on a background thread for performance; see <a href="..\..\libraries\graphics\reading_exif_tags_from_jpg_files\article.html">Reading EXIF Tags from JPEG
files</a> for a sample which does this).
</p><a name="events" /><h3>4. Responding to Events</h3><p>
There are three events that you'll probably be interested in responding to for the control:
</p><ol><li><span class="code">BarClick</span>, raised when bars are clicked.</li><li><span class="code">ItemClick</span>, raised when items are clicked.</li><li><span class="code">NonBarClick</span>, which is raised when any other area of the control is clicked.</li></ol><p>
When responding to the <span class="code">ItemClick</span> event, if you use different types of
items in the control you can either choose to use a single event handler and check the type of
the item that is being clicked, or (possibly more elegantly) use different event handlers for the
different types:
</p><pre>
   ...
   barSearch.ItemClick += new ExplorerBarItemClickEventHandler(barSearch_ItemClick);
   ...

private void barSearch_ItemClick(
      object sender, 
      ExplorerBarItemClickEventArgs e)
{
   // Check type of item that has been clicked:
   if (typeof(ExplorerBarRadioButtonItem).IsAssignableFrom(e.Item.GetType()))
   {
       // Perform radio button check processing
   }
}
</pre><h2>Implementation Notes</h2><p>
There were a number of issues that dogged the implementation of this control; these may
prove useful if you're trying to create your own control with some of these features so
I'll describe the issues and how I worked around them here.
</p><ol><li><a href="#scroll">Creating scrollable controls</a>.</li><li><a href="#focus">Implementing focus</a>.</li><li><a href="#transparent">Loading and drawing transparent bitmaps</a>.</li></ol><a name="scroll" /><h3>1. Creating scrollable controls</h3><p>
The System.Windows.Forms namespace <span class="code">ScrollableControl</span> is the obvious base for this type of
control.  However, this implementation has been specifically designed to act as a container
for other controls, and has some problems:
</p><ol><li>Whenever the size of the scroll viewport is changed, the position is reset to the top.</li><li>The control automatically sets scrolling based on child controls.</li><li>The scroll viewport is limited to a signed 16-bit range (from -32767 to 32768).</li></ol><p>
Whilst the last problem isn't an issue for the Explorer Bar control, the other to can be.  Therefore
this control implements a new scrollable control container using the Windows API to manipulate
the scroll bars.  The <span class="code">ControllableScrollableControl</span> class implements
this. Rather than implementing automatic scroll, this provides completely controllable access
to the position of the Horizontal and Vertical scroll bars.
</p><a name="focus" /><h3>2. Implementing Focus</h3><p>
The control framework has two types of controls: standard controls and container controls,
which can be configured when a control is created using the <span class="code">SetStyle</span>
member.  When a control contains other controls, it can no longer receive the input focus.
This is a problem for the ExplorerBar since it should both be able to contain controls
<span class="i">and</span> get the input focus itself.
</p><p>
To resolve this issue, the control uses a sub-control called <span class="code">FocusFaker</span>
which is responsible for gaining the focus and forwarding on keyboard events when the user selects
the control.  Since controls must be visible in order to gain focus, the FocusFaker control is 
positioned just out of view at the top-left area of the control.  Whenever a child control is
added to the control, a new FocusFaker is also generated which will then be next after the control
in the tab-order.  This allows the user to tab between internal objects in the control like
Bars and Items as well as into controls.
</p><a name="transparent" /><h3>3. Drawing Transparent Bitmaps</h3><p>
Although GDI+ provides support for alpha throughout, this support isn't so good for bitmaps.
If you load an image through GDI+ you will always find that the alpha channel is discarded.
This is a problem for the ExplorerBar where the images for the buttons are stored in Windows
as 32bpp bitmaps and rely on the alpha channel being preserved.  
</p><p>
You can see this by attempting to load the ExplorerBar images using the supplied 
<span class="code">FromResource</span> method of a <span class="code">Bitmap</span>
object:
</p><img src="gdiplusproblem.png" width="188" height="62" alt="Loading a transparent bitmap using FromResource" /><p class="caption">The Alpha Channel is discarded when using Bitmap.FromResource</p><p>
To preserve the alpha channel needs a significant amount more work.  To get a transparent bitmap 
using the API from a resource you use the <span class="code">LoadImage</span> API with the
<span class="code">LR_CREATEDIBSECTION</span> flag:
</p><pre>
[DllImport("user32", CharSet=CharSet.Auto, EntryPoint="LoadImage")]
private extern static IntPtr LoadImageLong(
      IntPtr hInst, 
      int lpsz, 
      int uType, 
      int cX, 
      int cY , 
      int uFlags);

[DllImport("gdi32")]
private static extern int DeleteObject(IntPtr hObject);

public enum ImageType
{
   IMAGE_BITMAP = 0,
   IMAGE_ICON = 1,
   IMAGE_CURSOR = 2
}

[Flags]
public enum ImageLoadOptions
{
   LR_DEFAULTCOLOR = 0,
   LR_MONOCHROME = 0x1,
   LR_COLOR = 0x2,
   LR_COPYRETURNORG = 0x4,
   LR_COPYDELETEORG = 0x8,
   LR_LOADFROMFILE = 0x10,
   LR_LOADTRANSPARENT = 0x20,
   LR_DEFAULTSIZE = 0x40,
   LR_VGACOLOR = 0x80,
   LR_LOADMAP3DCOLORS = 0x1000,
   LR_CREATEDIBSECTION = 0x2000,
   LR_COPYFROMRESOURCE = 0x4000,
   LR_SHARED = 0x8000
}

public IntPtr GetResource(
      int id,
      ImageType imageType,
      ImageLoadOptions options
   )
{
   ...
   handle = LoadImageLong(hLib, id, (int) imageType, 0, 0, (int) options);
   ...
}

   IntPtr hDib = lib.GetResource(
      id, 
      ResourceLibrary.ImageType.IMAGE_BITMAP, 
      ResourceLibrary.ImageLoadOptions.LR_CREATEDIBSECTION);
   if (!hDib.Equals(IntPtr.Zero))
   {
       Bitmap bm = ImageUtility.DibToBitmap(hDib);
       DeleteObject(hDib);
   }

</pre><p>
This yields a DIB Section which correctly contains transparency.  If you create an unmanaged
DC to contain it, you can then use the API function <span class="code">AlphaBlend</span> to draw
the image onto a DC obtained from a <span class="code">Graphics</span> object with the
<span class="code">GetHdc()</span> function.  However, it is nicer to be able to draw
it using the Framework.  To do this, it is necessary to copy the DIB data into a bitmap.
The first thing to note is that DIBs are stored "upside-down" and the second
is that the the .NET Framework lies to you when it suggests you can create a new Bitmap 
with an alpha channel: instead you have to clone a bitmap with the correct bitmap format!  
Here's the code to generate the bitmap with transparency from the DIB:
</p><pre>
   [DllImport("kernel32", EntryPoint="RtlMoveMemory")]
   private static extern int CopyMemory(
      IntPtr lpvDest, 
      IntPtr lpvSrc, 
      int cbCopy);

   ...

   BITMAP tBM = new BITMAP();
   GetObjectBitmap(hDib, Marshal.SizeOf(tBM), ref tBM);
   Bitmap bm = new Bitmap(tBM.bmWidth, tBM.bmHeight);

   // set the bitmap's data to the data from
   // the DIB:
   if (tBM.bmBitsPixel == 32)
   {
      // Bizarre but true: you *must* clone the newly created
      // bitmap to get one with the correct pixel format, even
      // if you attempted to create the original one with the 
      // correct format...
      bm = bm.Clone(new Rectangle(0, 0, tBM.bmWidth, tBM.bmHeight),
         PixelFormat.Format32bppArgb);

      // Lock the bitmap bits
      BitmapData destData = bm.LockBits(
         new Rectangle(0, 0, bm.Width, bm.Height),
         ImageLockMode.ReadWrite,
         PixelFormat.Format32bppArgb);
      int destWidth = destData.Stride;
      IntPtr destScan0 = destData.Scan0;

      // Unfortunately Marshal.Copy does not provide a suitable 
      // copy method for this operation
      CopyMemory(destScan0, tBM.bmBits, bm.Width * bm.Height * 4);
      bm.UnlockBits(destData);

      // DIBs are "upside-down" compared to GDI+ images:
      bm.RotateFlip(RotateFlipType.Rotate180FlipNone);
   }
   ... see the download code for &lt; 32 bpp processing
</pre><h2>Conclusion</h2><p>
This article provides a fully featured Explorer Bar control you can include in
your projects, and has also described workarounds for a few thorny issues in
the .NET Framework which may prove helpful when creating your own advanced controls.
</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\vb\code\libraries\compression\index.html" ><IMG SRC="..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\index.html">NET</a>&#160;.&#160;<a href="..\..\index.html">Code</a>&#160;.&#160;<a href="..\index.html">Controls</a>&#160;.&#160;.NET ExplorerBar Control</p><br /><p class="nav"><a href="..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2004 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 18 April 2004</p></td><td></td></tr></table>
</body></html>
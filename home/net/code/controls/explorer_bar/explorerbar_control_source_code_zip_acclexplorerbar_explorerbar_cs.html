<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: acclExplorerBar_ExplorerBar.cs</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: acclExplorerBar_ExplorerBar.cs" /><link rel="stylesheet" href="..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\res\print.css" media="PRINT" /><link rel="SHORTCUT ICON" href="/home/res/vbaccel.ico" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\index.html">NET</a>&#160;.&#160;<a href="..\..\index.html">Code</a>&#160;.&#160;<a href="..\index.html">Controls</a>&#160;.&#160;<a href="article.html">.NET ExplorerBar Control</a>&#160;.&#160;<a href="explorerbar_control_source_code.html">ExplorerBar Control Source Code</a>&#160;.&#160;acclExplorerBar_ExplorerBar.cs</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="explorerbar_control_binary.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />ExplorerBar Control Binary</a> (40K)</p><p class="nav"><a href="explorerbar_control_demonstration.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />ExplorerBar Control Demonstration</a> (47K)</p><p class="nav"><a href="explorerbar_control_documentation.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />ExplorerBar Control Documentation</a> (265K)</p><p class="nav"><a href="explorerbar_control_source_code.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />ExplorerBar Control Source Code</a> (201K)</p><br /><br /><img src="..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:14471</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\linkto_asp\id=14471&type=zip&title=explorerbar_20control_20source_20code_2ezip_5facclexplorerbar_5fexplorerbar.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;C#</p><p class="nav">&#160;&#160;VB.NET</p><p class="nav">&#160;&#160;.NET</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\res\update.png" width="8" height="8" alt="Update" />17 Apr 2004<br />First Posted</p><br /><br /><img src="..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\vb\code\controls\explorer_bar_control\article.html">vbAccelerator Explorer Bar Control</a></p><p class="nav"><img src="..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\libraries\graphics\reading_exif_tags_from_jpg_files\article.html">Reading EXIF Tags From JPEG Files</a></p><br /><br /><img src="..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: acclExplorerBar_ExplorerBar.cs</h1><pre>using System;
using System.Collections;
using System.Drawing;
using System.Drawing.Imaging;
using System.Windows.Forms;
using vbAccelerator.Components.Controls.ExplorerBarFramework;
using vbAccelerator.Components.Controls.ExplorerBarUtility;

namespace vbAccelerator.Components.Controls
{
   /// &lt;summary&gt;
   /// A single bar within the Explorer Bar control.
   /// &lt;/summary&gt;
   public class ExplorerBar : ICloneable, IExplorerBarControlItem
   {
      /// &lt;summary&gt;
      /// Instance of the &lt;see cref="acclExplorerBar"/&gt; control
      /// which owns this bar.
      /// &lt;/summary&gt;
      protected acclExplorerBar owner = null;

      private ExplorerBarItemCollection items = null;
      private object tag = null;
      private bool isSpecial = false;
      private Bitmap watermark = null;
      private ExplorerBarWatermarkMode watermarkMode =
       ExplorerBarWatermarkMode.Colourise;
      private ExplorerBarWatermarkAlignment watermarkHAlign =
       ExplorerBarWatermarkAlignment.Far;
      private ExplorerBarWatermarkAlignment watermarkVAlign =
       ExplorerBarWatermarkAlignment.Far;
      private int iconIndex = -1;
      private string text = "";
      private char mnemonicCode = '\0';
      private string toolTipText = "";
      private Color titleBackColorStart = Color.Empty;
      private Color titleBackColorEnd = Color.Empty;
      private Color titleForeColor = Color.Empty;
      private Color titleForeColorHot = Color.Empty;
      private Color backColor = Color.Empty;
      private Font font = null;
      private bool canExpand = true;
      private ExplorerBarState state = ExplorerBarState.Expanded;
      private int marginSize = 12;
      private bool animateStateChanges = true;

      private Bitmap processedWatermark = null;

      private int titleHeightWithScroll = 24;
      private int titleTextHeightWithScroll = 24;
      private bool singleLineTitleWithScroll = true;
      private bool singleLineTitleWithoutScroll = true;

      private int titleHeightWithoutScroll = 24;
      private int titleTextHeightWithoutScroll = 24;

      private int heightWithScroll = 12;
      private int heightWithoutScroll = 12;
      private int top  = 0;
      private bool mouseOver = false;
      private bool mouseDown = false;
      private bool expanding = false;
      private bool collapsing = false;
      private int alpha = 255;
      private int collapseOffset = 0;
      private bool hasFocus = false;

      /// &lt;summary&gt;
      /// Constructs a new, default instance of this class.
      /// &lt;/summary&gt;
      public ExplorerBar()
      {
         items = new ExplorerBarItemCollection();
      }

      #region Internal Implementation
      internal bool Animating
      {
         get
         {
            return (expanding || collapsing);
         }
      }

      internal void SetOwner(acclExplorerBar newOwner)
      {
         if (newOwner == null)
         {
            OnSizeChanged();
            if (owner != null)
            {
               owner.InternalOnBarRemoved(this);
            }
            owner = null;
         }
         else
         {
            if (owner == null)
            {
               owner = newOwner;
               // Set the owner of all the child items:
               items.SetOwner(owner);
               OnSizeChanged();
               if (watermark != null)
               {
                  OnWatermarkChanged();
               }
            }
            else if (owner != newOwner)
            {
               owner = newOwner;
               OnSizeChanged();
            }
         }

      }

      internal Bitmap ProcessedWatermark
      {
         get
         {
            return processedWatermark;
         }
         set
         {
            processedWatermark = value;
         }
      }

      internal int HeightWithScroll
      {
         get
         {
            int height = 0;
            if (expanding || collapsing)
            {
               height = heightWithScroll + collapseOffset;
            }
            else
            {
               if (state == ExplorerBarState.Expanded)
               {
                  height = heightWithScroll;
               }
               else
               {
                  height = titleHeightWithScroll;
               }
            }
            return height;
         }
      }

      internal int HeightWithoutScroll
      {
         get
         {
            int height = 0;
            if (collapsing || expanding)
            {
               height = heightWithoutScroll + collapseOffset;
            }
            else
            {
               if (state == ExplorerBarState.Expanded)
               {
                  height = heightWithoutScroll;
               }
               else
               {
                  height = titleHeightWithoutScroll;
               }
            }
            return height;
         }
      }

      internal int TitleHeightWithScroll
      {
         get
         {
            return titleHeightWithScroll;
         }
      }

      internal int TitleHeightWithoutScroll
      {
         get
         {
            return titleHeightWithoutScroll;
         }
      }

      internal void SetAnimationInformation(bool newExpanding, bool
       newCollapsing)
      {
         expanding = newExpanding;
         collapsing = newCollapsing;
      }

      internal void SetAnimationOffset(int offset, int newAlpha)
      {
         collapseOffset = offset;
         alpha = newAlpha;
      }
      #endregion

      #region Interface Implementation
      /// &lt;summary&gt;
      /// Determines whether this bar's title contains the specified mnemonic.
      /// &lt;/summary&gt;
      /// &lt;param name="charCode"&gt;Mnemonic key character code.&lt;/param&gt;
      /// &lt;returns&gt;&lt;c&gt;true&lt;/c&gt; if the bar contains the mnemonic code,
       &lt;c&gt;false&lt;/c&gt;
      /// otherwise.&lt;/returns&gt;
      public bool ContainsMnemonic(char charCode)
      {
         return (mnemonicCode == charCode);
      }
      /// &lt;summary&gt;
      /// Gets/sets whether this item displays the focus in the control.
      /// &lt;/summary&gt;
      public bool ShowFocus
      {
         get
         {
            return canExpand;
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets whether this bar has the focus in the control
      /// &lt;/summary&gt;
      public bool Focused
      {
         get
         {
            return hasFocus;
         }
         set
         {
            if (canExpand)
            {
               if (hasFocus != value)
               {
                  hasFocus = value;         
                  if ((owner != null) &amp;&amp; (value))
                  {
                     owner.InternalOnItemFocus(this);
                  }
                  else
                  {
                     OnAppearanceChanged();
                  }
                  if ((value) &amp; (!mouseDown))
                  {
                     EnsureVisible();
                  }
               }
            }
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets whether the mouse is over the bar's title
      /// &lt;/summary&gt;
      public bool MouseOver
      {
         get
         {
            return mouseOver;
         }
         set
         {
            if (mouseOver != value)
            {
               mouseOver = value;
               if (value)
               {
                  owner.InternalOnItemMouseOver(this);
               }
               OnAppearanceChanged();
            }
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets whether the mouse is down on this bar's title
      /// &lt;/summary&gt;
      public bool MouseDown
      {
         get
         {
            return mouseDown;
         }
         set
         {
            if (mouseDown != value)
            {
               mouseDown = value;
               Focused = value;
               if (value)
               {
                  owner.InternalOnItemMouseDown(this);
               }
               OnAppearanceChanged();
            }
         }
      }

      /// &lt;summary&gt;
      /// Gets whether the specified point is within the title of this bar.
      /// &lt;/summary&gt;
      /// &lt;param name="location"&gt;Location to hit test for.&lt;/param&gt;
      /// &lt;param name="width"&gt;Client width of the owning control.&lt;/param&gt;
      /// &lt;param name="scrollShowing"&gt;Whether the scroll bar is displayed in
       the 
      /// owning control.&lt;/param&gt;
      public bool HitTest(Point location, int width, bool scrollShowing)
      {
         bool ret = false;
         int testHeight = (scrollShowing ? titleTextHeightWithScroll :
          titleHeightWithoutScroll);
         int testTop = top + (scrollShowing ? 
            titleHeightWithScroll - titleTextHeightWithScroll : 
            titleHeightWithoutScroll - titleTextHeightWithoutScroll);
         
         if ((location.Y &gt;= testTop) &amp;&amp; (location.Y &lt;= testTop + testHeight))
         {
            if ((location.X &gt;= marginSize) &amp;&amp; (location.X &lt;= width -
             marginSize))
            {
               ret = true;
            }
         }

         return ret;
      }


      /// &lt;summary&gt;
      /// Gets whether this item responds to clicks from the mouse.
      /// &lt;/summary&gt;
      public bool Clickable
      {
         get
         {
            return canExpand;
         }
      }

      /// &lt;summary&gt;
      /// Returns a deep clone of this object, including any associated items
      /// which is not associated with an instance of the ExplorerBar control.
      /// &lt;/summary&gt;
      /// &lt;returns&gt;&lt;/returns&gt;
      public object Clone()
      {
         ExplorerBar clonedBar = new ExplorerBar();
         clonedBar.AnimateStateChanges = animateStateChanges;
         clonedBar.BackColor = backColor;
         clonedBar.CanExpand = canExpand;
         clonedBar.Font = font;
         clonedBar.IconIndex = iconIndex;
         clonedBar.IsSpecial = isSpecial;
         clonedBar.State = state;
         clonedBar.Tag = tag;
         clonedBar.Text  = text;
         clonedBar.TitleBackColorEnd = titleBackColorEnd;
         clonedBar.TitleBackColorStart = titleBackColorStart;
         clonedBar.TitleForeColor = titleForeColor;
         clonedBar.TitleForeColorHot = titleForeColorHot;
         clonedBar.ToolTipText = toolTipText;
         clonedBar.Watermark = watermark;
         clonedBar.WatermarkHAlign = watermarkHAlign;
         clonedBar.WatermarkMode = watermarkMode;
         clonedBar.WatermarkVAlign = watermarkVAlign;
         foreach (ExplorerBarItem item in items)
         {
            ExplorerBarItem clonedItem = (ExplorerBarItem) item.Clone();
            clonedBar.Items.Add(clonedItem);
         }
         return clonedBar;
      }

      /// &lt;summary&gt;
      /// Called when the bar is clicked.
      /// &lt;/summary&gt;
      public virtual void Click()
      {
      }
      #endregion

      #region Public Implementation

      /// &lt;summary&gt;
      /// Gets the collection of items associated with this bar.
      /// &lt;/summary&gt;
      public ExplorerBarItemCollection Items
      {
         get
         {
            return items;
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets an object to be associated with this Bar.
      /// &lt;/summary&gt;
      public object Tag
      {
         get
         {
            return tag;
         }
         set
         {
            tag = value;
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets whether this bar is special or not.  A special bar
      /// has different bar colours and is normally used to highlight the most
      /// common bar within a control.
      /// &lt;/summary&gt;
      public bool IsSpecial
      {
         get
         {
            return isSpecial;
         }
         set
         {
            if (isSpecial != value)
            {
               isSpecial = value;
               OnAppearanceChanged();
            }
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets whether bar state changes should be animated
      /// for this bar.  If the bar contains items which hold controls then the
      /// value will always be &lt;c&gt;false&lt;/c&gt; regardless of the setting.
      /// &lt;/summary&gt;
      public bool AnimateStateChanges
      {
         get
         {
            return (CanAnimateStateChanges &amp;&amp; animateStateChanges);
         }
         set
         {
            animateStateChanges = value;
         }
      }

      /// &lt;summary&gt;
      /// Gets whether it is possible to animate bar state changes or not.
      /// Bars which contain items that hold controls cannot be animated.
      /// &lt;/summary&gt;
      public bool CanAnimateStateChanges
      {
         get
         {
            bool canAnimate = true;
            foreach (ExplorerBarItem item in items)
            {
               if
                (typeof(ExplorerBarControlHolderItem).IsAssignableFrom(item.GetT
               ype()))
               {
                  canAnimate = false;
                  break;
               }
            }
            return canAnimate;
         }
      }
      
      /// &lt;summary&gt;
      /// Gets/sets an image used to display a watermark behind the
      /// items in the bar.
      /// &lt;/summary&gt;
      public Bitmap Watermark
      {
         get
         {
            return watermark;
         }
         set
         {
            watermark = value;
            OnWatermarkChanged();
            OnAppearanceChanged();
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets the Image Processing effect applied to the 
      /// &lt;see cref="Watermark"/&gt; image for this bar.
      /// &lt;/summary&gt;
      public ExplorerBarWatermarkMode WatermarkMode
      {
         get
         {
            return watermarkMode;
         }
         set
         {
            if (watermarkMode != value)
            {
               watermarkMode = value;
               OnWatermarkChanged();
               OnAppearanceChanged();
            }
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets the horizontal alignment of the &lt;see cref="Watermark"/&gt;
      /// image for this bar.
      /// &lt;/summary&gt;
      public ExplorerBarWatermarkAlignment WatermarkHAlign
      {
         get
         {
            return watermarkHAlign;
         }
         set
         {
            if (watermarkHAlign != value)
            {
               watermarkHAlign = value;
               OnAppearanceChanged();
            }
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets the vertical alignment of the &lt;see cref="Watermark"/&gt;
      /// image for this bar.
      /// &lt;/summary&gt;
      public ExplorerBarWatermarkAlignment WatermarkVAlign
      {
         get
         {
            return watermarkVAlign;
         }
         set
         {
            if (watermarkVAlign != value)
            {
               watermarkVAlign = value;
               OnAppearanceChanged();
            }
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets the 0-based index of an icon in an ImageList to
      /// show in the title for this bar.
      /// &lt;/summary&gt;
      public int IconIndex
      {
         get
         {
            return iconIndex;
         }
         set
         {
            if (((iconIndex &lt; 0) &amp;&amp; (value &gt; 0)) ||
               ((iconIndex &gt; 0) &amp;&amp; (value &lt; 0)))
            {
               iconIndex = value;
               OnSizeChanged();
            }
            else if (iconIndex != value)
            {
               iconIndex = value;
               OnAppearanceChanged();
            }
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets the title for this bar.
      /// &lt;/summary&gt;
      public string Text
      {
         get
         {
            return text;
         }
         set
         {
            if (!text.Equals(value))
            {
               text = value;
               DetermineMnemonicKey();
               OnSizeChanged();
            }
         }
      }

      private void DetermineMnemonicKey()
      {
         int pos = text.IndexOf("&amp;");
         if ((pos &gt; -1) &amp;&amp; (pos &lt; text.Length - 1))
         {
            mnemonicCode = text.Substring(pos + 1, 1).ToCharArray()[0];
         }
         else
         {
            mnemonicCode = '\0';
         }
      }


      /// &lt;summary&gt;
      /// Gets/sets the tooltip text that should be shown for this bar.
      /// Setting to an empty string means no tooltip.
      /// &lt;/summary&gt;
      public string ToolTipText
      {
         get
         {
            return toolTipText;
         }
         set
         {
            toolTipText = value;
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets the colour to use at the start of the TitleBar
      /// when the control is being drawn in the &lt;see
       cref="ExplorerBarDrawingStyle.Custom"/&gt;
      /// style.
      /// &lt;/summary&gt;
      public Color TitleBackColorStart
      {
         get
         {
            return titleBackColorStart;
         }
         set
         {
            if (titleBackColorStart != value)
            {
               titleBackColorStart = value;
               OnAppearanceChanged();
            }
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets the colour to use at the end of the TitleBar
      /// when the control is being drawn in the &lt;see
       cref="ExplorerBarDrawingStyle.Custom"/&gt;
      /// style.
      /// &lt;/summary&gt;
      public Color TitleBackColorEnd
      {
         get
         {
            return titleBackColorEnd;
         }
         set
         {
            if (titleBackColorEnd != value)
            {
               titleBackColorEnd = value;
               OnAppearanceChanged();
            }
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets the text colour to use for the title of this bar
      /// when the control is being drawn in the &lt;see
       cref="ExplorerBarDrawingStyle.Custom"/&gt;
      /// style.
      /// &lt;/summary&gt;
      public Color TitleForeColor
      {
         get
         {
            return titleForeColor;
         }
         set
         {
            if (titleForeColor != value)
            {
               titleForeColor = value;
               OnAppearanceChanged();
            }
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets the text colour to use for the title of this bar
      /// when the control is being drawn in the &lt;see
       cref="ExplorerBarDrawingStyle.Custom"/&gt;
      /// style and the bar is Hot (MouseOver).
      /// &lt;/summary&gt;
      public Color TitleForeColorHot
      {
         get
         {
            return titleForeColorHot;
         }
         set
         {
            if (titleForeColorHot != value)
            {
               titleForeColorHot = value;
               OnAppearanceChanged();
            }
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets the background colour of this bar.
      /// &lt;/summary&gt;
      public Color BackColor
      {
         get
         {
            return backColor;
         }
         set
         {
            if (backColor != value)
            {
               backColor = value;
               if ((watermark != null) &amp;&amp; 
                  (watermarkMode == ExplorerBarWatermarkMode.Colourise))
               {
                  OnWatermarkChanged();
               }
               OnAppearanceChanged();
            }
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets the font to use to draw the title of this bar.
      /// &lt;/summary&gt;
      public System.Drawing.Font Font
      {
         get
         {
            return font;
         }
         set
         {
            font = value;
            OnSizeChanged();
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets whether this bar can be expanded or collapsed.
      /// &lt;/summary&gt;
      public bool CanExpand
      {
         get
         {
            return canExpand;
         }
         set
         {
            if (canExpand != value)
            {               
               canExpand = value;
               OnSizeChanged();
            }
         }
      }

      /// &lt;summary&gt;
      /// Gets/sets the state of this bar.
      /// &lt;/summary&gt;
      public ExplorerBarState State
      {
         get
         {
            return state;
         }
         set
         {
            if (state != value)
            {
               if (owner != null)
               {
                  owner.InternalChangeBarState(this);
               }
            }
         }
      }
      /// &lt;summary&gt;
      /// Ensures that this bar is visible in the control.
      /// &lt;/summary&gt;
      public void EnsureVisible()
      {
         if (owner != null)
         {
            owner.InternalEnsureVisible(this);
         }
      }

      #endregion
      internal void InternalSetState(ExplorerBarState newState)
      {
         state = newState;
         InternalMakeControlsVisible((state == ExplorerBarState.Expanded));
      }

      internal void InternalMeasureItem(
         ExplorerBarMeasureItemParams measureItemParams
         )
      {
         MeasureItem(measureItemParams);
      }

      internal void InternalMakeControlsVisible(bool visible)
      {
         foreach (ExplorerBarItem item in items)
         {
            if
             (typeof(ExplorerBarControlHolderItem).IsAssignableFrom(item.GetType
            ()))
            {
               ExplorerBarControlHolderItem controlItem =
                (ExplorerBarControlHolderItem) item;
               if (controlItem.Control != null)
               {
                  if ((state == ExplorerBarState.Expanded) &amp;&amp; (!visible))
                  {
                     controlItem.Control.Top = -1000;
                  }
                  else
                  {
                     controlItem.Control.Visible = visible;
                  }
               }
            }
            if (!visible)
            {
               top = -100;
            }
         }
      }


      /// &lt;summary&gt;
      /// Measures the size of this bar.
      /// &lt;/summary&gt;
      /// &lt;param name="measureItemParams"&gt;Class specifying details required to
       measure the bar.&lt;/param&gt;
      protected virtual void MeasureItem(
         ExplorerBarMeasureItemParams measureItemParams         
         )
      {
         if (owner != null)
         {
            // First measure me:
            if ((measureItemParams.Mode == ExplorerBarMode.Search) &amp;&amp;
             (!CanExpand) &amp;&amp; (Text.Length == 0))
            {
               titleHeightWithScroll = 0;
               titleHeightWithoutScroll = 0;
               heightWithScroll = 0;
               heightWithoutScroll = 0;
            }
            else
            {            
               MeasureTitle(measureItemParams);            
               heightWithScroll = titleHeightWithScroll + 8;
               heightWithoutScroll = titleHeightWithoutScroll + 8;
            }

            // Now measure all of my subitems:
            foreach (ExplorerBarItem item in items)
            {
               item.InternalMeasureItem(measureItemParams);
               heightWithScroll += item.HeightWithScroll;
               heightWithoutScroll += item.HeightWithoutScroll;
            }


         }
      }

      /// &lt;summary&gt;
      /// Measures the size of the title of this bar.
      /// &lt;/summary&gt;
      /// &lt;param name="measureItemParams"&gt;Class specifying details required to
       measure the bar.&lt;/param&gt;
      private void MeasureTitle(
         ExplorerBarMeasureItemParams measureItemParams
         )
      {
         XpThemeAPI xpTheme = owner.XpTheme;
         BarBitmaps barBitmaps = owner.Bitmaps;

         int origHeightWith = HeightWithScroll;
         int origHeightWithout = HeightWithoutScroll;

         singleLineTitleWithoutScroll = false;
         singleLineTitleWithScroll = false;

         int heightWith = 0;
         int heightWithout = 0;

         if (
            (measureItemParams.Style == ExplorerBarDrawingStyle.XP ||
            (measureItemParams.Style == ExplorerBarDrawingStyle.System &amp;&amp;
             !xpTheme.hTheme.Equals(IntPtr.Zero))) &amp;&amp;
            (measureItemParams.Mode == ExplorerBarMode.Default))
         {
            // the height of the title is the height of the
            // title bar bitmaps
            heightWith = barBitmaps[BarBitmapType.EBP_NORMALGROUPHEAD].Height;
            heightWithout = heightWith;
         }
         else
         {
            // Get the font to use:
            Font useFont = Font;
            bool disposeFont = false;
            if (useFont == null)
            {
               useFont = new
                Font(measureItemParams.DefaultFont.FontFamily.Name, 
                  measureItemParams.DefaultFont.Size, 
                  measureItemParams.DefaultFont.Style | FontStyle.Bold);
               disposeFont = true;
            }
            
            // Set up default measure rectangle for the text:
            Rectangle measureRectF = new Rectangle(
               0, 0, 
               measureItemParams.WidthWithoutScroll - marginSize * 2, 
               512);

            // Check if we have a title icon:
            if ((iconIndex&gt; -1) &amp;&amp; (measureItemParams.ImageList != null))
            {
               measureRectF.X += measureItemParams.ImageList.ImageSize.Width +
                4;
               measureRectF.Width -=
                (measureItemParams.ImageList.ImageSize.Width + 4);
            }

            // Check if we have a collapse/expand icon on the bar:
            if (canExpand)
            {
               if (measureItemParams.Style == ExplorerBarDrawingStyle.Classic)
               {
                  measureRectF.Width -= 16;
               }
               else
               {
                  if (barBitmaps[BarBitmapType.EBP_NORMALGROUPCOLLAPSE] != null)
                  {
                     measureRectF.Width -=
                      (barBitmaps[BarBitmapType.EBP_NORMALGROUPCOLLAPSE].Width
                      + 4);
                  }
                  else
                  {
                     measureRectF.Width -= 16;
                  }
               }
            }

            // Now the height depends on whether we're in search mode 
            // or not:
            if (measureItemParams.Mode == ExplorerBarMode.Search)
            {
               // We may have multi-line captions
               measureRectF.Width -= 8;

               // measure a single line:
               StringFormat fmt = new StringFormat(StringFormatFlags.LineLimit
                | StringFormatFlags.NoWrap);
               SizeF sz = measureItemParams.Graphics.MeasureString("Xg",
                useFont, measureItemParams.WidthWithoutScroll, fmt);
               fmt.Dispose();               
               int heightOneLine = (int) sz.Height;

               // Now measure the size without the scroll bar:
               int measureWidth = (int) measureRectF.Width;
               sz = measureItemParams.Graphics.MeasureString(
                  text, useFont, measureWidth);
               if ((int) sz.Height &lt;= heightOneLine + 2)
               {
                  singleLineTitleWithoutScroll = true;
               }
               heightWithout = (int) sz.Height + 9;

               // Measure with the scroll bar:
               measureWidth -= (measureItemParams.WidthWithScroll -
                measureItemParams.WidthWithoutScroll);
               sz = measureItemParams.Graphics.MeasureString(
                  Text, useFont, measureWidth);
               if ((int) sz.Height &lt;= heightOneLine + 2)
               {
                  singleLineTitleWithScroll = true;
               }
               heightWith = (int) sz.Height + 9;

            }
            else
            {
               // captions must be single line
               StringFormat fmt = new StringFormat(StringFormatFlags.LineLimit
                | StringFormatFlags.NoWrap);
               SizeF sz = measureItemParams.Graphics.MeasureString(
                  "Xg", useFont, measureItemParams.WidthWithoutScroll, fmt);
               fmt.Dispose();
               heightWithout = (int) sz.Height + 9;
               heightWith = heightWithout;
            }
            if (disposeFont)
            {
               useFont.Dispose();
            }
         }

         // Ok apply some general checks:
         heightWithout = (heightWithout &lt; 24 ? 24 : heightWithout);
         heightWith = (heightWith &lt; 24 ? 24 : heightWith);

         // Set the title heights:
         titleTextHeightWithoutScroll = heightWithout;
         titleTextHeightWithScroll = heightWith;

         // Ensure we've accommodated the icon:
         if ((iconIndex &gt; -1) &amp;&amp; (measureItemParams.TitleImageList != null))
         {
            heightWith = (heightWith &lt;
             measureItemParams.TitleImageList.ImageSize.Height ? 
               measureItemParams.TitleImageList.ImageSize.Height : heightWith);
            heightWithout = (heightWithout &lt;
             measureItemParams.TitleImageList.ImageSize.Height ? 
               measureItemParams.TitleImageList.ImageSize.Height :
                heightWithout);
         }

         // Set:
         titleHeightWithScroll = heightWith;
         titleHeightWithoutScroll = heightWithout;

         // Here we can check whether we had a change, perhaps
         // we need to ask for a refresh of the control...

      }
         

      internal void InternalDrawItem(
         ExplorerBarDrawItemParams drawItemParams
         )
      {
         top = drawItemParams.Top;
         DrawItem(drawItemParams);
      }
      

      /// &lt;summary&gt;
      /// Draws this bar and all of the items contained within it.
      /// &lt;/summary&gt;
      /// &lt;param name="drawItemParams"&gt;Class specifying information required to 
      /// Draw the bar.&lt;/param&gt;
      protected virtual void DrawItem(
         ExplorerBarDrawItemParams drawItemParams
         )
      {         
         // First draw me:
         int overallTitleHeight = DrawTitle(drawItemParams);

         // Now draw the bar
         if ((state == ExplorerBarState.Expanded) ||
            (expanding || collapsing))

         {
            Graphics realGraphics = drawItemParams.Graphics;
            Graphics graphics = realGraphics;

            if (expanding || collapsing)
            {
               if (drawItemParams.AnimationBitmap != null)
               {
                  graphics = Graphics.FromImage(drawItemParams.AnimationBitmap);
                  drawItemParams.SetGraphics(graphics);
               }
            }
            
            DrawBarBackground(drawItemParams, overallTitleHeight);

            //  Now draw the items in the bar
            int newTop = drawItemParams.Top + (drawItemParams.ScrollShowing ? 
               titleHeightWithScroll : titleHeightWithoutScroll);
            int paintTop = newTop;
            newTop += 4;
            int origTop = 0;
            if (expanding || collapsing)
            {
               newTop += collapseOffset;
               origTop = newTop;
               drawItemParams.SetTop(collapseOffset);
            }
            else
            {
               drawItemParams.SetTop(newTop);
            }

            // Then draw all of my subitems:
            foreach (ExplorerBarItem item in items)
            {
               item.InternalDrawItem(drawItemParams);
               newTop  = drawItemParams.Top + (drawItemParams.ScrollShowing ?
                item.HeightWithScroll : item.HeightWithoutScroll);
               drawItemParams.SetTop(newTop);
            }

            if (expanding || collapsing)
            {
               drawItemParams.SetTop(drawItemParams.Top + origTop);
            }

            if (graphics != realGraphics)
            {
               Rectangle destRect = new Rectangle(
                  marginSize, paintTop,
                  (drawItemParams.ScrollShowing ?
                   drawItemParams.WidthWithScroll :
                   drawItemParams.WidthWithoutScroll) - marginSize * 2,
                  (drawItemParams.ScrollShowing ? heightWithScroll -
                   titleHeightWithScroll : heightWithoutScroll -
                   titleHeightWithoutScroll) + collapseOffset);
               float[][] matrixItems =  {
                  new float[] {1, 0, 0, 0, 0},
                  new float[] {0, 1, 0, 0, 0},
                  new float[] {0, 0, 1, 0, 0},
                  new float[] {0, 0, 0, (alpha / 255F), 0},
                  new float[] {0, 0, 0, 0, 1}};

               ColorMatrix colorMatrix = new ColorMatrix(matrixItems);
         
               ImageAttributes imageAttr = new ImageAttributes();
               imageAttr.SetColorMatrix(colorMatrix, ColorMatrixFlag.Default,
                ColorAdjustType.Bitmap);

               realGraphics.DrawImage(drawItemParams.AnimationBitmap,
                  destRect, 
                  destRect.Left, 0, destRect.Width, destRect.Height,
                  GraphicsUnit.Pixel, imageAttr);

               drawItemParams.SetGraphics(realGraphics);
               graphics.Dispose();
            }
         }
      }


      /// &lt;summary&gt;
      /// Draws the title to a bar and returns the height.
      /// &lt;/summary&gt;
      /// &lt;param name="drawItemParams"&gt;Object containing information needed 
      /// to draw the title&lt;/param&gt;
      /// &lt;returns&gt;Height&lt;/returns&gt;
      private int DrawTitle(ExplorerBarDrawItemParams drawItemParams)
      {
         // Multi-line title?
         bool multiLineTitle = false;
         if (drawItemParams.Mode == ExplorerBarMode.Search)
         {
            if (drawItemParams.ScrollShowing)
            {
               multiLineTitle = !singleLineTitleWithScroll;
            }
            else
            {
               multiLineTitle = !singleLineTitleWithScroll;
            }
         }

         // Draw the background of the title:
         Rectangle rcTitle = new Rectangle(marginSize, drawItemParams.Top,
            (drawItemParams.ScrollShowing ? drawItemParams.WidthWithScroll :
             drawItemParams.WidthWithoutScroll ) - marginSize * 2, 
            (drawItemParams.ScrollShowing ? titleHeightWithScroll :
             titleHeightWithoutScroll));
         int titleHeight =
          ExplorerBarHelper.DrawBarTitle(drawItemParams.Graphics,
            drawItemParams.Mode, drawItemParams.Style, 
            owner.Bitmaps, owner.XpTheme, 
            rcTitle, 
            isSpecial, mouseOver, mouseDown, state, canExpand, 
            drawItemParams.RightToLeft
            );
         if (hasFocus &amp;&amp; owner.ShowingFocusRectangle)
         {
            Rectangle rcFocus = new Rectangle(rcTitle.Location, rcTitle.Size);
            if (!multiLineTitle)
            {
               if (rcFocus.Height &gt; titleHeight)
               {
                  rcFocus.Y += (rcFocus.Height - titleHeight);
                  rcFocus.Height = titleHeight;
               }
            }
            rcFocus.Inflate(-1, -1);
            ControlPaint.DrawFocusRectangle(drawItemParams.Graphics, rcFocus);
         }
         // Draw the icon if any:         
         if ((iconIndex &gt; -1) &amp;&amp; (drawItemParams.TitleImageList != null))
         {
            if (drawItemParams.RightToLeft)
            {
               drawItemParams.TitleImageList.Draw(drawItemParams.Graphics, 
                  rcTitle.Width - (marginSize + 2), drawItemParams.Top,
                   iconIndex);
               rcTitle.Width -= (4 +
                drawItemParams.TitleImageList.ImageSize.Width);
            }
            else
            {
               drawItemParams.TitleImageList.Draw(drawItemParams.Graphics, 
                  marginSize + 2, drawItemParams.Top, iconIndex);
               rcTitle.X += (4 + drawItemParams.TitleImageList.ImageSize.Width);
            }            
         }
         else
         {
            if (drawItemParams.RightToLeft)
            {
               rcTitle.Width -= marginSize;
            }
            else
            {
               rcTitle.X += marginSize;
               rcTitle.Width -= marginSize;
            }
         }
         
         // Draw the title text:

         // Font to use
         Font useFont = Font;
         bool disposeFont = false;
         if (useFont == null)
         {
            useFont = new Font(drawItemParams.DefaultFont.FontFamily.Name, 
               drawItemParams.DefaultFont.Size, 
               drawItemParams.DefaultFont.Style | FontStyle.Bold);             
                 
            disposeFont = true;
         }
         
         // Get string format
         StringFormat format = null;

         if (multiLineTitle)
         {
            // Title can be multi-line
            if (drawItemParams.RightToLeft)
            {
               format = new
                StringFormat(StringFormatFlags.DirectionRightToLeft);
            }
            else
            {
               format = new StringFormat();
            }
         }
         else
         {
            // Title is always single line
            
            StringFormatFlags flags = StringFormatFlags.LineLimit |
             StringFormatFlags.NoWrap;
            if (drawItemParams.RightToLeft)
            {
               flags |= StringFormatFlags.DirectionRightToLeft;               
            }
            format = new StringFormat(flags);
            format.LineAlignment = StringAlignment.Center;
            format.Trimming = StringTrimming.EllipsisCharacter;
         }

         // Brush to draw with
         Color brushColor = Color.Empty;
         if (mouseOver)
         {
            brushColor = titleForeColorHot;
            if (brushColor == Color.Empty)
            {
               brushColor = ExplorerBarHelper.BarTitleColor(
                  true, isSpecial, drawItemParams.Style, state, owner.XpTheme);
            }
         }
         else
         {
            brushColor = titleForeColor;            
            if (brushColor == Color.Empty)
            {
               brushColor = ExplorerBarHelper.BarTitleColor(
                  false, isSpecial, drawItemParams.Style, state, owner.XpTheme);
            }
         }
         Brush brush = new SolidBrush(brushColor);

         // Rectangle to draw in
         RectangleF textRectangle = new RectangleF(
            (float) rcTitle.Left, (float) rcTitle.Top, (float) rcTitle.Width,
             (float) rcTitle.Height);
         if (!multiLineTitle)
         {
            textRectangle.Y += (float) (rcTitle.Height - titleHeight);
            textRectangle.Height = (float) titleHeight;
         }
         else
         {
            textRectangle.Y += 2.0F;
            textRectangle.Height -= 4.0F;
         }
         drawItemParams.Graphics.DrawString(text, useFont, brush, 
            textRectangle, format);
         
         // Clear up
         brush.Dispose();
         format.Dispose();
         if (disposeFont)
         {
            useFont.Dispose();
         }

         return rcTitle.Height;
      }

      private void DrawBarBackground(ExplorerBarDrawItemParams drawItemParams,
       int overallTitleHeight)
      {
         // Draw the background to the bar
         int top = 0;
         if (!(expanding || collapsing))
         {
            top = drawItemParams.Top + overallTitleHeight;
         }
         Rectangle rectangle = new Rectangle(
            marginSize,
            top,
            (drawItemParams.ScrollShowing ? drawItemParams.WidthWithScroll :
             drawItemParams.WidthWithoutScroll) - marginSize * 2,
            (drawItemParams.ScrollShowing ? heightWithScroll -
             overallTitleHeight : heightWithoutScroll - overallTitleHeight)
            );
         if (expanding || collapsing)
         {
            rectangle.Height += collapseOffset;
         }

         ExplorerBarHelper.DrawBarBackground(
            drawItemParams.Graphics, 
            drawItemParams.Style,
            drawItemParams.Mode, 
            owner.XpTheme, 
            owner.Bitmaps, 
            rectangle,
            isSpecial,
            backColor, 
            backColor
            );

         if (processedWatermark != null)
         {
            DrawBarWatermark(drawItemParams, rectangle);
         }
      }

      /// &lt;summary&gt;
      /// Draws the watermark in a bar.
      /// &lt;/summary&gt;
      /// &lt;param name="drawItemParams"&gt;Object containing information needed 
      /// to draw the title&lt;/param&gt;
      /// &lt;param name="rectangle"&gt;Bounding rectangle of the bar part&lt;/param&gt;
      private void DrawBarWatermark(
         ExplorerBarDrawItemParams drawItemParams,
         Rectangle rectangle
         )
      {
         rectangle.X += 2;
         rectangle.Y += 2;
         rectangle.Width -= 4;
         rectangle.Height -= 4;

         int waterMarkX = 2;
         int srcX = 0;
         int srcWidth = processedWatermark.Width;         
         switch (watermarkHAlign)
         {
            case ExplorerBarWatermarkAlignment.Near:
               if (drawItemParams.RightToLeft)
               {
                  waterMarkX = rectangle.Right - processedWatermark.Width;
                  if (waterMarkX &lt; rectangle.Left)
                  {
                     srcX = srcWidth - rectangle.Width;
                     srcWidth = rectangle.Width;
                  }
               }
               else
               {
                  if (waterMarkX + processedWatermark.Width &gt; rectangle.Right)
                  {
                     srcWidth = rectangle.Width;
                  }
               }
               break;
            case ExplorerBarWatermarkAlignment.Far:
               if (drawItemParams.RightToLeft)
               {
                  if (waterMarkX + processedWatermark.Width &gt; rectangle.Width -
                   4)
                  {
                     srcWidth = rectangle.Width;
                  }
               }
               else
               {
                  waterMarkX = rectangle.Right - processedWatermark.Width;     
                                  
                  if (waterMarkX + processedWatermark.Width &gt; rectangle.Right)
                  {
                     srcX = srcWidth - rectangle.Width;
                     srcWidth = rectangle.Width;
                  }
               }                  
               break;
            default:
               waterMarkX = rectangle.Left + (rectangle.Width -
                processedWatermark.Width) / 2;
               if (waterMarkX &lt; 0)
               {
                  srcX = srcWidth - rectangle.Width;
                  srcWidth = rectangle.Width;
                  waterMarkX = 0;
               }
               break;
         }
         int waterMarkY = rectangle.Top;
         int srcY = 0;
         int srcHeight = processedWatermark.Height;
         switch (WatermarkVAlign)
         {
            case ExplorerBarWatermarkAlignment.Near:
               waterMarkY = rectangle.Top;
               if (waterMarkY + srcHeight &gt; rectangle.Height)
               {
                  srcHeight = rectangle.Height;
               }
               break;
            case ExplorerBarWatermarkAlignment.Far:
               waterMarkY = rectangle.Bottom - processedWatermark.Height;
               if (waterMarkY &lt; rectangle.Top)
               {
                  srcY = srcHeight - rectangle.Height;
                  srcHeight = rectangle.Height;
                  waterMarkY = rectangle.Top;
               }
               break;
            default:
               waterMarkY = rectangle.Top + (rectangle.Height -
                processedWatermark.Height) / 2;
               if (waterMarkY &lt; rectangle.Top)
               {
                  srcY = srcHeight - rectangle.Height;
                  srcHeight = rectangle.Height;
                  waterMarkY = rectangle.Top;
               }
               break;
         }

         drawItemParams.Graphics.DrawImage(processedWatermark,
            new Rectangle(waterMarkX, waterMarkY, srcWidth, srcHeight),
            srcX, srcY, srcWidth, srcHeight, GraphicsUnit.Pixel);

      }
         

      /// &lt;summary&gt;
      /// Notifies the parent control when the Watermark changes.
      /// &lt;/summary&gt;
      protected virtual void OnWatermarkChanged()
      {
         if (owner != null)
         {
            owner.InternalOnBarWatermarkChanged(this);
         }
      }

      /// &lt;summary&gt;
      /// Notifies the parent control when any aspect of the appearance of
      /// this bar changes.
      /// &lt;/summary&gt;
      protected virtual void OnAppearanceChanged()
      {
         if (owner != null)
         {
            owner.InternalOnBarRedraw(this);
         }      
      }

      /// &lt;summary&gt;
      /// Notifies the parent control that the size of this bar has changed.
      /// &lt;/summary&gt;
      protected virtual void OnSizeChanged()
      {
         if (owner != null)
         {
            owner.InternalOnBarResized(this);
         }
      }
   }
}
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="javascript:window.alert(&quot;http://vbaccelerator.com/home/include/adredir.asp?url=http://oneandone.co.uk/xml/init?k_id=5791003&image=http://oneandone.co.uk/xml/banner?size=1&number=3\nThis link was not retrieved.&quot;)" ><IMG SRC="..\..\..\..\..\..\oneandone_co_uk\xml\banner\size=1&number=3.html" ALT="1&1 Web Hosting" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\index.html">NET</a>&#160;.&#160;<a href="..\..\index.html">Code</a>&#160;.&#160;<a href="..\index.html">Controls</a>&#160;.&#160;<a href="article.html">.NET ExplorerBar Control</a>&#160;.&#160;<a href="explorerbar_control_source_code.html">ExplorerBar Control Source Code</a>&#160;.&#160;acclExplorerBar_ExplorerBar.cs</p><br /><p class="nav"><a href="..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2004 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 18 April 2004</p></td><td></td></tr></table>
</body></html>
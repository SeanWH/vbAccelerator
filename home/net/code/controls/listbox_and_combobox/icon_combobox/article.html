<html lang="en" >
<head>

<title>vbAccelerator - vbAccelerator IconComboBox Control</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="
One of the more notable omissions from the set of .NET Framework Windows controls is a
Combo Box which supports icons, despite a control of this type being used to good effect
in Explorer and IE.  This article provides a reusable control which extends the standard ComboBox
to allow you to associate icons, indentation and multiple columns with each of the items
in the combo box, as well as providing Office/VS.NET style highlighting and auto-complete
features.
" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">NET</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ListBox and ComboBox</a>&#160;.&#160;vbAccelerator IconComboBox Control</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="iconcombobox_control_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />IconComboBox Control Binary</a> (16K)</p><p class="nav"><a href="iconcombobox_control_documentation.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />IconComboBox Control Documentation</a> (119K)</p><p class="nav"><a href="iconcombobox_control_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />IconComboBox Control Source</a> (47K)</p><p class="nav"><a href="iconcombobox_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />IconComboBox Demonstration</a> (30K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:12997</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=12997&type=article&title=vbaccelerator_20iconcombobox_20control.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;.NET</p><p class="nav">&#160;&#160;C#</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />11 Jan 2003<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\shell_projects\auto-file_completion_for_text_boxes_and_combo_boxes\article.html">Auto-File and URL Completion for Text Boxes and Combo Boxes</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\textbox_icon\article.html">Adding an Icon or Control to a TextBox or ComboBox</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\flat_style_combo_boxes\article.asp\index.html">Flat Style Combo Boxes</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator IconComboBox Control</h1><p class="splash">An extended combo box control with support for icons, indentation, auto-complete, multiple columns and more.</p><img src="iconcombobox.png" width="183" height="194" alt="IconComboBox demonstration application" /><p /><p>
One of the more notable omissions from the set of .NET Framework Windows controls is a
Combo Box which supports icons, despite a control of this type being used to good effect
in Explorer and IE.  This article provides a reusable control which extends the standard ComboBox
to allow you to associate icons, indentation and multiple columns with each of the items
in the combo box, as well as providing Office/VS.NET style highlighting and auto-complete
features.
</p><h2>Features of the Control</h2><p></p><h2>About The Downloads</h2><p>There are three code downloads provided with this article.</p><ul><li>The Binary download provides the official vbAccelerator strong-named signed assembly for the control, <span class="i">acclIconComboBox.Dll</span>. This assembly can be registered into the Global Assembly Cache (GAC).</li><li>The Demonstration download uses the signed assembly. You need to have the signed control to run the demonstration; it can either by registed into the GAC or placed into the demonstration executable directory.</li><li>The Source download provides the projects used to develop and release the control. You can copy the IconComboBox control source into your own project from here, or build your own version if you provide a new strong-name key pair.</li></ul><h2>Using The Control</h2><p>
The structure of the control is shown in the UML diagram below:
</p><img src="iconcomboboxuml.png" width="552" height="475" alt="Icon Combo Box UML Diagram" /><p class="caption">IconComboBox control UML Diagram</p><p><span class="code">IconComboBox</span> derives from the standard framework ComboBox, and contains 
two main collections:
</p><ol><li><span class="code">ObjectCollection</span>, containing the combo items.</li><li><span class="code">IconComboBoxColumnCollection</span>, containing information about the
columns.</li></ol><p>
Note that in this version of the control that <span class="code">ObjectCollection</span> is
not strongly typed, as I could not find a way to override the standard combo box 
<span class="code">ObjectCollection</span>.  This isn't a problem, just you need to remember
to add <span class="code">IconComboItem</span> objects (or objects which derive from it)
to the control.
</p><p>
The next three sections describe the new features of the control and these objects.
</p><h3>1. Configuring the ComboBox</h3><p>
As well as the standard combo box properties such as drop-down style, the control additionally
provides these properties:
</p><ul><li><span class="code">AutoComplete</span><br />
Gets/sets whether text entered into the text box portion of the combo box will be auto-matched
to an item in the drop-down list.</li><li><span class="code">HighlightStyle</span><br />
Gets/sets the type of highlighting applied to items in the box. This can either be the standard
combo box highlighting style or a VS.NET/Office style.</li><li><span class="code">BorderStyle</span><br />
Gets/sets the border style of the combo box.  This can either be the standard border or
a flat VS.NET/Office style with mouse-over highlighting (see the article <a href="..\flat_style_combo_boxes\article.asp\index.html">Flat Combo Boxes</a> for details of this technique).</li><li><span class="code">FullRowSelect</span><br />
When more than one column is associated with the control, this configures whether all
items in the row are selected, or just the first column.</li><li><span class="code">GridLines</span><br />
Gets/sets whether gridlines are displayed around the items in the drop-down list.  Most useful
in a multi-column combo box.</li><li><span class="code">TextBoxIcon</span><br />
Gets/sets whether an icon is shown next to the text box when the control has the <span class="code">DropDown</span> style. </li><li><span class="code">ImageList</span><br />
Gets/sets the ImageList used to draw images in the control.</li><li><span class="code">IndentationSize</span><br />
Each item in the control can have an associated indentation.  This property specifies how
many pixels are used for each unit of indentation.</li></ul><h3>2. Configuring Items</h3><p>
The <span class="code">IconComboItem</span> class is an implementation of the 
<span class="code">IIconComboItem</span> interface which defines the items in the 
control.  Each item can also have a collection of <span class="code">IconComboSubItem</span> 
subitems associated with it.  Both
<span class="code">IconComboItem</span>  and <span class="code">IconComboSubItem</span>
derive from the same abstract base class, <span class="code">IconComboItemBase</span>, which
provides a comprehensive set of formatting and display properties.
</p><ul><li><span class="code">Text</span><br />
Gets/sets an object to use to display in the item.  When the control renders the item,
it uses the <span class="code">TextFormat</span> formatting string to display the item
if it is set, or the <span class="code">ToString</span> method of the object otherwise.
This is allows you to display many different types of object as items in the 
combo box without losing the underlying object itself.
</li><li><span class="code">TextFormat</span><br />
Gets/sets an optional formatting string to use when rendering the <span class="code">Text</span>
object into the control.  For example, if the <span class="code">Text</span> object was
set to a <span class="code">Date</span> then you might use a <span class="code">TextFormat</span>
of <span class="code">"{0:d MMMM yyyy}"</span> to show the date.
</li><li><span class="code">Icon</span><br />
Gets/sets the 0-based index of the icon in the ImageList.  Set to -1 (the default) for no icon.
</li><li><span class="code">StringFormat</span><br />
Gets/sets an optional <span class="code">System.Drawing.StringFormat</span> object to use when
rendering the item.  This allows you to adjust the alignment and wrapping characteristics of
the text that is displayed.
</li><li><span class="code">Font</span><br />
Gets/sets the font used to display this item.  If set to <span class="code">null</span>, the 
control's font is used.
</li><li><span class="code">ForeColor</span><br />
Gets/sets a foreground colour to use when drawing the item.
</li><li><span class="code">BackColor</span><br />
Gets/sets a background colour to use when drawing the item.
</li><li><span class="code">AutoHeight</span>, <span class="code">Height</span><br />
This pair of properties allow you control how the heights of items are set in the control.
If <span class="code">AutoHeight</span> is set to true, then the items's size is
automatically calculated.  Otherwise, the value of the <span class="code">Height</span>
property is used.
</li></ul><p>
The following properties are only available for items (<span class="code">IconComboItem</span>)
and not sub-items:
</p><ul><li><span class="code">LineAbove, LineBelow</span><br />
Get/set whether ruling lines are drawn above or below the item.
</li><li><span class="code">Indentation</span><br />
Gets/sets the indentation used to display the item. The indentation is multiplied by
the owning control's <span class="code">IndentationSize</span> prior to display.
</li><li><span class="code">SubItems</span><br />
Gets the collection of sub-items associated with this item.
</li><li><span class="code">GroupRow</span><br />
When set true, makes this item extend the entire width of the combo box regardless
of whether multiple columns are set or not.
</li></ul><h3>3. Configuring Columns</h3><p>
By default, the IconComboBox control has a single column and any sub-items are
ignored.  By modifying the contents of the <span class="code">IconComboBoxColumnCollection</span>
you can configure the control to display more columns, and also to manipulate the order
of the columns as well as whether they are shown or not.  <span class="code">IconComboBoxColumnCollection</span> is a standard Framework collection which is strongly-typed to 
contain <span class="code">IconComboBoxColumn</span> objects, which have these properties:
</p><ul><li><span class="code">ColumnWidth</span><br />
Gets/sets the width of the column in the control.  Set the width to 0 if you want to 
hide the column.
</li><li><span class="code">ColumnOrder</span><br />
Gets/sets the 0-based order of this column when it is displayed in the control.  Normally,
the first column shown in the control is the <span class="code">IconComboItem</span> which
was added to the control, and this is followed by each of the subitems in the order that
they were added.  By setting this property <span class="code">ColumnOrder</span> you can 
rearrange the order in which the columns are displayed.
</li></ul><h2>Conclusion</h2><p>
This article provides a flexible and powerful combo box control with support for icons,
multiple columns, indentation, auto-complete and per-item formatting properties.  In
future articles we'll be looking at applying the same techniques to the ListBox, as
well as how to use the control to pick fonts, paragraph formatting styles and Shell
file system objects.
</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="javascript:window.alert(&quot;http://vbaccelerator.com/home/include/adredir.asp?url=http://oneandone.co.uk/xml/init?k_id=5791003&image=http://oneandone.co.uk/xml/banner?size=1&number=3\nThis link was not retrieved.&quot;)" ><IMG SRC="..\..\..\..\..\..\..\oneandone_co_uk\xml\banner\size=1&number=3.html" ALT="1&1 Web Hosting" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">NET</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ListBox and ComboBox</a>&#160;.&#160;vbAccelerator IconComboBox Control</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 6 November 2003</p></td><td></td></tr></table>
</body></html>
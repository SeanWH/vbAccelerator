<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: FlatComboCS_frmFlatCombo.cs</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: FlatComboCS_frmFlatCombo.cs" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">NET</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ListBox and ComboBox</a>&#160;.&#160;<a href="article.asp\index.html">Flat Style Combo Boxes</a>&#160;.&#160;<a href="flatcombo_class_and_demonstration.html">FlatCombo Class and Demonstration</a>&#160;.&#160;FlatComboCS_frmFlatCombo.cs</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="flatcombo_class_and_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />FlatCombo Class and Demonstration</a> (67K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:13017</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=13017&type=zip&title=flatcombo_20class_20and_20demonstration_2ezip_5fflatcombocs_5ffrmflatcombo.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;.NET</p><p class="nav">&#160;&#160;VB.NET</p><p class="nav">&#160;&#160;C#</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />23 Oct 2003<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\windows_messages\subclassing_in__net\article.html">Subclassing In .NET</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: FlatComboCS_frmFlatCombo.cs</h1><pre>using System;
using System.Drawing;
using System.Collections;
using System.ComponentModel;
using System.Windows.Forms;
using System.Data;

using vbAccelerator.Components.Controls;

namespace FlatComboCS
{
   /// &lt;summary&gt;
   /// Summary description for Form1.
   /// &lt;/summary&gt;
   public class frmFlatCombo : System.Windows.Forms.Form
   {
      private ArrayList flatComboBoxList = new ArrayList();
      private System.Windows.Forms.ComboBox comboBox1;
      private System.Windows.Forms.ComboBox comboBox2;
      private System.Windows.Forms.ComboBox comboBox3;
      private System.Windows.Forms.ComboBox comboBox4;
      private System.Windows.Forms.Label lblInfo1;
      private System.Windows.Forms.Label lblInfo2;
      private System.Windows.Forms.Label lblInfo3;
      private System.Windows.Forms.Label lblInfo4;
      private System.Windows.Forms.ComboBox cboSize;
      private System.Windows.Forms.Label llblInfo5;
      private System.Windows.Forms.CheckBox chkEnabled;
      /// &lt;summary&gt;
      /// Required designer variable.
      /// &lt;/summary&gt;
      private System.ComponentModel.Container components = null;

      public frmFlatCombo()
      {
         //
         // Required for Windows Form Designer support
         //
         InitializeComponent();

         //
         // TODO: Add any constructor code after InitializeComponent call
         //
      }

      /// &lt;summary&gt;
      /// Clean up any resources being used.
      /// &lt;/summary&gt;
      protected override void Dispose( bool disposing )
      {
         if( disposing )
         {
            if (components != null) 
            {
               components.Dispose();
            }
         }
         base.Dispose( disposing );
      }

      #region Windows Form Designer generated code
      /// &lt;summary&gt;
      /// Required method for Designer support - do not modify
      /// the contents of this method with the code editor.
      /// &lt;/summary&gt;
      private void InitializeComponent()
      {
         System.Resources.ResourceManager resources = new
          System.Resources.ResourceManager(typeof(frmFlatCombo));
         this.comboBox1 = new System.Windows.Forms.ComboBox();
         this.comboBox2 = new System.Windows.Forms.ComboBox();
         this.comboBox3 = new System.Windows.Forms.ComboBox();
         this.comboBox4 = new System.Windows.Forms.ComboBox();
         this.lblInfo1 = new System.Windows.Forms.Label();
         this.lblInfo2 = new System.Windows.Forms.Label();
         this.lblInfo3 = new System.Windows.Forms.Label();
         this.lblInfo4 = new System.Windows.Forms.Label();
         this.cboSize = new System.Windows.Forms.ComboBox();
         this.llblInfo5 = new System.Windows.Forms.Label();
         this.chkEnabled = new System.Windows.Forms.CheckBox();
         this.SuspendLayout();
         // 
         // comboBox1
         // 
         this.comboBox1.Items.AddRange(new object[] {
                                             "Test Item 1",
                                             "Test Item 2",
                                             "Test Item 3",
                                             "Test Item 4",
                                             "Test Item 5",
                                             "Test Item 6",
                                             "Test Item 7",
                                             "Test Item 8",
                                             "Test Item 9",
                                             "Test Item 10",
                                             "Test Item 11",
                                             "Test Item 12",
                                             "Test Item 13",
                                             "Test Item 14"});
         this.comboBox1.Location = new System.Drawing.Point(12, 28);
         this.comboBox1.Name = "comboBox1";
         this.comboBox1.Size = new System.Drawing.Size(212, 21);
         this.comboBox1.TabIndex = 0;
         this.comboBox1.Text = "vbAccelerator";
         // 
         // comboBox2
         // 
         this.comboBox2.DropDownStyle =
          System.Windows.Forms.ComboBoxStyle.DropDownList;
         this.comboBox2.Items.AddRange(new object[] {
                                             "Test Item 1",
                                             "Test Item 2",
                                             "Test Item 3",
                                             "Test Item 4",
                                             "Test Item 5",
                                             "Test Item 6",
                                             "Test Item 7",
                                             "Test Item 8",
                                             "Test Item 9",
                                             "Test Item 10",
                                             "Test Item 11",
                                             "Test Item 12",
                                             "Test Item 13",
                                             "Test Item 14"});
         this.comboBox2.Location = new System.Drawing.Point(12, 80);
         this.comboBox2.Name = "comboBox2";
         this.comboBox2.Size = new System.Drawing.Size(212, 21);
         this.comboBox2.TabIndex = 1;
         // 
         // comboBox3
         // 
         this.comboBox3.BackColor = System.Drawing.SystemColors.Control;
         this.comboBox3.Enabled = false;
         this.comboBox3.Items.AddRange(new object[] {
                                             "Test Item 1",
                                             "Test Item 2",
                                             "Test Item 3",
                                             "Test Item 4",
                                             "Test Item 5",
                                             "Test Item 6",
                                             "Test Item 7",
                                             "Test Item 8",
                                             "Test Item 9",
                                             "Test Item 10",
                                             "Test Item 11",
                                             "Test Item 12",
                                             "Test Item 13",
                                             "Test Item 14"});
         this.comboBox3.Location = new System.Drawing.Point(12, 132);
         this.comboBox3.Name = "comboBox3";
         this.comboBox3.Size = new System.Drawing.Size(212, 21);
         this.comboBox3.TabIndex = 2;
         this.comboBox3.Text = "comboBox3";
         // 
         // comboBox4
         // 
         this.comboBox4.Font = new System.Drawing.Font("Tahoma", 15.75F,
          System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point,
          ((System.Byte)(0)));
         this.comboBox4.Items.AddRange(new object[] {
                                             "Test Item 1",
                                             "Test Item 2",
                                             "Test Item 3",
                                             "Test Item 4",
                                             "Test Item 5",
                                             "Test Item 6",
                                             "Test Item 7",
                                             "Test Item 8",
                                             "Test Item 9",
                                             "Test Item 10",
                                             "Test Item 11",
                                             "Test Item 12",
                                             "Test Item 13",
                                             "Test Item 14"});
         this.comboBox4.Location = new System.Drawing.Point(12, 184);
         this.comboBox4.Name = "comboBox4";
         this.comboBox4.RightToLeft = System.Windows.Forms.RightToLeft.Yes;
         this.comboBox4.Size = new System.Drawing.Size(212, 33);
         this.comboBox4.TabIndex = 3;
         this.comboBox4.Text = "comboBox4";
         // 
         // lblInfo1
         // 
         this.lblInfo1.Location = new System.Drawing.Point(12, 8);
         this.lblInfo1.Name = "lblInfo1";
         this.lblInfo1.Size = new System.Drawing.Size(212, 16);
         this.lblInfo1.TabIndex = 4;
         this.lblInfo1.Text = "Drop-Down Combo";
         // 
         // lblInfo2
         // 
         this.lblInfo2.Location = new System.Drawing.Point(12, 60);
         this.lblInfo2.Name = "lblInfo2";
         this.lblInfo2.Size = new System.Drawing.Size(212, 16);
         this.lblInfo2.TabIndex = 5;
         this.lblInfo2.Text = "Drop-Down List";
         // 
         // lblInfo3
         // 
         this.lblInfo3.Location = new System.Drawing.Point(12, 112);
         this.lblInfo3.Name = "lblInfo3";
         this.lblInfo3.Size = new System.Drawing.Size(212, 16);
         this.lblInfo3.TabIndex = 6;
         this.lblInfo3.Text = "Disabled Combo Box";
         // 
         // lblInfo4
         // 
         this.lblInfo4.Location = new System.Drawing.Point(12, 164);
         this.lblInfo4.Name = "lblInfo4";
         this.lblInfo4.Size = new System.Drawing.Size(212, 16);
         this.lblInfo4.TabIndex = 7;
         this.lblInfo4.Text = "Right-To-Left, Larger Font";
         // 
         // cboSize
         // 
         this.cboSize.Items.AddRange(new object[] {
                                           "8",
                                           "9",
                                           "10",
                                           "10.5",
                                           "11",
                                           "12",
                                           "14",
                                           "16",
                                           "18",
                                           "20",
                                           "22",
                                           "24",
                                           "26",
                                           "28",
                                           "36",
                                           "48",
                                           "72"});
         this.cboSize.Location = new System.Drawing.Point(244, 28);
         this.cboSize.Name = "cboSize";
         this.cboSize.Size = new System.Drawing.Size(44, 21);
         this.cboSize.TabIndex = 8;
         this.cboSize.Text = "8";
         // 
         // llblInfo5
         // 
         this.llblInfo5.Location = new System.Drawing.Point(244, 8);
         this.llblInfo5.Name = "llblInfo5";
         this.llblInfo5.Size = new System.Drawing.Size(60, 16);
         this.llblInfo5.TabIndex = 9;
         this.llblInfo5.Text = "Narrow";
         // 
         // chkEnabled
         // 
         this.chkEnabled.Checked = true;
         this.chkEnabled.CheckState = System.Windows.Forms.CheckState.Checked;
         this.chkEnabled.Location = new System.Drawing.Point(12, 236);
         this.chkEnabled.Name = "chkEnabled";
         this.chkEnabled.Size = new System.Drawing.Size(212, 20);
         this.chkEnabled.TabIndex = 10;
         this.chkEnabled.Text = "E&amp;nabled";
         this.chkEnabled.CheckedChanged += new
          System.EventHandler(this.chkEnabled_CheckedChanged);
         // 
         // frmFlatCombo
         // 
         this.AutoScaleBaseSize = new System.Drawing.Size(5, 14);
         this.ClientSize = new System.Drawing.Size(312, 270);
         this.Controls.AddRange(new System.Windows.Forms.Control[] {
                                                        this.chkEnabled,
                                                        this.llblInfo5,
                                                        this.cboSize,
                                                        this.lblInfo4,
                                                        this.lblInfo3,
                                                        this.lblInfo2,
                                                        this.lblInfo1,
                                                        this.comboBox4,
                                                        this.comboBox3,
                                                        this.comboBox2,
                                                        this.comboBox1});
         this.Font = new System.Drawing.Font("Tahoma", 8.25F,
          System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point,
          ((System.Byte)(0)));
         this.Icon = ((System.Drawing.Icon)(resources.GetObject("$this.Icon")));
         this.Name = "frmFlatCombo";
         this.Text = ".NET Flat Combo Box Demonstration";
         this.Load += new System.EventHandler(this.frmFlatCombo_Load);
         this.ResumeLayout(false);

      }
      #endregion

      /// &lt;summary&gt;
      /// The main entry point for the application.
      /// &lt;/summary&gt;
      [STAThread]
      static void Main() 
      {
         Application.Run(new frmFlatCombo());
      }

      private void frmFlatCombo_Load(object sender, System.EventArgs e)
      {
         FlatControl flatComboBox;
         foreach (Control ctl in this.Controls)
         {
            if (ctl.GetType().IsAssignableFrom(comboBox1.GetType()))
            {
               flatComboBox = new FlatControl();
               flatComboBox.Attach(ctl);
               flatComboBoxList.Add(flatComboBox);
            }
         }
      }

      private void chkEnabled_CheckedChanged(object sender, System.EventArgs e)
      {
         bool enabled = chkEnabled.Checked;
         foreach (Control ctl in this.Controls)
         {
            if (ctl.GetType().IsAssignableFrom(comboBox1.GetType()))
            {
               if (!enabled)
               {
                  ctl.BackColor = Color.FromKnownColor(KnownColor.Control);
               }
               ctl.Enabled = enabled;
               if (enabled)
               {
                  ctl.BackColor = Color.FromKnownColor(KnownColor.Window);
               }
            }
         }
      
      }
   }
}
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\..\vb\code\libraries\compression\index.html" ><IMG SRC="..\..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">NET</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ListBox and ComboBox</a>&#160;.&#160;<a href="article.asp\index.html">Flat Style Combo Boxes</a>&#160;.&#160;<a href="flatcombo_class_and_demonstration.html">FlatCombo Class and Demonstration</a>&#160;.&#160;FlatComboCS_frmFlatCombo.cs</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 1 November 2003</p></td><td></td></tr></table>
</body></html>
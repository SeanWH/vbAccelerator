<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: FontComboVB_MRUQueue.vb</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: FontComboVB_MRUQueue.vb" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">NET</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ListBox and ComboBox</a>&#160;.&#160;<a href="article.html">Font ComboBox</a>&#160;.&#160;<a href="font_combobox_code_and_demonstration.html">Font ComboBox Code and Demonstration</a>&#160;.&#160;FontComboVB_MRUQueue.vb</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="font_combobox_code_and_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Font ComboBox Code and Demonstration</a> (75K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:13338</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=13338&type=zip&title=font_20combobox_20code_20and_20demonstration_2ezip_5ffontcombovb_5fmruqueue.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;.NET</p><p class="nav">&#160;&#160;VB.NET</p><p class="nav">&#160;&#160;C#</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />2 Nov 2003<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\icon_combobox\article.html">vbAccelerator IconComboBox Control</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: FontComboVB_MRUQueue.vb</h1><pre>Namespace FontCombo
    ''' &lt;summary&gt;
    ''' A basic Most-Recently Used (MRU) Queue implementation
    ''' &lt;/summary&gt;
    &lt;SerializableAttribute()&gt; _
    Public Class MRUQueue
        Implements ICloneable, ICollection, IEnumerable

        Private Const INITIAL_SIZE As Integer = 8

        ''' &lt;summary&gt;
        ''' The ArrayList used to maintain the MRU queue
        ''' &lt;/summary&gt;
        Protected innerList As ArrayList
        Private m_size As Integer = INITIAL_SIZE

        ''' &lt;summary&gt;
        ''' Gets/sets the maximum size of the MRU Queue.
        ''' &lt;/summary&gt;
        Public Property Size() As Integer
            Get
                Return m_size
            End Get
            Set(ByVal Value As Integer)
                If (Value &lt;= 0) Then
                    Throw New ArgumentException("Size must be greater than or
                     equal to 1", "value")
                End If
                Me.Size = Value
                OnSizeChanged()
            End Set
        End Property

        ''' &lt;summary&gt;
        ''' Trims the MRU list to size based on the setting
        ''' of the &lt;see cref="Size" /&gt; property.
        ''' &lt;/summary&gt;
        Protected Overridable Sub OnSizeChanged()
            If (innerList.Count &gt; Size) Then
                Dim i As Integer
                For i = Size To innerList.Count - 1
                    innerList.RemoveAt(innerList.Count - 1)
                Next i
            End If
        End Sub

        ''' &lt;summary&gt;
        ''' Copies the contents of the MRU starting at the specified
        ''' index to an array.
        ''' &lt;/summary&gt;
        ''' &lt;param name="array"&gt;Array to copy contents to&lt;/param&gt;
        ''' &lt;param name="arrayIndex"&gt;Index of array to start at.&lt;/param&gt;
        Public Overridable Sub CopyTo(ByVal array As Array, ByVal arrayIndex As
         Integer) _
            Implements ICollection.CopyTo
            Me.innerList.CopyTo(array, arrayIndex)
        End Sub

        ''' &lt;summary&gt;
        ''' Gets the object with the specified index.
        ''' &lt;/summary&gt;
        Default Public ReadOnly Property Item(ByVal index As Integer)
            Get
                Return innerList(index)
            End Get
        End Property

        ''' &lt;summary&gt;
        ''' Adds the specified item to the MRU queue.  If the queue
        ''' already contains the specified item, it is shifted up
        ''' to the first position.  Otherwise, it is added at the
        ''' first position and any existing items are shuffled 
        ''' downwards and the &lt;see cref="OnSizeChanged"/&gt; method
        ''' is called to trim the collection to size.
        ''' &lt;/summary&gt;
        ''' &lt;param name="item"&gt;Item to add&lt;/param&gt;
        Public Overridable Sub Add(ByVal item As Object)
            Dim noSizeChange As Boolean = False
            If (Me.innerList.Contains(item)) Then
                innerList.Remove(item)
                noSizeChange = True
            End If
            Me.innerList.Insert(0, item)
            If Not (noSizeChange) Then
                OnSizeChanged()
            End If
        End Sub

        ''' &lt;summary&gt;
        ''' Clears the MRU cache.
        ''' &lt;/summary&gt;
        Public Overridable Sub Clear()
            OnClear()
        End Sub

        ''' &lt;summary&gt;
        ''' Called to clear the collection of contents.
        ''' &lt;/summary&gt;
        Protected Overridable Sub OnClear()
            Me.innerList.Clear()
        End Sub

        ''' &lt;summary&gt;
        ''' Gets the number of items currently in the MRU Queue.
        ''' &lt;/summary&gt;
        Public Overridable ReadOnly Property Count() As Integer _
            Implements ICollection.Count
            Get
                Return innerList.Count
            End Get
        End Property

        ''' &lt;summary&gt;
        ''' Gets whether this implementation is synchronized or not.
        ''' &lt;/summary&gt;
        Public Overridable ReadOnly Property IsSynchronized() As Boolean _
            Implements ICollection.IsSynchronized
            Get
                Return innerList.IsSynchronized
            End Get
        End Property

        ''' &lt;summary&gt;
        ''' Gets an object that can be used to synchronize access to the 
        ''' &lt;see cref="MRUQueue"/&gt;.
        ''' &lt;/summary&gt;
        Public Overridable ReadOnly Property SyncRoot() As Object _
            Implements ICollection.SyncRoot
            Get
                Return innerList.SyncRoot
            End Get
        End Property

        ''' &lt;summary&gt;
        ''' Gets the object that allows iterating through the members of the
         collection.
        ''' &lt;/summary&gt;
        ''' &lt;returns&gt;An object that implements the &lt;see
         cref="System.Collections.IEnumerator "/&gt; interface.&lt;/returns&gt;
        Public Overridable Function GetEnumerator() As IEnumerator _
                  Implements IEnumerable.GetEnumerator
            Return innerList.GetEnumerator()
        End Function

        ''' &lt;summary&gt;
        ''' Creates a shallow copy of the System.Collections.Hashtable.
        ''' &lt;/summary&gt;
        ''' &lt;returns&gt;A shallow copy of the &lt;see cref="MRUQueue"/&gt;.&lt;/returns&gt;
        Public Overridable Function Clone() As Object _
            Implements ICloneable.Clone
            Dim list As ArrayList = innerList.Clone()
            Dim mruQueue As MRUQueue = New MRUQueue(list)
            Return mruQueue
        End Function


        ''' &lt;summary&gt;
        ''' Constructs a new &lt;see cref="MRUQueue"/&gt; using the specified &lt;see
         cref="ArrayList"/&gt; as the
        ''' internal collection.
        ''' &lt;/summary&gt;
        ''' &lt;param name="arrayList"&gt;ArrayList to use as the internal
         collection.&lt;/param&gt;
        Protected Sub New(ByVal arrayList As ArrayList)
            Me.innerList = arrayList
        End Sub

        ''' &lt;summary&gt;
        ''' Constructs a new instance of this collection
        ''' &lt;/summary&gt;
        Public Sub New()
            innerList = New ArrayList()
        End Sub
    End Class

End Namespace
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="javascript:window.alert(&quot;http://vbaccelerator.com/home/include/adredir.asp?url=http://oneandone.co.uk/xml/init?k_id=5791003&image=http://oneandone.co.uk/xml/banner?size=1&number=2\nThis link was not retrieved.&quot;)" ><IMG SRC="..\..\..\..\..\..\..\oneandone_co_uk\xml\banner\size=1&number=2.html" ALT="1&1 Web Hosting" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">NET</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ListBox and ComboBox</a>&#160;.&#160;<a href="article.html">Font ComboBox</a>&#160;.&#160;<a href="font_combobox_code_and_demonstration.html">Font ComboBox Code and Demonstration</a>&#160;.&#160;FontComboVB_MRUQueue.vb</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 7 November 2003</p></td><td></td></tr></table>
</body></html>
<html lang="en" >
<head>

<title>vbAccelerator - Common Dialog Templates - Create a WinZip Style File Add Dialog</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="This sample, from Cayce Cochran (cayce@fastlane.net), 
demonstrates how to use a dialog template with a File Open or Save CommonDialog. 
It takes advantage of the CommonDialog/Direct DLL component which now (versions dated 
1 November 1999 and higher) includes the relevant support for templates." /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Common Dialogs</a>&#160;.&#160;Common Dialog Templates - Create a WinZip Style File Add Dialog</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_common_dialog_template_sample.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Common Dialog Template Sample</a> (87K)</p><p /><p class="nav"><a href="vb6_common_dialog_template_sample.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Common Dialog Template Sample</a> (80K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:1422</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=1422&type=article&title=common_20dialog_20templates_20_2d_20create_20a_20winzip_20style_20file_20.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:cayce@fastlane.net">Cayce Cochran</a></p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />19 Dec 2002<br />VB6 Version Added</p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\common_dialog_direct\article.html">CommonDialog/Direct</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>Common Dialog Templates - Create a WinZip Style File Add Dialog</h1><p class="splash">Using templates and subclassing to create fully-featured dialogs</p><img src="templatecommondialog.png" width="210" height="235" alt="WinZip Style File-Add Dialog" /><p /><p>This sample, from Cayce Cochran (<a href="mailto:cayce@fastlane.net">cayce@fastlane.net</a>), 
demonstrates how to use a dialog template with a File Open or Save CommonDialog. 
It takes advantage of the CommonDialog/Direct DLL component which now (versions dated 
1 November 1999 and higher) includes the relevant support for templates.</p><h2>About Dialog Templates</h2><p>A dialog template is a concept popular in C and C++ coding. Basically they work 
like a really rubbish version of VB: you lay out the components of the resource 
in some sort of WYSIWYG environment, which is then written to a resource. 
When you come to show the dialog box in the C or C++ program, you pass in the dialog 
template resource and the appropriate functions are invoked to create the 
specified controls on your dialog for you.</p><p>Templates can be created quite easily if you have a Resource Editor tool 
(such as the ones provided with the C and C++ environments in Visual Studio, 
which will even import a VB form for you and spit out the equivalent dialog template). 
If you're feeling particularly in the mood for this sort of functionality then you 
should see it isn't particularly difficult to create your own by hand. Look at the files 
<i>WAdlgres.rc</i> and <i>Resource.h</i> in the download for hints on 
the format of a template.</p><h2>Resources And VB</h2><p>The first problem is the fact that the Common Dialog template function 
requires the template to be included in a resource in the executable. However, 
resources in VB apps are hidden from the API functions whilst you are debugging 
the app in IDE (you can only read VB resources in the IDE using the standard 
VB resource functions <i>LoadResPicture</i>, <i>LoadResData</i> and <i>LoadResString</i>).</p><p>Incidentally, in version 6 of you could debug VC++ projects in a very similar way
to Visual Basic ones, it seems a shame that this sort of functionality was never provided
for Visual Basic (and is actually retrograded in .NET). Resources aren't the only example 
of VB messing around with stuff behind the scenes. More annoying is what happens 
to your COM object's CLSIDs in the IDE...</p><p>Anyway, this problem is easy to work around by compiling the resource into a DLL 
and then using that when working in the IDE. The easiest way to do this is to create a 
VB ActiveX DLL project, add the .RES file to it and compile that (you may want to 
add a dummy method to the default Class1 just to give VB something to do when creating it).</p><p>Determining whether you are in the IDE or not is achieved using the classic 
<i>Debug.Assert</i> check:</p><pre>
   Private m_bInIDE As Boolean

   Public Property Get InIDE() As Boolean
      Debug.Assert (IsInIDE)
      InIDE = m_bInIDE
   End Property

   Private Property Get IsInIDE() As Boolean
      m_bInIDE = True
      IsInIDE = True
   End Property
</pre><p>Because <i>Debug.Assert</i> code is only run when you are in the IDE, 
when the code is compiled the <i>IsInIDE</i> property is never called, and therefore 
the <i>m_bInIDE</i> property is never set to True.</p><h2>CommonDialog/Direct and Dialog Templates</h2><p>Telling the CommonDialog/Direct library to use a dialog template when it is 
shown is achieved by setting two properties:</p><ul><li>The <i>TemplateName</i> property (which accepts a the resource ID as a Long value).</li><li>A parameter indicating where the resource can be found. If you are running in 
compiled code with the resource compiled into the executable, then set the 
<i>hInstance</i> property to the <i>App.hInstance</i> value.  Otherwise, use 
<i>cdLoadLibrary</i> to specify to CommonDialog/Direct the filename of a DLL or EXE 
including the dialog as a resource. You must remember to call <i>cdFreeLibrary</i> to free 
up the resources associated with loading the file before your application terminates.</li></ul><p>Because you probably need to know the value of any additional controls in 
your template, you should set the CommonDialog/Direct <i>HookDialog</i> flag to True. 
Having done this the class will raise <i>InitDialog</i> and <i>WMCommand</i> events, 
which you can use to populate controls and respond to changes in their values.</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\..\index.html" ><IMG SRC="..\..\..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Common Dialogs</a>&#160;.&#160;Common Dialog Templates - Create a WinZip Style File Add Dialog</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 4 January 2003</p></td><td></td></tr></table>
</body></html>

<html lang="en" >
<head>

<title>vbAccelerator - Browsing For Folders</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="The Folder Browse Dialog is the missing dialog in VB - it can't be called from a run-time function 
and it is missing from the Common Dialog OCX as well. Whilst a number of code samples demonstrate 
that calling this dialog is simple, many ignore the most important feature: the ability to initialise the 
folder browse dialog to the user's previously selected folder or to some default.This librbary also offers the ability to capture the Browse for Folder dialog into your own VB form 
and respond to browse events such as folder change." /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Common Dialogs</a>&#160;.&#160;Browsing For Folders</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_folder_browser.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Folder Browser</a> (50K)</p><p /><p class="nav"><a href="vb6_folder_browser.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Folder Browser</a> (43K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:1420</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=1420&type=article&title=browsing_20for_20folders.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />16 Dec 2002<br />Added VB6 version</p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\type_libraries\ishellfolder\article.html">IShellFolder Extended Type Library Version 1.2 (ISHF_Ex.Tlb)</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>Browsing For Folders</h1><p class="splash">Controllable Folder Browsing, including a method for creating a WinZip style Extract Dialog Box.</p><img src="folderbrowse.png" width="492" height="299" alt="WinZip-Style Folder Browse Dialog" /><p /><p>The Folder Browse Dialog is the missing dialog in VB - it can't be called from a run-time function 
and it is missing from the Common Dialog OCX as well. Whilst a number of code samples demonstrate 
that calling this dialog is simple, many ignore the most important feature: the ability to initialise the 
folder browse dialog to the user's previously selected folder or to some default.</p><p>This librbary also offers the ability to capture the Browse for Folder dialog into your own VB form 
and respond to browse events such as folder change.</p><h2>About The Browse For Folder Dialog</h2><p>The implementation of the Dialog is provided in vbalFlBr.DLL (VB5) or vbalFlBr6.DLL (VB6), which you will
find under "vbAccelerator Folder Browse Library" in the references box once the object has been 
registered.</p><p>Two classes and one interface are exposed by the library.  <i>cBrowseForFolder</i> is the class you will
normally use to display a folder-browse dialog.  <i>cCaptureBF</i> and <i>iCaptureBF</i> provide additional
code wrappers allowing you to capture a folder browser into your own forms and further customise the 
appearance.  These will be covered in turn.</p><h3>cBrowseForFolder</h3><p>This class exposes the standard Browse for folder dialog.  You can either instantiate the class as you
are about to use it, or you can create a <i>WithEvents</i> instance of it in order to respond to 
selection changes and validate the folder the user has chosen prior to closing the dialog.</p><p>To display the dialog, perform the following steps:</p><ol><li>Set <i>hWndOwner</i> property<br />
Setting the hWndOwner to the window handle of the form you're displaying the dialog from will make
the dialog display modally and also centre the dialog.  If you don't set this, then code execution
continues when you show the form.  You can manually change the position of the dialog by responding
to the <i>Initialised</i> event and using the <i>SetWindowPos</i> API function on the dialog
(get the dialog position using the <i>hWndDialog</i> property).</li><li>Set the display flags<br />
There are a number of settings which control how the dialog appears, however, note that some are
only supported by Windows 2000 and above.  These flags are ignored on earlier versions.

<ul><li>UseNewUI (boolean)<br />Windows 2000 and above support a resizable folder browsing dialog.  Use
this flag to enable this setting.</li><li>StatusText (boolean)<br />Determines whether an extra line below the title is displayed for
status purposes.  Note that this is always displayed when <i>UseNewUI</i> is set.  You can
change the status text which is displayed using the <i>SetStatus</i> method once the dialog
is shown.</li><li>EditBox (boolean)<br />Display a Text Box below the folder browser allowing the user to type
in the folder name.  Windows 2000 and above only.</li></ul></li><li>Set flags controlling the behaviour of the dialog<br /><ul><li>RootDir<br />Sets the root directory of the folder browse dialog.  The user cannot navigate
to a higher level directory.  Note that there is a helper method, <i>SpecialFolderLocation</i>
which will return the path to most of the special folders on Windows systems, such as My Documents.</li><li>InitialDir<br />Sets the initially selected folder.</li><li>FileSystemOnly<br />Forces the dialog box to only display file system objecs (and not, for
example, printers or other Explorer extensions).</li><li>ValidateEditBox<br />If the <i>EditBox</i> property is set, ensures that what has been
typed into the Edit box is validated before the dialog is closed.</li></ul></li></ol><p>If you choose to create the class as a WithEvents instance then you can respond to the 
<i>Initialized</i>, <i>SelectionChanged</i> and <i>ValidationFailed</i> events.</p><ul><li>Initialized<br />This event is fired once the dialog box has been displayed.  Prior to this
event, you should not try and modify the dialog box.</li><li>SelectionChanged<br />This event is fired whenever the user changes the selection in 
the dialog box.  The selected path is provided and you can also disable the OK button 
by setting the <i>bAllowOk</i> parameter to <i>False</i>.</li><li>ValidationFailed<br />If the folder browser is set up to display and 
validate an Edit Box (<i>EditBox</i> and <i>ValidateEditBox</i> flags set) and the user types
an invalid folder name, then this event will fire.  The message from the folder browse dialog
about the problem is passed in, and you can choose to keep the dialog box open 
by setting the <i>bKeepOpen</i> parameter to <i>True</i>.</li></ul><p>Whilst the dialog is displayed, you can also change the status text using <i>SetStatus</i>
and also modify the selected folder using <i>SetFolder</i>.  Unless you are displaying the dialog
non-modally, you will only be able to do this during one of the events.</p><p>Note that you don't have to use the DLL to take advantage of this code.  If you would rather
incorporate the code directly into your own project, just extract <i>cBrowseForFolder.cls</i> 
and <i>mBrowseForFolder.bas</i> from the download (the code in the VB5 and VB6 versions are both
the same) and add them to your project.</p><h3>cCaptureBF and iCaptureBF</h3><p>These classes enable you to capture the folder browse dialog box into another VB form.  This is
a bit of a slimy hack I discovered whilst trying to create a customised file extract dialog similar
 to the one in WinZip, although it does appear stable and works fine on all systems MS have come
up with so far.</p><p>The idea is basically to show the dialog modally and then capture it into a non-modal form, moving
it to the correct location.  The easiest way to build your own version of this code is to copy
<i>frmCapture</i> from the sample project and then customise the UI.</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\compression\index.html" ><IMG SRC="..\..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Common Dialogs</a>&#160;.&#160;Browsing For Folders</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 11 June 2003</p></td><td></td></tr></table>
</body></html>

<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: frmMouseGesture.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmMouseGesture.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Hooks</a>&#160;.&#160;<a href="article.html">Enabling Mouse Gestures with a WH_MOUSE hook</a>&#160;.&#160;<a href="vb5_mouse_gestures.html">VB5 Mouse Gestures</a>&#160;.&#160;frmMouseGesture.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_mouse_gestures.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Mouse Gestures</a> (23K)</p><p /><p class="nav"><a href="vb6_mouse_gestures.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Mouse Gestures</a> (22K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:13223</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=13223&type=zip&title=vb5_20mouse_20gestures_2ezip_5ffrmmousegesture.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />23 Oct 2003<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\tips\detecting_mouse_xbutton_clicks\article.asp\index.html">Detecting Mouse XButton Clicks</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\vbaccelerator_hook_library\article.html">Win32 Hooks in VB - The vbAccelerator Hook Library</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\..\resources\babbage\vb6_docking_forms\article.html">(Incomplete) Docking Forms In VB</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmMouseGesture.frm</h1><pre>VERSION 5.00
Object = "{EAB22AC0-30C1-11CF-A7EB-0000C05BAE0B}#1.1#0"; "SHDOCVW.dll"
Begin VB.Form frmMouseGesture 
   Caption         =   "vbAccelerator Mouse Gesture Demonstration"
   ClientHeight    =   5865
   ClientLeft      =   3315
   ClientTop       =   2175
   ClientWidth     =   5820
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmMouseGesture.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   5865
   ScaleWidth      =   5820
   Begin SHDocVwCtl.WebBrowser webBrowser 
      Height          =   2415
      Left            =   120
      TabIndex        =   3
      Top             =   3360
      Width           =   5595
      ExtentX         =   9869
      ExtentY         =   4260
      ViewMode        =   0
      Offline         =   0
      Silent          =   0
      RegisterAsBrowser=   0
      RegisterAsDropTarget=   1
      AutoArrange     =   0   'False
      NoClientEdge    =   0   'False
      AlignLeft       =   0   'False
      NoWebView       =   0   'False
      HideFileNames   =   0   'False
      SingleClick     =   0   'False
      SingleSelection =   0   'False
      NoFolders       =   0   'False
      Transparent     =   0   'False
      ViewID          =   "{0057D0E0-3573-11CF-AE69-08002B2E1262}"
      Location        =   ""
   End
   Begin VB.Timer tmrHighlight 
      Interval        =   350
      Left            =   180
      Top             =   2520
   End
   Begin VB.PictureBox picGesture 
      AutoSize        =   -1  'True
      BorderStyle     =   0  'None
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1410
      Left            =   1680
      Picture         =   "frmMouseGesture.frx":1272
      ScaleHeight     =   1410
      ScaleWidth      =   2340
      TabIndex        =   0
      Top             =   1800
      Width           =   2340
   End
   Begin VB.Label lblInfo 
      Caption         =   $"frmMouseGesture.frx":BE8C
      Height          =   1215
      Left            =   120
      TabIndex        =   2
      Top             =   120
      Width           =   5595
   End
   Begin VB.Label lblGestureType 
      Caption         =   " Gesture Type"
      Height          =   255
      Left            =   1680
      TabIndex        =   1
      Top             =   1500
      Width           =   2355
   End
End
Attribute VB_Name = "frmMouseGesture"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Type RECT
   top As Long
   left As Long
   right As Long
   bottom As Long
End Type

Private Declare Function BitBlt Lib "gdi32" (ByVal hDestDC As Long, ByVal x As
 Long, ByVal y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal
 hSrcDC As Long, ByVal xSrc As Long, ByVal ySrc As Long, ByVal dwRop As Long)
 As Long
Private Const SRCINVERT = &amp;H660046       ' (DWORD) dest = source XOR dest
Private m_highlightRect As RECT
Private m_bHighlighted As Boolean

Private WithEvents mouseGestures As cMouseGestures
Attribute mouseGestures.VB_VarHelpID = -1

Private Sub Form_Load()
   Set mouseGestures = New cMouseGestures
   mouseGestures.Attach
   webBrowser.Navigate2 "http://vbaccelerator.com/"
End Sub

Private Sub mouseGestures_MouseGesture(ByVal gestureType As MouseGestureTypes,
 ByVal xGestureStart As Long, ByVal yGestureStart As Long, ByVal xGestureEnd As
 Long, ByVal yGestureEnd As Long, acceptGesture As Boolean)
   '
   HighlightGesture gestureType
   acceptGesture = True
   '
End Sub

Private Sub HighlightGesture(ByVal gestureType As MouseGestureTypes)
   
   tmrHighlight.Enabled = False
   If (m_bHighlighted) Then
      ToggleHighlight
   End If
   
   Dim width As Long
   width = 30
   Select Case gestureType
   Case MouseGestureTypes.NorthGesture:
      m_highlightRect.left = 1: m_highlightRect.top = 32
               
   Case MouseGestureTypes.SouthGesture:
      m_highlightRect.left = 1: m_highlightRect.top = 63
      
   Case MouseGestureTypes.EastGesture:
      m_highlightRect.left = 94: m_highlightRect.top = 1
      width = 61
      
   Case MouseGestureTypes.WestGesture:
      m_highlightRect.left = 32: m_highlightRect.top = 1
      width = 61

   Case MouseGestureTypes.NorthThenWestGesture:
      m_highlightRect.left = 32: m_highlightRect.top = 32
      
   Case MouseGestureTypes.WestThenNorthGesture:
      m_highlightRect.left = 63: m_highlightRect.top = 32
      
   Case MouseGestureTypes.EastThenNorthGesture:
      m_highlightRect.left = 94: m_highlightRect.top = 32
      
   Case MouseGestureTypes.NorthThenEastGesture:
      m_highlightRect.left = 125: m_highlightRect.top = 32

   Case MouseGestureTypes.SouthThenWestGesture:
      m_highlightRect.left = 32: m_highlightRect.top = 63
      
   Case MouseGestureTypes.WestThenSouthGesture:
      m_highlightRect.left = 63: m_highlightRect.top = 63
      
   Case MouseGestureTypes.EastThenSouthGesture:
      m_highlightRect.left = 94: m_highlightRect.top = 63
      
   Case MouseGestureTypes.SouthThenEastGesture:
      m_highlightRect.left = 125: m_highlightRect.top = 63
               
   End Select
   
   m_highlightRect.right = m_highlightRect.left + width
   m_highlightRect.bottom = m_highlightRect.top + 30
   
   ToggleHighlight
   tmrHighlight.Enabled = True
   
End Sub

Private Sub tmrHighlight_Timer()
   '
   If (m_bHighlighted) Then
      ToggleHighlight
   End If
   tmrHighlight.Enabled = False
   '
End Sub

Private Sub ToggleHighlight()
   m_bHighlighted = Not (m_bHighlighted)
   BitBlt picGesture.hDC, m_highlightRect.left, m_highlightRect.top, _
      m_highlightRect.right - m_highlightRect.left, m_highlightRect.bottom -
       m_highlightRect.top, _
      Me.hDC, 8, 100, SRCINVERT
End Sub

</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\compression\index.html" ><IMG SRC="..\..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Hooks</a>&#160;.&#160;<a href="article.html">Enabling Mouse Gestures with a WH_MOUSE hook</a>&#160;.&#160;<a href="vb5_mouse_gestures.html">VB5 Mouse Gestures</a>&#160;.&#160;frmMouseGesture.frm</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 1 November 2003</p></td><td></td></tr></table>
</body></html>
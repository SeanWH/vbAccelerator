<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: frmRefPoint.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmRefPoint.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Hooks</a>&#160;.&#160;<a href="article.html">Scrolling on the Middle Mouse Button</a>&#160;.&#160;<a href="vb6_middle_scroller_full_source.html">VB6 Middle Scroller Full Source</a>&#160;.&#160;frmRefPoint.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_middle_scroller_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Middle Scroller Full Source</a> (47K)</p><p /><p class="nav"><a href="vb6_middle_scroller_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Middle Scroller Full Source</a> (45K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:14301</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=14301&type=zip&title=vb6_20middle_20scroller_20full_20source_2ezip_5ffrmrefpoint.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />24 Jan 2004<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\vbaccelerator_hook_library\article.html">Win32 Hooks in VB - The vbAccelerator Hook Library</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\graphics_and_gdi\changing_window_shapes\creating_geometric_window_shapes\article.html">A window that's star-shaped, circular or tank-shaped</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\..\resources\babbage\vb6_docking_forms\article.html">(Incomplete) Docking Forms In VB</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmRefPoint.frm</h1><pre>VERSION 5.00
Begin VB.Form frmRefPoint 
   BackColor       =   &amp;H00808080&amp;
   BorderStyle     =   0  'None
   ClientHeight    =   420
   ClientLeft      =   0
   ClientTop       =   0
   ClientWidth     =   1725
   ClipControls    =   0   'False
   ControlBox      =   0   'False
   LinkTopic       =   "Form2"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   420
   ScaleWidth      =   1725
   ShowInTaskbar   =   0   'False
   StartUpPosition =   3  'Windows Default
End
Attribute VB_Name = "frmRefPoint"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

' Point
Private Type POINTAPI
    X As Long
    Y As Long
End Type

' Change region of a window:
Private Declare Function SetWindowRgn Lib "user32" (ByVal hwnd As Long, ByVal
 hRgn As Long, ByVal bRedraw As Boolean) As Long


' Precanned region creation functions:
Private Declare Function CreateEllipticRgn Lib "gdi32" (ByVal X1 As Long, ByVal
 Y1 As Long, ByVal X2 As Long, ByVal Y2 As Long) As Long
Private Declare Function CreateRectRgn Lib "gdi32" (ByVal X1 As Long, ByVal Y1
 As Long, ByVal X2 As Long, ByVal Y2 As Long) As Long
Private Declare Function CreatePolygonRgn Lib "gdi32" (lpPoint As POINTAPI,
 ByVal nCount As Long, ByVal nPolyFillMode As Long) As Long
' Polygon type:
Private Const WINDING = 2

' Region combination:
Private Declare Function CombineRgn Lib "gdi32" (ByVal hDestRgn As Long, ByVal
 hSrcRgn1 As Long, ByVal hSrcRgn2 As Long, ByVal nCombineMode As Long) As Long

    ' Region combination types:
    Private Const RGN_AND = 1
    Private Const RGN_COPY = 5
    Private Const RGN_DIFF = 4
    Private Const RGN_MAX = RGN_COPY
    Private Const RGN_MIN = RGN_AND
    Private Const RGN_OR = 2
    Private Const RGN_XOR = 3
    ' Region combination return values:
    Private Const COMPLEXREGION = 3
    Private Const SIMPLEREGION = 2
    Private Const NULLREGION = 1

' GDI Clear up:
Private Declare Function DeleteObject Lib "gdi32" (ByVal hObject As Long) As
 Long

Private m_bHorizontal As Boolean
Private m_bVertical As Boolean

Public Sub Init(ByVal bHorizontal As Boolean, ByVal bVertical As Boolean)
   m_bHorizontal = bHorizontal
   m_bVertical = bVertical
End Sub

Private Sub Form_Load()
Dim hRgn As Long
Dim hRgnCircle As Long
Dim hRgnTri As Long
Dim tP(0 To 3) As POINTAPI
   
   hRgn = CreateRectRgn(0, 0, 0, 0)
   
   hRgnCircle = CreateEllipticRgn(10, 10, 15, 15)
   CombineRgn hRgn, hRgnCircle, hRgn, RGN_OR
   DeleteObject hRgnCircle
   
   If (m_bVertical) Then
      ' Up
      tP(0).X = 11
      tP(0).Y = 1
      tP(1).X = 6
      tP(1).Y = 6
      tP(2).X = 18
      tP(2).Y = 6
      tP(3).X = 12
      tP(3).Y = 0
      hRgnTri = CreatePolygonRgn(tP(0), 4, WINDING)
      CombineRgn hRgn, hRgn, hRgnTri, RGN_OR
      DeleteObject hRgnTri
      
      ' Down
      tP(0).X = 12
      tP(0).Y = 23
      tP(1).X = 7
      tP(1).Y = 18
      tP(2).X = 17
      tP(2).Y = 18
      tP(3).X = 12
      tP(3).Y = 23
      hRgnTri = CreatePolygonRgn(tP(0), 4, WINDING)
      CombineRgn hRgn, hRgn, hRgnTri, RGN_OR
      DeleteObject hRgnTri
   End If
   
   If (m_bHorizontal) Then
      ' Left
      tP(0).X = 1
      tP(0).Y = 11
      tP(1).X = 6
      tP(1).Y = 6
      tP(2).X = 6
      tP(2).Y = 17
      tP(3).X = 1
      tP(3).Y = 12
      hRgnTri = CreatePolygonRgn(tP(0), 4, WINDING)
      CombineRgn hRgn, hRgn, hRgnTri, RGN_OR
      DeleteObject hRgnTri
      
      ' Right
      tP(0).X = 23
      tP(0).Y = 11
      tP(1).X = 18
      tP(1).Y = 6
      tP(2).X = 18
      tP(2).Y = 17
      tP(3).X = 23
      tP(3).Y = 12
      hRgnTri = CreatePolygonRgn(tP(0), 4, WINDING)
      CombineRgn hRgn, hRgn, hRgnTri, RGN_OR
      DeleteObject hRgnTri
   End If
   
   SetWindowRgn Me.hwnd, hRgn, True
   
End Sub


</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\compression\index.html" ><IMG SRC="..\..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Hooks</a>&#160;.&#160;<a href="article.html">Scrolling on the Middle Mouse Button</a>&#160;.&#160;<a href="vb6_middle_scroller_full_source.html">VB6 Middle Scroller Full Source</a>&#160;.&#160;frmRefPoint.frm</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2004 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 1 February 2004</p></td><td></td></tr></table>
</body></html>
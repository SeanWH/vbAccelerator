<html lang="en" >
<head>

<title>vbAccelerator - Introduction to the freeware Info-ZIP libraries</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="This project started when I was trying to build up the indexes for the 
vbAccelerator site. I had a program to search through all the HTML files 
which make up the site, and this could pick out the ZIP files linked to by the pages. 
But how to determine which projects these ZIP files contained? You need a 
way to read ZIP files. As usual with VB there are no library routines or standard 
controls available for ZIP files, so you need another way." /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Compression</a>&#160;.&#160;Introduction to the freeware Info-ZIP libraries</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="info-zip_unzip_dll_(renamed_vbuzip10_dll).html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Info-ZIP Unzip DLL (Renamed vbuzip10.dll)</a> (63K)</p><p class="nav"><a href="info-zip_zip_dll_(renamed_vbzip10_dll).html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Info-ZIP Zip DLL (Renamed vbzip10.dll)</a> (71K)</p><p class="nav"><a href="info-zip_zip_dll_with_encryption_(renamed_vbzip11_dll).html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Info-ZIP Zip DLL With Encryption (Renamed vbzip11.dll)</a> (72K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:1424</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=1424&type=article&title=introduction_20to_20the_20freeware_20info_2dzip_20libraries.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />26 Jan 2003<br /><p class="update">Provided a new version of the Info-ZIP Zip32.DLL with
encryption code compiled in.  This enables you to create password-protected
ZIP files.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\zipping_files\article.html">Zipping files using the free Info-Zip Zip DLL (now with encryption support)</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\unzipping_files\article.html">Unzipping files using the free Info-Zip Unzip DLL with VB</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\utilities\vbpzip\article.html">Visual Basic Project Zip Utility</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>Introduction to the freeware Info-ZIP libraries</h1><p class="splash">Add the ability to read and write ZIP files to your application without third-party controls</p><img src="unzip.gif" width="366" height="217" alt="Unzip Sample Application" /><p /><p>This project started when I was trying to build up the indexes for the 
vbAccelerator site. I had a program to search through all the HTML files 
which make up the site, and this could pick out the ZIP files linked to by the pages. 
But how to determine which projects these ZIP files contained? You need a 
way to read ZIP files. As usual with VB there are no library routines or standard 
controls available for ZIP files, so you need another way.</p><p>Luckily there is one, and its free! If you have a look at the Acknowledgements in 
the WinZip helpfile, you will find that the compression code for ZIP files is 
actually implemented using free code from the Info-ZIP group:</p><table><tr><td>  </td><td width="100%"><p>"WinZip incorporates compression code by the Info-ZIP group, which is used with 
their permission. Special thanks to the entire Info-Zip group, in particular 
to Jean-loup Gailly, Greg Roelofs, and Mark Adler. The original Info-Zip sources 
are freely available from CompuServe in the pcprog forum and by anonymous 
ftp from the Internet site ftp.uu.net:/pub/archiving/zip. We will also, upon request, 
mail you the Info-Zip sources if you send a self-addressed stamped envelope to 
the address in the WinZip "About" dialog box."</p></td></tr></table><p>Info-ZIP's purpose is to "provide free, portable, high-quality versions 
of the Zip and UnZip compressor-archiver utilities that are compatible with 
the DOS-based PKZIP by PKWARE, Inc." - and they do an excellent job at it. 
Their code runs on almost every OS ever devised (Tandem NSK?) and is 
also part of many products such as WinZip, PGP, the third party ActiveX control 
DynaZip and so on. The licensing arrangment for this DLL is classic freeware too: 
you cannot sell the product, but you are free to use it as you wish provided that 
(1) the customer does not believe Unzip is being sold and 
(2) the customer receives all normal documentation.</p><h2>Using the Info-ZIP Unzip DLL from VB </h2><p>The task of using Info-ZIP in VB is greatly assisted by two things:</p><ul><li>Info-ZIP being good enough to package their code into precompiled 
Win32 DLLs (note that these aren't ActiveX DLLs).</li><li>The work of coders Raymond L. King, Christian Spieler, Mike Le Voi 
and Mike White who contributed Visual Basic modules to the Info-ZIP project.</li></ul><p>Unfortunately, there are two problems directly related to this. The first is 
that the Win32 DLLs from Info-ZIP have a habit of mutating radically and incompatibly 
between versions. The second is that the VB modules supplied, although useful, 
are very difficult to reuse because you have to pick out the 
code from the presentation in the sample.</p><p>Which is where vbAccelerator comes in! Luckily we can deal with both of these problems.</p><h3>1) The Curious Case of the Mad DLLs</h3><p>One problem with using the Info-ZIP compiled DLL as-is is that the 
precompiled binaries supplied by the Info-ZIP group are for courtesy only, 
and the Win32 rules for DLL have not been followed, i.e. if you create a 
DLL which is not compatible with the previous version then you should change the 
name so you don't stop existing applications from working.</p><p>For example, the function for unzipping files was actually renamed from 
<i>windll_unzip</i> to <i>Wiz_SingleEntryUnzip</i> between versions! 
No doubt Info-ZIP have their reasons for this but if you had production code out there 
that used the older version then you would be stuffed - there would be 
no choice but to ship an entirely new version of your code.</p><p>You can prevent this happening to you by simply renaming the DLLs downloaded 
from the Info-ZIP site. In this case, I've renamed the latest versions of the 
Info-ZIP DLLs as follows:</p><table><tr><td>Original</td><td>Version</td><td>Name</td></tr><tr><td>zip32.dll</td><td>2.30</td><td>vbzip10.dll</td></tr><tr><td>zip32.dll with Encryption code compiled-in</td><td>2.30</td><td>vbzip11.dll</td></tr><tr><td>unzip32.dll</td><td>5.40</td><td>vbuzip10.dll</td></tr></table><p>When/if future versions appear, and it requires code to be changed, 
I will create new versions of the classes and rename the new versions of 
the DLL to the next number in the sequence.</p><p>Note that because these DLLs are Win32 DLLs and not ActiveX DLLs, they 
should be installed into the Windows\System directory of the target machine.</p><h3>2) Code for Tommorrow - Building for Reuse </h3><p>The Info-ZIP DLLs are somewhat alarming in that they have that 
C-coders "less is more" type of interface. For example, the 
Unzip DLL really has only one method, although this is complemented by some nasty 
callback functions, a structure with lots of members to fill in and six 
or seven parameters to cover all cases. Whilst this succinct model provides access 
to everything you need, its not so easy to use.</p><p>An easy way to manage this sort of functionality is to write a class wrapper 
which exposes the items in a more verbose but clearer manner. The result is a 
class with 4 events, 25 properties and 3 methods.</p><h2>Try the Code</h2><p>The other articles in this section demonstrate how to use the Zipping and Unzipping
functions. You can also download the VBPZip application from the Utilities section to
see how to use these functions in a useful application!</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\..\index.html" ><IMG SRC="..\..\..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Compression</a>&#160;.&#160;Introduction to the freeware Info-ZIP libraries</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 11 April 2003</p></td><td></td></tr></table>
</body></html>

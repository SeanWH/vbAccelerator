<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: frmTest.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmTest.frm" /><link rel="stylesheet" href="..\..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Graphics and GDI</a>&#160;.&#160;<a href="..\index.html">Changing Window Shapes</a>&#160;.&#160;<a href="article.html">Creating Window Shapes from Bitmaps</a>&#160;.&#160;<a href="bitmap_shape_project_files.html">Bitmap Shape Project Files</a>&#160;.&#160;frmTest.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="bitmap_shape_project_files.html"><img src="..\..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Bitmap Shape Project Files</a> (37K)</p><br /><br /><img src="..\..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:2881</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\..\linkto_asp\id=2881&type=zip&title=bitmap_20shape_20project_20files_2ezip_5ffrmtest.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />13 Aug 1999<br />First Posted</p><br /><br /><img src="..\..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\window_shapes_using_layering\article.html">Window Shapes Using Layering</a></p><p class="nav"><img src="..\..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\resources\reading_data_from_local_or_external_library_resources\article.html">Reading Data from Local or External Library Resources</a></p><br /><br /><img src="..\..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmTest.frm</h1><pre>VERSION 5.00
Begin VB.Form frmTest 
   BorderStyle     =   0  'None
   ClientHeight    =   5040
   ClientLeft      =   2295
   ClientTop       =   2550
   ClientWidth     =   5445
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmTest.frx":0000
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   5040
   ScaleWidth      =   5445
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdReadDLL 
      Caption         =   "Read from &amp;DLL"
      Height          =   435
      Left            =   3360
      TabIndex        =   8
      Top             =   4140
      Width           =   1335
   End
   Begin VB.CommandButton cmdReset 
      Caption         =   "&amp;Reset"
      Height          =   315
      Left            =   240
      Style           =   1  'Graphical
      TabIndex        =   7
      Top             =   1080
      Width           =   735
   End
   Begin VB.CommandButton cmdRead 
      Caption         =   "Read from &amp;File"
      Height          =   435
      Left            =   3360
      TabIndex        =   6
      Top             =   3660
      Width           =   1335
   End
   Begin VB.CommandButton cmdCreate 
      Caption         =   "&amp;Create"
      Height          =   435
      Left            =   3360
      TabIndex        =   5
      Top             =   3180
      Width           =   1335
   End
   Begin VB.CommandButton cmdOK 
      Caption         =   "OK"
      Height          =   315
      Left            =   1020
      MaskColor       =   &amp;H00FF8080&amp;
      Style           =   1  'Graphical
      TabIndex        =   3
      Top             =   1080
      Width           =   735
   End
   Begin VB.TextBox Text1 
      Height          =   315
      Left            =   240
      TabIndex        =   1
      Top             =   660
      Width           =   1515
   End
   Begin VB.CommandButton cmdSaveAs 
      Caption         =   "&amp;Save As..."
      Height          =   375
      Left            =   3360
      TabIndex        =   0
      Top             =   4620
      Width           =   1335
   End
   Begin VB.PictureBox picBackground 
      AutoSize        =   -1  'True
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   1980
      Left            =   3360
      Picture         =   "frmTest.frx":1272
      ScaleHeight     =   1920
      ScaleWidth      =   1920
      TabIndex        =   4
      Top             =   1140
      Width           =   1980
   End
   Begin VB.Label lblInfo 
      Caption         =   $"frmTest.frx":D2B4
      Height          =   855
      Left            =   2280
      TabIndex        =   9
      Top             =   180
      Width           =   3075
   End
   Begin VB.Label Label1 
      BackStyle       =   0  'Transparent
      Caption         =   "Enter Code:"
      ForeColor       =   &amp;H00FFFFFF&amp;
      Height          =   195
      Left            =   240
      TabIndex        =   2
      Top             =   420
      Width           =   1395
   End
End
Attribute VB_Name = "frmTest"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Declare Function SendMessageLong Lib "USER32" Alias "SendMessageA"
 (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As
 Long) As Long
Private Declare Function ReleaseCapture Lib "USER32" () As Long
Private Const WM_SYSCOMMAND = &amp;H112&amp;
Private Const SC_MOVE = &amp;HF010&amp;
Private Const WM_NCLBUTTONDOWN = &amp;HA1
Private Const HTCAPTION = 2

Private m_cDibR As New cDIBSectionRegion

Public Sub MoveWithKeys()
   ReleaseCapture
   SendMessageLong Me.hWnd, WM_SYSCOMMAND, SC_MOVE, 0
End Sub

Private Sub cmdCreate_Click()
Dim cDib As New cDIBSection
   cDib.CreateFromPicture picBackground.Picture
   m_cDibR.Create cDib
   m_cDibR.Applied(Me.hWnd) = True
   Set Me.Picture = picBackground.Picture
End Sub

Private Sub cmdOK_Click()
   Unload Me
End Sub

Private Sub cmdRead_Click()
   If m_cDibR.LoadFromFile(App.Path &amp; "\Test.rgn") Then
      m_cDibR.Applied(Me.hWnd) = True
      Set Me.Picture = picBackground.Picture
   End If
End Sub

Private Sub cmdReset_Click()
   m_cDibR.Applied(Me.hWnd) = False
End Sub

Private Sub cmdSaveAs_Click()
Dim cDib As New cDIBSection
Dim cDibR As New cDIBSectionRegion
Dim sFIle As String
   cDib.CreateFromPicture picBackground.Picture
   cDibR.Create cDib
   sFIle = App.Path &amp; "\Test.rgn"
   sFIle = InputBox("Enter the file to save to", , sFIle)
   If Not Len(sFIle) = 0 Then
      If cDibR.Save(App.Path &amp; "\Test.rgn") Then
         MsgBox "Saved Region", vbInformation
      End If
   End If
End Sub

Private Sub cmdReadDLL_Click()
   If m_cDibR.LoadFromResource(101, App.Path &amp; "\Res\DemoRegionDLL.dll") Then
      m_cDibR.Applied(Me.hWnd) = True
      Set Me.Picture = picBackground.Picture
   End If
End Sub

Private Sub Form_Load()
   cmdOK.Picture = picBackground.Picture
   cmdReset.Picture = picBackground.Picture
End Sub

Private Sub Form_MouseDown(Button As Integer, Shift As Integer, x As Single, y
 As Single)
   ' A better (more flexible) way of doing this is to use
   ' the vbAccelerator WM_NCHITTEST interception library.
   ' but if you want minimal code, here is the quick way!
    If Button = vbLeftButton Then
        'Fake a mouse down on the titlebar so form can be moved...
        ReleaseCapture
        SendMessageLong Me.hWnd, WM_NCLBUTTONDOWN, HTCAPTION, 0&amp;
    End If
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\compression\index.html" ><IMG SRC="..\..\..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Graphics and GDI</a>&#160;.&#160;<a href="..\index.html">Changing Window Shapes</a>&#160;.&#160;<a href="article.html">Creating Window Shapes from Bitmaps</a>&#160;.&#160;<a href="bitmap_shape_project_files.html">Bitmap Shape Project Files</a>&#160;.&#160;frmTest.frm</p><br /><p class="nav"><a href="..\..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
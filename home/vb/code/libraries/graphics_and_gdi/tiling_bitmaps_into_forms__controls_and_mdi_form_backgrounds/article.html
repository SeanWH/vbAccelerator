<html lang="en" >
<head>

<title>vbAccelerator - Tiling Bitmaps into Controls, Forms and MDI Form backgrounds </title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="This article provides a bitmap tiling component which allows you to:Tile any Device Context with a bitmapAutomatically tile the background area of an MDI form" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.asp\index.html">Graphics and GDI</a>&#160;.&#160;Tiling Bitmaps into Controls, Forms and MDI Form backgrounds </p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_bitmap_tiling_component_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Bitmap Tiling Component Binary</a> (14K)</p><p class="nav"><a href="vb5_bitmap_tiling_source_and_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Bitmap Tiling Source and Demonstration</a> (47K)</p><p /><p class="nav"><a href="vb6_bitmap_tiling_component_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Bitmap Tiling Component Binary</a> (14K)</p><p class="nav"><a href="vb6_bitmap_tiling_source_and_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Bitmap Tiling Source and Demonstration</a> (46K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:2770</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=2770&type=article&title=tiling_20bitmaps_20into_20controls_2c_20forms_20and_20mdi_20form_20backgr.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />7 Jan 2003<br /><p class="update">Posted VB6 version of the component, and updated to use <i>FindWindowsEx</i> to obtain the MDI client.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\controls\toolbar\vbaccelerator_toolbar_and_coolmenu_control\article.html">vbAccelerator Toolbar and CoolMenu Control v3.5</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\controls\menus\popup_menu_activex_dll\article.html">PopupMenu DLL - Create Unlimited Popup Menus</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\common_dialogs\common_dialog_direct\article.html">CommonDialog/Direct</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\controls\s_grid\article.html">vbAccelerator S-Grid Control</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>Tiling Bitmaps into Controls, Forms and MDI Form backgrounds </h1><img src="bmptile.gif" width="416" height="316" alt="Bitmap Tiling Tester Project" /><p /><p>This article provides a bitmap tiling component which allows you to:</p><ul><li>Tile any Device Context with a bitmap</li><li>Automatically tile the background area of an MDI form</li></ul><p>Tiling a bitmap into the background of a control or form can make a bit difference to its
graphical impact. You can see some samples of this tiling code in use in the 
<a href="..\..\..\controls\s_grid\article.html">S Grid Control</a>,<a href="..\..\..\controls\menus\popup_menu_activex_dll\article.html">PopupMenu DLL</a> 
and <a href="..\..\..\controls\toolbar\vbaccelerator_toolbar_and_coolmenu_control\article.html">Toolbar and CoolMenu Control</a>.</p><p>As well as providing reusable code which you can extract for tiling a picture into 
an object in the download, this 
article also presents a component which encapsulates the code and provides a way of tiling
the background space of an MDI form with your own custom bitmap.</p><h2>Drawing whatever you like on the background of an MDI form</h2><p>In order to do this, you need to be able to subclass the MDI form message.  This component
uses the <a href="..\..\subclassing\ssubtimer\article.html">Subclassing and Timer Assistant</a> to enable subclassing.
With that in place, here are the steps you need to take to draw into the MDI background:</p><ol><li>Obtain the hWnd of the background of the MDI form. The background of the MDI form is a 
special window with the class "MDIClient".  You can use <i>FindWindowEx</i> to find the
handle to this window:
<pre>
Private Declare Function FindWindowEx Lib "user32" Alias "FindWindowExA" _
   (ByVal hWnd1 As Long, ByVal hWnd2 As Long, _
    ByVal lpsz1 As String, lpsz2 As Any) As Long

...

FindWindowEx(frmThis.hwnd, 0, "MDIClient", ByVal 0&amp;)
</pre></li><li>Subclass the <i>WM_PAINT</i> message for the MDI form's background window, and make 
sure you receive it before the default window handler.</li><li>On receipt of the <i>WM_PAINT</i> message:
<ul><li>Call <i>BeginPaint</i> to get the DC of the MDI form's background window.</li><li>Call <i>GetClientRect</i> to get the size of the window.</li><li>Draw on the DC you obtained with <i>BeginPaint</i>.</li><li>Call <i>EndPaint</i> to commit your changes and remove the invalid parts 
from the areas to be repainted.</li></ul></li><li>If you want to force a refresh of the window, call <i>GetClientRect</i> to receive the size, and 
then call <i>InvalidateRect</i> on this area. This will cause a <i>WM_PAINT</i> message to be sent 
to your <i>WM_PAINT</i> handler.</li></ol><p>You can use these techniques to achieve other effects when you paint the MDI background. For example, 
InstallShield (used to) put their www addresses at the bottom right hand corner of the MDI background.</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\..\index.html" ><IMG SRC="..\..\..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.asp\index.html">Graphics and GDI</a>&#160;.&#160;Tiling Bitmaps into Controls, Forms and MDI Form backgrounds </p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 8 January 2003</p></td><td></td></tr></table>
</body></html>

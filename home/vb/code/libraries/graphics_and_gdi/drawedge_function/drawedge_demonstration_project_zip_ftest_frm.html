<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: fTest.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: fTest.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.asp\index.html">Graphics and GDI</a>&#160;.&#160;<a href="article.html">Drawing Borders and Edges using the API DrawEdge Function</a>&#160;.&#160;<a href="drawedge_demonstration_project.html">DrawEdge Demonstration Project</a>&#160;.&#160;fTest.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="drawedge_demonstration_project.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />DrawEdge Demonstration Project</a> (19K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:975</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=975&type=zip&title=drawedge_20demonstration_20project_2ezip_5fftest.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />21 Jun 1998<br />First Posted.</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\text_at_any_angle\article.html">Text At Any Angle</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\controls\treeview\hierarchy_selector_control\article.html">Hierarchy Selector Control </a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: fTest.frm</h1><pre>VERSION 5.00
Object = "{6B7E6392-850A-101B-AFC0-4210102A8DA7}#1.2#0"; "COMCTL32.OCX"
Begin VB.Form fTest 
   Caption         =   "Draw Edge Control Demonstration"
   ClientHeight    =   6375
   ClientLeft      =   2625
   ClientTop       =   2535
   ClientWidth     =   5025
   Icon            =   "fTest.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   6375
   ScaleWidth      =   5025
   Begin TestDrawEdge.DrawEdgeDemo ctlEdges 
      Height          =   2295
      Left            =   120
      TabIndex        =   1
      Top             =   60
      Width           =   4635
      _ExtentX        =   5847
      _ExtentY        =   3096
   End
   Begin ComctlLib.TreeView tvwOptions 
      Height          =   3855
      Left            =   120
      TabIndex        =   0
      Top             =   2460
      Width           =   3975
      _ExtentX        =   7011
      _ExtentY        =   6800
      _Version        =   327682
      HideSelection   =   0   'False
      Indentation     =   441
      LabelEdit       =   1
      Style           =   5
      Appearance      =   1
   End
   Begin ComctlLib.ImageList ilsIcons 
      Left            =   4200
      Top             =   2460
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   327682
      BeginProperty Images {0713E8C2-850A-101B-AFC0-4210102A8DA7} 
         NumListImages   =   3
         BeginProperty ListImage1 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "fTest.frx":014A
            Key             =   ""
         EndProperty
         BeginProperty ListImage2 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "fTest.frx":0464
            Key             =   ""
         EndProperty
         BeginProperty ListImage3 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "fTest.frx":077E
            Key             =   ""
         EndProperty
      EndProperty
   End
End
Attribute VB_Name = "fTest"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub Form_Load()

    ' Set up user control:
    With ctlEdges
        .BorderStyle(BDR_CONTROL) = True
        .BorderPart(BF_RECT) = True
    End With
    
    ' Set up options:
    Dim n1 As Node, n2 As Node
    With tvwOptions
        .ImageList = ilsIcons
        Set n1 = .Nodes.Add(, , "C" &amp; BF_RECT, "Edge Rectangle", 1)
        Set n2 = .Nodes.Add(n1, tvwChild, "C" &amp; BF_TOPLEFT, "Edge TopLeft", 1)
        .Nodes.Add n2, tvwChild, "C" &amp; Bf_Top, "Edge Top", 1
        Set n2 = .Nodes.Add(n2, tvwChild, "C" &amp; Bf_left, "Edge Left", 1)
        n2.EnsureVisible
        Set n2 = .Nodes.Add(n1, tvwChild, "C" &amp; Bf_BOTTOMRIGHT, "Edge
         BottomRight", 1)
        .Nodes.Add n2, tvwChild, "C" &amp; Bf_bottom, "Edge Bottom", 1
        Set n2 = .Nodes.Add(n2, tvwChild, "C" &amp; Bf_right, "Edge Right", 1)
        n2.EnsureVisible
        Set n1 = .Nodes.Add(, , "F" &amp; BDR_BUTTON, "ButtonBorder", 2)
        .Nodes.Add n1, tvwChild, "F" &amp; BDR_RAISEDOUTER, "Raised Outer", 2
        Set n2 = .Nodes.Add(n1, tvwChild, "F" &amp; BDR_RAISEDINNER, "Raised
         Inner", 2)
        n2.EnsureVisible
        Set n1 = .Nodes.Add(, , "F" &amp; BDR_CONTROL, "ControlBorder", 1)
        .Nodes.Add n1, tvwChild, "F" &amp; BDR_SUNKENOUTER, "Sunken Outer", 1
        Set n2 = .Nodes.Add(n1, tvwChild, "F" &amp; BDR_SUNKENINNER, "Sunken
         Inner", 1)
        n2.EnsureVisible
        .Nodes.Add , , "F" &amp; BF_SOFT, "Soft Edge", 2
        .Nodes.Add , , "F" &amp; BF_FLAT, "Flat Edge", 2
        .Nodes.Add , , "F" &amp; BF_MONO, "Monochrome Edge", 2
    End With
End Sub

Public Sub EvaluateOption()
Dim i As Long
Dim sKey As String
Dim LVal As Long
Dim bSet As Boolean
    
    For i = 1 To tvwOptions.Nodes.Count
        If (tvwOptions.Nodes(i).Children = 0) Then
            sKey = tvwOptions.Nodes(i).Key
            LVal = CLng(Mid$(sKey, 2))
            If (tvwOptions.Nodes(i).Image = 1) Then
                bSet = True
            Else
                bSet = False
            End If
            If (Left$(sKey, 1) = "F") Then
                ctlEdges.BorderStyle(LVal) = bSet
            Else
                ctlEdges.BorderPart(LVal) = bSet
            End If
        End If
    Next i
End Sub

Private Sub Form_Resize()
    On Error Resume Next
    With ctlEdges
        .Move .Left, .Top, Me.ScaleWidth - .Left * 2, .Height
        tvwOptions.Move .Left, .Top * 2 + .Height, .Width, Me.ScaleHeight -
         .Top * 3 - .Height
    End With
End Sub

Private Sub tvwOptions_NodeClick(ByVal Node As ComctlLib.Node)
Dim iImage As Long
Dim iNewImage As Long
    iImage = Node.Image
    If (iImage = 1) Then
        iNewImage = 2
    Else
        iNewImage = 1
    End If
    Node.Image = iNewImage
    If (Node.Children &gt; 0) Then
        SetLower Node.Child, iNewImage, False
    End If
    If Not (Node.Parent Is Nothing) Then
        SetHigher Node.Parent
    End If
    EvaluateOption
End Sub
Private Sub SetLower(ByRef nodX As Node, ByVal iImage As Long, ByVal bSiblings
 As Boolean)
Dim i As Long
    For i = nodX.FirstSibling.Index To nodX.LastSibling.Index
        If tvwOptions.Nodes(i).Children &gt; 0 Then
            SetLower tvwOptions.Nodes(i).Child, iImage, True
        End If
        tvwOptions.Nodes(i).Image = iImage
    Next i
End Sub
Private Sub SetHigher(ByRef nodX As Node)
Dim i As Long
Dim bAllSelected As Boolean
Dim bAllDeSelected As Boolean
Dim nodC As Node
    
    bAllSelected = True
    bAllDeSelected = True
    Set nodC = nodX.Child
    For i = nodC.FirstSibling.Index To nodC.LastSibling.Index
        Select Case tvwOptions.Nodes(i).Image
        Case 1
            bAllDeSelected = False
        Case 2
            bAllSelected = False
        Case 3
            bAllDeSelected = False
            bAllSelected = False
        End Select
    Next i
    If (bAllSelected) Then
        nodX.Image = 1
    ElseIf (bAllDeSelected) Then
        nodX.Image = 2
    Else
        nodX.Image = 3
    End If
    If Not nodX.Parent Is Nothing Then
        SetHigher nodX.Parent
    End If

End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\..\index.html" ><IMG SRC="..\..\..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.asp\index.html">Graphics and GDI</a>&#160;.&#160;<a href="article.html">Drawing Borders and Edges using the API DrawEdge Function</a>&#160;.&#160;<a href="drawedge_demonstration_project.html">DrawEdge Demonstration Project</a>&#160;.&#160;fTest.frm</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
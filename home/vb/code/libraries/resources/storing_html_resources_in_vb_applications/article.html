<html lang="en" >
<head>

<title>vbAccelerator - Storing and Showing HTML Resources in a VB Application</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="Since Internet Explorer 4, it is has been possible to display HTML directly from application resources using
the res:// protocol. This article demonstrates how to embed HTML files and images into your application
resources to use this function and encapsulate HTML files." /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Resources</a>&#160;.&#160;Storing and Showing HTML Resources in a VB Application</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="html_resource_dll.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />HTML Resource DLL</a> (6K)</p><p class="nav"><a href="html_resource_viewer_client.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />HTML Resource Viewer Client</a> (29K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:2523</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=2523&type=article&title=storing_20and_20showing_20html_20resources_20in_20a_20vb_20application.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />3 Jan 2002<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>Storing and Showing HTML Resources in a VB Application</h1><img src="htmlres.png" width="390" height="281" alt="HTML Resources Demonstration Application" /><p /><p>Since Internet Explorer 4, it is has been possible to display HTML directly from application resources using
the <i>res://</i> protocol. This article demonstrates how to embed HTML files and images into your application
resources to use this function and encapsulate HTML files.</p><h2>About the res:// Protocol</h2><p>Internet Explorer since v4 started to support the concept of pluggable protocols. This means that beyond the
standard web protocols, such as http and ftp, IE can support any number of other ways of accessing information.
If you want to find out more about the different ways you can extend IE, check out the article "Cutting Edge:
Pluggable Protocols" published in the January 1999 issue of Microsoft Internet Developer, which shows how
to implement various flavours of this functionality (at least for the C/C++ programmer).</p><p>The res:// protocol was one scheme introduced at the same time.  Basically it allows you to read resources
from EXEs or DLLs directly into IE.  The most common example of this protocol in use are the various http error
screens you get in IE.  For example, if you try and navigate to a web page whilst offline (and the page is
not available offline) then you'll get the familiar "Web page unavailable" screen.  If you look at
the properties, you'll see the address for this page looks like this:</p><pre>res://C:\WINDOWS\System32\shdoclc.dll/offcancl.htm#http://www.vbaccelerator.com/</pre><p>What this tells IE to do is to load the "offcancl.htm" HTML resource from <i>shdoclc.dll</i>.
The part after the hash symbol is read as a parameter by script on the page.  If you look at the page
itself, you'll see it refers to an image "pagerror.gif".  This image is also contained as
a resource, as you'll see if you try this URL:</p><pre>res://C:\WINDOWS\System32\shdoclc.dll/pagerror.gif</pre><p>Actually, that's not quite all.  The res protocol can also be used for displaying other resources in
an application.  When you use:</p><pre>res://C:\WINDOWS\System32\shdoclc.dll/pagerror.gif</pre><p>you're actually telling IE implicitly to look in the RT_HTML (id = 23) section of the DLL for the resource.
You can look under any other resource type by adding an explicit resource type id after the DLL name. For 
example, to extract the Bitmap (bitmaps are stored under type RT_BITMAP = 2) with id 17034 from the DLL, 
you would do this:</p><pre>res://C:\WINDOWS\System32\shdoclc.dll/2/17034</pre><p>Note that if you try to read a resource type which IE doesn't support, such as an Icon or Menu then 
nothing happens except a page cannot be displayed window.</p><p>Therefore if you know how to add resources to an application, you can show them in a WebBrowser control
by navigating to a res:// URL.</p><h2>Adding HTML Resources</h2><p>For the purposes of this article, I've created a separate DLL to store the HTML resources.  The reason
for this is that you cannot access Win32 resources within a VB object when it is running in the IDE. If
you want to test your application, then it is much easier if the resources are stored in a separate
DLL or EXE.  Of course, once you're happy with an application there is no problem about compiling the
resources into the application and then ditching the external DLL.</p><p>The "HTML Resource DLL" download contains the actual HTML resources. The DLL itself is 
simply an ActiveX DLL with one class and no methods or properties.  It only exists as a holder for
the resources themselves.  The resources are specified in the /Resources subfolder.  In this simple
example, I included just one HTML document and one image, but you can have as many as you want.  The
RC (resource compiler) file for this example is as follows:</p><pre>
#define RT_HTML  23

// HTML
test.html   RT_HTML "test.html"
testimg.gif RT_HTML "testimg.gif"
</pre><p>Run this through RC.EXE and you get the compiled .res file (I typically use a batch file to do this).
Then it is compiled into the DLL and its ready to test: try the URLs:</p><pre>
res://[DLL full file name]/test.html
res://[DLL full file name]/testimg.gif
</pre><p>And you will see that IE picks up the resources.</p><h2>Building a Client</h2><p>Once you've done this, then a client is simplicity itself.  Just drop a WebBrowser control onto
your application form and you can show the HTML.  The sample download goes a little bit further
and uses resource enumeration functions to display all available HTML resources in a selected
DLL.  If you pick <i>shdoclc.dll</i> you can even take a look at the resources built into to
IE itself (check wcee.htm for some rather useless code).</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\compression\index.html" ><IMG SRC="..\..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Resources</a>&#160;.&#160;Storing and Showing HTML Resources in a VB Application</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 3 January 2003</p></td><td></td></tr></table>
</body></html>

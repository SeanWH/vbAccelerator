<html lang="en" >
<head>

<title>vbAccelerator - Icons without forms and document association icons in VB</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="VB allows you to choose an icon for an executable, but it offers a somewhat limited choice. The icon must be stored in a form included in your VB project, and you can only pick one icon to be exposed publicly per project. Whilst the single icon is the most important one, you might want to have additional icons for two reasons:To allow the user to pick alternative icons in Explorer's 'Change Icon' dialog for shortcuts.To allow a document icon to be associated with files for your application." /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Resources</a>&#160;.&#160;Icons without forms and document association icons in VB</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="icon_resource_demonstration_project.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Icon Resource Demonstration Project</a> (45K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:2521</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=2521&type=article&title=icons_20without_20forms_20and_20document_20association_20icons_20in_20vb.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />21 Mar 2000<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>Icons without forms and document association icons in VB</h1><p class="splash">Using resources rather than VB's weak icon selection to provide better binaries</p><img src="dllicons.gif" width="150" height="138" alt="Nice Icons in the Windows\System directory" /><p /><p>VB allows you to choose an icon for an executable, but it offers a somewhat limited choice. The icon must be stored in a form included in your VB project, and you can only pick one icon to be exposed publicly per project. Whilst the single icon is the most important one, you might want to have additional icons for two reasons:</p><ul><li>To allow the user to pick alternative icons in Explorer's "Change Icon" dialog for shortcuts.</li><li>To allow a document icon to be associated with files for your application.</li></ul><p>In Win32 applications, you can have as many public icon resources as you want for a binary. 
The icon used as the icon in explorer for EXEs and DLLs (and any other binary file where the 
<i>DefaultIcon</i> key in the file association for the file is set to %1 - more on this later) 
is the icon stored with resource id 0 in the resource file. Since VB allows you to compile resources 
into your application, you can use this information to set icons for ActiveX binaries 
which don't have forms. You can also add additional icons to EXEs.</p><p>The first thing to note is that although VB has a resource editor 
(provided built-in for VB6, available as a Downloadable Add-in for VB5) this does not create 
public icon resources. To create icon resources which are visible to Explorer, you need to 
script the resources using the Resource Compiler tool directly.</p><ol><li><strong>Setting the Explorer Icon for ActiveX Binaries without forms</strong><p>This is done simply by creating a resource compiler script with the icon 
you wish to show in explorer at resource ID 0, for example:</p><pre>
   // Icons for this application
   0   ICON   MOVEABLE   PRELOAD   STIMPY.ICO
</pre><p>Compile this file to a .RES file, add it to your project and compile it. You will see 
that the project automatically gets the icon in the resource file.</p><p>Note that .OCX files are not normally set up to show an icon. To ask Explorer 
to show an icon extracted from a the file itself, you just set the <i>DefaultIcon</i> registry 
key to "%1" for the file association. You might want to add a file association for 
.OCX files to allow you to quickly and easily register and unregister the control in Explorer. 
Here are the entries you need - note you should also make the same entries under the <i>HKEY_LOCAL_MACHINE\SOFTWARE\Classes</i>
key:</p><img src="ocxregistryentries.png" width="446" height="164" alt="OCX Registry Entries to show icons and Allow Registration/Unregistration" /><p>Having entered these, you will see when you right click on a .OCX file in Explorer 
you get an Open default option which will call regsvr32 to register the file, 
and also an Unregister option which allows you to remove the registration entries.</p></li><li><strong>To provide alternative icons.</strong><p>To do this you use the same approach as for the last section 
except you add icon resources with identifiers other than 0 (numeric or strings). Setting 
up a document type association to use these icons is just a matter of ensuring the 
<i>DefaultIcon</i> key gets populated with the executable followed by a comma and 
the 0-based index of the icon in the executable (remembering that if VB is set to 
create an icon for you in the executable's properties, this will get priority over any 
icons in your resource file.) To read about this in more detail, check out the article 
"Passing command line parameters to an existing instance of your app, 
and making sure only one instance runs.".</p></li></ol><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\..\index.html" ><IMG SRC="..\..\..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Resources</a>&#160;.&#160;Icons without forms and document association icons in VB</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 3 January 2003</p></td><td></td></tr></table>
</body></html>

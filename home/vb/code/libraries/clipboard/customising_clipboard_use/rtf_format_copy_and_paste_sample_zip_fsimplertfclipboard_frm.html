<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: fSimpleRTFClipboard.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: fSimpleRTFClipboard.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Clipboard</a>&#160;.&#160;<a href="article.html">Customising Clipboard Use </a>&#160;.&#160;<a href="rtf_format_copy_and_paste_sample.html">RTF Format Copy and Paste Sample</a>&#160;.&#160;fSimpleRTFClipboard.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="rtf_format_copy_and_paste_sample.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />RTF Format Copy and Paste Sample</a> (25K)</p><p /><p class="nav"><a href="vb5_clipboard_classes_and_sample.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Clipboard Classes and Sample</a> (22K)</p><p /><p class="nav"><a href="vb6_clipboard_classes_and_sample.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Clipboard Classes and Sample</a> (19K)</p><p class="nav"><a href="vb6_clipoard_classes_and_sample.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Clipoard Classes and Sample</a> (23K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:3682</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=3682&type=zip&title=rtf_20format_20copy_20and_20paste_20sample_2ezip_5ffsimplertfclipboard.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />23 Aug 2003<br /><p class="update">Modified the clipboard viewer task to ensure it removes itself from the
clipboard chain at the right point.  Previously the class could attempt to remove itself
from the chain after the owning Window was destroyed, which would not work.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\utilities\goldfish\article.html">Goldfish</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: fSimpleRTFClipboard.frm</h1><pre>VERSION 5.00
Begin VB.Form frmSimpleRTFClipboard 
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "Simple RTF Format Clipboard Sample"
   ClientHeight    =   3480
   ClientLeft      =   3510
   ClientTop       =   2055
   ClientWidth     =   5685
   Icon            =   "fSimpleRTFClipboard.frx":0000
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   3480
   ScaleWidth      =   5685
   ShowInTaskbar   =   0   'False
   Begin VB.CommandButton cmdPaste 
      Caption         =   "&amp;Paste"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   4320
      TabIndex        =   3
      Top             =   960
      Width           =   1275
   End
   Begin VB.CommandButton cmdCopy 
      Caption         =   "&amp;Copy"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   4320
      TabIndex        =   2
      Top             =   540
      Width           =   1275
   End
   Begin VB.TextBox txtRTF 
      BeginProperty Font 
         Name            =   "Lucida Console"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   2835
      Left            =   60
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertical
      TabIndex        =   0
      Text            =   "fSimpleRTFClipboard.frx":014A
      Top             =   540
      Width           =   4155
   End
   Begin VB.Label lblInfo 
      Caption         =   "Visit vbAccelerator for advanced, free VB source
       code at http://vbaccelerator.com"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   1500
      TabIndex        =   1
      Top             =   60
      Width           =   4155
   End
   Begin VB.Image Image1 
      Height          =   330
      Left            =   60
      Picture         =   "fSimpleRTFClipboard.frx":0150
      Top             =   60
      Width           =   1275
   End
End
Attribute VB_Name = "frmSimpleRTFClipboard"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private m_cClip As New cCustomClipboard
Private m_lID As Long

Private Sub cmdCopy_Click()
On Error GoTo ErrorHandler
   
   ' Open the clipboard:
   If (m_cClip.ClipboardOpen(Me.hWnd)) Then
      ' Put the RTF in there:
      If (m_cClip.SetTextData(m_lID, txtRTF.Text)) Then
         ' Success!
         MsgBox "Put RTF on the clipboard.", vbInformation
      End If
      ' Allow other apps access to the clipboard again:
      m_cClip.ClipboardClose
   End If
   Exit Sub
   
ErrorHandler:
   ' Failed somehow -
   MsgBox "An error occurred: " &amp; Err.Description &amp; " [" &amp; Err.Number &amp; "]",
    vbExclamation
   ' ensure clipboard is closed:
   m_cClip.ClipboardClose
   
End Sub

Private Sub cmdPaste_Click()
On Error GoTo ErrorHandler
   
Dim sRtf As String
   
   ' Open the clipboard:
   If (m_cClip.ClipboardOpen(Me.hWnd)) Then
      ' Check if RTF is available:
      If (m_cClip.IsDataAvailableForFormat(m_lID)) Then
         ' Get the RTF:
         If m_cClip.GetTextData(m_lID, sRtf) Then
            ' Success!
            txtRTF.Text = sRtf
         End If
      Else
         MsgBox "No RTF data on the clipboard.", vbInformation
      End If
      m_cClip.ClipboardClose
   End If
   Exit Sub

ErrorHandler:
   ' Failed somehow -
   MsgBox "An error occurred: " &amp; Err.Description &amp; " [" &amp; Err.Number &amp; "]",
    vbExclamation
   ' ensure clipboard is closed:
   m_cClip.ClipboardClose
   
End Sub

Private Sub Form_Load()
   
   ' Add Rich Text Format.
   ' If another application has already registered this
   ' format, e.g. Word, WordPad, IE etc, then you will
   ' get the ID that is already registered.
   m_lID = m_cClip.AddFormat("Rich Text Format")
   If (m_lID = 0) Then
      ' Exceptional circumstance (API call failed):
      MsgBox "Add RTF Format Failed.", vbExclamation
   End If
   
   ' Load a sample RTF File:
   Dim iFile As Long, sBuf As String
   iFile = FreeFile
   Open App.Path &amp; "\toptips.rtf" For Binary Access Read As #iFile
   sBuf = String$(LOF(iFile), 32)
   Get #iFile, , sBuf
   Close #iFile
   txtRTF.Text = sBuf
   
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\..\index.html" ><IMG SRC="..\..\..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Clipboard</a>&#160;.&#160;<a href="article.html">Customising Clipboard Use </a>&#160;.&#160;<a href="rtf_format_copy_and_paste_sample.html">RTF Format Copy and Paste Sample</a>&#160;.&#160;fSimpleRTFClipboard.frm</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
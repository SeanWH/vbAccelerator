<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: frmIDiscMaster.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmIDiscMaster.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /><link rel="SHORTCUT ICON" href="/home/res/vbaccel.ico" /><link rel="copyright" href="/home/The_Site/Copyright/article.asp" /><link rel="contents" href="./VB6_IMAPI_Properties_Demonstration.asp" /><link rel="meta" type="application/rdf+xml" href="./VB6 IMAPI Properties Demonstration.rdf" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Writing CDs</a>&#160;.&#160;<a href="article.html">Image Mastering API (IMAPI) Library for VB</a>&#160;.&#160;<a href="vb6_imapi_properties_demonstration.html">VB6 IMAPI Properties Demonstration</a>&#160;.&#160;frmIDiscMaster.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_imapi_library_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 IMAPI Library Binary</a> (26K)</p><p class="nav"><a href="vb5_imapi_library_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 IMAPI Library Source</a> (74K)</p><p class="nav"><a href="vb5_imapi_properties_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 IMAPI Properties Demonstration</a> (31K)</p><p /><p class="nav"><a href="vb6_imapi_library_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 IMAPI Library Binary</a> (27K)</p><p class="nav"><a href="vb6_imapi_library_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 IMAPI Library Source</a> (74K)</p><p class="nav"><a href="vb6_imapi_properties_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 IMAPI Properties Demonstration</a> (30K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:15050</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=15050&type=zip&title=vb6_20imapi_20properties_20demonstration_2ezip_5ffrmidiscmaster.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />2 Jun 2004<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\controls\treeview\treeview_control\article.html">vbAccelerator TreeView Control</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\simple_cd_burn\article.html">Simple Data CD Creation Using ICDBurn</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\type_libraries\imapi_(cd_burning)\article[1].html">VB IMAPI (CD Burning) Interfaces (IVBIMAPI.tlb)</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\tips\mapping_nt_device_names\article.html">Mapping NT Device Names to Drive Letters and vice-versa</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmIDiscMaster.frm</h1><p>This file is part of the download <a href="vb6_imapi_properties_demonstration.html">VB6 IMAPI Properties Demonstration</a>, which is described in the article <a href="article.html">Image Mastering API (IMAPI) Library for VB</a>.</p><pre>VERSION 5.00
Object = "{CA5A8E1E-C861-4345-8FF8-EF0A27CD4236}#1.1#0"; "vbalTreeView6.ocx"
Begin VB.Form frmDiscMaster 
   Caption         =   "vbAccelerator: IMAPI CD Properties"
   ClientHeight    =   5805
   ClientLeft      =   4755
   ClientTop       =   2040
   ClientWidth     =   6630
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmIDiscMaster.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   5805
   ScaleWidth      =   6630
   Begin vbalTreeViewLib6.vbalTreeView tvwRecorders 
      Height          =   4755
      Left            =   120
      TabIndex        =   2
      Top             =   480
      Width           =   6375
      _ExtentX        =   11245
      _ExtentY        =   8387
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
   End
   Begin VB.CommandButton cmdRefresh 
      Caption         =   "&amp;Refresh"
      Height          =   375
      Left            =   180
      TabIndex        =   1
      Top             =   5340
      Width           =   1335
   End
   Begin VB.Label lblRecorderInformation 
      Caption         =   "Recorder Information:"
      Height          =   255
      Left            =   180
      TabIndex        =   0
      Top             =   120
      Width           =   6255
   End
End
Attribute VB_Name = "frmDiscMaster"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private m_cDiscMaster As cDiscMaster

Private Sub showRecorders()
Dim cRecorders As cDiscRecorders
Dim cRecorder As cDiscRecorder
Dim iRecorder As Long
Dim iProperty As Long
Dim nodRecorder As cTreeViewNode
Dim nodMedia As cTreeViewNode
Dim nodProperties As cTreeViewNode
Dim nodFormats As cTreeViewNode
Dim nodJoliet As cTreeViewNode
Dim sKey As String
Dim cMedia As cMediaInfo

   Screen.MousePointer = vbHourglass

   Set cRecorders = m_cDiscMaster.Recorders
   
   For iRecorder = 1 To cRecorders.Count
      Set cRecorder = cRecorders(iRecorder)
      With cRecorder
         
         sKey = "R:" &amp; iRecorder
         Set nodRecorder = tvwRecorders.Nodes.Add(, , sKey, "Recorder " &amp;
          iRecorder)
         
         nodRecorder.AddChildNode sKey &amp; ":ID", "PNP ID=" &amp; .PnPID
         nodRecorder.AddChildNode sKey &amp; ":Type", "Type=" &amp;
          RecorderTypeName(.RecorderType)
         nodRecorder.AddChildNode sKey &amp; ":Path", "Path = " &amp; cRecorder.Path
         nodRecorder.AddChildNode sKey &amp; ":Vendor", "Vendor = " &amp;
          cRecorder.VendorId
         nodRecorder.AddChildNode sKey &amp; ":Product", "Product = " &amp;
          cRecorder.ProductId
         nodRecorder.AddChildNode sKey &amp; ":Revision", "Revision = " &amp;
          cRecorder.RevisionId
         nodRecorder.AddChildNode sKey &amp; ":State", "State=" &amp;
          RecorderStateName(.RecorderState)
         
         Me.Refresh
         
         .OpenExclusive
         Set cMedia = cRecorder.MediaInfo
         Set nodMedia = nodRecorder.AddChildNode(, "Media")
         If cMedia.MediaPresent Then
            nodMedia.AddChildNode sKey &amp; ":MediaType", "Media Type=" &amp;
             MediaTypeName(cMedia.MediaType)
            nodMedia.AddChildNode sKey &amp; ":MediaFlags", "Media Flags=" &amp;
             MediaFlagNames(cMedia.MediaFlags)
         
            nodMedia.AddChildNode sKey &amp; ":Sessions", "Sessions=" &amp;
             cMedia.Sessions
            nodMedia.AddChildNode sKey &amp; ":LastTrack", "LastTrack=" &amp;
             cMedia.LastTrack
            nodMedia.AddChildNode sKey &amp; ":Start", "Start=" &amp;
             cMedia.StartAddress
            nodMedia.AddChildNode sKey &amp; ":Next", "Next=" &amp; cMedia.LastWritable
            nodMedia.AddChildNode sKey &amp; ":Free", "Free=" &amp; cMedia.FreeBlocks
         Else
            nodMedia.AddChildNode sKey &amp; ":NoMedia", "No Media in drive"
         End If
         
         .CloseExclusive
         DoEvents
         nodMedia.Expanded = True
         
         Set nodProperties = nodRecorder.AddChildNode(sKey &amp; ":PROPS",
          "Recorder Properties")
         With .Properties
            For iProperty = 1 To .Count
               With .Property(iProperty)
                  nodProperties.AddChildNode sKey &amp; ":PROPS:" &amp; iProperty,
                   .Name &amp; " = " &amp; .Value
               End With
            Next iProperty
         End With
         nodProperties.Expanded = True
         
         DoEvents
         Me.Refresh
         
         Set nodFormats = nodRecorder.AddChildNode(sKey &amp; ":FORMATS", "Recorder
          Formats")
         If (.SupportsRedbook) Then
            nodFormats.AddChildNode sKey &amp; ":REDBOOK", "Redbook (Audio)"
         End If
         If (.SupportsJoliet) Then
            Set nodJoliet = nodFormats.AddChildNode(sKey &amp; ":JOLIET", "Joliet
             (Data)")
         End If
         nodFormats.Expanded = True
                  
         nodRecorder.Expanded = True
         
      End With
   Next iRecorder
   
   Screen.MousePointer = vbDefault
   
End Sub

Private Sub Command2_Click()
   With m_cDiscMaster.Recorders.Recorder(1)
      .OpenExclusive
      .Eject
      .CloseExclusive
   End With
End Sub

Private Sub cmdRefresh_Click()
   '
   lblRecorderInformation.Caption = "Getting recorder information, please
    wait..."
   tvwRecorders.Nodes.Clear
   Me.Enabled = False
   showRecorders
   lblRecorderInformation.Caption = "Recorder Information:"
   Me.Enabled = True
   '
End Sub

Private Sub Form_Load()

   lblRecorderInformation.Caption = "Getting recorder information, please
    wait..."

   Me.Enabled = False
   Me.Show
   Me.Refresh

   Set m_cDiscMaster = New cDiscMaster
   m_cDiscMaster.Initialise
   
   showRecorders
   
   lblRecorderInformation.Caption = "Recorder Information:"
   Me.Enabled = True

End Sub

Private Sub Form_QueryUnload(Cancel As Integer, UnloadMode As Integer)
   
   Me.Enabled = False
   
   lblRecorderInformation.Caption = "Shutting down, please wait..."
   tvwRecorders.Nodes.Clear
   Me.Refresh
   
   Screen.MousePointer = vbHourglass
   m_cDiscMaster.ClearUp
   Screen.MousePointer = vbDefault
   
End Sub

Private Sub Form_Resize()
   '
   On Error Resume Next
   tvwRecorders.Move tvwRecorders.Left, tvwRecorders.Top, Me.ScaleWidth -
    tvwRecorders.Left * 2, _
      Me.ScaleHeight - tvwRecorders.Top - tvwRecorders.Left * 2 -
       cmdRefresh.Height
   cmdRefresh.Top = tvwRecorders.Top + tvwRecorders.Height + tvwRecorders.Left
   '
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\compression\index.html" ><IMG SRC="..\..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Writing CDs</a>&#160;.&#160;<a href="article.html">Image Mastering API (IMAPI) Library for VB</a>&#160;.&#160;<a href="vb6_imapi_properties_demonstration.html">VB6 IMAPI Properties Demonstration</a>&#160;.&#160;frmIDiscMaster.frm</p><br /><table style="font-size: 100%;"><tr><td valign="top"><a href="javascript:window.alert(&quot;http://creativecommons.org/licenses/by/1.0/\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\res\cc.png" width="88" height="31" alt="Creative Commons Licence" /></a></td></a></td><td valign="top"><p class="nav" style="padding-bottom: 4px;">All contents of this web site are licensed under a <a href="javascript:window.alert(&quot;http://creativecommons.org/licenses/by/1.0/\nThis link was not retrieved.&quot;)">Creative Commons Licence</a>, except where otherwise noted.</p><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2004 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>, vbAccelerator Ltd.<br />Last Updated: 9 June 2004</p></td></tr></table></td><td></td></tr></table>
</body></html>
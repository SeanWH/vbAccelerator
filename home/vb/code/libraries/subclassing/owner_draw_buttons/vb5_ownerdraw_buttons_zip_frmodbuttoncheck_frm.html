<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: frmODButtonCheck.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmODButtonCheck.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.asp\index.html">Subclassing</a>&#160;.&#160;<a href="article.html">Drawing Buttons, Option Boxes and Check Boxes In Your Own Style </a>&#160;.&#160;<a href="vb5_ownerdraw_buttons.html">VB5 OwnerDraw Buttons</a>&#160;.&#160;frmODButtonCheck.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_ownerdraw_buttons.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 OwnerDraw Buttons</a> (34K)</p><p /><p class="nav"><a href="vb6_ownerdraw_buttons.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 OwnerDraw Buttons</a> (32K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:5007</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=5007&type=zip&title=vb5_20ownerdraw_20buttons_2ezip_5ffrmodbuttoncheck.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />27 Jan 1999<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\ssubtimer\article.html">Subclassing Without The Crashes</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmODButtonCheck.frm</h1><pre>VERSION 5.00
Object = "{6B7E6392-850A-101B-AFC0-4210102A8DA7}#1.3#0"; "COMCTL32.OCX"
Begin VB.Form frmODButtonCheck 
   Caption         =   "Owner Draw Button Class Sample"
   ClientHeight    =   3780
   ClientLeft      =   3120
   ClientTop       =   2385
   ClientWidth     =   5940
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmODButtonCheck.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   3780
   ScaleWidth      =   5940
   Begin VB.Frame fraDrawStyle 
      Caption         =   "&amp;Draw Style"
      ClipControls    =   0   'False
      Height          =   1035
      Left            =   2340
      TabIndex        =   16
      Top             =   2400
      Width           =   3315
      Begin VB.OptionButton optStyle 
         Caption         =   "&amp;Thin Borders"
         Height          =   255
         Index           =   0
         Left            =   120
         TabIndex        =   19
         Top             =   240
         Width           =   2595
      End
      Begin VB.OptionButton optStyle 
         Caption         =   "&amp;Owner Draw"
         Height          =   255
         Index           =   1
         Left            =   120
         TabIndex        =   18
         Top             =   480
         Width           =   2355
      End
      Begin VB.OptionButton optStyle 
         Caption         =   "&amp;Standard"
         Height          =   255
         Index           =   2
         Left            =   120
         TabIndex        =   17
         Top             =   720
         Value           =   -1  'True
         Width           =   2415
      End
   End
   Begin VB.CommandButton cmdPrint 
      Caption         =   "&amp;Print"
      Height          =   435
      Left            =   120
      Style           =   1  'Graphical
      TabIndex        =   13
      Top             =   840
      Width           =   1155
   End
   Begin VB.PictureBox picDemo 
      AutoRedraw      =   -1  'True
      Height          =   1935
      Left            =   3060
      Picture         =   "frmODButtonCheck.frx":1272
      ScaleHeight     =   1875
      ScaleWidth      =   1875
      TabIndex        =   12
      Top             =   3000
      Visible         =   0   'False
      Width           =   1935
   End
   Begin VB.CommandButton cmdStandard 
      Height          =   195
      Index           =   0
      Left            =   120
      Style           =   1  'Graphical
      TabIndex        =   11
      Top             =   3000
      Width           =   195
   End
   Begin VB.CheckBox chkTest 
      Caption         =   "Check1"
      Height          =   495
      Index           =   2
      Left            =   3900
      Style           =   1  'Graphical
      TabIndex        =   6
      Top             =   1500
      Width           =   1275
   End
   Begin VB.CheckBox chkTest 
      Caption         =   "Check1"
      Height          =   495
      Index           =   1
      Left            =   3900
      Style           =   1  'Graphical
      TabIndex        =   5
      Top             =   960
      Width           =   1275
   End
   Begin VB.CheckBox chkTest 
      Caption         =   "Check1"
      Height          =   495
      Index           =   0
      Left            =   3900
      Style           =   1  'Graphical
      TabIndex        =   4
      Top             =   420
      Width           =   1275
   End
   Begin VB.OptionButton optButton 
      Caption         =   "Option1"
      Height          =   495
      Index           =   2
      Left            =   2340
      Style           =   1  'Graphical
      TabIndex        =   3
      Top             =   1500
      Width           =   1155
   End
   Begin VB.OptionButton optButton 
      Caption         =   "Option1"
      Height          =   495
      Index           =   1
      Left            =   2340
      Style           =   1  'Graphical
      TabIndex        =   2
      Top             =   960
      Width           =   1155
   End
   Begin VB.OptionButton optButton 
      Caption         =   "Option1"
      Height          =   495
      Index           =   0
      Left            =   2340
      Style           =   1  'Graphical
      TabIndex        =   1
      Top             =   420
      Width           =   1155
   End
   Begin VB.CommandButton cmdNormal 
      Caption         =   "&amp;Save"
      Height          =   435
      Left            =   120
      Style           =   1  'Graphical
      TabIndex        =   0
      Top             =   360
      Width           =   1155
   End
   Begin VB.Label lblCheckInfo 
      BackStyle       =   0  'Transparent
      Height          =   255
      Left            =   3900
      TabIndex        =   15
      Top             =   2100
      Width           =   1515
   End
   Begin VB.Label lblOptionInfo 
      BackStyle       =   0  'Transparent
      Height          =   255
      Left            =   2340
      TabIndex        =   14
      Top             =   2040
      Width           =   1515
   End
   Begin VB.Label lblStandard 
      Caption         =   "Simple Standard Buttons:"
      Height          =   255
      Left            =   120
      TabIndex        =   10
      Top             =   2700
      Width           =   1935
   End
   Begin ComctlLib.ImageList ilsIcons 
      Left            =   2340
      Top             =   3060
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   327682
      BeginProperty Images {0713E8C2-850A-101B-AFC0-4210102A8DA7} 
         NumListImages   =   5
         BeginProperty ListImage1 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "frmODButtonCheck.frx":1ACE
            Key             =   ""
         EndProperty
         BeginProperty ListImage2 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "frmODButtonCheck.frx":1DE8
            Key             =   ""
         EndProperty
         BeginProperty ListImage3 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "frmODButtonCheck.frx":2102
            Key             =   ""
         EndProperty
         BeginProperty ListImage4 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "frmODButtonCheck.frx":241C
            Key             =   ""
         EndProperty
         BeginProperty ListImage5 {0713E8C3-850A-101B-AFC0-4210102A8DA7} 
            Picture         =   "frmODButtonCheck.frx":2736
            Key             =   ""
         EndProperty
      EndProperty
   End
   Begin VB.Label lblCheckButtons 
      BackStyle       =   0  'Transparent
      Caption         =   "Check Buttons:"
      Height          =   195
      Left            =   3960
      TabIndex        =   9
      Top             =   120
      Width           =   1395
   End
   Begin VB.Label lblOptionButtons 
      BackStyle       =   0  'Transparent
      Caption         =   "Option Buttons:"
      Height          =   195
      Left            =   2340
      TabIndex        =   8
      Top             =   120
      Width           =   1395
   End
   Begin VB.Label lblCommand 
      BackStyle       =   0  'Transparent
      Caption         =   "Command Button:"
      Height          =   195
      Left            =   120
      TabIndex        =   7
      Top             =   120
      Width           =   1875
   End
End
Attribute VB_Name = "frmODButtonCheck"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Implements IOwnerDrawButton
Private m_cODBtn As cOwnerDrawButton
Private Declare Function GetDlgCtrlID Lib "user32" (ByVal hwnd As Long) As Long


Private Sub chkTest_Click(Index As Integer)
Dim sMsg As String
Dim i As Long
   For i = 0 To 2
      If (chkTest(i).Value = Checked) Then
         sMsg = sMsg &amp; i &amp; ","
      End If
   Next
   If (sMsg &lt;&gt; "") Then
      sMsg = left$(sMsg, Len(sMsg) - 1) &amp; " selected"
   Else
      sMsg = "None selected"
   End If
   lblCheckInfo.Caption = sMsg
End Sub

Private Sub cmdNormal_Click()
   MsgBox "Clicked Save.", vbInformation
End Sub

Private Sub cmdPrint_Click()
   MsgBox "Clicked Print.", vbInformation
End Sub

Private Sub cmdStandard_Click(Index As Integer)
   MsgBox "Clicked Simple Standard Button Index " &amp; Index, vbInformation
End Sub

Private Sub Form_Load()
Dim i As Long
   Set m_cODBtn = New cOwnerDrawButton
   m_cODBtn.Attach Me
   For i = eodClose To eodSizeBox
      If (i &gt; eodClose) Then
         Load cmdStandard(i - 1)
         cmdStandard(i - 1).left = cmdStandard(i - 2).left + cmdStandard(i -
          2).Width + Screen.TwipsPerPixelX
         cmdStandard(i - 1).Visible = True
      End If
      m_cODBtn.SetStandardButtonStyle cmdStandard(i - 1), i
   Next i
   Set Me.Picture = picDemo.Picture
   ilsIcons.ListImages(1).Draw 0, 0, 0
   optButton_Click 0
   chkTest_Click 0
End Sub
Private Function FindControl(ByVal lhWnd As Long, ByRef ctl As Control) As
 Boolean
Dim i As Long
   For i = 0 To 2
      If lhWnd = chkTest(i).hwnd Then
         Set ctl = chkTest(i)
         FindControl = True
         Exit Function
      ElseIf lhWnd = optButton(i).hwnd Then
         Set ctl = optButton(i)
         FindControl = True
         Exit Function
      End If
   Next i
End Function

Private Property Get IOwnerDrawButton_ButtonContainerhWnd() As Long
   IOwnerDrawButton_ButtonContainerhWnd = Me.hwnd
End Property

Private Property Get IOwnerDrawButton_DoOwnerDraw(ByVal lhWnd As Long) As
 Boolean
   IOwnerDrawButton_DoOwnerDraw = True
End Property

Private Sub IOwnerDrawButton_DrawItem(ByVal lhWnd As Long, ByVal lHDC As Long,
 ByRef lLeft As Long, ByRef lTop As Long, ByRef lRight As Long, ByRef lBottom
 As Long, ByVal bPushed As Boolean, ByVal bChecked As Boolean, ByVal bEnabled
 As Boolean, ByVal bInFocus As Boolean, ByRef bDoDefault As Boolean)
Dim ctl As Control
   If (lhWnd = cmdNormal.hwnd) Then
      InitCustomDrawButton ilsIcons.hImageList, 3, picDemo.hdc,
       cmdNormal.Caption
      DrawButton lhWnd, lHDC, lLeft, lTop, lRight, lBottom, bPushed, bEnabled,
       bInFocus
   ElseIf (lhWnd = cmdPrint.hwnd) Then
      InitCustomDrawButton ilsIcons.hImageList, 1, picDemo.hdc, cmdPrint.Caption
      DrawButton lhWnd, lHDC, lLeft, lTop, lRight, lBottom, bPushed, bEnabled,
       bInFocus
   Else
      If (optStyle(1).Value) Then
         If FindControl(lhWnd, ctl) Then
            InitCustomDrawButton ilsIcons.hImageList, 2, picDemo.hdc,
             ctl.Caption
            DrawButton lhWnd, lHDC, lLeft, lTop, lRight, lBottom, bPushed Or
             bChecked, bEnabled, bInFocus
         Else
            bDoDefault = True
         End If
      Else
         bDoDefault = True
      End If
   End If
End Sub

Private Sub optButton_Click(Index As Integer)
   lblOptionInfo.Caption = Index &amp; " selected."
End Sub

Private Sub optStyle_Click(Index As Integer)
Dim i As Long
   Select Case Index
   Case 0
      For i = 0 To 2
         m_cODBtn.SetBorderStyle optButton(i), eodBorderThin
         m_cODBtn.RedrawButton optButton(i)
         m_cODBtn.SetBorderStyle chkTest(i), eodBorderThin
         m_cODBtn.RedrawButton chkTest(i)
      Next
   Case 1
      For i = 0 To 2
         m_cODBtn.RedrawButton optButton(i)
         m_cODBtn.RedrawButton chkTest(i)
      Next i
   Case 2
      For i = 0 To 2
         m_cODBtn.SetBorderStyle optButton(i), eodBorderThick
         m_cODBtn.RedrawButton optButton(i)
         m_cODBtn.SetBorderStyle chkTest(i), eodBorderThick
         m_cODBtn.RedrawButton chkTest(i)
      Next
   End Select
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\vbmedia\using_gdi_plus\index.html" ><IMG SRC="..\..\..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.asp\index.html">Subclassing</a>&#160;.&#160;<a href="article.html">Drawing Buttons, Option Boxes and Check Boxes In Your Own Style </a>&#160;.&#160;<a href="vb5_ownerdraw_buttons.html">VB5 OwnerDraw Buttons</a>&#160;.&#160;frmODButtonCheck.frm</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
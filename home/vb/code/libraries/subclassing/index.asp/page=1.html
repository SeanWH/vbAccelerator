<html lang="en" >
<head>

<title>vbAccelerator - Index of Subclassing</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /><link rel="SHORTCUT ICON" href="/home/res/vbaccel.ico" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;Subclassing</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\seealso.png" width="125" height="21" alt="See Also" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\clipboard\index.html">Clipboard</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\common_dialogs\index.html">Common Dialogs</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\compression\index.html">Compression</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\crc32\article.html">Calculating CRC32 With VB</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\graphics_and_gdi\index.asp\index.html">Graphics and GDI</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\hirestimer\article.html">High Resolution Multimedia Timer</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\hooks\index.html">Hooks</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\persistance\index.html">Persistance</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\registry_and_ini_files\index.html">Registry and Ini Files</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\resources\index.html">Resources</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\shell_projects\index.html">Shell Projects</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\splitting\index.html">Splitting</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\subclassing_and_hooking_with_machine_code_thunks\article.html">Subclassing and Hooking with Machine Code Thunks</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\threading\index.html">Threading</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\windows\index.html">Windows</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related" /><a href="..\..\xp_visual_styles\index.html">XP Visual Styles</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>Subclassing Index</h1>
<p class="nav">Page 1&#160;<a href="page=2.html">2</a>&#160;<a href="page=2.html">Next &gt;</a><p class="nav">&#160;</p><table><tr><td valign="top"><a href="..\ssubtimer\article.html"><img src="..\ssubtimer\subclass_small.png" width="98" height="98" alt="Subclassing" /></a></td><td valign="top" width="100%"><h2><a href="..\ssubtimer\article.html">Subclassing Without The Crashes</a></h2><p>Prior to VB5, it was impossible to subclass a control without relying on a proprietary 
custom control. This greatly restricted what you could do if you wanted to play around with 
some of the neater customisation features - creating a new control was completely out, finding out 
in detail what was going on with menus was impossible and so on.</p><p>The introduction of the <i>AddressOf</i> operator to VB5 now allows you to subclass, although 
it is not nearly as simple as it ought to be.</p><p>The <i>SSubTmr</i> component is a more stable and consistent way of working with subclassing,
without some of the attendent difficulties. You can either use it as an external DLL to provide, or 
by including one module and one interface class, you can compile it directly into your application 
once you are happy the subclassing is working. SSubTmr is the basis for most of the VB controls
on this site.</p><p>The component itself mostly uses the <i>SubTimer.DLL</i> component code from 
Bruce McKinney's excellent "Hardcore Visual Basic" book, however it has a couple of 
very useful enhancements described in this article.</p><p class="cell">&#160;&#160;<a href="..\ssubtimer\article.html">more...</a></p><br /><p>Last Updated: 26 January 2003</p></td></tr><tr><td colspan="2"><hr /></td></tr><tr><td valign="top"><a href="..\ssubtimer_asm_version\article.html"><img src="..\ssubtimer_asm_version\subclass_small.png" width="98" height="98" alt="Click for SSubTimer - ASM Thunk Version" /></a></td><td valign="top" width="100%"><h2><a href="..\ssubtimer_asm_version\article.html">SSubTimer - ASM Thunk Version</a></h2><p>
The SSubTimer component launched on this site in 1998 has been used extensively
to solve two of the difficulties associated with subclassing Window messages
in Visual Basic: allowing subclassing code to be encapsulated so that independent subclassers do not negatively interact with each other and abstracting an application
from low-level underlying details of installing and removing the callback procedure
function.
</p><p>
However, the use of Visual Basic code to run the callback meant that it was still
possible to crash the IDE during debugging.  This article provides a binary
compatible implementation of the original SSubTimer which uses an ASM Thunk and
includes IDE detection which means even better stability.
</p><p class="cell">&#160;&#160;<a href="..\ssubtimer_asm_version\article.html">more...</a></p><br /><p>Last Updated: 25 April 2004</p></td></tr><tr><td colspan="2"><hr /></td></tr><tr><td valign="top"><a href="..\emulating_modal_forms\article.html"><img src="..\emulating_modal_forms\emulatingmodality_small.png" width="98" height="98" alt="Click for Emulating Modal Forms" /></a></td><td valign="top" width="100%"><h2><a href="..\emulating_modal_forms\article.html">Emulating Modal Forms</a></h2><p>
Sometimes, the restrictions applied when showing a modal form can be restrictive.  For example,
if your application can have more than one main view window, a modal dialog prevents any other
form from being activated whilst the modal dialog is displayed.  Another example occurs when
you want to try and show a <a href="..\..\..\controls\drop_down_tool_windows\drop_down_form_control\article.html">Drop-Down Form</a> or a <a href="..\..\..\controls\toolbar\vbaccelerator_office_docking_bar\article.html">floating toolbar</a> from an otherwise
modal form.  This article demonstrates how to emulate showing a modal form and fix these limitations.
</p><p class="cell">&#160;&#160;<a href="..\emulating_modal_forms\article.html">more...</a></p><br /><p>Last Updated: 1 November 2003</p></td></tr><tr><td colspan="2"><hr /></td></tr><tr><td valign="top"><a href="..\adding_scroll_bars_to_forms__pictureboxes_and_usercontrols\article.html"><img src="..\adding_scroll_bars_to_forms__pictureboxes_and_usercontrols\scrolldemo_small.png" width="98" height="98" alt="Click for Adding Scroll Bars to Forms, PictureBoxes and User Controls" /></a></td><td valign="top" width="100%"><h2><a href="..\adding_scroll_bars_to_forms__pictureboxes_and_usercontrols\article.html">Adding Scroll Bars to Forms, PictureBoxes and User Controls</a></h2><p>In the Win32 API, all windows can have scroll bars. However, this feature is not exposed in any 
way in Visual Basic. Its not too hard to enable, though provided you can intercept <span class="code">WM_HSCROLL</span> and 
<span class="code">WM_VSCROLL</span> messages sent to the window. This project provides a small, self-contained class which extends 
Forms, UserControls and PictureBoxes to allow full scroll-bar functionality. This class is based on 
the Flat Scroll-Bar control and provides the same functionality but in a smaller, easier-to-use package which 
you can compile directly into your executable.</p><p class="cell">&#160;&#160;<a href="..\adding_scroll_bars_to_forms__pictureboxes_and_usercontrols\article.html">more...</a></p><br /><p>Last Updated: 2 July 2003</p></td></tr><tr><td colspan="2"><hr /></td></tr><tr><td valign="top"><a href="..\tile_a_bitmap_into_a_textbox\article.html"><img src="..\tile_a_bitmap_into_a_textbox\textboxback_small.png" width="98" height="98" alt="TextBox Background sample" /></a></td><td valign="top" width="100%"><h2><a href="..\tile_a_bitmap_into_a_textbox\article.html">Tile a Bitmap Into a TextBox Background</a></h2><p>
This sample presents a small class that allows you to tile a bitmap into the background of a TextBox.
Note that the technique only works on multi-line text boxes, as the drawing of single-line TextBoxes is done
in a different way and cannot be easily overridden in code.
    </p><p class="cell">&#160;&#160;<a href="..\tile_a_bitmap_into_a_textbox\article.html">more...</a></p><br /><p>Last Updated: 25 November 2002</p></td></tr><tr><td colspan="2"><hr /></td></tr><tr><td valign="top"><a href="..\sophisticated_control_over_window_sizing_and_moving\article.html"><img src="..\sophisticated_control_over_window_sizing_and_moving\resizesample_small.png" width="98" height="98" alt="Click for Sophisticated Control Over Window Sizing and Moving " /></a></td><td valign="top" width="100%"><h2><a href="..\sophisticated_control_over_window_sizing_and_moving\article.html">Sophisticated Control Over Window Sizing and Moving </a></h2><p>VB's control over moving and sizing isn't much - basically you have the <i>Resize</i> event, as has 
been the case since VB1. Windows gives you a lot more control over moving and sizing forms if you need it though. 
For example, try resizing an undocked tool window in MS Office. You will see that the size snaps so groups 
of buttons or controls are kept on the same line.</p><p>This sample demonstrates how to get access to all the more sophisticated moving and sizing messages, 
and how to use them to control your window's resize without the flickering and jumping to position you get 
if you try to change size during VB's Resize event.</p><p class="cell">&#160;&#160;<a href="..\sophisticated_control_over_window_sizing_and_moving\article.html">more...</a></p><br /><p>Last Updated: 25 August 1999</p></td></tr><tr><td colspan="2"><hr /></td></tr><tr><td valign="top"><a href="..\keep_form_titlebars_in_focus_when_toolwindows_are_shown\article.html"><img src="..\keep_form_titlebars_in_focus_when_toolwindows_are_shown\titlebarfocus_small.png" width="98" height="98" alt="Click for Keep Form Titlebars in Focus when ToolWindows are Shown" /></a></td><td valign="top" width="100%"><h2><a href="..\keep_form_titlebars_in_focus_when_toolwindows_are_shown\article.html">Keep Form Titlebars in Focus when ToolWindows are Shown</a></h2><p>
The ToolWindow style, introduced with VB4, allowing you to easily create 
pop-up tool windows with small captions. However, there is (and has always been) 
a problem with them: whenever the form or a control on it gets the focus, 
it appears that the main form of your application looses focus. Whilst 
maybe this isn't the worst user-interface crime in the world, it is 
annoying and makes your application look unprofessional compared to the 
smoother behaviour in Word, Excel, DevStudio etc.
</p><p>
This subclassing sample demonstrates how to fix the title bar problem with 
a working but, erm, rather slimy hack.
</p><p class="cell">&#160;&#160;<a href="..\keep_form_titlebars_in_focus_when_toolwindows_are_shown\article.html">more...</a></p><br /><p>Last Updated: 25 August 1999</p></td></tr><tr><td colspan="2"><hr /></td></tr><tr><td valign="top"><a href="..\generating_mouseleave_events_for_a_window\article.html"><img src="..\generating_mouseleave_events_for_a_window\mouseleave_small.png" width="98" height="98" alt="Click for Generating MouseLeave Events for a Window" /></a></td><td valign="top" width="100%"><h2><a href="..\generating_mouseleave_events_for_a_window\article.html">Generating MouseLeave Events for a Window</a></h2><p>Almost all of the more recent windows control support a feature known as "Hot-Tracking" - that is, 
when the control appears to highlight when the mouse moves over it, then returns to normal when the mouse leaves. 
Common examples include the flat toolbar buttons provided with the Windows Commmon controls.</p><p>This article demonstrates how to add this to your controls - properly.</p><p class="cell">&#160;&#160;<a href="..\generating_mouseleave_events_for_a_window\article.html">more...</a></p><br /><p>Last Updated: 17 February 1999</p></td></tr><tr><td colspan="2"><hr /></td></tr><tr><td valign="top"><a href="..\registered_hotkeys\article.html"><img src="..\registered_hotkeys\hotkey_small.png" width="98" height="98" alt="Click for Creating and Responding to System-Wide Hotkeys" /></a></td><td valign="top" width="100%"><h2><a href="..\registered_hotkeys\article.html">Creating and Responding to System-Wide Hotkeys</a></h2><p>
Win32 allows you to set up combinations of key-presses which can be 
associated with an application on a system-wide scope, called Hotkeys. 
When a user presses a registered HotKey it doesn't matter which 
application is active when they pressed it, the hot-key message will 
get routed to your application.
</p><p class="cell">&#160;&#160;<a href="..\registered_hotkeys\article.html">more...</a></p><br /><p>Last Updated: 27 January 1999</p></td></tr><tr><td colspan="2"><hr /></td></tr><tr><td valign="top"><a href="..\owner_draw_buttons\article.html"><img src="..\owner_draw_buttons\odbutton_small.png" width="98" height="98" alt="Click for Drawing Buttons, Option Boxes and Check Boxes In Your Own Style " /></a></td><td valign="top" width="100%"><h2><a href="..\owner_draw_buttons\article.html">Drawing Buttons, Option Boxes and Check Boxes In Your Own Style </a></h2><p>
If you set the <i>Style</i> property for VB's CommandButton, OptionBox or 
CheckBox controls to <i>Graphical</i>, VB turns the control into an Owner-Draw 
control. By default VB allows you to associate three pictures with 
these controls.   However, if you've ever tried this you will know that the 
button draws like a turd when you set these properties.
</p><p>
The code with this sample shows you how to intercept the <i>WM_DRAWITEM</i>
messages an Owner-Draw button sends to its parent whenever it is about to
draw itself and replace VB's implementation with something a bit nicer.
</p><p class="cell">&#160;&#160;<a href="..\owner_draw_buttons\article.html">more...</a></p><br /><p>Last Updated: 27 January 1999</p></td></tr><tr><td colspan="2"><hr /></td></tr></table><p class="nav">Page 1&#160;<a href="page=2.html">2</a>&#160;<a href="page=2.html">Next &gt;</a><p class="nav">&#160;</p>
<p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\..\index.html" ><IMG SRC="..\..\..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;Subclassing</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2004 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 25 April 2004</p></td><td></td></tr></table>
</body></html>
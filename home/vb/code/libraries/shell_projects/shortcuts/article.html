<html lang="en" >
<head>

<title>vbAccelerator - Creating Shortcuts using VB</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="
This article expands on the cShellLink class provided to allow the
shortcuts used in Window's Recent Document 
Collection to be investigated.  It demonstrates how to use the class
to read and write shortcuts, including choosing the icon, start up
directory and more.
" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Shell Projects</a>&#160;.&#160;Creating Shortcuts using VB</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_shortcut_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Shortcut Demonstration</a> (49K)</p><p /><p class="nav"><a href="vb6_shortcut_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Shortcut Demonstration</a> (47K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:4573</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=4573&type=article&title=creating_20shortcuts_20using_20vb.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />28 Mar 2003<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\type_libraries\shelllink\article.html">VB IShellLink Interface (ShellLink.tlb)</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\adding__deleting_and_viewing_recent_documents\article.html">Adding, Deleting and Viewing Recent Documents</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\common_dialogs\folder_browser\article.html">Browsing For Folders</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\type_libraries\ishellfolder\article.html">IShellFolder Extended Type Library Version 1.2 (ISHF_Ex.Tlb)</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\controls\icon_controls\icon_selector\article.html">vbAccelerator Icon Selector Control</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\..\net\code\libraries\shell_projects\getting_file_icons_using_the_shell\article.html">Getting File Icons Using The Shell</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\common_dialogs\common_dialog_direct\article.html">CommonDialog/Direct</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>Creating Shortcuts using VB</h1><img src="shortcut.png" width="275" height="264" alt="Shortcut Class Demonstration Application" /><p /><p>
This article expands on the <span class="code">cShellLink</span> class provided to allow the
shortcuts used in <a href="..\adding__deleting_and_viewing_recent_documents\article.html">Window's Recent Document 
Collection</a> to be investigated.  It demonstrates how to use the class
to read and write shortcuts, including choosing the icon, start up
directory and more.
</p><h2>Using the ShellLink Class</h2><p>A shortcut in Windows has a number of properties, most of which are
optional:</p><ul><li><strong>The shortcut's Target</strong><br />
This is the file or Shell object to launch when the shortcut is opened and is 
the only required property.</li><li><strong>The icon to display</strong><br />
There are two ways to specify the icon.  Firstly, if nothing is specified,
Windows display's the target's default icon.  Otherwise, you can specify either
a .ICO file or the index of an icon resource within a Windows EXE or DLL.</li><li><strong>Target Arguments</strong><br />
Any arguments are passed to the target when it is started, for example, a
Shortcut could have a target of Notepad.exe and a arguments containing a file to
open.</li><li><strong>Working Directory</strong><br />
The directory to change to for the any new process started using the 
shortcut.</li><li><strong>Shortcut Description</strong><br />
The description can be displayed in the Comments column of Explorer's
Details view or as an InfoTip when the user hovers over the shortcut.</li><li><strong>Open State</strong><br />
This specifies whether to open the object in a normal, minimised or maximised
Window.</li><li><strong>Hot Key</strong><br />
Specifies a key combination which will open the shortcut from anywhere in
Windows.  This is typically used with icons on the desktop.</li></ul><p>
The <span class="code">cShellLink</span> class provided with the download provides a straightforward
wrapper around each of these properties.  Once you've created an instance of the
object, you can use the <span class="code">Resolve</span> method to load an existing shortcut, or
just start modifying the properties for a new one.  The <span class="code">Target</span>, <span class="code">IconPath</span> and <span class="code">IconIndex</span>,
<span class="code">Arguments</span>, <span class="code">WorkingDirectory</span>, <span class="code">Description</span>,
<span class="code">DisplayMode</span> and <span class="code">HotKey</span> properties then provide read/write access
to the shortcut's details.  To get a <span class="code">StdPicture</span> containing the icon, use 
the <span class="code">Icon</span> property: note that as the icon details are optional, the icon
may just be the Shell's icon associated with the target, in which case you
can use the <a href="..\..\..\..\..\net\code\libraries\shell_projects\getting_file_icons_using_the_shell\article.html">File Icon</a> class to get it.
</p><p>
To make the sample more usable, I've included the <a href="..\..\..\controls\icon_controls\icon_selector\article.html">Icon Picker</a> control for choosing icons for the shortcut.
</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\vbmedia\using_gdi_plus\index.html" ><IMG SRC="..\..\..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Libraries</a>&#160;.&#160;<a href="..\index.html">Shell Projects</a>&#160;.&#160;Creating Shortcuts using VB</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 1 September 2003</p></td><td></td></tr></table>
</body></html>

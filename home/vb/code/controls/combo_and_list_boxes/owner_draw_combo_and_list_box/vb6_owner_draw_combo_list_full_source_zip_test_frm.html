<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: Test.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: Test.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Combo and List Boxes</a>&#160;.&#160;<a href="article.html">Owner Draw Combo and List Boxes Version 2.1</a>&#160;.&#160;<a href="vb6_owner_draw_combo_list_full_source.html">VB6 Owner Draw Combo List Full Source</a>&#160;.&#160;Test.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_owner_draw_combo_list_control.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Owner Draw Combo List Control</a> (40K)</p><p class="nav"><a href="vb5_owner_draw_combo_list_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Owner Draw Combo List Full Source</a> (255K)</p><p /><p class="nav"><a href="vb6_owner_draw_combo_list_control.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Owner Draw Combo List Control</a> (41K)</p><p class="nav"><a href="vb6_owner_draw_combo_list_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Owner Draw Combo List Demonstration</a> (153K)</p><p class="nav"><a href="vb6_owner_draw_combo_list_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Owner Draw Combo List Full Source</a> (239K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:1603</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=1603&type=zip&title=vb6_20owner_20draw_20combo_20list_20full_20source_2ezip_5ftest.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />19 Dec 2002<br />VB6 Version Added</p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\type_libraries\ole_guid_and_interface_definitions\article.html">Ole Guid and interface definitions (OleGuids.Tlb) </a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\imagelist\system_image_list\article.html">Using the System Image List with (and without) vbAccelerator Controls</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\imagelist\vbaccelerator_image_list_control\article.html">vbAccelerator ImageList Control and Class v2.0</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: Test.frm</h1><pre>VERSION 5.00
Object = "{462EF1F4-16AF-444F-9DEE-F41BEBEC2FD8}#1.0#0"; "vbalODCL6.ocx"
Begin VB.Form frmTest 
   Caption         =   "Owner Draw Combo and List Box Tester"
   ClientHeight    =   8475
   ClientLeft      =   2565
   ClientTop       =   1785
   ClientWidth     =   6975
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "Test.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   8475
   ScaleWidth      =   6975
   Begin VB.CommandButton cmdTestForm 
      Caption         =   "MDI Test Form"
      Height          =   435
      Left            =   2460
      TabIndex        =   9
      Top             =   6060
      Width           =   1215
   End
   Begin VB.CheckBox chkEmpty 
      Caption         =   "&amp;Empty"
      Height          =   195
      Left            =   1440
      TabIndex        =   7
      Top             =   4440
      Width           =   2235
   End
   Begin ODCboLst6.OwnerDrawComboList cboFonts 
      Height          =   360
      Left            =   60
      TabIndex        =   6
      Top             =   3900
      Width           =   3615
      _ExtentX        =   6376
      _ExtentY        =   582
      Sorted          =   -1  'True
      ExtendedUI      =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   -2147483630
      ClientDraw      =   7
      Style           =   0
   End
   Begin VB.CommandButton cmdSetFocus 
      Caption         =   "Set Focus v"
      Height          =   435
      Left            =   5760
      TabIndex        =   11
      Top             =   6060
      Width           =   1095
   End
   Begin VB.Timer tmrFocus 
      Interval        =   250
      Left            =   3900
      Top             =   5880
   End
   Begin ODCboLst6.OwnerDrawComboList lstMultiSelect 
      Height          =   1755
      Left            =   4020
      TabIndex        =   15
      Top             =   4080
      Width           =   2835
      _ExtentX        =   5001
      _ExtentY        =   3096
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   -2147483630
      Style           =   6
      MaxLength       =   0
   End
   Begin ODCboLst6.OwnerDrawComboList cboCursors 
      Height          =   360
      Left            =   4020
      TabIndex        =   13
      Top             =   2940
      Width           =   2895
      _ExtentX        =   5106
      _ExtentY        =   635
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   -2147483630
      Style           =   0
      Enabled         =   0   'False
      NoGrayWhenDisabled=   -1  'True
   End
   Begin ODCboLst6.OwnerDrawComboList lstSysColours 
      Height          =   1995
      Left            =   3960
      TabIndex        =   12
      Top             =   300
      Width           =   2955
      _ExtentX        =   5212
      _ExtentY        =   3519
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   -2147483630
      ClientDraw      =   5
      Style           =   4
      MaxLength       =   0
   End
   Begin ODCboLst6.OwnerDrawComboList cboSysColor 
      Height          =   360
      Left            =   60
      TabIndex        =   0
      Top             =   300
      Width           =   2055
      _ExtentX        =   3625
      _ExtentY        =   556
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   -2147483630
      ClientDraw      =   5
      MaxLength       =   0
   End
   Begin ODCboLst6.OwnerDrawComboList cboColorPicker 
      Height          =   360
      Left            =   60
      TabIndex        =   3
      Top             =   1500
      Width           =   1995
      _ExtentX        =   3519
      _ExtentY        =   556
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   -2147483630
      ClientDraw      =   3
      MaxLength       =   0
   End
   Begin ODCboLst6.OwnerDrawComboList cboStyles 
      Height          =   360
      Left            =   60
      TabIndex        =   5
      Top             =   3000
      Width           =   3555
      _ExtentX        =   6271
      _ExtentY        =   582
      ExtendedUI      =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   -2147483630
      ClientDraw      =   6
      Style           =   0
   End
   Begin ODCboLst6.OwnerDrawComboList lstCheck 
      Height          =   1335
      Left            =   60
      TabIndex        =   8
      Top             =   4680
      Width           =   3615
      _ExtentX        =   6376
      _ExtentY        =   2355
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   -2147483630
      Style           =   7
      MaxLength       =   0
   End
   Begin ODCboLst6.OwnerDrawComboList lstMultiCol 
      Height          =   1875
      Left            =   60
      TabIndex        =   10
      Top             =   6540
      Width           =   6795
      _ExtentX        =   11986
      _ExtentY        =   3307
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Style           =   4
      MaxLength       =   0
   End
   Begin VB.CheckBox chkEnabled 
      Caption         =   "&amp;Enabled"
      Enabled         =   0   'False
      Height          =   195
      Left            =   4020
      TabIndex        =   16
      Top             =   5880
      Width           =   2835
   End
   Begin VB.CheckBox chkShowNames 
      Caption         =   "&amp;Show Names"
      Height          =   255
      Left            =   60
      TabIndex        =   4
      Top             =   1920
      Value           =   1  'Checked
      Width           =   1995
   End
   Begin VB.PictureBox picColorSample 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   855
      Left            =   2100
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   22
      TabStop         =   0   'False
      Top             =   1500
      Width           =   975
   End
   Begin VB.CheckBox chkVisible 
      Caption         =   "Selection &amp;Invisible"
      Height          =   195
      Left            =   60
      TabIndex        =   2
      Top             =   720
      Width           =   1875
   End
   Begin VB.CommandButton cmdLoad 
      Caption         =   "&amp;Load..."
      Height          =   375
      Left            =   4020
      TabIndex        =   14
      Top             =   3480
      Width           =   1035
   End
   Begin VB.CommandButton cmdShow 
      Caption         =   "v"
      Height          =   375
      Left            =   3180
      TabIndex        =   1
      Top             =   300
      Width           =   375
   End
   Begin VB.PictureBox picSample 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   855
      Left            =   2160
      ScaleHeight     =   795
      ScaleWidth      =   915
      TabIndex        =   17
      TabStop         =   0   'False
      Top             =   300
      Width           =   975
   End
   Begin VB.Label lblFocus 
      Caption         =   "x"
      Height          =   315
      Left            =   3900
      TabIndex        =   28
      Top             =   6300
      Width           =   1035
   End
   Begin VB.Label lblInfo 
      Caption         =   "Multi Column List Box:"
      Height          =   195
      Index           =   5
      Left            =   60
      TabIndex        =   27
      Top             =   6300
      Width           =   3615
   End
   Begin VB.Label lblInfo 
      Caption         =   "Checked List Box:"
      Height          =   195
      Index           =   4
      Left            =   60
      TabIndex        =   26
      Top             =   4440
      Width           =   3135
   End
   Begin VB.Label lblInfo 
      Caption         =   "Font Chooser Combo with Auto-Complete and ExtendedUI
       (Down Arrow key drops):"
      Height          =   435
      Index           =   3
      Left            =   60
      TabIndex        =   25
      Top             =   3480
      Width           =   3615
   End
   Begin VB.Label lblInfo 
      Caption         =   "As a Multi Select List Box:"
      Height          =   195
      Index           =   8
      Left            =   4020
      TabIndex        =   24
      Top             =   3840
      Width           =   2775
   End
   Begin VB.Label lblInfo 
      Caption         =   "Default Draw Using Imagelist.  Auto-Complete combo
       box which doesn't gray when disabled."
      Height          =   615
      Index           =   7
      Left            =   4020
      TabIndex        =   23
      Top             =   2340
      Width           =   2775
   End
   Begin VB.Label lblInfo 
      Caption         =   "Colour Picker Combo:"
      Height          =   195
      Index           =   1
      Left            =   60
      TabIndex        =   21
      Top             =   1260
      Width           =   3075
   End
   Begin VB.Label lblInfo 
      Caption         =   "Sys Colour Picker as a List Box:"
      Height          =   195
      Index           =   6
      Left            =   3960
      TabIndex        =   20
      Top             =   60
      Width           =   2775
   End
   Begin VB.Label lblInfo 
      Caption         =   "Paragraph Style Chooser with Auto-Complete and
       ExtendedUI (Down Arrow key drops):"
      Height          =   435
      Index           =   2
      Left            =   120
      TabIndex        =   19
      Top             =   2580
      Width           =   3495
   End
   Begin VB.Label lblInfo 
      Caption         =   "Sys Colour Picker as a ComboBox:"
      Height          =   195
      Index           =   0
      Left            =   60
      TabIndex        =   18
      Top             =   60
      Width           =   3075
   End
End
Attribute VB_Name = "frmTest"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Declare Function SendMessageLong Lib "user32" Alias "SendMessageA"
 (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As
 Long) As Long
Private Const LB_SETHORIZONTALEXTENT = &amp;H194
Private Declare Function DestroyIcon Lib "user32" (ByVal hIcon As Long) As Long


Private Sub AddStyles()
   Dim sFnt As New StdFont, lHeight As Long
   lHeight = 32
   With cboStyles
      sFnt.Name = "Arial"
      sFnt.Size = 14
      sFnt.Bold = True
      sFnt.Italic = False
      Set Me.Font = sFnt
      .AddItemAndData "Heading 1", , 8, , , sFnt.Size, , lHeight, , eixVCentre,
       sFnt
      sFnt.Name = "Arial"
      sFnt.Size = 12
      sFnt.Bold = False
      sFnt.Italic = True
      Set Me.Font = sFnt
      .AddItemAndData "Heading 2", , 8, , , sFnt.Size, , lHeight, , eixVCentre,
       sFnt
      sFnt.Name = "Arial"
      sFnt.Size = 10
      sFnt.Bold = True
      sFnt.Italic = False
      Set Me.Font = sFnt
      .AddItemAndData "Heading 3", , 8, , , sFnt.Size, , lHeight, , eixVCentre,
       sFnt
      sFnt.Name = "Times New Roman"
      sFnt.Size = 10
      sFnt.Bold = False
      sFnt.Italic = False
      Set Me.Font = sFnt
      .AddItemAndData "Normal", , 8, , , sFnt.Size, , lHeight, , eixVCentre,
       sFnt
      .AddItemAndData "Centred", , 8, , , sFnt.Size, , lHeight, eixCentre,
       eixVCentre, sFnt
      sFnt.Name = "Courier New"
      sFnt.Size = 8
      sFnt.Bold = False
      sFnt.Italic = False
      Set Me.Font = sFnt
      .AddItemAndData "Code", , 8, , , sFnt.Size, , lHeight, , eixVCentre, sFnt
      sFnt.Name = "Arial"
      sFnt.Size = 10
      sFnt.Bold = False
      sFnt.Italic = False
      sFnt.Underline = True
      Set Me.Font = sFnt
      .AddItemAndData "Followed Hyperlink", , 8, &amp;H800080, , sFnt.Size, ,
       lHeight, , eixVCentre, sFnt
      .AddItemAndData "Hyperlink", , 8, &amp;HFF0000, , sFnt.Size, , lHeight, ,
       eixVCentre, sFnt
      .DoAutoComplete = True
      .AutoCompleteListItemsOnly = True
   End With

End Sub

Private Sub cboColorPicker_Click()
   picColorSample.BackColor =
    cboColorPicker.ItemBackColor(cboColorPicker.ListIndex)
End Sub


Private Sub cboCursors_Change()
   Debug.Print "cboCursors_Change", cboCursors.Text
End Sub

Private Sub cboCursors_Click()
   Debug.Print "cboCursors_Click"
End Sub

Private Sub cboCursors_GotFocus()
   Debug.Print "cboCursors:LostFocus"
End Sub

Private Sub cboCursors_KeyDown(KeyCode As Integer, Shift As Integer)
   Debug.Print "cboCursors_KeyDown", KeyCode, Shift
End Sub

Private Sub cboCursors_KeyPress(KeyAscii As Integer)
   Debug.Print "cboCursors_KeyPRess", KeyAscii
   Dim sC As String
   sC = Chr$(KeyAscii)
   KeyAscii = Asc(UCase$(sC))
End Sub

Private Sub cboCursors_LostFocus()
   Debug.Print "cboCursors:LostFocus"
End Sub

Private Sub cboCursors_ODGotFocus()
   Debug.Print "cboCursors:ODGotFocus"
End Sub

Private Sub cboCursors_ODLostFocus()
   Debug.Print "cboCursors:ODLostFocus"
End Sub

Private Sub cboSysColor_Click()
   picSample.BackColor = cboSysColor.ItemBackColor(cboSysColor.ListIndex)
End Sub

Private Sub cboSysColor_CloseUp()
   If (chkVisible.Value = 1) Then
      cmdShow.SetFocus
   End If
End Sub

Private Sub cboSysColor_KeyDown(KeyCode As Integer, Shift As Integer)
   Debug.Print "SysColor:KeyDown", KeyCode
End Sub

Private Sub chkEmpty_Click()
   If (chkEmpty.Value = Checked) Then
      lstCheck.Clear
   Else
      ' Add some items to the checked list box:
      With lstCheck
         .AddItem "File Menu Items"
         .AddItemAndData "Open", , 16
         .AddItemAndData "Save", , 16
         .AddItemAndData "Exit", , 16
      End With
   End If
End Sub

Private Sub chkEnabled_Click()
   cboCursors.Enabled = -1 * chkEnabled.Value
   lstMultiSelect.Enabled = -1 * chkEnabled.Value
   If (chkEnabled.Value = Checked) Then
      cboCursors.BackColor = vbWindowBackground
   Else
      cboCursors.BackColor = vbButtonFace
   End If
End Sub

Private Sub chkShowNames_Click()
   If (chkShowNames.Value = 1) Then
      cboColorPicker.ClientDraw = ecdColourPickerWithNames
   Else
      cboColorPicker.ClientDraw = ecdColourPickerNoNames
   End If
End Sub

Private Sub chkVisible_Click()
   cboSysColor.Visible = (chkVisible - 1) * -1
End Sub


Private Sub cmdLoad_Click()
Dim sFile As String
Dim iCount As Integer
Dim iImgCount As Integer
Dim i As Long
Dim sLC As String
Dim bFound As Boolean
Dim iH As Long
Dim cf As New cFileIcon
Dim iC As Long
Dim fMaxColorDepth As Double
Dim iMaxColorDepthIndex As Long
Dim hIcon As Long

   If cboCursors.Tag = "" Then
      With cboCursors.InternalImageList
         .IconSizeX = 16
         .IconSizeY = 16
         .ColourDepth = ILC_COLOR24
         .Create2
         cboCursors.ImageList = .hIml
      End With
      iImgCount = 0
      sFile = Dir(App.Path &amp; "\Images\*.*")
      Do While sFile &lt;&gt; ""
         iCount = iCount + 1
         cf.LoadIcon App.Path &amp; "\Images\" &amp; sFile
         fMaxColorDepth = 0
         For iC = 1 To cf.ImageCount
            If (cf.ImageWidth(iC) = 16) Then
               If (cf.ImageColourCount(iC) &gt; fMaxColorDepth) And Not
                (cf.ImageHasAlphaChannel(iC)) Then
                  fMaxColorDepth = cf.ImageColourCount(iC)
                  iMaxColorDepthIndex = iC
               End If
            End If
         Next iC
         hIcon = cf.IconHandle(Me.hdc, iMaxColorDepthIndex)
         cboCursors.InternalImageList.AddFromHandle hIcon, IMAGE_ICON
         DestroyIcon hIcon
         iImgCount = iImgCount + 1
         If (iCount = 1) Then
            cboCursors.AddItemAndData UCase$(Left$(sFile, 1)), , 2
            iCount = iCount + 1
         Else
            ' Check if we have a header:
            sLC = UCase$(Left$(sFile, 1))
            bFound = False
            For iH = 0 To cboCursors.ListCount - 1
              If (cboCursors.List(iH) = sLC) Then
                bFound = True
              End If
            Next iH
            If Not (bFound) Then
              cboCursors.AddItemAndData sLC, , 2
              cboCursors.ItemOverLine(cboCursors.NewIndex) = True
            End If
         End If
         cboCursors.AddItemAndData sFile, (iImgCount - 1), 8, , , iCount, , 20
         sFile = Dir
      Loop
      If (iCount &gt; 0) Then
         chkEnabled.Enabled = True
         chkEnabled.Value = 1
         cboCursors.ListIndex = 0
         cmdLoad.Enabled = False
         lstMultiSelect.ImageList = cboCursors.InternalImageList.hIml
         For i = 0 To cboCursors.ListCount - 1
            lstMultiSelect.AddItemAndData cboCursors.List(i),
             cboCursors.ItemIcon(i), cboCursors.ItemIndent(i), , ,
             cboCursors.ItemData(i), , cboCursors.itemHeight(i) - 2
            If (cboCursors.ItemOverLine(i)) Then
              lstMultiSelect.ItemOverLine(i) = True
            End If
         Next i
      Else
         MsgBox "No images found in the path: " &amp; App.Path &amp; "\Images\*.*",
          vbInformation
      End If
      cboCursors.Tag = "LOADED"
     
     cboCursors.DoAutoComplete = True
     cboCursors.AutoCompleteItemsAreSorted = True
     cboCursors.AutoCompleteListItemsOnly = False

   End If
End Sub

Private Sub cmdShow_Click()
Dim X As Long, Y As Long
   X = cmdShow.Left \ Screen.TwipsPerPixelX
   Y = 1 + (cmdShow.Top + cmdShow.Height) \ Screen.TwipsPerPixelY
   cboSysColor.ShowDropDownAtPosition X, Y
End Sub

Private Sub cmdTestForm_Click()
   mfrmTest.Show
End Sub

Private Sub cmdSetFocus_Click()
   lstMultiCol.SetFocus
End Sub

Private Sub Form_Load()
   
   cboSysColor.DropDownWidth = (cboSysColor.Width * 2) \ Screen.TwipsPerPixelX
   
   ' Set up the colour picker combo:
   With cboColorPicker
      .AddItemAndData "Black", , , , vbBlack
      .AddItemAndData "Dark Red", , , , &amp;H80&amp;
      .AddItemAndData "Dark Green", , , , &amp;H8000&amp;
      .AddItemAndData "Ochre", , , , &amp;H8080&amp;
      .AddItemAndData "Dark Blue", , , , &amp;H800000
      .AddItemAndData "Purple", , , , &amp;H800080
      .AddItemAndData "Turquoise", , , , &amp;H808000
      .AddItemAndData "Silver", , , , &amp;HC0C0C0
      .AddItemAndData "Gray", , , , &amp;H808080
      .AddItemAndData "Red", , , , vbRed
      .AddItemAndData "Green", , , , vbGreen
      .AddItemAndData "Yellow", , , , vbYellow
      .AddItemAndData "Blue", , , , vbBlue
      .AddItemAndData "Magenta", , , , vbMagenta
      .AddItemAndData "Cyan", , , , vbCyan
      .AddItemAndData "White", , , , vbWhite
      .ListIndex = 0
   End With
   
   ' Select the first font:
   If (cboFonts.ListCount = 0) Then
      cboFonts.AddItem "No fonts available"
      cboFonts.Enabled = False
   Else
      cboFonts.DoAutoComplete = True
      cboFonts.AutoCompleteItemsAreSorted = True
      cboFonts.AutoCompleteListItemsOnly = True
   End If
   cboFonts.ListIndex = 0
   
   ' Set up available styles:
   AddStyles
   
   ' Add some items to the checked list box:
   With lstCheck
      .AddItem "File Menu Items"
      .AddItemAndData "Open", , 16
      .AddItemAndData "Save", , 16
      .AddItemAndData "Exit", , 16
   End With
   
   ' Set up the multi-column list box:
   Dim lW As Long, i As Long
   With lstMultiCol
      .Columns = 4
      lW = lstMultiCol.Width \ Screen.TwipsPerPixelX * 8
      .ColWidth(1) = lW * 3
      .ColWidth(2) = lW
      .ColWidth(3) = 2 * lW
      .ColWidth(4) = 2 * lW
      .ImageList = .InternalImageList.hIml
      For i = 1 To 10
         .AddItemAndData ("Quite a reasonably long item for column 1, row" &amp; i
          &amp; vbTab &amp; "Col2" &amp; i &amp; vbTab &amp; Format$(Now, "hh:mm:ss") &amp; vbTab &amp; i),
          Rnd * 7
      Next i
      .FullRowSelect = True
   End With
   
   SendMessageLong lstMultiCol.hWnd, LB_SETHORIZONTALEXTENT, (lstMultiCol.Width
    \ Screen.TwipsPerPixelX) * 3, 0
   
   
End Sub


Private Sub lstCheck_Click()
Dim i As Long
   'Debug.Print "Check_Click"
   'If (lstCheck.ListIndex = 0) Then
   '   For i = 1 To 3
   '      lstCheck.Selected(i) = lstCheck.Selected(0)
   '   Next i
   'End If
End Sub

Private Sub lstCheck_KeyPress(KeyAscii As Integer)
Dim lI As Long
   If (KeyAscii = 13) Then
      lI = lstCheck.ListIndex
      If (lI &gt; -1) Then
         'lstCheck.Selected(lI) = Not (lstCheck.Selected(lI))
      End If
   End If
End Sub

Private Sub lstMultiCol_Click()
   Debug.Print "MultiCol_Click" &amp; lstMultiCol.List(lstMultiCol.ListIndex)
End Sub

Private Sub lstSysColours_Change()
   Debug.Print "Colour:Change"
End Sub

Private Sub lstSysColours_Click()
   Debug.Print "Colour:Click"
   Debug.Print lstSysColours.List(lstSysColours.ListIndex)
End Sub

Private Sub lstSysColours_KeyDown(KeyCode As Integer, Shift As Integer)
   Debug.Print "Colour:KeyDown", KeyCode, Shift
End Sub

Private Sub lstSysColours_KeyPress(KeyAscii As Integer)
   Debug.Print "Colour:KeyPress", KeyAscii
End Sub

Private Sub lstSysColours_KeyUp(KeyCode As Integer, Shift As Integer)
   Debug.Print "Colour:KeyUp"
End Sub

Private Sub lstMultiCol_KeyDown(KeyCode As Integer, Shift As Integer)
   Debug.Print "MultiCol:KEYDOWN", KeyCode, Shift
End Sub

Private Sub lstMultiSelect_KeyDown(KeyCode As Integer, Shift As Integer)
   Debug.Print KeyCode, Shift
End Sub

Private Sub picSample_Click()
   Set cboStyles.Font = Me.Font
End Sub

Private Sub tmrFocus_Timer()
   If Not (Me.ActiveControl Is Nothing) Then
      lblFocus.Caption = Me.ActiveControl.Name
   Else
      lblFocus.Caption = "&lt;none&gt;"
   End If
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\vbmedia\using_gdi_plus\index.html" ><IMG SRC="..\..\..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Combo and List Boxes</a>&#160;.&#160;<a href="article.html">Owner Draw Combo and List Boxes Version 2.1</a>&#160;.&#160;<a href="vb6_owner_draw_combo_list_full_source.html">VB6 Owner Draw Combo List Full Source</a>&#160;.&#160;Test.frm</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 11 May 2003</p></td><td></td></tr></table>
</body></html>
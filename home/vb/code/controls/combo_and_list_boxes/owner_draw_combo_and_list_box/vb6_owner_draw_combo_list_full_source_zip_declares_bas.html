<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: Declares.bas</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: Declares.bas" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Combo and List Boxes</a>&#160;.&#160;<a href="article.html">Owner Draw Combo and List Boxes Version 2.1</a>&#160;.&#160;<a href="vb6_owner_draw_combo_list_full_source.html">VB6 Owner Draw Combo List Full Source</a>&#160;.&#160;Declares.bas</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_owner_draw_combo_list_control.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Owner Draw Combo List Control</a> (40K)</p><p class="nav"><a href="vb5_owner_draw_combo_list_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Owner Draw Combo List Full Source</a> (255K)</p><p /><p class="nav"><a href="vb6_owner_draw_combo_list_control.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Owner Draw Combo List Control</a> (41K)</p><p class="nav"><a href="vb6_owner_draw_combo_list_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Owner Draw Combo List Demonstration</a> (153K)</p><p class="nav"><a href="vb6_owner_draw_combo_list_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Owner Draw Combo List Full Source</a> (239K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:1603</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=1603&type=zip&title=vb6_20owner_20draw_20combo_20list_20full_20source_2ezip_5fdeclares.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />19 Dec 2002<br />VB6 Version Added</p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\type_libraries\ole_guid_and_interface_definitions\article.html">Ole Guid and interface definitions (OleGuids.Tlb) </a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\imagelist\system_image_list\article.html">Using the System Image List with (and without) vbAccelerator Controls</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\imagelist\vbaccelerator_image_list_control\article.html">vbAccelerator ImageList Control and Class v2.0</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: Declares.bas</h1><pre>Attribute VB_Name = "mDeclares"
Option Explicit

' rect
Type RECT
    left As Long
    tOp As Long
    Right As Long
    Bottom As Long
End Type

' font
Public Const LF_FACESIZE = 32
Type LOGFONT
    lfHeight As Long
    lfWidth As Long
    lfEscapement As Long
    lfOrientation As Long
    lfWeight As Long
    lfItalic As Byte
    lfUnderline As Byte
    lfStrikeOut As Byte
    lfCharSet As Byte
    lfOutPrecision As Byte
    lfClipPrecision As Byte
    lfQuality As Byte
    lfPitchAndFamily As Byte
    lfFaceName(LF_FACESIZE) As Byte
End Type

' Owner draw Combo Box stuff:

' Type to hold information about combo items:
Type ICONLISTBOXITEMINFO
    lItemData As Long           ' Provide item data - normal item data is used
     to store a pointer to a structure of this type
    lExtraData As Long          ' An additional item data
    lIconIndex As Long          ' Index of icon in icon list, if required
    lIndentSize As Long         ' How far the text should be indented from
     left, in pixels
    lItemHeight As Long         ' How high a single item should be
    lForeColour As OLE_COLOR    ' Fore colour of the item
    lBackColour As OLE_COLOR    ' Back colour of the item
    bUnderLineItem As Boolean   ' Whether a ruling should be placed below the
     item
    bOverLineItem As Boolean    ' Whether a ruling should be placed above the
     item
    dFontSize As Single         ' VB font size, stored here for ease of
     extracting a font object
    tLF As LOGFONT              ' API font description.  lfFaceName should have
     all bytes = 0 to use default
    lTextAlignX As Long         ' Horizonal Text alignment
    lTextAlignY As Long         ' Vertical Text alignment
End Type

' Windows API stuff

' Owner draw item measure:
Type MEASUREITEMSTRUCT
    CtlType As Long
    CtlID As Long
    ItemId As Long
    itemWidth As Long
    itemHeight As Long
    itemData As Long
End Type

' Owner draw item draw:
Type DRAWITEMSTRUCT
    CtlType As Long
    CtlID As Long
    ItemId As Long
    ItemAction As Long
    ItemState As Long
    hwndItem As Long
    hdc As Long
    rcItem As RECT
    itemData As Long
End Type

' Memory functions:
Public Declare Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" ( _
    lpvDest As Any, lpvSource As Any, ByVal cbCopy As Long)
Declare Function GlobalAlloc Lib "kernel32" (ByVal wFlags As Long, ByVal
 dwBytes As Long) As Long
Declare Function GlobalFree Lib "kernel32" (ByVal hMem As Long) As Long
Declare Function GlobalLock Lib "kernel32" (ByVal hMem As Long) As Long
Declare Function GlobalUnlock Lib "kernel32" (ByVal hMem As Long) As Long
' Memory allocation/manipulation constants:
Public Const GMEM_DISCARDABLE = &amp;H100
Public Const GMEM_FIXED = &amp;H0
Public Const GMEM_INVALID_HANDLE = &amp;H8000
Public Const GMEM_MODIFY = &amp;H80
Public Const GMEM_MOVEABLE = &amp;H2
Public Const GMEM_NOCOMPACT = &amp;H10
Public Const GMEM_NODISCARD = &amp;H20
Public Const GMEM_NOT_BANKED = &amp;H1000
Public Const GMEM_NOTIFY = &amp;H4000
Public Const GMEM_SHARE = &amp;H2000
Public Const GMEM_VALID_FLAGS = &amp;H7F72
Public Const GMEM_ZEROINIT = &amp;H40
Public Const GPTR = (GMEM_FIXED Or GMEM_ZEROINIT)

' Window style bit functions:
Public Declare Function SetWindowLong Lib "user32" Alias "SetWindowLongA" _
    (ByVal hwnd As Long, ByVal nIndex As Long, _
    ByVal dwNewLong As Long _
    ) As Long
Public Declare Function GetWindowLong Lib "user32" Alias "GetWindowLongA" _
    (ByVal hwnd As Long, ByVal nIndex As Long _
    ) As Long
' Window Long indexes:
Public Const GWL_EXSTYLE = (-20)
Public Const GWL_HINSTANCE = (-6)
Public Const GWL_HWNDPARENT = (-8)
Public Const GWL_ID = (-12)
Public Const GWL_STYLE = (-16)
Public Const GWL_USERDATA = (-21)
Public Const GWL_WNDPROC = (-4)

' Creating new windows:
Declare Function CreateWindowEx Lib "user32" Alias "CreateWindowExA" (ByVal
 dwExStyle As Long, ByVal lpClassName As String, ByVal lpWindowName As String,
 ByVal dwStyle As Long, ByVal x As Long, ByVal y As Long, ByVal nWidth As Long,
 ByVal nHeight As Long, ByVal hWndParent As Long, ByVal hMenu As Long, ByVal
 hInstance As Long, lpParam As Any) As Long
' General window styles:
Public Const WS_BORDER = &amp;H800000
Public Const WS_CAPTION = &amp;HC00000                  '  WS_BORDER Or WS_DLGFRAME
Public Const WS_CHILD = &amp;H40000000
Public Const WS_CHILDWINDOW = (WS_CHILD)
Public Const WS_CLIPCHILDREN = &amp;H2000000
Public Const WS_CLIPSIBLINGS = &amp;H4000000
Public Const WS_DISABLED = &amp;H8000000
Public Const WS_DLGFRAME = &amp;H400000
Public Const WS_EX_ACCEPTFILES = &amp;H10&amp;
Public Const WS_EX_DLGMODALFRAME = &amp;H1&amp;
Public Const WS_EX_NOPARENTNOTIFY = &amp;H4&amp;
Public Const WS_EX_TOPMOST = &amp;H8&amp;
Public Const WS_EX_TRANSPARENT = &amp;H20&amp;
Public Const WS_GROUP = &amp;H20000
Public Const WS_HSCROLL = &amp;H100000
Public Const WS_MAXIMIZE = &amp;H1000000
Public Const WS_MAXIMIZEBOX = &amp;H10000
Public Const WS_MINIMIZE = &amp;H20000000
Public Const WS_ICONIC = WS_MINIMIZE
Public Const WS_MINIMIZEBOX = &amp;H20000
Public Const WS_OVERLAPPED = &amp;H0&amp;
Public Const WS_POPUP = &amp;H80000000
Public Const WS_SYSMENU = &amp;H80000
Public Const WS_TABSTOP = &amp;H10000
Public Const WS_THICKFRAME = &amp;H40000
Public Const WS_SIZEBOX = WS_THICKFRAME
Public Const WS_TILED = WS_OVERLAPPED
Public Const WS_VISIBLE = &amp;H10000000
Public Const WS_VSCROLL = &amp;H200000
Public Const WS_OVERLAPPEDWINDOW = (WS_OVERLAPPED Or WS_CAPTION Or WS_SYSMENU
 Or WS_THICKFRAME Or WS_MINIMIZEBOX Or WS_MAXIMIZEBOX)
Public Const WS_TILEDWINDOW = WS_OVERLAPPEDWINDOW
Public Const WS_POPUPWINDOW = (WS_POPUP Or WS_BORDER Or WS_SYSMENU)
' extended Style:
Public Const WS_EX_CLIENTEDGE = &amp;H200&amp;
Public Const WS_EX_STATICEDGE = &amp;H20000

' Combo box window styles
Public Const CBS_AUTOHSCROLL = &amp;H40&amp;
Public Const CBS_DISABLENOSCROLL = &amp;H800&amp;
Public Const CBS_DROPDOWN = &amp;H2&amp;
Public Const CBS_DROPDOWNLIST = &amp;H3&amp;
Public Const CBS_HASSTRINGS = &amp;H200&amp;
Public Const CBS_NOINTEGRALHEIGHT = &amp;H400&amp;
Public Const CBS_OEMCONVERT = &amp;H80&amp;
Public Const CBS_OWNERDRAWFIXED = &amp;H10&amp;
Public Const CBS_OWNERDRAWVARIABLE = &amp;H20&amp;
Public Const CBS_SIMPLE = &amp;H1&amp;
Public Const CBS_SORT = &amp;H100&amp;
' List box styles:
Public Const LBS_DISABLENOSCROLL = &amp;H1000&amp;
Public Const LBS_EXTENDEDSEL = &amp;H800&amp;
Public Const LBS_HASSTRINGS = &amp;H40&amp;
Public Const LBS_MULTICOLUMN = &amp;H200&amp;
Public Const LBS_MULTIPLESEL = &amp;H8&amp;
Public Const LBS_NODATA = &amp;H2000&amp;
Public Const LBS_NOINTEGRALHEIGHT = &amp;H100&amp;
Public Const LBS_NOREDRAW = &amp;H4&amp;
Public Const LBS_NOTIFY = &amp;H1&amp;
Public Const LBS_OWNERDRAWFIXED = &amp;H10&amp;
Public Const LBS_OWNERDRAWVARIABLE = &amp;H20&amp;
Public Const LBS_SORT = &amp;H2&amp;
Public Const LBS_USETABSTOPS = &amp;H80&amp;
Public Const LBS_WANTKEYBOARDINPUT = &amp;H400&amp;

' Window appearance control:
Declare Function ShowWindow Lib "user32" (ByVal hwnd As Long, ByVal nCmdShow As
 Long) As Long
' Show window styles
Public Const SW_SHOWNORMAL = 1
Public Const SW_ERASE = &amp;H4
Public Const SW_HIDE = 0
Public Const SW_INVALIDATE = &amp;H2
Public Const SW_MAX = 10
Public Const SW_MAXIMIZE = 3
Public Const SW_MINIMIZE = 6
Public Const SW_NORMAL = 1
Public Const SW_OTHERUNZOOM = 4
Public Const SW_OTHERZOOM = 2
Public Const SW_PARENTCLOSING = 1
Public Const SW_RESTORE = 9
Public Const SW_PARENTOPENING = 3
Public Const SW_SHOW = 5
Public Const SW_SCROLLCHILDREN = &amp;H1
Public Const SW_SHOWDEFAULT = 10
Public Const SW_SHOWMAXIMIZED = 3
Public Const SW_SHOWMINIMIZED = 2
Public Const SW_SHOWMINNOACTIVE = 7
Public Const SW_SHOWNA = 8
Public Const SW_SHOWNOACTIVATE = 4
Declare Function SetWindowPos Lib "user32" (ByVal hwnd As Long, ByVal
 hWndInsertAfter As Long, ByVal x As Long, ByVal y As Long, ByVal cX As Long,
 ByVal cY As Long, ByVal wFlags As Long) As Long
Public Const SWP_SHOWWINDOW = &amp;H40
Public Const SWP_HIDEWINDOW = &amp;H80
Public Const SWP_FRAMECHANGED = &amp;H20        '  The frame changed: send
 WM_NCCALCSIZE
Public Const SWP_NOACTIVATE = &amp;H10
Public Const SWP_NOCOPYBITS = &amp;H100
Public Const SWP_NOMOVE = &amp;H2
Public Const SWP_NOOWNERZORDER = &amp;H200      '  Don't do owner Z ordering
Public Const SWP_NOREDRAW = &amp;H8
Public Const SWP_NOREPOSITION = SWP_NOOWNERZORDER
Public Const SWP_NOSIZE = &amp;H1
Public Const SWP_NOZORDER = &amp;H4
Public Const SWP_DRAWFRAME = SWP_FRAMECHANGED
Public Const HWND_NOTOPMOST = -2

Declare Function DestroyWindow Lib "user32" (ByVal hwnd As Long) As Long
Declare Function EnableWindow Lib "user32" (ByVal hwnd As Long, ByVal fEnable
 As Long) As Long
Declare Function SetFocusAPI Lib "user32" Alias "SetFocus" (ByVal hwnd As Long)
 As Long
Declare Function GetFocus Lib "user32" () As Long
Declare Function MoveWindow Lib "user32" (ByVal hwnd As Long, ByVal x As Long,
 ByVal y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal bRepaint
 As Long) As Long
Declare Function GetWindowRect Lib "user32" (ByVal hwnd As Long, lpRect As
 RECT) As Long
Declare Function GetClientRect Lib "user32" (ByVal hwnd As Long, lpRect As
 RECT) As Long
Declare Function InvalidateRect Lib "user32" (ByVal hwnd As Long, lpRect As
 RECT, ByVal bErase As Long) As Long
Declare Function IsWindow Lib "user32" (ByVal hwnd As Long) As Long
Declare Function IsWindowEnabled Lib "user32" (ByVal hwnd As Long) As Long
Declare Function IsWindowVisible Lib "user32" (ByVal hwnd As Long) As Long

' Window relationship functions:
Declare Function SetParent Lib "user32" (ByVal hWndChild As Long, ByVal
 hWndNewParent As Long) As Long
Declare Function GetParent Lib "user32" (ByVal hwnd As Long) As Long
Declare Function ClientToScreen Lib "user32" (ByVal hwnd As Long, lpPoint As
 POINTAPI) As Long
Declare Function ScreenToClient Lib "user32" (ByVal hwnd As Long, lpPoint As
 POINTAPI) As Long
Declare Function ChildWindowFromPoint Lib "user32" (ByVal hWndParent As Long,
 ByVal x As Long, ByVal y As Long) As Long
Declare Function GetWindow Lib "user32" (ByVal hwnd As Long, ByVal wCmd As
 Long) As Long
Public Const GW_CHILD = 5
Public Const GW_HWNDFIRST = 0
Public Const GW_HWNDLAST = 1
Public Const GW_HWNDNEXT = 2
Public Const GW_HWNDPREV = 3
Public Const GW_MAX = 5
Public Const GW_OWNER = 4

' Message functions:
Declare Function SendMessageByString Lib "user32" Alias "SendMessageA" (ByVal
 hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As
 String) As Long
Declare Function SendMessageByLong Lib "user32" Alias "SendMessageA" (ByVal
 hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As Long)
 As Long
Declare Function SendMessage Lib "user32" Alias "SendMessageA" (ByVal hwnd As
 Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long
Declare Function PostMessage Lib "user32" Alias "PostMessageA" (ByVal hwnd As
 Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long

' Key functions:
Declare Function GetAsyncKeyState Lib "user32" (ByVal vKey As Long) As Integer

' ImageList functions:
' Draw:
Declare Function ImageList_Draw Lib "COMCTL32.DLL" ( _
        ByVal hIml As Long, _
        ByVal i As Long, _
        ByVal hdcDst As Long, _
        ByVal x As Long, _
        ByVal y As Long, _
        ByVal fStyle As Long _
    ) As Long
Public Const ILD_NORMAL = 0
Public Const ILD_TRANSPARENT = 1
Public Const ILD_BLEND25 = 2
Public Const ILD_SELECTED = 4
Public Const ILD_FOCUS = 4
Public Const ILD_MASK = &amp;H10&amp;
Public Const ILD_IMAGE = &amp;H20&amp;
Public Const ILD_ROP = &amp;H40&amp;
Public Const ILD_OVERLAYMASK = 3840
Declare Function ImageList_GetImageRect Lib "COMCTL32.DLL" ( _
        ByVal hIml As Long, _
        ByVal i As Long, _
        prcImage As RECT _
    ) As Long
' Messages:
Declare Function ImageList_DrawEx Lib "COMCTL32" (ByVal hIml As Long, ByVal i
 As Long, ByVal hdcDst As Long, ByVal x As Long, ByVal y As Long, ByVal dx As
 Long, ByVal dy As Long, ByVal rgbBk As Long, ByVal rgbFg As Long, ByVal fStyle
 As Long) As Long
Public Const CLR_NONE = -1
        
' GDI object functions:
Declare Function SelectObject Lib "gdi32" (ByVal hdc As Long, ByVal hObject As
 Long) As Long
Declare Function DeleteObject Lib "gdi32" (ByVal hObject As Long) As Long
Declare Function GetObjectAPI Lib "gdi32" Alias "GetObjectA" (ByVal hObject As
 Long, ByVal nCount As Long, lpObject As Any) As Long
Declare Function GetDC Lib "user32" (ByVal hwnd As Long) As Long
Declare Function DeleteDC Lib "gdi32" (ByVal hdc As Long) As Long
Declare Function ReleaseDC Lib "user32" (ByVal hwnd As Long, ByVal hdc As Long)
 As Long
Declare Function CreateCompatibleDC Lib "gdi32" (ByVal hdc As Long) As Long
Declare Function CreateCompatibleBitmap Lib "gdi32" (ByVal hdc As Long, ByVal
 nWidth As Long, ByVal nHeight As Long) As Long
Declare Function GetDeviceCaps Lib "gdi32" (ByVal hdc As Long, ByVal nIndex As
 Long) As Long
    Public Const BITSPIXEL = 12
    Public Const LOGPIXELSX = 88    '  Logical pixels/inch in X
    Public Const LOGPIXELSY = 90    '  Logical pixels/inch in Y
' System metrics:
Declare Function GetSystemMetrics Lib "user32" (ByVal nIndex As Long) As Long
    Public Const SM_CXICON = 11
    Public Const SM_CYICON = 12
    Public Const SM_CXFRAME = 32
    Public Const SM_CYCAPTION = 4
    Public Const SM_CYFRAME = 33
    Public Const SM_CYBORDER = 6
    Public Const SM_CXBORDER = 5

' Region paint and fill functions:
Declare Function PaintRgn Lib "gdi32" (ByVal hdc As Long, ByVal hRgn As Long)
 As Long
Declare Function ExtFloodFill Lib "gdi32" (ByVal hdc As Long, ByVal x As Long,
 ByVal y As Long, ByVal crColor As Long, ByVal wFillType As Long) As Long
    Public Const FLOODFILLBORDER = 0
    Public Const FLOODFILLSURFACE = 1
Declare Function GetPixel Lib "gdi32" (ByVal hdc As Long, ByVal x As Long,
 ByVal y As Long) As Long

' Pen functions:
Declare Function CreatePen Lib "gdi32" (ByVal nPenStyle As Long, ByVal nWidth
 As Long, ByVal crColor As Long) As Long
    Public Const PS_DASH = 1
    Public Const PS_DASHDOT = 3
    Public Const PS_DASHDOTDOT = 4
    Public Const PS_DOT = 2
    Public Const PS_SOLID = 0
    Public Const PS_NULL = 5

' Brush functions:
Declare Function CreateSolidBrush Lib "gdi32" (ByVal crColor As Long) As Long
Declare Function CreatePatternBrush Lib "gdi32" (ByVal hBitmap As Long) As Long
Declare Function GetSysColorBrush Lib "user32" (ByVal nIndex As Long) As Long

' Rectangle:
Declare Function PtInRect Lib "user32" (lpRect As RECT, ByVal ptX As Long,
 ByVal ptY As Long) As Long
Declare Function InflateRect Lib "user32" (lpRect As RECT, ByVal x As Long,
 ByVal y As Long) As Long

' Line functions:
Declare Function LineTo Lib "gdi32" (ByVal hdc As Long, ByVal x As Long, ByVal
 y As Long) As Long
Type POINTAPI
        x As Long
        y As Long
End Type
Declare Function MoveToEx Lib "gdi32" (ByVal hdc As Long, ByVal x As Long,
 ByVal y As Long, lpPoint As POINTAPI) As Long

' Colour functions:
Declare Function SetTextColor Lib "gdi32" (ByVal hdc As Long, ByVal crColor As
 Long) As Long
Declare Function SetBkColor Lib "gdi32" (ByVal hdc As Long, ByVal crColor As
 Long) As Long
Declare Function SetBkMode Lib "gdi32" (ByVal hdc As Long, ByVal nBkMode As
 Long) As Long
    Public Const OPAQUE = 2
    Public Const TRANSPARENT = 1
Declare Function GetSysColor Lib "user32" (ByVal nIndex As Long) As Long
    Public Const COLOR_ACTIVEBORDER = 10
    Public Const COLOR_ACTIVECAPTION = 2
    Public Const COLOR_ADJ_MAX = 100
    Public Const COLOR_ADJ_MIN = -100
    Public Const COLOR_APPWORKSPACE = 12
    Public Const COLOR_BACKGROUND = 1
    Public Const COLOR_BTNFACE = 15
    Public Const COLOR_BTNHIGHLIGHT = 20
    Public Const COLOR_BTNSHADOW = 16
    Public Const COLOR_BTNTEXT = 18
    Public Const COLOR_CAPTIONTEXT = 9
    Public Const COLOR_GRAYTEXT = 17
    Public Const COLOR_HIGHLIGHT = 13
    Public Const COLOR_HIGHLIGHTTEXT = 14
    Public Const COLOR_INACTIVEBORDER = 11
    Public Const COLOR_INACTIVECAPTION = 3
    Public Const COLOR_INACTIVECAPTIONTEXT = 19
    Public Const COLOR_MENU = 4
    Public Const COLOR_MENUTEXT = 7
    Public Const COLOR_SCROLLBAR = 0
    Public Const COLOR_WINDOW = 5
    Public Const COLOR_WINDOWFRAME = 6
    Public Const COLOR_WINDOWTEXT = 8
    Public Const COLORONCOLOR = 3

' Shell Extract icon functions:
Declare Function FindExecutable Lib "shell32.dll" Alias "FindExecutableA"
 (ByVal lpFile As String, ByVal lpDirectory As String, ByVal lpResult As
 String) As Long
Declare Function ExtractIcon Lib "shell32.dll" Alias "ExtractIconA" (ByVal
 hInst As Long, ByVal lpszExeFileName As String, ByVal nIconIndex As Long) As
 Long

' Icon functions:
Declare Function DrawIcon Lib "user32" (ByVal hdc As Long, ByVal x As Long,
 ByVal y As Long, ByVal hIcon As Long) As Long
Declare Function DestroyIcon Lib "user32" (ByVal hIcon As Long) As Long
Declare Function DrawIconEx Lib "user32" (ByVal hdc As Long, ByVal xLeft As
 Long, ByVal yTop As Long, ByVal hIcon As Long, ByVal cxWidth As Long, ByVal
 cyWidth As Long, ByVal istepIfAniCur As Long, ByVal hbrFlickerFreeDraw As
 Long, ByVal diFlags As Long) As Boolean
Declare Function LoadImage Lib "user32" Alias "LoadImageA" (ByVal hInst As
 Long, ByVal lpsz As String, ByVal un1 As Long, ByVal n1 As Long, ByVal n2 As
 Long, ByVal un2 As Long) As Long
    Public Const LR_LOADMAP3DCOLORS = &amp;H1000
    Public Const LR_LOADFROMFILE = &amp;H10
    Public Const LR_LOADTRANSPARENT = &amp;H20

' Blitting functions
Declare Function BitBlt Lib "gdi32" (ByVal hDestDC As Long, ByVal x As Long,
 ByVal y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal hSrcDC As
 Long, ByVal xSrc As Long, ByVal ySrc As Long, ByVal dwRop As Long) As Long
    Public Const SRCAND = &amp;H8800C6
    Public Const SRCCOPY = &amp;HCC0020
    Public Const SRCERASE = &amp;H440328
    Public Const SRCINVERT = &amp;H660046
    Public Const SRCPAINT = &amp;HEE0086
    Public Const BLACKNESS = &amp;H42
    Public Const WHITENESS = &amp;HFF0062
Declare Function PatBlt Lib "gdi32" (ByVal hdc As Long, ByVal x As Long, ByVal
 y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal dwRop As Long)
 As Long
Declare Function LoadBitmapBynum Lib "user32" Alias "LoadBitmapA" (ByVal
 hInstance As Long, ByVal lpBitmapName As Long) As Long
Type BITMAP '14 bytes
    bmType As Long
    bmWidth As Long
    bmHeight As Long
    bmWidthBytes As Long
    bmPlanes As Integer
    bmBitsPixel As Integer
    bmBits As Long
End Type
Declare Function CreateBitmapIndirect Lib "gdi32" (lpBitmap As BITMAP) As Long

' Text functions:
Declare Function DrawText Lib "user32" Alias "DrawTextA" (ByVal hdc As Long,
 ByVal lpStr As String, ByVal nCount As Long, lpRect As RECT, ByVal wFormat As
 Long) As Long
    Public Const DT_BOTTOM = &amp;H8
    Public Const DT_CENTER = &amp;H1
    Public Const DT_LEFT = &amp;H0
    Public Const DT_CALCRECT = &amp;H400
    Public Const DT_WORDBREAK = &amp;H10
    Public Const DT_VCENTER = &amp;H4
    Public Const DT_TOP = &amp;H0
    Public Const DT_TABSTOP = &amp;H80
    Public Const DT_SINGLELINE = &amp;H20
    Public Const DT_RIGHT = &amp;H2
    Public Const DT_NOCLIP = &amp;H100
    Public Const DT_INTERNAL = &amp;H1000
    Public Const DT_EXTERNALLEADING = &amp;H200
    Public Const DT_EXPANDTABS = &amp;H40
    Public Const DT_CHARSTREAM = 4
    Public Const DT_NOPREFIX = &amp;H800
Type DRAWTEXTPARAMS
    cbSize As Long
    iTabLength As Long
    iLeftMargin As Long
    iRightMargin As Long
    uiLengthDrawn As Long
End Type
Declare Function DrawTextEx Lib "user32" Alias "DrawTextExA" (ByVal hdc As
 Long, ByVal lpsz As String, ByVal n As Long, lpRect As RECT, ByVal un As Long,
 lpDrawTextParams As DRAWTEXTPARAMS) As Long
Declare Function DrawTextExAsNull Lib "user32" Alias "DrawTextExA" (ByVal hdc
 As Long, ByVal lpsz As String, ByVal n As Long, lpRect As RECT, ByVal un As
 Long, ByVal lpDrawTextParams As Long) As Long
    Public Const DT_EDITCONTROL = &amp;H2000&amp;
    Public Const DT_PATH_ELLIPSIS = &amp;H4000&amp;
    Public Const DT_END_ELLIPSIS = &amp;H8000&amp;
    Public Const DT_MODIFYSTRING = &amp;H10000
    Public Const DT_RTLREADING = &amp;H20000
    Public Const DT_WORD_ELLIPSIS = &amp;H40000

Type SIZEAPI
    cX As Long
    cY As Long
End Type
Public Declare Function GetTextExtentPoint32 Lib "gdi32" Alias
 "GetTextExtentPoint32A" (ByVal hdc As Long, ByVal lpsz As String, ByVal
 cbString As Long, lpSize As SIZEAPI) As Long
Public Declare Function GetStockObject Lib "gdi32" (ByVal nIndex As Long) As
 Long
    Public Const ANSI_FIXED_FONT = 11
    Public Const ANSI_VAR_FONT = 12
    Public Const SYSTEM_FONT = 13
    Public Const DEFAULT_GUI_FONT = 17 'win95 only
Declare Function FillRect Lib "user32" (ByVal hdc As Long, lpRect As RECT,
 ByVal hBrush As Long) As Long
Declare Function Rectangle Lib "gdi32" (ByVal hdc As Long, ByVal X1 As Long,
 ByVal y1 As Long, ByVal x2 As Long, ByVal y2 As Long) As Long
Declare Function DrawEdge Lib "user32" (ByVal hdc As Long, qrc As RECT, ByVal
 edge As Long, ByVal grfFlags As Long) As Long
    Public Const BF_LEFT = 1
    Public Const BF_TOP = 2
    Public Const BF_RIGHT = 4
    Public Const BF_BOTTOM = 8
    Public Const BF_RECT = BF_LEFT Or BF_TOP Or BF_RIGHT Or BF_BOTTOM
    Public Const BF_MIDDLE = 2048
    Public Const BDR_SUNKENINNER = 8
    Public Const BDR_SUNKENOUTER = 2

' Scrolling and region functions:
Declare Function ScrollDC Lib "user32" (ByVal hdc As Long, ByVal dx As Long,
 ByVal dy As Long, lprcScroll As RECT, lprcClip As RECT, ByVal hrgnUpdate As
 Long, lprcUpdate As RECT) As Long
Declare Function SetWindowRgn Lib "user32" (ByVal hwnd As Long, ByVal hRgn As
 Long, ByVal bRedraw As Long) As Long
Declare Function SelectClipRgn Lib "gdi32" (ByVal hdc As Long, ByVal hRgn As
 Long) As Long
Declare Function CreateRectRgn Lib "gdi32" (ByVal X1 As Long, ByVal y1 As Long,
 ByVal x2 As Long, ByVal y2 As Long) As Long
Declare Function CreateRectRgnIndirect Lib "gdi32" (lpRect As RECT) As Long
Declare Function CreatePolyPolygonRgn Lib "gdi32" (lpPoint As POINTAPI,
 lpPolyCounts As Long, ByVal nCount As Long, ByVal nPolyFillMode As Long) As
 Long
Declare Function CreatePolygonRgn Lib "gdi32" (lpPoint As POINTAPI, ByVal
 nCount As Long, ByVal nPolyFillMode As Long)
Declare Function SaveDC Lib "gdi32" (ByVal hdc As Long) As Long
Declare Function RestoreDC Lib "gdi32" (ByVal hdc As Long, ByVal hSavedDC As
 Long) As Long

Public Const FW_NORMAL = 400
Public Const FW_BOLD = 700
Public Const FF_DONTCARE = 0
Public Const DEFAULT_QUALITY = 0
Public Const DEFAULT_PITCH = 0
Public Const DEFAULT_CHARSET = 1
Declare Function CreateFontIndirect&amp; Lib "gdi32" Alias "CreateFontIndirectA"
 (lpLogFont As LOGFONT)
Declare Function MulDiv Lib "kernel32" (ByVal nNumber As Long, ByVal nNumerator
 As Long, ByVal nDenominator As Long) As Long
Declare Function DrawFocusRect Lib "user32" (ByVal hdc As Long, lpRect As RECT)
 As Long

Declare Function OleTranslateColor Lib "olepro32.dll" (ByVal OLE_COLOR As Long,
 ByVal HPALETTE As Long, pccolorref As Long) As Long
Public Const CLR_INVALID = -1

' General windows messages:
Public Const WM_CREATE = &amp;H1
Public Const WM_DESTROY = &amp;H2
Public Const WM_COMMAND = &amp;H111
Public Const WM_KEYDOWN = &amp;H100
Public Const WM_KEYUP = &amp;H101
Public Const WM_CHAR = &amp;H102
Public Const WM_SETFOCUS = &amp;H7
Public Const WM_KILLFOCUS = &amp;H8
Public Const WM_SETFONT = &amp;H30
Public Const WM_GETTEXT = &amp;HD
Public Const WM_GETTEXTLENGTH = &amp;HE
Public Const WM_SETTEXT = &amp;HC
Public Const WM_LBUTTONUP = &amp;H202
Public Const WM_LBUTTONDOWN = &amp;H201
Public Const WM_MBUTTONDOWN = &amp;H207
Public Const WM_MBUTTONUP = &amp;H208
Public Const WM_MOUSEMOVE = &amp;H200
Public Const WM_RBUTTONDOWN = &amp;H204
Public Const WM_RBUTTONUP = &amp;H205
Public Const WM_RBUTTONDBLCLK = &amp;H206
Public Const WM_LBUTTONDBLCLK = &amp;H203
Public Const WM_MBUTTONDBLCLK = &amp;H209
Public Const WM_MOUSEACTIVATE = &amp;H21
Public Const WM_SIZE = &amp;H5
Public Const WM_GETFONT = &amp;H31
Public Const WM_PARENTNOTIFY = &amp;H210

   ' mouse activate responses
   Public Const MA_ACTIVATE = 1
   Public Const MA_ACTIVATEANDEAT = 2
   Public Const MA_NOACTIVATE = 3
   Public Const MA_NOACTIVATEANDEAT = 4
   ' Hit test:
   Public Const HTCLIENT = 1

' Owner drawn control messages:
Public Const WM_MEASUREITEM = &amp;H2
Public Const WM_DRAWITEM = &amp;H2B

' Combo box notification messages:
Public Const WM_CTLCOLORLISTBOX = &amp;H134
Public Const CBN_CLOSEUP = 8
Public Const CBN_DBLCLK = 2
Public Const CBN_DROPDOWN = 7
Public Const CBN_EDITCHANGE = 5
Public Const CBN_EDITUPDATE = 6
Public Const CBN_ERRSPACE = (-1)
Public Const CBN_KILLFOCUS = 4
Public Const CBN_SELCHANGE = 1
Public Const CBN_SELENDCANCEL = 10
Public Const CBN_SELENDOK = 9
Public Const CBN_SETFOCUS = 3

' List box notification messages:
Public Const LBN_DBLCLK = 2
Public Const LBN_ERRSPACE = (-2)
Public Const LBN_KILLFOCUS = 5
Public Const LBN_SELCANCEL = 3
Public Const LBN_SELCHANGE = 1
Public Const LBN_SETFOCUS = 4

' Useful constants
' Virtual key code constants:
Public Const VK_SHIFT = &amp;H10&amp;
Public Const VK_CONTROL = &amp;H11&amp;
Public Const VK_MENU = &amp;H12&amp; ' Alt key

' Combo box messages:
Public Const CB_ADDSTRING = &amp;H143
Public Const CB_DELETESTRING = &amp;H144
Public Const CB_DIR = &amp;H145
Public Const CB_ERR = (-1)
Public Const CB_ERRSPACE = (-2)
Public Const CB_FINDSTRING = &amp;H14C
Public Const CB_FINDSTRINGEXACT = &amp;H158
Public Const CB_GETCOUNT = &amp;H146
Public Const CB_GETCURSEL = &amp;H147
Public Const CB_GETDROPPEDCONTROLRECT = &amp;H152
Public Const CB_GETDROPPEDSTATE = &amp;H157
Public Const CB_GETEDITSEL = &amp;H140
Public Const CB_GETEXTENDEDUI = &amp;H156
Public Const CB_GETITEMDATA = &amp;H150
Public Const CB_GETITEMHEIGHT = &amp;H154
Public Const CB_GETLBTEXT = &amp;H148
Public Const CB_GETLBTEXTLEN = &amp;H149
Public Const CB_GETLOCALE = &amp;H15A
Public Const CB_INSERTSTRING = &amp;H14A
Public Const CB_LIMITTEXT = &amp;H141
Public Const CB_MSGMAX = &amp;H15B
Public Const CB_OKAY = 0
Public Const CB_RESETCONTENT = &amp;H14B
Public Const CB_SELECTSTRING = &amp;H14D
Public Const CB_SETCURSEL = &amp;H14E
Public Const CB_SETEDITSEL = &amp;H142
Public Const CB_SETEXTENDEDUI = &amp;H155
Public Const CB_SETITEMDATA = &amp;H151
Public Const CB_SETITEMHEIGHT = &amp;H153
Public Const CB_SETLOCALE = &amp;H159
Public Const CB_SHOWDROPDOWN = &amp;H14F
Public Const CB_GETDROPPEDWIDTH = &amp;H15F
Public Const CB_SETDROPPEDWIDTH = &amp;H160

' List box messages:
Public Const LB_ADDFILE = &amp;H196
Public Const LB_ADDSTRING = &amp;H180
Public Const LB_DELETESTRING = &amp;H182
Public Const LB_CTLCODE = 0&amp;
Public Const LB_DIR = &amp;H18D
Public Const LB_ERR = (-1)
Public Const LB_ERRSPACE = (-2)
Public Const LB_FINDSTRING = &amp;H18F
Public Const LB_FINDSTRINGEXACT = &amp;H1A2
Public Const LB_GETANCHORINDEX = &amp;H19D
Public Const LB_GETCARETINDEX = &amp;H19F
Public Const LB_GETCOUNT = &amp;H18B
Public Const LB_GETCURSEL = &amp;H188
Public Const LB_GETHORIZONTALEXTENT = &amp;H193
Public Const LB_GETITEMDATA = &amp;H199
Public Const LB_GETITEMRECT = &amp;H198
Public Const LB_GETITEMHEIGHT = &amp;H1A1
Public Const LB_GETLOCALE = &amp;H1A6
Public Const LB_GETSEL = &amp;H187
Public Const LB_GETSELCOUNT = &amp;H190
Public Const LB_GETSELITEMS = &amp;H191
Public Const LB_GETTEXT = &amp;H189
Public Const LB_GETTEXTLEN = &amp;H18A
Public Const LB_GETTOPINDEX = &amp;H18E
Public Const LB_INSERTSTRING = &amp;H181
Public Const LB_MSGMAX = &amp;H1A8
Public Const LB_OKAY = 0
Public Const LB_RESETCONTENT = &amp;H184
Public Const LB_SELECTSTRING = &amp;H18C
Public Const LB_SELITEMRANGE = &amp;H19B
Public Const LB_SELITEMRANGEEX = &amp;H183
Public Const LB_SETANCHORINDEX = &amp;H19C
Public Const LB_SETCARETINDEX = &amp;H19E
Public Const LB_SETCOLUMNWIDTH = &amp;H195
Public Const LB_SETCOUNT = &amp;H1A7
Public Const LB_SETCURSEL = &amp;H186
Public Const LB_SETHORIZONTALEXTENT = &amp;H194
Public Const LB_SETITEMDATA = &amp;H19A
Public Const LB_SETITEMHEIGHT = &amp;H1A0
Public Const LB_SETLOCALE = &amp;H1A5
Public Const LB_SETSEL = &amp;H185
Public Const LB_SETTABSTOPS = &amp;H192
Public Const LB_SETTOPINDEX = &amp;H197

' Text box messages:
Public Const EM_SETREADONLY = &amp;HCF

' Owner draw style types:
Public Const ODS_CHECKED = &amp;H8
Public Const ODS_DISABLED = &amp;H4
Public Const ODS_FOCUS = &amp;H10
Public Const ODS_GRAYED = &amp;H2
Public Const ODS_SELECTED = &amp;H1
Public Const ODS_COMBOBOXEDIT = &amp;H1000

' Owner draw action types:
Public Const ODA_DRAWENTIRE = &amp;H1
Public Const ODA_FOCUS = &amp;H4
Public Const ODA_SELECT = &amp;H2


' Win32 SDK recommends the use of EnumFontFamiliesEx rather than the other
 versions:
Public Const LF_FULLFACESIZE = 64
Type ENUMLOGFONTEX
    elfLogFont As LOGFONT
    elfFullName(LF_FULLFACESIZE) As Byte
    elfStyle(LF_FACESIZE) As Byte
    elfScript(LF_FACESIZE) As Byte
End Type
Type NEWTEXTMETRIC
    tmHeight As Long
    tmAscent As Long
    tmDescent As Long
    tmInternalLeading As Long
    tmExternalLeading As Long
    tmAveCharWidth As Long
    tmMaxCharWidth As Long
    tmWeight As Long
    tmOverhang As Long
    tmDigitizedAspectX As Long
    tmDigitizedAspectY As Long
    tmFirstChar As Byte
    tmLastChar As Byte
    tmDefaultChar As Byte
    tmBreakChar As Byte
    tmItalic As Byte
    tmUnderlined As Byte
    tmStruckOut As Byte
    tmPitchAndFamily As Byte
    tmCharSet As Byte
    ' Additional to TEXTMETRIC
    ntmFlags As Long
    ntmSizeEM As Long
    ntmCellHeight As Long
    ntmAveWidth As Long
End Type
Type FONTSIGNATURE
        fsUsb(4) As Long
        fsCsb(2) As Long
End Type
Type TEXTMETRIC
    tmHeight As Long
    tmAscent As Long
    tmDescent As Long
    tmInternalLeading As Long
    tmExternalLeading As Long
    tmAveCharWidth As Long
    tmMaxCharWidth As Long
    tmWeight As Long
    tmOverhang As Long
    tmDigitizedAspectX As Long
    tmDigitizedAspectY As Long
    tmFirstChar As Byte
    tmLastChar As Byte
    tmDefaultChar As Byte
    tmBreakChar As Byte
    tmItalic As Byte
    tmUnderlined As Byte
    tmStruckOut As Byte
    tmPitchAndFamily As Byte
    tmCharSet As Byte
End Type
Type NEWTEXTMETRICEX
    ntmTm As NEWTEXTMETRIC
    ntmFontSig As FONTSIGNATURE
End Type

' Declares:)
Declare Function EnumFontFamiliesEx Lib "gdi32" Alias "EnumFontFamiliesExA"
 (ByVal hdc As Long, lpLogFont As LOGFONT, ByVal lpEnumFontProc As Long, ByVal
 lParam As Long, ByVal dw As Long) As Long
Private Const ANSI_CHARSET = 0
Private Const SYMBOL_CHARSET = 2
Private Const SHIFTJIS_CHARSET = 128
Private Const HANGEUL_CHARSET = 129
Private Const GB2312_CHARSET = 134
Private Const CHINESEBIG5_CHARSET = 136
Private Const OEM_CHARSET = 255
Private Const JOHAB_CHARSET = 130
Private Const HEBREW_CHARSET = 177
Private Const ARABIC_CHARSET = 178
Private Const GREEK_CHARSET = 161
Private Const TURKISH_CHARSET = 162
Private Const THAI_CHARSET = 222
Private Const EASTEUROPE_CHARSET = 238
Private Const RUSSIAN_CHARSET = 204

Private Const MAC_CHARSET = 77
Private Const BALTIC_CHARSET = 186


Private m_lID As Long

'/* EnumFonts Masks */
Public Const RASTER_FONTTYPE = 1&amp;
Public Const DEVICE_FONTTYPE = 2&amp;
Public Const TRUETYPE_FONTTYPE = 4&amp;

' Object to add items to:
Private m_ctl As OwnerDrawComboList
Private m_bPrinterFont As Boolean



Public Sub gGetHiWordLoWord( _
        ByVal lValue As Long, _
        ByRef lHiWord As Long, _
        ByRef lLoWord As Long _
    )
    lHiWord = lValue \ &amp;H10000
    lLoWord = (lValue And &amp;HFFFF&amp;)
End Sub

Public Function giGetShiftState() As Integer
Dim iR As Integer
Dim lR As Long
Dim lKey As Long
    iR = iR Or (-1 * gbKeyIsPressed(VK_SHIFT))
    iR = iR Or (-2 * gbKeyIsPressed(VK_MENU))
    iR = iR Or (-4 * gbKeyIsPressed(VK_CONTROL))
    giGetShiftState = iR

End Function
Public Function gbKeyIsPressed( _
        ByVal nVirtKeyCode As KeyCodeConstants _
    ) As Boolean
Dim lR As Long
    lR = GetAsyncKeyState(nVirtKeyCode)
    If (lR And &amp;H8000&amp;) = &amp;H8000&amp; Then
        gbKeyIsPressed = True
    End If
End Function

' Convert Automation color to Windows color
Public Function gTranslateColor(ByVal clr As OLE_COLOR, _
                        Optional hPal As Long = 0) As Long
    If OleTranslateColor(clr, hPal, gTranslateColor) Then
        gTranslateColor = CLR_INVALID
    End If
End Function

Public Sub gSplitDelimitedString( _
        ByVal sString As String, _
        ByVal sDelim As String, _
        ByRef sValues() As String, _
        ByRef iCount As Integer _
    )
' ==================================================================
' Splits sString into an array of parts which are
' delimited in the string by sDelim.  The array is
' indexed 1-iCount where iCount is the number of
' items.  If no items found iCount=1 and the array has
' one element, the original string.
'   sString : String to split
'   sDelim  : Delimiter
'   sValues : Return array of values
'   iCount  : Number of items returned in sValues()
' ==================================================================
Dim iPos As Integer
Dim iNextPos As Integer
Dim iDelimLen As Integer
    iCount = 0
    Erase sValues
    iDelimLen = Len(sDelim)
    iPos = 1
    iNextPos = InStr(sString, sDelim)
    Do While iNextPos &gt; 0
        iCount = iCount + 1
        ReDim Preserve sValues(1 To iCount) As String
        sValues(iCount) = Mid$(sString, iPos, (iNextPos - iPos))
        iPos = iNextPos + iDelimLen
        iNextPos = InStr(iPos, sString, sDelim)
    Loop
    iCount = iCount + 1
    ReDim Preserve sValues(1 To iCount) As String
    sValues(iCount) = Mid$(sString, iPos)
End Sub


Public Function glGetFontDialogUnits( _
        ByVal hwnd As Long _
    ) As Long

Dim hFont As Long
Dim hFontOld As Long
Dim r As Long
Dim avgWidth As Long
Dim hdc As Long
Dim tmp As String
Dim sz As SIZEAPI
   
   'get the hdc to the main window
    hdc = GetDC(hwnd)
   
   'with the current font attributes, select the font
    hFont&amp; = GetStockObject(ANSI_VAR_FONT)
    hFontOld&amp; = SelectObject(hdc, hFont&amp;)
   
   'get it's length, then calculate the average character width
    tmp$ = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"
    r&amp; = GetTextExtentPoint32(hdc, tmp$, 52, sz)
    avgWidth&amp; = (sz.cX \ 52)
   
   're-select the previous font &amp; delete the hDc
    r&amp; = SelectObject(hdc, hFontOld&amp;)
    r&amp; = DeleteObject(hFont&amp;)
    r&amp; = ReleaseDC(hwnd, hdc)
   
   'return the average character width
    glGetFontDialogUnits&amp; = avgWidth&amp;

End Function

Public Function IsIn(ByVal vThis As Variant, ParamArray vItems() As Variant) As
 Boolean
Dim i As Long
    For i = LBound(vItems) To UBound(vItems)
        If (vThis = vItems(i)) Then
            IsIn = True
            Exit For
        End If
    Next i
End Function

Public Function glCStr(ByVal sThis As String, Optional ByVal lDefault As Long =
 0) As Long
On Error Resume Next
    glCStr = CLng(sThis)
    If (Err.Number &lt;&gt; 0) Then
        glCStr = lDefault
    End If
End Function
Public Function GetFonts( _
        ByVal lHDC As Long, _
        ctl As OwnerDrawComboList, _
        ByVal bPrinter As Boolean, _
        Optional ByVal sFaceName As String = "" _
    ) As Long
Dim tLF As LOGFONT
Dim i As Integer
Dim lCharSet As Long

    ' No re-entrancy, please:
    If Not (m_ctl Is Nothing) Then Exit Function
    ' Get the fonts:
    m_bPrinterFont = bPrinter
    Set m_ctl = ctl
    m_lID = m_lID + 1
    If Len(sFaceName) &gt; 0 Then
        For i = 1 To Len(sFaceName)
            tLF.lfFaceName(i - 1) = Asc(Mid$(sFaceName, i, 1))
        Next i
    End If
   If lCharSet &lt;= 0 Then lCharSet = ANSI_CHARSET
   tLF.lfCharSet = lCharSet
    
    GetFonts = EnumFontFamiliesEx(lHDC, tLF, AddressOf EnumFontFamExProc,
     m_lID, 0)
    Set m_ctl = Nothing
    
End Function

Public Function EnumFontFamExProc(ByVal lpelfe As Long, ByVal lpntme As Long,
 ByVal iFontType As Long, ByVal lParam As Long) As Long
' The callback function for EnumFontFamiliesEx.

' lpelf points to an ENUMLOGFONTEX structure, lpntm points to either
' a NEWTEXTMETRICEX (if true type) or a TEXTMETRIC (non-true type)
' structure.
Dim tLFEx As ENUMLOGFONTEX
Dim sFace As String
Dim lPos As Long
Dim sItem As String
Dim lIconIndex As Long
    
    CopyMemory tLFEx, ByVal lpelfe, LenB(tLFEx) ' Get the ENUMLOGFONTEX info
    sFace = StrConv(tLFEx.elfLogFont.lfFaceName, vbUnicode)
    lPos = InStr(sFace, Chr$(0))
    If (lPos &gt; 0) Then sFace = left$(sFace, (lPos - 1))
    ' Only display printer and true type fonts:
    If Not (m_bPrinterFont) Then
        'If (iFontType And TRUETYPE_FONTTYPE) &lt;&gt; TRUETYPE_FONTTYPE Then
        '    EnumFontFamExProc = 1
        '    Exit Function
        'End If
    End If
    ' Only display a given font once:
    If (m_ctl.FindItemIndex(sFace, True) &lt; 0) Then
        If (m_bPrinterFont) Then
            lIconIndex = 1
        Else
            lIconIndex = 0
        End If
        m_ctl.AddItemAndData sFace, lIconIndex, 2
    End If
    EnumFontFamExProc = 1
    
End Function


</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\libraries\compression\index.html" ><IMG SRC="..\..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Combo and List Boxes</a>&#160;.&#160;<a href="article.html">Owner Draw Combo and List Boxes Version 2.1</a>&#160;.&#160;<a href="vb6_owner_draw_combo_list_full_source.html">VB6 Owner Draw Combo List Full Source</a>&#160;.&#160;Declares.bas</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 11 May 2003</p></td><td></td></tr></table>
</body></html>
<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: cToolBoxBar.cls</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: cToolBoxBar.cls" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ListBar</a>&#160;.&#160;<a href="article.html">vbAccelerator Visual Studio Style ToolBox ListBar</a>&#160;.&#160;<a href="vb5_toolbox_listbar_full_source.html">VB5 ToolBox ListBar Full Source</a>&#160;.&#160;cToolBoxBar.cls</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_toolbox_listbar_control_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 ToolBox ListBar Control Binary</a> (30K)</p><p class="nav"><a href="vb5_toolbox_listbar_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 ToolBox ListBar Demonstration</a> (18K)</p><p class="nav"><a href="vb5_toolbox_listbar_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 ToolBox ListBar Full Source</a> (75K)</p><p /><p class="nav"><a href="vb6_toolbox_listbar_control_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 ToolBox ListBar Control Binary</a> (30K)</p><p class="nav"><a href="vb6_toolbox_listbar_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 ToolBox ListBar Demonstration</a> (17K)</p><p class="nav"><a href="vb6_toolbox_listbar_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 ToolBox ListBar Full Source</a> (74K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:3838</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=3838&type=zip&title=vb5_20toolbox_20listbar_20full_20source_2ezip_5fctoolboxbar.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav"><a href="bugtrak.html">BugTrak</a></p><p class="nav"><a href="bugtrak.html#bugs"><img src="..\..\..\..\..\res\btbug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 3 / 3</p><p class="nav"><a href="bugtrak.html#issues"><img src="..\..\..\..\..\res\btissue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 0 / 0</p><p class="nav"><a href="bugtrak.html#questions"><img src="..\..\..\..\..\res\btquestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:27 October 2003</p>
<br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />12 Feb 2003<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\clipboard\clipboard_ring_sample\article.html">Clipboard Ring Sample</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\tab_controls\visual_studio_style_tab_control\article.html">vbAccelerator Visual Studio Style Tab Control</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: cToolBoxBar.cls</h1><pre>VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "cToolBoxBar"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = True
Option Explicit

'
 ===============================================================================
=======
' Name:     cToolBoxBar.cls
' Author:   Steve McMahon (steve@vbaccelerator.com)
' Date:     9 February 2003
'
' Requires: -
'
' Copyright  2003 Steve McMahon for vbAccelerator
'
 -------------------------------------------------------------------------------
-------
' Visit vbAccelerator - advanced free source code for VB programmers
'    http://vbaccelerator.com
'
 -------------------------------------------------------------------------------
-------
'
' Public access to tab properties for the vbalDTab6 control.
'
' FREE SOURCE CODE - ENJOY!
' Do not sell this code.  Credit vbAccelerator.
'
 ===============================================================================
=======

Private Declare Function IsWindow Lib "user32" (ByVal hWnd As Long) As Long
Private Declare Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" (pDest As
 Any, pSrc As Any, ByVal ByteLen As Long)

Private m_lOwner As Long
Private m_hWnd As Long
Private m_lId As Long

Friend Sub fInit(ByVal lPtr As Long, ByVal lhWnd As Long, ByVal lId As Long)
   m_lOwner = lPtr
   m_hWnd = lhWnd
   m_lId = lId
End Sub

Public Property Get OwnerControl() As vbalToolBoxBarCtl
Attribute OwnerControl.VB_Description = "Gets the owning control of this bar."
   If Not (m_hWnd = 0) Then
      If (IsWindow(m_hWnd)) Then
         If Not (m_lOwner = 0) Then
            Dim oT As Object
            CopyMemory oT, m_lOwner, 4
            Set OwnerControl = oT
            CopyMemory oT, 0&amp;, 4
            Exit Property
         End If
      End If
   End If
   Err.Raise 9, App.EXEName &amp; ".vbalToolBoxBarCtl"
End Property

Public Property Get SelectedItem() As cToolItem
Attribute SelectedItem.VB_Description = "Gets the selected item (if any) within
 this bar."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      Set SelectedItem = oT.fSelectedItem(m_lId)
   End If
End Property

Public Property Get NextBar( _
      Optional ByVal bVisibleOnly As Boolean = True _
   ) As cToolBoxBar
Attribute NextBar.VB_Description = "Gets the next bar along in the control."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      Set NextBar = oT.fNextBar(m_lId, 1, bVisibleOnly)
   End If
End Property
Public Property Get PreviousBar( _
      Optional ByVal bVisibleOnly As Boolean = True _
   ) As cToolBoxBar
Attribute PreviousBar.VB_Description = "Gets the previous bar along in the
 control."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      Set PreviousBar = oT.fNextBar(m_lId, -1, bVisibleOnly)
   End If
End Property

Public Sub MovePrevious()
Attribute MovePrevious.VB_Description = "Moves this bar to the previous
 position along in the control."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      oT.fBarMove m_lId, -1
   End If
End Sub

Public Sub MoveNext()
Attribute MoveNext.VB_Description = "Moves this bar to the next position along
 in the control."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      oT.fBarMove m_lId, 1
   End If
End Sub

Public Property Get Caption() As String
Attribute Caption.VB_Description = "Gets/sets the caption of the bar."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      Caption = oT.fBarCaption(m_lId)
   End If
End Property
Public Property Let Caption(ByVal sCaption As String)
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      oT.fBarCaption(m_lId) = sCaption
   End If
End Property

Public Property Get Tag() As String
Attribute Tag.VB_Description = "Gets/sets a string value associated with the
 bar."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      Tag = oT.fBarTag(m_lId)
   End If
End Property
Public Property Let Tag(ByVal sTag As String)
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      oT.fBarTag(m_lId) = sTag
   End If
End Property

Public Property Get ItemData() As Long
Attribute ItemData.VB_Description = "Gets/sets a long value associated with
 this bar."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      ItemData = oT.fBarItemData(m_lId)
   End If
End Property
Public Property Let ItemData(ByVal lItemData As Long)
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      oT.fBarItemData(m_lId) = lItemData
   End If
End Property

Public Property Get Key() As String
Attribute Key.VB_Description = "Gets the key of this bar."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      Key = oT.fBarKey(m_lId)
   End If
End Property

Public Property Get Index() As Long
Attribute Index.VB_Description = "Gets the index of the bar in the control."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      Index = oT.fBarIndex(m_lId)
   End If
End Property

Public Property Get Selected() As Boolean
Attribute Selected.VB_Description = "Gets/sets whether this bar is selected."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      Selected = oT.fBarSelected(m_lId)
   End If
End Property
Public Property Let Selected(ByVal bSelected As Boolean)
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      oT.fBarSelected(m_lId) = bSelected
   End If
End Property

Public Property Get Sorted() As Boolean
Attribute Sorted.VB_Description = "Gets/sets whether items are sorted
 alphabetically in the control."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      Sorted = oT.fBarSorted(m_lId)
   End If
End Property
Public Property Let Sorted(ByVal bSorted As Boolean)
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      oT.fBarSorted(m_lId) = bSorted
   End If
End Property

Public Property Get Visible() As Boolean
Attribute Visible.VB_Description = "Gets/sets whether this bar is visible or
 not."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      Visible = oT.fBarVisible(m_lId)
   End If
End Property
Public Property Let Visible(ByVal bVisible As Boolean)
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      oT.fBarVisible(m_lId) = bVisible
   End If
End Property

Public Property Get ListStyle() As Boolean
Attribute ListStyle.VB_Description = "Gets/sets whether items are displayed in
 a list style with captions.  Defaults to True."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      ListStyle = oT.fBarListStyle(m_lId)
   End If
End Property
Public Property Let ListStyle(ByVal bListStyle As Boolean)
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      oT.fBarListStyle(m_lId) = bListStyle
   End If
End Property


Public Property Get Items() As cToolItemCollection
Attribute Items.VB_Description = "Gets the collection of items associated with
 this bar."
Dim oT As vbalToolBoxBarCtl
   Set oT = OwnerControl()
   If Not oT Is Nothing Then
      Set Items = oT.fBarItems(m_lId)
   End If
End Property

Private Sub Class_Initialize()
   'Debug.Print "cToolBoxBar:Initialize", ObjPtr(Me)
End Sub

Private Sub Class_Terminate()
   'Debug.Print "cToolBoxBar:Terminate", ObjPtr(Me)
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\vbmedia\using_gdi_plus\index.html" ><IMG SRC="..\..\..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ListBar</a>&#160;.&#160;<a href="article.html">vbAccelerator Visual Studio Style ToolBox ListBar</a>&#160;.&#160;<a href="vb5_toolbox_listbar_full_source.html">VB5 ToolBox ListBar Full Source</a>&#160;.&#160;cToolBoxBar.cls</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
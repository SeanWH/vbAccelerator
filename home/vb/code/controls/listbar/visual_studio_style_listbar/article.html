<html lang="en" >
<head>

<title>vbAccelerator - vbAccelerator Visual Studio Style ToolBox ListBar</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="This control provides a full implementation of a Visual Studio-style List Bar
which holds lists of controls.  Bars and items can be dragged around the control, 
and items can be dragged, pressed or double-clicked to add the item to an object.
" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ListBar</a>&#160;.&#160;vbAccelerator Visual Studio Style ToolBox ListBar</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_toolbox_listbar_control_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 ToolBox ListBar Control Binary</a> (30K)</p><p class="nav"><a href="vb5_toolbox_listbar_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 ToolBox ListBar Demonstration</a> (18K)</p><p class="nav"><a href="vb5_toolbox_listbar_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 ToolBox ListBar Full Source</a> (75K)</p><p /><p class="nav"><a href="vb6_toolbox_listbar_control_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 ToolBox ListBar Control Binary</a> (30K)</p><p class="nav"><a href="vb6_toolbox_listbar_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 ToolBox ListBar Demonstration</a> (17K)</p><p class="nav"><a href="vb6_toolbox_listbar_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 ToolBox ListBar Full Source</a> (74K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:3771</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=3771&type=article&title=vbaccelerator_20visual_20studio_20style_20toolbox_20listbar.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav"><a href="bugtrak.html">BugTrak</a></p><p class="nav"><a href="bugtrak.html#bugs"><img src="..\..\..\..\..\res\btbug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 3 / 3</p><p class="nav"><a href="bugtrak.html#issues"><img src="..\..\..\..\..\res\btissue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 0 / 0</p><p class="nav"><a href="bugtrak.html#questions"><img src="..\..\..\..\..\res\btquestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:27 October 2003</p>
<br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />12 Feb 2003<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\clipboard\clipboard_ring_sample\article.html">Clipboard Ring Sample</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\tab_controls\visual_studio_style_tab_control\article.html">vbAccelerator Visual Studio Style Tab Control</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator Visual Studio Style ToolBox ListBar</h1><p class="splash">Create tabbed bars of tools for your application</p><img src="vslistbar.png" width="426" height="256" alt="Tool Box List Bar Demonstration Project" /><p /><p>This control provides a full implementation of a Visual Studio-style List Bar
which holds lists of controls.  Bars and items can be dragged around the control, 
and items can be dragged, pressed or double-clicked to add the item to an object.
</p><h2>Quick Start</h2><p>The ToolBox List Bar control has the following object hierarchy:</p><img src="vslistbarobjectmodel.png" width="270" height="250" alt="ToolBox ListBar Control Object Model" /><br /><p><small><strong>ToolBox ListBar Control Object Model</strong></small></p><p>There are three main areas in using the control:</p><ol><li>Configuring the Control</li><li>Adding and Removing Bars and Items</li><li>Responding to Events</li></ol><p>These will be covered in turn.</p><h3>Configuring the Control</h3><p>The control supports most of the basic properties of a VB control, including as <i>BackColor</i>, <i>ForeColor</i>,
<i>Font</i>, <i>BorderStyle</i>, <i>Align</i> and <i>ScaleMode</i>. These can be set at design time or runtime.</p><p>Icons for the items are sourced from an ImageList.  To add an ImageList to the control, set the <i>ImageList</i>
property at run-time.  If you're using a ComCtl32.DLL ImageList, then set this property to the <i>hImageList</i>
handle, otherwise set it to the ImageList control instance.</p><h3>Adding and Removing Bars and Items</h3><p>To build a bar, you need to start with the correct bottles.  So, a bottle of Bombay Sapphire or Tanqueray 10, 
some Grey Goose vodka, Absolut Citron, Makers Mark Bourbon, Myers's Dark Rum, Noilly Prat, Cointreau, Creme de Mure... 
Oops, I appear to have got off
on the wrong subject.  Actually adding, removing and accessing bars is done through the <i>Bars</i> collection 
provided by the control 
using the standard collection methods: <i>Add</i>, <i>Remove</i>, <i>Item</i> and <i>Count</i>.  The only 
things to note are that you must provide a unique <i>Key</i> for the bar and that 
For..Each enumeration is not supported at this time.</p><p>The <i>Add</i> and <i>Item</i> properties return a <i>cToolBoxBar</i> object which can be used to set
the properties of the bar and move it around.  Bar properties and methods are as follows:</p><ul><li><strong>OwnerControl</strong><br />
Returns the owning control of this bar.</li><li><strong>Caption</strong><br />
Gets/sets the caption of this bar</li><li><strong>Sorted</strong><br />
Gets/sets whether items are sorted alphabetically within the bar.</li><li><strong>Visible</strong><br />
Gets/sets whether this bar is visible in the control or not.</li><li><strong>Tag</strong><br />
Gets/sets a string value associated with the bar.</li><li><strong>ItemData</strong><br />
Gets/sets a long value associated with the bar.</li><li><strong>Index</strong><br />
Returns the index of the bar within the control.</li><li><strong>Key</strong><br />
Returns the key for this bar.</li><li><strong>NextBar</strong><br />
Gets a reference to the next bar along in the control.  By default, this returns the next visible bar,
however if you set the optional <i>bVisibleOnly</i> parameter to False you can find the next bar along
regardless of visibility.</li><li><strong>PreviousBar</strong><br />
Same as <i>NextBar</i> but for the previous bar in the control.</li><li><strong>MoveNext</strong><br />
Moves this bar to the next position along in the control.</li><li><strong>MovePrevious</strong><br />
Same as <i>MoveNext</i> but for the previous position.</li><li><strong>Items</strong><br />
Returns the <i>cToolItemCollection</i> of items within this bar, allowing you to add, insert, remove and find
items within the bar.</li><li><strong>SelectedItem</strong><br />
Returns the <i>cToolItem</i> which is selected within the bar.</li></ul><p>Adding and removing items from bars is accomplished using the <i>cToolItemCollection</i> returned by
the <i>Items</i> property of the bar.  This works in the same way as the <i>cToolBoxBarCollection</i> (and
again Keys are mandatory and the For..Each enumeration is not supported at this time).  Note that item
keys must be unique across all bars, since you can shift an item between bars using drag and drop.</p><p>The <i>Add</i> and <i>Item</i> properties return a <i>cToolItem</i> object which can be used to set
the properties of the item and move it around.  Bar properties and methods are as follows:</p><ul><li><strong>OwnerControl</strong><br />
Returns the owning control of this item.</li><li><strong>OwnerBar</strong><br />
Returns the owning bar of this item.</li><li><strong>Caption</strong><br />
Gets/sets the caption of this item.</li><li><strong>IconIndex</strong><br />
Gets/sets the zero-based index of the icon within the ImageList associated with the control for this item.</li><li><strong>Enabled</strong><br />
Gets/sets whether this item is enabled or not.</li><li><strong>Selected</strong><br />
Gets/sets whether this item is selected or not.</li><li><strong>CanDrag</strong><br />
Gets/sets whether this item can be dragged or not.</li><li><strong>Tag</strong><br />
Gets/sets a string value associated with the item.</li><li><strong>ItemData</strong><br />
Gets/sets a long value associated with the item.</li><li><strong>Index</strong><br />
Returns the index of the item within its bar.</li><li><strong>Key</strong><br />
Returns the key for this item.</li><li><strong>NextItem</strong><br />
Gets a reference to the next item along in the bar.</li><li><strong>PreviousItem</strong><br />
Same as <i>NextItem</i> but for the previous item in the bar.</li><li><strong>MoveNext</strong><br />
Moves this item to the next position along in the bar.</li><li><strong>MovePrevious</strong><br />
Same as <i>MoveNext</i> but for the previous position.</li><li><strong>EnsureVisible</strong><br />
Scrolls the bar containing this item if it is not visible in the control.</li></ul><h3>Responding to Events</h3><p>The control raises the following events:</p><ul><li><strong>BarClick</strong><br />
Raised when a bar is clicked by the user.  Provides the bar that was clicked and the mouse button, shift state and coordinates
of the click.</li><li><strong>BarDblClick</strong><br />
Raised when a bar is double clicked by the user.</li><li><strong>BarSelected</strong><br />
Raised when a bar is selected by the user.  Note that this event does not fire if you select a bar in code using
the <i>Selected</i> property of a bar.</li><li><strong>ItemClick</strong><br />
Same as <i>BarClick</i> except for an item. Note that this event is also raised if the user clicks a non-item area within
a bar, in which case the <i>Item</i> object will be Nothing.</li><li><strong>ItemDblClick</strong><br />
Same as <i>BarDblClick</i> except for an Item.</li><li><strong>ItemSelected</strong><br />
Same as <i>BarSelected</i> except for an item.</li><li><strong>KeyDown</strong><br />
The standard <i>KeyDown</i> event for the control.  You can prevent the control from processing the key by modifying
the Key and Shift values.  By default the control processes the Up, Down, PageUp, PageDown, Home and End keys.</li><li><strong>KeyPress</strong><br />
The standard <i>KeyPress</i> event for the control.</li><li><strong>KeyUp</strong><br />
The standard <i>KeyUp</i> event for the control.</li></ul><h2>Drag and Drop</h2><p>When an item has the <i>CanDrag</i> property set true (which is the default), the user can drag the item within
the control itself or onto any control which supports drag and drop in the project.  The control sets 
customised Drag data which you can use to determine whether to allow the item to be dropped onto a particular
control.  The formats set for an item are as follows:</p><ul><li><strong>tbbCfItemIdentifier</strong><br />
The data contains an identifier to the item within the control. You can use the <i>ItemFromDragData</i> method
of the control to get a <i>cToolItem</i> object from this data, as follows:
<pre>
Private Sub ctl_OLEDragDrop( _
      Data As DataObject, _
      Effect As Long, _
      Button As Integer, _
      Shift As Integer, _
      x As Single, y As Single)

   If (Data.GetFormat(tbbCfItemIdentifier)) Then

      ' Custom formats can only be obtained as a byte array:
      Dim b() as Byte 
      b = Data.GetData(tbbCfItemIdentifier)

      ' Get the item itself:
      Dim cT As cToolItem
      Set cT = tbxLeft.ItemFromDragData(b)

      ' Now can use cT to work out whether to allow drag-drop
      ' or not.

    End If

End Sub
</pre></li><li><strong>tbbCfItemTag</strong><br />
The data contains the tag of the item within the control, as a byte array.</li><li><strong>vbCFText</strong><br />
The caption of the item as a string.</li></ul><h2>Wrap Up</h2><p>That concludes the details of using the control.  Another sample of using this control is 
available demonstrating how to add the control to a pinnable
<a href="..\..\tab_controls\visual_studio_style_tab_control\article.html">Visual Studio Style Tabs control</a>
to create a full <a href="..\..\..\libraries\clipboard\clipboard_ring_sample\article.html">Visual Studio style Clipboard Ring</a>.
</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\..\index.html" ><IMG SRC="..\..\..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ListBar</a>&#160;.&#160;vbAccelerator Visual Studio Style ToolBox ListBar</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 28 April 2003</p></td><td></td></tr></table>
</body></html>

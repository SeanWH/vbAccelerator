<html lang="en" >
<head>

<title>vbAccelerator - Button ListBar Control</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="
The Button ListBar control provides an emulation of the ListBar provided in the Windows
Add/Remove Programs window.  Under XP it uses the UxTheme API to draw parts of the toolbar,
and degrades to use standard GDI drawing calls when used on earlier OS versions.
" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ListBar</a>&#160;.&#160;Button ListBar Control</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_button_listbar_control.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Button ListBar Control</a> (27K)</p><p class="nav"><a href="vb5_button_listbar_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Button ListBar Demonstration</a> (68K)</p><p class="nav"><a href="vb5_button_listbar_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Button ListBar Full Source</a> (123K)</p><p /><p class="nav"><a href="vb6_button_listbar_control.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Button ListBar Control</a> (27K)</p><p class="nav"><a href="vb6_button_listbar_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Button ListBar Demonstration</a> (66K)</p><p class="nav"><a href="vb6_button_listbar_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Button ListBar Full Source</a> (121K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:5292</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=5292&type=article&title=button_20listbar_20control.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />5 Jul 2003<br /><p class="update">Fixed bug with icons not drawing when using VB6 MSCOMCTL.OCX
ImageList</p><p class="update">Added Mouse Wheel support. Thanks to Chris Eastwood
at <a href="javascript:window.alert(&quot;http://vbcodelibrary.co.uk/\nThis link was not retrieved.&quot;)">vbCode Library</a> for the
suggestion.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\imagelist\displaying_alpha_(32bit)_icons_with_imagelists\article[1].html">Displaying Alpha (32bit) Icons with ImageLists</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\graphics_and_gdi\flicker_free_api_drawing\article.html">Flicker Free API Drawing</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\xp_visual_styles\drawing_with_xp_visual_styles\article.html">Drawing with XP Visual Styles</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\type_libraries\vbaccelerator_com_support_type_library\article.html">vbAccelerator COM/VB Support Type Library (vbaCOM.Tlb)</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\utilities\vbpzip\article.html">Visual Basic Project Zip Utility</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\imagelist\vbaccelerator_image_list_control\article.html">vbAccelerator ImageList Control and Class v2.0</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\adding_scroll_bars_to_forms__pictureboxes_and_usercontrols\article.html">Adding Scroll Bars to Forms, PictureBoxes and User Controls</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>Button ListBar Control</h1><img src="buttonlistbar.png" width="365" height="295" alt="Button ListBar in XP" /><p /><p>
The Button ListBar control provides an emulation of the ListBar provided in the Windows
Add/Remove Programs window.  Under XP it uses the UxTheme API to draw parts of the toolbar,
and degrades to use standard GDI drawing calls when used on earlier OS versions.
</p><h2>About The Control</h2><p>
As a consequence of rebuilding a PC from scratch, I had occasion to visit Windows Add/Remove
Programs Dialog and thought it might be a good idea to build a reusable control to provide
the same functionality.  A basic implementation of the same concept is provided in the
<a href="..\..\..\..\utilities\vbpzip\article.html">VBPZip Utility</a> but that doesn't support scrolling and
as it draws directly into a PictureBox on the form its more difficult to set up.
    </p><img src="addremove.png" width="281" height="184" alt="Windows XP Add/Remove Programs Dialog" /><p><small><strong>Windows XP Add/Remove Programs Dialog</strong></small></p><p>
The ListBar allows you to add as many buttons as you wish to a single bar.  The buttons
display images sourced from an ImageList, tooltips and resize to fit as many lines of text 
as you supply for the caption.  Buttons can also be disabled if required.  The control
supports both keyboard and mouse navigation, either of which can be overridden by modifying
the parameters of the standard Key and Mouse events.
    </p><h2>Using the Control</h2><p>
To use the control, make a reference to the vbAccelerator Button ListBar Control from
the Project - Components dialog box and then put an instance on your form.  The control
is Alignable so normally you would set the <i>Align</i> property to either Left or Right.
</p><h3>Setting Up Icons for the Buttons</h3><p>
You can then associate an ImageList with the control to act as a source of buttons.
This can be any VB ImageList, or a vbAccelerator one.  If you use a VB ImageList control,
pass in the ImageList object instance to the <i>ImageList</i> property, otherwise pass
in the long <i>hImageList</i> or <i>hIml</i> property.  The demonstration project uses
a <a href="..\..\imagelist\vbaccelerator_image_list_control\article.html">vbAccelerator ImageList class</a> as an icon source.
</p><h3>Adding and Removing Buttons</h3><p>
Adding buttons is performed using the <i>Add</i> method.  You can specify the Key, Caption,
0-based icon index, tooltip, whether the button should be enabled and any data you want
to associate with the button at the time you're adding the button, or you can modify 
these properties later using the relevant <i>Item...</i> properties.  To insert a button,
specify the <i>KeyBefore</i> parameter to the <i>Add</i> method, otherwise the button is
added to the end of the control.  
</p><p>
Individual buttons can be removed using the <i>Remove</i> method and all buttons in the bar
can be removed using the <i>Clear</i> method.
</p><h3>Setting The Size of the Control</h3><p>
Once the control is in place and has buttons, you can configure the width of the buttons
using the <i>ButtonWidth</i> property.  This is used to set the width rather than the 
normal <i>Width</i> property because the actual width of the control changes depending
on whether a vertical scroll bar needs to be displayed or not, in the same way as the
Windows version.  You can then resize other controls on the form to take account of the
actual size by making sure the
client area of the form is resized in response to the control's <i>Resize</i> event.
</p><h3>Responding to Selections and Clicks</h3><p>
When a button is clicked or selected using the keyboard, the <i>ItemClick</i> event
is raised.  This event doesn't fire when a button is selected in code, however, so
you may wish to respond to the <i>SelectionChanged</i> event instead if you want
the same behaviour to occur regardless of how a button is selected.
</p><h3>Other Properties and Methods</h3><p>
To select a button in code, use the <i>ItemSelected</i> property.  This will
select the button and automatically scroll it into view; it is also possible
to force an item into view using the <i>EnsureItemVisible</i> method.
</p><p>
You can configure the background colour of the control using the standard
<i>BackColor</i> property.  If you set this to -1 (the default) then the control
will pick the default <i>BackColor</i> for the OS that it is running on.
Likewise the font for the button text can be chosen using the <i>Font</i> property.
</p><p>
The <i>ItemRightClick</i> and <i>BarRightClick</i> events allow you to display a 
context menu when the user right clicks on a button or on the ListBar itself.
</p><h2>Implementation Notes</h2><p>
The control uses a the <a href="..\..\s_grid\article.html">Subclassing and Timer assistant</a>
to add the vertical <a href="..\..\..\libraries\subclassing\adding_scroll_bars_to_forms__pictureboxes_and_usercontrols\article.html">scroll bar</a> to the control,
and the <a href="..\..\..\libraries\graphics_and_gdi\flicker_free_api_drawing\article.html">Flicker-Free GDI Drawing</a> code to render the
control itself smoothly.  The buttons themselves are drawn using either the current 
<a href="..\..\..\libraries\xp_visual_styles\drawing_with_xp_visual_styles\article.html">XP Visual Style</a> or using GDI calls if the control 
is running on a pre-XP system or no style is in effect.  This image demonstrates how
the control draws when there is no XP Visual Style:
</p><img src="nonxprendering.png" width="224" height="153" alt="Button ListBar Control without XP Visual Styles" /><p><small><strong>Button ListBar Control without XP Visual Styles</strong></small></p><h2>When To Use</h2><p>This control makes an intuitive replacement for a tab control when there are a relatively 
small number of tab panels to choose from (although you could have hundreds of items, the scroll
bar gets quite long).  It can also be used as a shortcut selector in the same way that Windows
uses one in the File Open and Save Common Dialogs.
</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="javascript:window.alert(&quot;http://vbaccelerator.com/home/include/adredir.asp?url=http://oneandone.co.uk/xml/init?k_id=5791003&image=http://oneandone.co.uk/xml/banner?size=1&number=2\nThis link was not retrieved.&quot;)" ><IMG SRC="..\..\..\..\..\..\..\oneandone_co_uk\xml\banner\size=1&number=2.html" ALT="1&1 Web Hosting" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ListBar</a>&#160;.&#160;Button ListBar Control</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 5 July 2003</p></td><td></td></tr></table>
</body></html>

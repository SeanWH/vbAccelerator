<html lang="en" >
<head>

<title>vbAccelerator - PopupMenu DLL - Create Unlimited Popup Menus</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="The PopupMenu (cNewMenu.dll) ActiveX DLL is allows 
you to create completely new popup menus with icons for your application. Menus created using this control
either can be used as normal Windows Context menus or can be attached to a vbAccelerator 
CoolMenu and ToolBar control to be used as a form menu within a toolbar.  PopupMenu supports all of the latest
Menu UI features: showing and hiding infrequently used items, Office XP menu drawing styles, menus
which stay open when you click them and much more.
    " /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Menus</a>&#160;.&#160;PopupMenu DLL - Create Unlimited Popup Menus</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="popmenu_dll_documentation.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />PopMenu DLL Documentation</a> (3K)</p><p /><p class="nav"><a href="vb5_popupmenu_dll_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 PopupMenu DLL Binary</a> (51K)</p><p class="nav"><a href="vb5_popupmenu_dll_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 PopupMenu DLL Demonstration</a> (78K)</p><p class="nav"><a href="vb5_popupmenu_dll_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 PopupMenu DLL Full Source</a> (184K)</p><p /><p class="nav"><a href="vb6_popupmenu_dll_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 PopupMenu DLL Binary</a> (52K)</p><p class="nav"><a href="vb6_popupmenu_dll_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 PopupMenu DLL Demonstration</a> (76K)</p><p class="nav"><a href="vb6_popupmenu_dll_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 PopupMenu DLL Full Source</a> (185K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:7</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=7&type=article&title=popupmenu_20dll_20_2d_20create_20unlimited_20popup_20menus.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav"><a href="bugtrak.html">BugTrak</a></p><p class="nav"><a href="bugtrak.html#bugs"><img src="..\..\..\..\..\res\btbug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 12 / 13</p><p class="nav"><a href="bugtrak.html#issues"><img src="..\..\..\..\..\res\btissue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 0 / 0</p><p class="nav"><a href="bugtrak.html#questions"><img src="..\..\..\..\..\res\btquestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:6 February 2004</p>
<br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />23 Apr 2003<br /><p class="update">If an menu was used as a drop-down from
a vbAccelerator Toolbar control, and it contained infrequently used items
which were hidden, once the items were exposed they did not respond when
clicked. Now all items click correctly.</p><p class="update">When showing as a chevron in a menu, if you customised
which buttons were visible they could incorrectly appear in the chevron
menu.</p><p class="update">Disabled items now draw in the correct colour when XP
style is in effect.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>PopupMenu DLL - Create Unlimited Popup Menus</h1><p class="splash">This component provides you with Popup Icon Menus and much more.</p><img src="popupmenu.png" width="346" height="256" alt="PopupMenu DLL in Action" /><p /><p>The PopupMenu (cNewMenu.dll) ActiveX DLL is allows 
you to create completely new popup menus with icons for your application. Menus created using this control
either can be used as normal Windows Context menus or can be attached to a <a href="..\..\toolbar\vbaccelerator_toolbar_and_coolmenu_control\article.html">vbAccelerator 
CoolMenu and ToolBar control</a> to be used as a form menu within a toolbar.  PopupMenu supports all of the latest
Menu UI features: showing and hiding infrequently used items, Office XP menu drawing styles, menus
which stay open when you click them and much more.
    </p><h2>Quick Start - Using the cNewMenu DLL</h2><p>Here is how to get cNewMenu working in your project quickly:</p><ul><li>Add a reference to the cNewMenu DLL to your project (it appears as 
"vbAccelerator Popup Menu DLL - Allows an unlimited number of new pop-up menus 
to be created without reference to a VB menu" in the References list.) If you don't already 
have an ImageList, add one with the icons you want.</li><li>Initialise an instance of the cPopupMenu class in a form you want the popup menus to appear. 
You can either make the instance visible to the entire form, in which case you can respond 
to cPopupMenu events such as <i>ItemHighlight</i> and <i>InitPopupMenu</i>, or you can declare 
it at the point you need it.
<ul><li>To declare the instance with event handling:
<pre>
Private WithEvents m_cPopMenu as cPopMenu

Private Sub Form_Load()

    Set m_cPopMenu = New cPopupMenu
    ' Initialise the Image List (you can change this later):
    m_cPopMenu.ImageList = ilsIcons16
    ' Initialise the hWndOwner (you must do this before showing a menu):
    m_cPopMenu.hWndOwner = Me.hWnd

End Sub 
</pre></li><li>To declare the instance when you need it:
<pre>
Private Sub txtEdit_MouseDown( _
    Button As Integer, Shift As Integer, X As Single, Y As Single)

    Dim cPopMenu As New cPopupMenu
    ' Initialise the Image List:
    cPopMenu.ImageList = ilsIcons16
    ' Initialise the hWndOwner (you must do this before showing a menu):
    cPopMenu.hWndOwner = Me.hWnd

End Sub
</pre></li></ul></li><li>Now you are in a position to create some menus. This sample shows you how to 
add a (vaguely familiar?) menu which looks like this:
<pre>
      Cu<u>t</u><u>C</u>opy
      <u>P</u>aste
    --------------------
      <u>T</u>oggle &gt;
                    Breakpoint
                  ----------------------------
                  v Break On All Errors
                    Break In Class Module
                    Break On Unhandled Errors
                  -----------------------------
                    Bookmark
    ---------------------
      <u>O</u>bject Browser
</pre><p>The code:</p><pre>
Dim lIndex As Long
Dim lIconIndex As Long

    ' Here I am assuming the Image List is called ilsIcons and
    ' the PopMenu object is cP:

    ' Add Cut/Copy/Paste:
    lIconIndex = ilsIcons.ListImages("CUT").Index - 1
    cP.AddItem "Cu&amp;t", , , , lIconIndex, , , "Cut"
    lIconIndex = ilsIcons.ListImages("COPY").Index - 1
    cP.AddItem "&amp;Copy", , , , lIconIndex, , , "Copy"
    lIconIndex = ilsIcons.ListImages("PASTE").Index - 1
    ' The Paste item is disabled here:
    cP.AddItem "&amp;Paste", , , , lIconIndex, False, , "Paste"
    cP.AddItem "-"

    ' Add Toggle and Store the Index so we can add sub items to it:
    lIndex = cP.AddItem("&amp;Toggle")

    ' Add the Sub Items:
    lIconIndex = ilsIcons.ListImages("BREAKPOINT").Index - 1
    cP.AddItem "Breakpoint", , ,lIndex , lIconIndex, , , "Breakpoint"
    cP.AddItem "-", , ,lIndex
    ' This item is checked:
    cP.AddItem "Break on All Errors", , ,lIndex , , , True, "BreakAll"
    cP.AddItem "Break in Class Module", , ,lIndex , , , , "BreakClass"
    cP.AddItem "Break on Unhandled Errors", , ,lIndex , , , , "BreakUnhandled"
    cP.AddItem "-", , ,lIndex
    lIconIndex = ilsIcons.ListImages("BOOKMARK").Index - 1
    cP.AddItem "Bookmark", , ,lIndex , , , , "Bookmark"

    cP.AddItem "-"
    lIconIndex = ilsIcons.ListImages("OBJECTBROWSER").Index - 1
    cP.AddItem "&amp;Object Browser", , , , lIconIndex, False, , "ObjBrowser"
</pre></li><li><p>Having built a menu, you can now show it. If your PopMenu instance is in scope for the entire form, 
you can store this menu for later use under a string key of your choice using <i>cP.Store "YourName"</i>. 
To get it back again, just call <i>cP.Restore "YourName"</i>.</p><p>To show the menu, you need to determine the left and right positions to show it, and you can 
optionally provide the boundaries of a rectangle in which the menu must not appear. This rectangle 
is useful if you are showing the menu as the result of clicking a button, when you don't 
want the button to be obscured by the menu:</p><pre>
    ' Show the menu and get the index the user chooses (if any):
    ' For this sample, it is assumed the menu is been shown because
    ' the button cmdNewMenu has been clicked:

    lIndex = cP.ShowPopupMenu( _
        cmdNewMenu.Left, cmdNewMenu.Top + cmdNewMenu.Height, _
        cmdNewMenu.Left, cmdNewMenu.Top, _
        cmdNewMenu.Left + cmdNewMenu.Width, cmdNewMenu.Top + cmdNewMenu.Height _
        )
    If (iIndex &gt; 0) Then
        ' Display the key of the chosen item:
        MsgBox "Selected: " &amp; cP.ItemKey(iIndex)
    End If
</pre><p>Note that the coordinates to exclude should be specified relative to the form that 
owns the instance of the cPopupMenu class (specified through the <i>hWndOwner</i> property when 
you initialise the class).</p></li></ul><p>You can do more sophisticated things by responding to the <i>ItemHighlight</i> and 
<i>MenuExit</i> events to provide status messages. You can also respond to the 
<i>InitPopupMenuMenu</i> event if you want to dynamically create sub items just as they are about 
to be shown. Check the cPopMenu control for more details on these methods.</p><h2>Text Separators</h2><p>The new text separator feature can be used by either setting the <i>Header</i> property to 
true for the menu item, or by prefixing the item's caption with a minus when it is added:</p><pre>
    cP.AddItem "-Other Sites", , , , lIconIndex
</pre><p>There are two styles for text separators, set using the HeaderStyle property:</p><ol><li><strong>ecnmHeaderCaptionBar</strong><br />
This is the default, and renders like a small caption bar:<br /><img src="captionheader.png" width="263" height="140" alt="Small Caption Style Menu Headers" /></li><li><strong>ecnmHeaderSeparator</strong><br />
In this style the separator renders in the ICQ style:<br /><img src="titleheader.png" width="264" height="139" alt="ICQ Style Menu Headers" /></li></ol><p>Although the small caption style headers look a little like the tear off bars you get in 
Office, there is no way to allow a menu to be torn off like a dialog control. vbAccelerator 
is working on an Office 97 style tear-off drop-down control, but this will have to be based 
on a VB Form or Win32 window from first principles rather than a Menu.</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\libraries\compression\index.html" ><IMG SRC="..\..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Menus</a>&#160;.&#160;PopupMenu DLL - Create Unlimited Popup Menus</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 23 April 2003</p></td><td></td></tr></table>
</body></html>

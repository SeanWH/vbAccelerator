<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: frmTest.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmTest.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Status Bar</a>&#160;.&#160;<a href="article.html">vbAccelerator Status Bar Control</a>&#160;.&#160;<a href="vb5_status_bar_control_full_source.html">VB5 Status Bar Control Full Source</a>&#160;.&#160;frmTest.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_status_bar_control_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Status Bar Control Binary</a> (17K)</p><p class="nav"><a href="vb5_status_bar_control_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Status Bar Control Full Source</a> (96K)</p><p /><p class="nav"><a href="vb6_status_bar_control_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Status Bar Control Binary</a> (17K)</p><p class="nav"><a href="vb6_status_bar_control_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Status Bar Control Full Source</a> (98K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:1708</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=1708&type=zip&title=vb5_20status_20bar_20control_20full_20source_2ezip_5ffrmtest.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav"><a href="bugtrak.html">BugTrak</a></p><p class="nav"><a href="bugtrak.html#bugs"><img src="..\..\..\..\..\res\btbug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 2 / 2</p><p class="nav"><a href="bugtrak.html#issues"><img src="..\..\..\..\..\res\btissue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 0 / 0</p><p class="nav"><a href="bugtrak.html#questions"><img src="..\..\..\..\..\res\btquestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:1 February 2003</p>
<br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />19 Dec 2002<br /><p class="update">VB6 version added.</p><p class="update">Fixed bug when inserting panels, which led to some randomisation of 
the panel text and icons.</p><p class="update">XP Style status bar now displayed from the demonstration.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\imagelist\vbaccelerator_image_list_control\article.html">vbAccelerator ImageList Control and Class v2.0</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmTest.frm</h1><pre>VERSION 5.00
Object = "{8245A918-4CF7-11D2-8E21-10B404C10000}#8.1#0"; "vbalIml.ocx"
Object = "{418F6080-7954-11D2-805B-00C04FA4EE99}#2.1#0"; "vbalSbar.ocx"
Begin VB.Form frmTest 
   Caption         =   "vbAccelerator Status Bar Control Demonstrator"
   ClientHeight    =   5985
   ClientLeft      =   3270
   ClientTop       =   2460
   ClientWidth     =   8610
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmTest.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   5985
   ScaleWidth      =   8610
   Begin VB.PictureBox picTest 
      AutoRedraw      =   -1  'True
      Height          =   675
      Left            =   5460
      Picture         =   "frmTest.frx":1272
      ScaleHeight     =   615
      ScaleWidth      =   1275
      TabIndex        =   6
      Top             =   1860
      Visible         =   0   'False
      Width           =   1335
   End
   Begin vbalSbar.vbalStatusBar sbrMain 
      Align           =   2  'Align Bottom
      Height          =   375
      Left            =   0
      TabIndex        =   1
      Top             =   5610
      Width           =   8610
      _ExtentX        =   15187
      _ExtentY        =   661
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      BackColor       =   -2147483633
      SimpleStyle     =   0
   End
   Begin vbalIml.vbalImageList ilsIcons 
      Left            =   4620
      Top             =   1080
      _ExtentX        =   953
      _ExtentY        =   953
      ColourDepth     =   24
      Size            =   9400
      Images          =   "frmTest.frx":4021
      KeyCount        =   10
      Keys            =   ""
   End
   Begin VB.ListBox lstTest 
      Height          =   2205
      IntegralHeight  =   0   'False
      Left            =   60
      TabIndex        =   0
      Top             =   2040
      Width           =   4455
   End
   Begin VB.Label lblVBAccel 
      BackStyle       =   0  'Transparent
      Caption         =   "Advanced, free source code at
       http://vbaccelerator.com"
      ForeColor       =   &amp;H0080C0FF&amp;
      Height          =   375
      Left            =   2640
      TabIndex        =   3
      Top             =   360
      Width           =   2715
   End
   Begin VB.Label lblLogoStripe 
      BackColor       =   &amp;H000040C0&amp;
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   2580
      TabIndex        =   4
      Top             =   330
      Width           =   3855
   End
   Begin VB.Image imgVBAccel 
      Height          =   660
      Left            =   60
      Picture         =   "frmTest.frx":64F9
      Top             =   120
      Width           =   2535
   End
   Begin VB.Label lblSimple 
      Alignment       =   2  'Center
      BackColor       =   &amp;H80000002&amp;
      Caption         =   "Click and hold/drag to demo simple mode"
      ForeColor       =   &amp;H80000009&amp;
      Height          =   255
      Left            =   0
      TabIndex        =   2
      Top             =   840
      Width           =   3075
   End
   Begin VB.Label lblLogoBack 
      BackColor       =   &amp;H00000000&amp;
      BorderStyle     =   1  'Fixed Single
      Caption         =   "Label1"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   795
      Left            =   0
      TabIndex        =   5
      Top             =   60
      Width           =   6555
   End
   Begin VB.Menu mnuTestTop 
      Caption         =   "&amp;Test"
      Begin VB.Menu mnuTest 
         Caption         =   "&amp;Add Panel..."
         Index           =   0
      End
      Begin VB.Menu mnuTest 
         Caption         =   "&amp;Delete Panel..."
         Index           =   1
      End
      Begin VB.Menu mnuTest 
         Caption         =   "-"
         Index           =   2
      End
      Begin VB.Menu mnuTest 
         Caption         =   "&amp;Show MDI..."
         Index           =   3
      End
      Begin VB.Menu mnuTest 
         Caption         =   "-"
         Index           =   4
      End
      Begin VB.Menu mnuTest 
         Caption         =   "E&amp;xit"
         Index           =   5
      End
   End
   Begin VB.Menu mnuViewTOp 
      Caption         =   "&amp;View"
      Begin VB.Menu mnuView 
         Caption         =   "&amp;Status Bar"
         Checked         =   -1  'True
         Index           =   0
      End
   End
End
Attribute VB_Name = "frmTest"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

' for the owner-drawn panel:
Private Type RECT
   Left As Long
   Top As Long
   Right As Long
   Bottom As Long
End Type
Private Declare Function BitBlt Lib "gdi32" (ByVal hDestDC As Long, ByVal X As
 Long, ByVal Y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal
 hSrcDC As Long, ByVal xSrc As Long, ByVal ySrc As Long, ByVal dwRop As Long)
 As Long
Private Const TRANSPARENT = 1
Private Declare Function SetBkMode Lib "gdi32" (ByVal hdc As Long, ByVal
 nBkMode As Long) As Long
Private Declare Function DrawText Lib "user32" Alias "DrawTextA" (ByVal hdc As
 Long, ByVal lpStr As String, ByVal nCount As Long, lpRect As RECT, ByVal
 wFormat As Long) As Long
Private Const DT_CALCRECT = &amp;H400
Private Const DT_CENTER = &amp;H1
Private Const DT_VCENTER = &amp;H4
Private Const DT_SINGLELINE = &amp;H20
Private Const DT_RIGHT = &amp;H2
Private Const DT_BOTTOM = &amp;H8
Private Declare Function SetTextColor Lib "gdi32" (ByVal hdc As Long, ByVal
 crColor As Long) As Long


Private Sub Form_Load()
Dim i As Long
Dim eStyle As ESTBRPanelStyle
Dim sText As String
Dim iImg As Long
Dim iMinWIdth As Long

   sbrMain.ImageList = ilsIcons
   For i = 1 To 5
      iImg = -1
      iMinWIdth = 64
      If (i = 2) Then
         eStyle = estbrIns
         sText = "Test item " &amp; i
      ElseIf (i = 3) Then
         eStyle = estbrStandard
         sText = ""
         iMinWIdth = 12
      ElseIf (i = 4) Then
         eStyle = estbrOwnerDraw
         sText = "Owner Draw"
         iMinWIdth = 72
      Else
         eStyle = estbrStandard
         sText = "Test item " &amp; i
      End If
      sbrMain.AddPanel eStyle, sText, , iImg, iMinWIdth, (i = 1), , , "Item" &amp; i
   Next i
   sbrMain.PanelIcon("Item3") = 1
   sbrMain.PanelToolTipText("Item3") = "Test Tool Tip"
End Sub

Private Sub Form_Resize()
On Error Resume Next
   lblLogoBack.Width = Me.ScaleWidth - lblLogoBack.Left * 2
   lblSimple.Move lblLogoBack.Left + Screen.TwipsPerPixelX, lblSimple.Top,
    lblLogoBack.Width - 2 * Screen.TwipsPerPixelX
   lblLogoStripe.Width = lblLogoBack.Width - lblLogoStripe.Left -
    Screen.TwipsPerPixelX * 2
   lstTest.Move lblLogoBack.Left + Screen.TwipsPerPixelX, lblSimple.Top +
    lblSimple.Height + 2 * Screen.TwipsPerPixelY, lblLogoBack.Width,
    Me.ScaleHeight - (lblSimple.Top + lblSimple.Height + 4 *
    Screen.TwipsPerPixelY + sbrMain.Height * Abs(sbrMain.Visible))
End Sub

Private Sub lblSimple_MouseDown(Button As Integer, Shift As Integer, X As
 Single, Y As Single)
   sbrMain.SimpleMode = True
   sbrMain.SimpleText = "Drag mouse to see X,Y"
End Sub

Private Sub lblSimple_MouseMove(Button As Integer, Shift As Integer, X As
 Single, Y As Single)
   If (Button = vbLeftButton) Then
      sbrMain.SimpleText = "Position (twips): " &amp; X &amp; "," &amp; Y
   End If
End Sub

Private Sub lblSimple_MouseUp(Button As Integer, Shift As Integer, X As Single,
 Y As Single)
   sbrMain.SimpleMode = False
End Sub

Private Sub mnuTest_Click(Index As Integer)
Dim sI As String
Dim iPos As Long

   Select Case Index
   Case 0
      ' Add
      sI = InputBox$("This inserts a panel with a random icon at a random
       location." &amp; vbCrLf &amp; "Panel caption?", , "New Panel")
      If (sI &lt;&gt; "") Then
         iPos = Rnd * sbrMain.PanelCount + 1
         If (sbrMain.PanelCount = 0) Or (iPos &gt;= sbrMain.PanelCount) Then
            ' Add to end
            sbrMain.AddPanel , sI, , Rnd * ilsIcons.ImageCount
         Else
            ' Insert panel
            sbrMain.AddPanel , sI, , Rnd * ilsIcons.ImageCount, , , , , , iPos
         End If
      End If
   Case 1
      ' Delete
      sbrMain.RemovePanel sbrMain.PanelCount
   Case 3
      mfrmTest.Show
   Case 5
      Unload Me
   End Select
End Sub

Private Sub mnuView_Click(Index As Integer)
Dim bs As Boolean
   bs = Not (mnuView(0).Checked)
   mnuView(0).Checked = bs
   sbrMain.Visible = bs
   Form_Resize
End Sub

Private Sub sbrMain_Click(ByVal iPanel As Long, ByVal X As Single, ByVal Y As
 Single, ByVal eButton As MouseButtonConstants)
   lstTest.AddItem "Click " &amp; iPanel
End Sub

Private Sub sbrMain_DblClick(ByVal iPanel As Long, ByVal X As Single, ByVal Y
 As Single, ByVal eButton As MouseButtonConstants)
   lstTest.AddItem "DblClick " &amp; iPanel
End Sub

Private Sub sbrMain_DrawItem(ByVal lHDC As Long, ByVal iPanel As Long, ByVal
 lLeftPixels As Long, ByVal lTopPixels As Long, ByVal lRightPixels As Long,
 ByVal lBottomPixels As Long)
Dim tR As RECT

   'lstTest.AddItem "OwnerDraw DrawItem " &amp; iPanel
   tR.Left = lLeftPixels
   tR.Right = lRightPixels - 1
   tR.Top = lTopPixels
   tR.Bottom = lBottomPixels - 1
   BitBlt lHDC, tR.Left, tR.Top, tR.Right - tR.Left, tR.Bottom - tR.Top,
    picTest.hdc, 0, 0, vbSrcCopy
   SetBkMode lHDC, TRANSPARENT
   SetTextColor lHDC, &amp;H303030
   tR.Right = tR.Left + sbrMain.PanelMinWidth(iPanel)
   tR.Bottom = tR.Bottom - 1
   DrawText lHDC, "Owner Draw", 10, tR, DT_CENTER Or DT_BOTTOM Or DT_SINGLELINE
   
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\..\index.html" ><IMG SRC="..\..\..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Status Bar</a>&#160;.&#160;<a href="article.html">vbAccelerator Status Bar Control</a>&#160;.&#160;<a href="vb5_status_bar_control_full_source.html">VB5 Status Bar Control Full Source</a>&#160;.&#160;frmTest.frm</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
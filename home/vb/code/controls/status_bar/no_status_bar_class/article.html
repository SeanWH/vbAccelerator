<html lang="en" >
<head>

<title>vbAccelerator - vbAccelerator No Status Bar Control</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="
This article provides a small class which implements all of the StatusBar functionality
you're likely to need in an application with none of the distribution
headaches associated with a control.  The latest version supports XP Style drawing and
frankly looks quite great.
" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Status Bar</a>&#160;.&#160;vbAccelerator No Status Bar Control</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_no_status_bar_class.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 No Status Bar Class</a> (31K)</p><p /><p class="nav"><a href="vb6_no_status_bar_class.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 No Status Bar Class</a> (30K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:1416</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=1416&type=article&title=vbaccelerator_20no_20status_20bar_20control.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />21 Jun 2003<br /><p class="update">VB6 download did not have the updated version
checking.  Fixed.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator No Status Bar Control</h1><p class="splash">A fully-featured, ultra-lightweight status bar implemented in a class</p><img src="nostatusbar.png" width="341" height="216" alt="No Status Bar Class Demonstration" /><p /><p>
This article provides a small class which implements all of the StatusBar functionality
you're likely to need in an application with none of the distribution
headaches associated with a control.  The latest version supports XP Style drawing and
frankly looks quite great.
</p><h2>Using the Class</h2><p>To use the class, you first need to place a PictureBox on the form to display the
status bar in. Typically you'll set this to be aligned to the bottom of the form.  Don't
set the <i>AutoRedraw</i> property of the text box to True, otherwise any changes you
make to panels will not be painted until the <i>Refresh</i> method is called on the
PictureBox.</p><p>Once this has been done, create a form-wide instance of the cNoStatusBar class and
call the <i>Create</i> method, passing in the control you want the class to draw on.
Then ensure that the bar is redrawn in the PictureBox's <i>Paint</i> event.  Here
is the skeleton code you need:
</p><pre>
Private m_cSBar As New cNoStatusBar

Private Sub Form_Load()
   With m_cSBar
      .Create picStatus
   End With
End Sub

Private Sub picStatus_Paint()
   m_cSBar.Draw
End Sub
</pre><p>Now you can configure the panels, panel text and icons for the status bar.  For a
simple status bar with two panels this might look like this:</p><pre>
   With m_cSBar
      ' Associate a ComCtl32.DLL compatible image list:
      .ImageList = ilsIcons

      ' Add a main panel which springs to fit the available 
      ' size:
      .AddPanel , "Please wait whilst the application loads", _
          , , True, , , "MAIN"
      ' Add an icon panel: icons are specified using 0-based
      ' index:
      .AddPanel , "My Computer", 0, , , , , "DOMAIN"

      ' Show the size grip:
      .SizeGrip = True

      ' Set the height of the status bar to the system default
      ' height:
      picStatus.Height = .Height
   End With
</pre><p>More details of the methods and properties available are provided in the Status Bar
Control article.</p><h2>Compared to the vbAccelerator Status Bar Control</h2><p>The No-Status Bar class shares all the methods of the status bar control, except:</p><ul><li>It has no events.</li><li>It does not support owner draw panels.</li><li>It does not support pre-defined panels, such as NumLock, CapsLock, 
Date/Time and so on. Check the source code for the full Status Bar if you want a hint 
on building these items.</li></ul><p>XP Style in the No Status Bar class does not require an application manifest as the 
class uses the UxTheme.DLL API to draw the status bar panels.  Instead, set the
<i>AllowXPStyles</i> property to switch on or off the XP Style drawing.  By default, on
an XP machine, this property will be set and the control will draw using the theme
selected for your application - you can turn it on or off at any point.  If the machine
is a lower Windows version than XP, this property will be off and an attempt to turn
it on will raise an "Unsupported" error.</p><p>Other than that, the interface exposed by the class is identical to the control, so
you can refer to the documentation provided for more information.</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\libraries\compression\index.html" ><IMG SRC="..\..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Status Bar</a>&#160;.&#160;vbAccelerator No Status Bar Control</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 21 June 2003</p></td><td></td></tr></table>
</body></html>

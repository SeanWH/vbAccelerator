<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: cTreeViewNodes.cls</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: cTreeViewNodes.cls" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /><link rel="SHORTCUT ICON" href="/home/res/vbaccel.ico" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">TreeView</a>&#160;.&#160;<a href="article.html">Multi-Column TreeView Control</a>&#160;.&#160;<a href="vb6_multicolumn_tree_full_source.html">VB6 MultiColumn Tree Full Source</a>&#160;.&#160;cTreeViewNodes.cls</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_multicolumn_tree_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 MultiColumn Tree Binary</a> (73K)</p><p class="nav"><a href="vb5_multicolumn_tree_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 MultiColumn Tree Demonstration</a> (52K)</p><p class="nav"><a href="vb5_multicolumn_tree_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 MultiColumn Tree Full Source</a> (200K)</p><p /><p class="nav"><a href="vb6_multicolumn_tree_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 MultiColumn Tree Binary</a> (74K)</p><p class="nav"><a href="vb6_multicolumn_tree_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 MultiColumn Tree Demonstration</a> (49K)</p><p class="nav"><a href="vb6_multicolumn_tree_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 MultiColumn Tree Full Source</a> (198K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:14591</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=14591&type=zip&title=vb6_20multicolumn_20tree_20full_20source_2ezip_5fctreeviewnodes.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />15 Apr 2004<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\treeview_control\article.html">vbAccelerator TreeView Control</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\adding_scroll_bars_to_forms__pictureboxes_and_usercontrols\article.html">Adding Scroll Bars to Forms, PictureBoxes and User Controls</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\utility_controls\header_control\article.html">ComCtl32 Header Control</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\type_libraries\ole_guid_and_interface_definitions\article.html">Ole Guid and interface definitions (OleGuids.Tlb) </a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\type_libraries\ishellfolder\article.html">IShellFolder Extended Type Library Version 1.2 (ISHF_Ex.Tlb)</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: cTreeViewNodes.cls</h1><pre>VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "cCTreeViewNodes"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = True
Option Explicit

Private m_lIDParent As Long
Private m_hWndCtl As Long

Private Function pbVerify(ByRef ctlThis As vbalColumnTreeView) As Boolean
Dim lPtr As Long
Dim lIdx As Long
   If IsWindow(m_hWndCtl) Then
      lPtr = GetProp(m_hWndCtl, gcOBJECT_PROP)
      If Not (lPtr = 0) Then
         
         If (lPtr = 1) Then
            Debug.Print "NOOOOOO"
         End If
         
         Set ctlThis = ObjectFromPtr(lPtr)
         pbVerify = True
      Else
         gErr 1, "cListItems"
      End If
   Else
      gErr 1, "cListItems"
   End If
End Function

Friend Sub fInit(ctl As vbalColumnTreeView, ByVal lIDParent As Long)
   m_lIDParent = lIDParent
   m_hWndCtl = ctl.hwnd
End Sub

Public Function Add( _
      Optional ByVal Relative As cCTreeViewNode = Nothing, _
      Optional ByVal RelationShip As ETreeViewRelationshipContants = etvwChild,
       _
      Optional ByVal Key As String = "", _
      Optional ByVal Text As String = "", _
      Optional ByVal Image As Long = -1, _
      Optional ByVal SelectedImage As Long = -1 _
   ) As cCTreeViewNode
Attribute Add.VB_Description = "Adds a new node with the specified relation to
 the node which owns this collection."
Dim ctl As vbalColumnTreeView
Dim lIDRel As Long
Dim lIDNew As Long
Dim nodRet As cCTreeViewNode
   If (pbVerify(ctl)) Then
      If (Relative Is Nothing) Then
         lIDRel = m_lIDParent
      Else
         lIDRel = Relative.ID
      End If
      lIDNew = ctl.fAdd(lIDRel, RelationShip, Key, Text, Image, SelectedImage)
      If Not (lIDNew = 0) Then
         Set nodRet = New cCTreeViewNode
         nodRet.fInit ctl, lIDNew
         Set Add = nodRet
      End If
   End If
End Function

Public Sub Clear()
Attribute Clear.VB_Description = "Clears all the nodes from this collection."
Dim ctl As vbalColumnTreeView
   If (pbVerify(ctl)) Then
      If (m_lIDParent = 0) Then
         ctl.fRemoveAll
      Else
         ctl.fRemoveChildren m_lIDParent
      End If
   End If
   '
End Sub

Public Property Get Count() As Long
Attribute Count.VB_Description = "Gets the number of nodes in this collection."
Dim ctl As vbalColumnTreeView
   If (pbVerify(ctl)) Then
      Count = ctl.fCount(m_lIDParent)
   End If
End Property

Public Property Get Item(Index As Variant) As cCTreeViewNode
Attribute Item.VB_Description = "Gets the item with the specified Key or index
 within the collection."
Attribute Item.VB_UserMemId = 0
Dim ctl As vbalColumnTreeView
Dim lID As Long
   If (pbVerify(ctl)) Then
      If (m_lIDParent = 0) Or Not IsNumeric(Index) Then
         lID = ctl.fIDForIndex(Index)
      Else
         lID = ctl.fIDForNumericIndexInSubTree(m_lIDParent, Index)
      End If
      If Not (lID = 0) Then
         Dim cItem As New cCTreeViewNode
         cItem.fInit ctl, lID
         Set Item = cItem
      End If
   End If
End Property

Public Sub Remove(Index As Variant)
Attribute Remove.VB_Description = "Removes the item with the specified index or
 key."
Dim ctl As vbalColumnTreeView
Dim lID As Long
   If (pbVerify(ctl)) Then
      If Not IsNumeric(Index) Then
         lID = ctl.fIDForIndex(Index)
      Else
         lID = ctl.fIDForNumericIndexInSubTree(m_lIDParent, Index)
      End If
      If Not (lID = 0) Then
         ctl.fRemove lID
      End If
   End If
End Sub

Public Function Exists(Index As Variant) As Boolean
Attribute Exists.VB_Description = "Returns true if the item with the specified
 key exists in the collection or not."
Dim ctl As vbalColumnTreeView
Dim lID As Long
Dim lErr As Long
   If (pbVerify(ctl)) Then
      On Error Resume Next
      lID = ctl.fIDForIndex(Index)
      lErr = Err.Number
      On Error GoTo 0
      Exists = ((lID &lt;&gt; 0) And (lErr = 0))
   End If
End Function

Public Property Get Parent() As cCTreeViewNode
Attribute Parent.VB_Description = "Gets the parent of this node collection, if
 any, otherwise returns Nothing if it contains the root items in the tree."
Dim ctl As vbalColumnTreeView
   If (pbVerify(ctl)) Then
      If Not (m_lIDParent = 0) Then
         If Not (ctl.fhItemForID(m_lIDParent) = 0) Then
            Dim cNod As New cCTreeViewNode
            cNod.fInit ctl, m_lIDParent
            Set Parent = cNod
         End If
      End If
   End If
End Property
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\vbmedia\using_gdi_plus\index.html" ><IMG SRC="..\..\..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">TreeView</a>&#160;.&#160;<a href="article.html">Multi-Column TreeView Control</a>&#160;.&#160;<a href="vb6_multicolumn_tree_full_source.html">VB6 MultiColumn Tree Full Source</a>&#160;.&#160;cTreeViewNodes.cls</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2004 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 18 April 2004</p></td><td></td></tr></table>
</body></html>
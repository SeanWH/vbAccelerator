<html lang="en" >
<head>

<title>vbAccelerator - Multi-Column TreeView Control</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="
This article provides a control which extends the vbAccelerator TreeView control to provide
multiple columns, complete with headers for each of the columns.
" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /><link rel="SHORTCUT ICON" href="/home/res/vbaccel.ico" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">TreeView</a>&#160;.&#160;Multi-Column TreeView Control</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_multicolumn_tree_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 MultiColumn Tree Binary</a> (73K)</p><p class="nav"><a href="vb5_multicolumn_tree_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 MultiColumn Tree Demonstration</a> (52K)</p><p class="nav"><a href="vb5_multicolumn_tree_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 MultiColumn Tree Full Source</a> (200K)</p><p /><p class="nav"><a href="vb6_multicolumn_tree_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 MultiColumn Tree Binary</a> (74K)</p><p class="nav"><a href="vb6_multicolumn_tree_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 MultiColumn Tree Demonstration</a> (49K)</p><p class="nav"><a href="vb6_multicolumn_tree_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 MultiColumn Tree Full Source</a> (198K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:14442</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=14442&type=article&title=multi_2dcolumn_20treeview_20control.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />15 Apr 2004<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\treeview_control\article.html">vbAccelerator TreeView Control</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\adding_scroll_bars_to_forms__pictureboxes_and_usercontrols\article.html">Adding Scroll Bars to Forms, PictureBoxes and User Controls</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\utility_controls\header_control\article.html">ComCtl32 Header Control</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\type_libraries\ole_guid_and_interface_definitions\article.html">Ole Guid and interface definitions (OleGuids.Tlb) </a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\type_libraries\ishellfolder\article.html">IShellFolder Extended Type Library Version 1.2 (ISHF_Ex.Tlb)</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>Multi-Column TreeView Control</h1><img src="multicolumntree.png" width="435" height="402" alt="Multi-Column TreeView&#xD;&#xA;Demonstration" /><p /><p>
This article provides a control which extends the vbAccelerator TreeView control to provide
multiple columns, complete with headers for each of the columns.
</p><h2>A Multi-Column Tree</h2><p>
The technique used here to create a multi-column tree is based on an MFC article by
Michal Mecinski at <a href="javascript:window.alert(&quot;http://www.codeguru.com/\nThis link was not retrieved.&quot;)">CodeGuru</a>.  The TreeView
control is created with the <span class="code">TVS_NOHSCROLL</span> so that it
never displays a horizontal scroll bar.  Then it is added, along with a header
control implementation into a container control, and the container control is 
configured so that if the total column width is greater than the width of the
control then a horizontal scroll bar is shown.  Finally, when the Tree View control
is rendered, the Custom Draw facilities are used to overdraw the text drawn
by the control with the columns and grid lines if necessary.
</p><p>
Internally, these are implemented in the control using code from existing
components on the site:
</p><ol><li>The <span class="code">TreeView</span> with custom-draw support is taken
from the <a href="..\treeview_control\article.html">vbAccelerator TreeView Control</a>.</li><li>The <span class="code">Header</span> is derived from the 
<a href="..\..\utility_controls\header_control\article.html">Header Control</a>.</li><li>The Horizonal Scroll bars is added to the control using <a href="..\..\..\libraries\subclassing\adding_scroll_bars_to_forms__pictureboxes_and_usercontrols\article.html">ScrollBars</a>
class.</li></ol><p>
In the original sample,the text for each column is stored as a tab-delimited string in 
the node.  Although simple, it means that some built-in facilities of the TreeView such 

label editing will not work correctly.  In this sample, the text for the other columns
is stored in a class which is associated with the node; this also provides a route for
further options to be added in the future such as text alignment and different colours
for the items.
</p><p>
The diagram belows shows the object model for the new control:
</p><img src="objectmodel.png" width="334" height="389" alt="Multi-Column Tree Control Object Model" /><p class="caption">Multi-Column Tree Control Object Model.</p><h2>Using the Control</h2><p>
Using the control is much the same as using the vbAccelerator TreeView which is described
in other articles in this section.  The main differences are:
</p><ol><li>The common objects such as Nodes have
a different class name: they are prefixed with <span class="code">cCTreeView</span> rather than 
<span class="code">cTreeView</span> (this is so you can use the column tree view easily in a
project which also contains a normal TreeView).
</li><li>The <span class="code">History</span> and <span class="code">ShowNumber</span> styles are
not supported; neither is it possible to turn Custom Draw off.</li><li>You can add and remove columns using the <span class="code">Columns</span> collection.
</li><li>The text to appear in the new columns can be specified through the <span class="code">SubItems</span>
property of a node.</li></ol><p>
I'll cover the last two points in turn.
</p><h3>Configuring Columns</h3><p>
To add a column to the control, use the <span class="code">Columns</span> collection.  When
a column is added, you can configure the text that will appear in the header and its width
at the same time (there is also the possibility of a column image, although that is not
yet implemented in this release).  Note that the first column in the control cannot
be removed, although you can change it's properties.
</p><pre>
Private Sub setUpColumns()
Dim cCol As cCTreeViewColumn
   With tvwColumns
      With .Columns
         Set cCol = .Item(1)
         cCol.Width = 128
         cCol.Caption = "Name"
         Set cCol = .Add("TRACK", "Track")
         Set cCol = .Add("LENGTH", "Length")
         Set cCol = .Add("SIZE", "Size")
      End With
   End With
End Sub
</pre><h3>Configuring Text for Additional Columns</h3><p>
Once you have some columns, you can start adding text to display in the sub-items.  The default
for the sub-items is for the column to appear blank.  To change the text, use the 
<span class="code">SubItems</span> property of a Node.  This works in a similar way
to the <span class="code">SubItems</span> of a MSCOMCTL.OCX ListView item, in that the first
sub-item specifies the data for the second column, the second sub-item specifies the data for
the third column and so on:
</p><pre>
Private Sub addTrack( _
       parent As cCTreeViewNode, _
       ByVal sKey As String, _
       ByVal sTrack As String, _
       ByVal lTrackNumber As Long, _
       ByVal dLength As Date, _
       ByVal lSize As Long _
   )
Dim nod As cCTreeViewNode
   ' Node text appears in column 1:
   Set nod = parent.AddChildNode(sKey, sTrack) 
   ' SubItem(1) is the Track column:
   nod.SubItem(1).Text = lTrackNumber
   ' SubItem(2) is the Length column:
   nod.SubItem(2).Text = Format(dLength, "nn:ss")
   ' SubItem(3)  is the Size column:
   nod.SubItem(3).Text = Format(lSize / 1024, "#,##0 KB")
End Sub
</pre><h2>Conclusion</h2><p>
This article provides a multi-column TreeView control.  Although the formatting support for the
columns is fairly rudimentary, it should be easy to extend in the future.  Suggest options you
would like to see implemented and I'll take a look into it.
</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\vbmedia\using_gdi_plus\index.html" ><IMG SRC="..\..\..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">TreeView</a>&#160;.&#160;Multi-Column TreeView Control</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2004 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 18 April 2004</p></td><td></td></tr></table>
</body></html>
<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: mfrmMain.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: mfrmMain.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Tab Controls</a>&#160;.&#160;<a href="article.html">vbAccelerator MDITabs Control</a>&#160;.&#160;<a href="vb6_mditabs_demonstration.html">VB6 MDITabs Demonstration</a>&#160;.&#160;mfrmMain.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_mditabs_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 MDITabs Binary</a> (14K)</p><p class="nav"><a href="vb5_mditabs_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 MDITabs Demonstration</a> (50K)</p><p class="nav"><a href="vb5_mditabs_full_source_code.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 MDITabs Full Source Code</a> (79K)</p><p /><p class="nav"><a href="vb6_mditabs_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 MDITabs Binary</a> (15K)</p><p class="nav"><a href="vb6_mditabs_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 MDITabs Demonstration</a> (46K)</p><p class="nav"><a href="vb6_mditabs_full_source_code.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 MDITabs Full Source Code</a> (77K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:2354</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=2354&type=zip&title=vb6_20mditabs_20demonstration_2ezip_5fmfrmmain.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />28 Mar 2003<br /><p class="update">Correction to colour selection logic; background colour
of tabs now renders correctly under all colour schemes.</p><p class="update">Minor drawing and tab selection logic fixes.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\graphics_and_gdi\flicker_free_api_drawing\article.html">Flicker Free API Drawing</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\toolbar\vbaccelerator_toolbar_and_coolmenu_control\article.html">vbAccelerator Toolbar and CoolMenu Control v3.5</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: mfrmMain.frm</h1><pre>VERSION 5.00
Begin VB.MDIForm mfrmMain 
   Appearance      =   0  'Flat
   AutoShowChildren=   0   'False
   BackColor       =   &amp;H8000000C&amp;
   Caption         =   "MDI Tab Tester"
   ClientHeight    =   6540
   ClientLeft      =   3150
   ClientTop       =   3090
   ClientWidth     =   10050
   Icon            =   "mfrmMain.frx":0000
   LinkTopic       =   "MDIForm1"
   Begin VB.PictureBox picTools 
      Align           =   4  'Align Right
      BorderStyle     =   0  'None
      Height          =   5730
      Index           =   3
      Left            =   8280
      ScaleHeight     =   5730
      ScaleWidth      =   1770
      TabIndex        =   3
      Top             =   435
      Width           =   1770
      Begin VB.CommandButton cmdChangeCaption 
         Caption         =   "&amp;Caption"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   300
         TabIndex        =   4
         Top             =   0
         Width           =   1155
      End
   End
   Begin VB.PictureBox picTools 
      Align           =   3  'Align Left
      BorderStyle     =   0  'None
      Height          =   5730
      Index           =   2
      Left            =   0
      ScaleHeight     =   5730
      ScaleWidth      =   810
      TabIndex        =   2
      Top             =   435
      Width           =   810
   End
   Begin VB.PictureBox picTools 
      Align           =   2  'Align Bottom
      BorderStyle     =   0  'None
      Height          =   375
      Index           =   1
      Left            =   0
      ScaleHeight     =   375
      ScaleWidth      =   10050
      TabIndex        =   1
      Top             =   6165
      Width           =   10050
   End
   Begin VB.PictureBox picTools 
      Align           =   1  'Align Top
      BorderStyle     =   0  'None
      Height          =   435
      Index           =   0
      Left            =   0
      ScaleHeight     =   435
      ScaleWidth      =   10050
      TabIndex        =   0
      Top             =   0
      Width           =   10050
   End
   Begin VB.Menu mnuFileTop 
      Caption         =   "&amp;File"
      Begin VB.Menu mnuFile 
         Caption         =   "&amp;New"
         Index           =   0
         Shortcut        =   ^N
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&amp;Open..."
         Index           =   1
         Shortcut        =   ^O
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&amp;Close"
         Enabled         =   0   'False
         Index           =   2
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   3
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&amp;Save"
         Enabled         =   0   'False
         Index           =   4
         Shortcut        =   ^S
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Save &amp;As..."
         Enabled         =   0   'False
         Index           =   5
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   6
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Page Se&amp;tup"
         Enabled         =   0   'False
         Index           =   7
      End
      Begin VB.Menu mnuFile 
         Caption         =   "Print Pre&amp;view"
         Enabled         =   0   'False
         Index           =   8
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&amp;Print"
         Enabled         =   0   'False
         Index           =   9
         Shortcut        =   ^P
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   10
      End
      Begin VB.Menu mnuFile 
         Caption         =   "P&amp;roperties"
         Enabled         =   0   'False
         Index           =   11
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   12
      End
      Begin VB.Menu mnuFile 
         Caption         =   "E&amp;xit"
         Index           =   13
      End
   End
   Begin VB.Menu mnuViewTOP 
      Caption         =   "&amp;View"
      Begin VB.Menu mnuView 
         Caption         =   "&amp;Toolbar"
         Checked         =   -1  'True
         Index           =   0
      End
      Begin VB.Menu mnuView 
         Caption         =   "&amp;Status Bar"
         Checked         =   -1  'True
         Index           =   1
      End
      Begin VB.Menu mnuView 
         Caption         =   "&amp;Toolbox"
         Checked         =   -1  'True
         Index           =   2
      End
      Begin VB.Menu mnuView 
         Caption         =   "&amp;Project"
         Checked         =   -1  'True
         Index           =   3
      End
      Begin VB.Menu mnuView 
         Caption         =   "-"
         Index           =   4
      End
      Begin VB.Menu mnuView 
         Caption         =   "&amp;Tab Below"
         Index           =   5
      End
   End
   Begin VB.Menu mnuWindowTop 
      Caption         =   "&amp;Window"
      WindowList      =   -1  'True
   End
   Begin VB.Menu mnuHelpTOP 
      Caption         =   "&amp;Help"
      Begin VB.Menu mnuHelp 
         Caption         =   "&amp;vbAccelerator on the Web..."
         Index           =   0
         Shortcut        =   {F1}
      End
      Begin VB.Menu mnuHelp 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu mnuHelp 
         Caption         =   "&amp;About..."
         Index           =   2
      End
   End
End
Attribute VB_Name = "mfrmMain"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private WithEvents m_cMDITabs As cMDITabs
Attribute m_cMDITabs.VB_VarHelpID = -1
Private m_lDocumentId As Long

Private Declare Function SetWindowLong Lib "USER32" Alias "SetWindowLongA"
 (ByVal hWnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) As Long
Private Declare Function GetWindowLong Lib "USER32" Alias "GetWindowLongA"
 (ByVal hWnd As Long, ByVal nIndex As Long) As Long

Private Declare Function SetWindowPos Lib "USER32" (ByVal hWnd As Long, ByVal
 hWndInsertAfter As Long, ByVal x As Long, ByVal y As Long, ByVal cx As Long,
 ByVal cy As Long, ByVal wFlags As Long) As Long
Private Const GWL_STYLE = (-16)
Private Const GWL_EXSTYLE = (-20)
Private Const WS_EX_APPWINDOW = &amp;H40000
Private Const WS_SYSMENU = &amp;H80000
Private Const SWP_FRAMECHANGED = &amp;H20        '  The frame changed: send
 WM_NCCALCSIZE
Private Const SWP_NOACTIVATE = &amp;H10
Private Const SWP_NOMOVE = &amp;H2
Private Const SWP_NOOWNERZORDER = &amp;H200      '  Don't do owner Z ordering
Private Const SWP_NOSIZE = &amp;H1
Private Const SWP_NOZORDER = &amp;H4


Private Sub newWindow(Optional ByVal sFileName As String)
   m_lDocumentId = m_lDocumentId + 1
   Dim fT As New frmTest
   fT.Show
   If (sFileName = "") Then
      fT.NewDocument "Document" &amp; m_lDocumentId
   Else
      fT.OpenDocument sFileName
   End If
   m_cMDITabs.ForceRefresh
End Sub


Private Sub cmdChangeCaption_Click()
   If Not Me.ActiveForm Is Nothing Then
      Dim sCap As String
      sCap = Me.ActiveForm.Caption
      If InStr(sCap, "Changed Cap") = 0 Then
         Me.ActiveForm.Tag = sCap
         sCap = "Changed Caption:" &amp; Format$(Now, "Short Time")
      Else
         sCap = Me.ActiveForm.Tag
      End If
      Me.ActiveForm.Caption = sCap
      m_cMDITabs.ForceRefresh
   End If
End Sub

Private Sub m_cMDITabs_CloseWindow(ByVal hWnd As Long)
Dim frm As Form
   Set frm = formForHwnd(hWnd)
   Unload frm
   m_cMDITabs.ForceRefresh
End Sub

Private Sub m_cMDITabs_TabBarClick(ByVal iButton As MouseButtonConstants, ByVal
 screenX As Long, ByVal screenY As Long)
   Dim sMsg As String
   sMsg = "Bar Click, button: "
   If (iButton = vbLeftButton) Then
      sMsg = sMsg &amp; "Left"
   Else
      sMsg = sMsg &amp; "Right"
   End If
   sMsg = sMsg &amp; " at (" &amp; screenX &amp; "," &amp; screenY &amp; ")"
   showEvent sMsg
End Sub

Private Sub m_cMDITabs_TabClick(ByVal iButton As MouseButtonConstants, ByVal
 hWnd As Long, ByVal screenX As Long, ByVal screenY As Long)
   Dim sMsg As String
   sMsg = "Tab Click, button: "
   If (iButton = vbLeftButton) Then
      sMsg = sMsg &amp; "Left"
   Else
      sMsg = sMsg &amp; "Right"
   End If
   sMsg = sMsg &amp; " for form: " &amp; formForHwnd(hWnd).Name
   sMsg = sMsg &amp; " at (" &amp; screenX &amp; "," &amp; screenY &amp; ")"
   showEvent sMsg
   If (iButton = vbRightButton) Then
      Me.PopupMenu mnuViewTOP, , screenX * Screen.TwipsPerPixelX, screenY *
       Screen.TwipsPerPixelY
      'Me.PopupMenu mnuViewTOP, , 0, 0
   End If
End Sub

Private Function formForHwnd(ByVal hWnd As Long) As Form
   Dim frmChild As Form
   For Each frmChild In Forms
      If (frmChild.hWnd = hWnd) Then
         Set formForHwnd = frmChild
         Exit For
      End If
   Next
End Function
Private Sub showEvent(ByVal sMsg As String)
   Dim frmChild As Form
   For Each frmChild In Forms
      'If (frmChild.MDIChild) Then
         If TypeName(frmChild) = "frmEvents" Then
            frmChild.lstEvents.AddItem sMsg
            frmChild.lstEvents.ListIndex = frmChild.lstEvents.ListCount - 1
         End If
      'End If
   Next
End Sub

Private Sub m_cMDITabs_WindowChanged(ByVal hWnd As Long)
   Dim frm As Form
   Set frm = formForHwnd(hWnd)
   Dim bEnable As Boolean
   If Not frm Is Nothing Then
      bEnable = (TypeName(frm) = "frmTest")
   End If
   mnuFile(2).Enabled = bEnable
   mnuFile(4).Enabled = bEnable
   mnuFile(5).Enabled = bEnable
   
   ' would do 7,8,9,11 here as well
End Sub

Private Sub MDIForm_Load()
   
   Set m_cMDITabs = New cMDITabs
   m_cMDITabs.Attach Me.hWnd
   
   Load frmEvents
   frmEvents.Show
   
   Dim fB As New frmBrowser
   Dim sUrl As String
   sUrl = App.Path
   If (Right(sUrl, 1) &lt;&gt; "\") Then sUrl = sUrl &amp; "\"
   sUrl = sUrl &amp; "startPage.html"
   fB.Url = sUrl
   fB.Show
   
   newWindow App.Path &amp; "\licence.txt"
   
End Sub

Private Sub mnuFile_Click(Index As Integer)
Dim sFile As String
   Select Case Index
   Case 0
      ' new
      newWindow
   Case 1
      ' open
      Dim c As New cCommonDialog
      If (c.VBGetOpenFileName( _
         Filename:=sFile, _
         Filter:="Text Files (*.TXT)|*.TXT|HTML Files (*.HTML)|*.HTML|XML Files
          (*.XML)|*.XML)|All Files (*.*)|*.*", _
         InitDir:=App.Path, _
         Owner:=Me.hWnd)) Then
         newWindow sFile
      End If
      
   Case 2
      ' close
      If Not (Me.ActiveForm Is Nothing) Then
         If Not (Me Is Me.ActiveForm) Then
            Unload Me.ActiveForm
            m_cMDITabs.ForceRefresh
         End If
      End If
      
   Case 4
      ' save
      Me.ActiveForm.SaveDocument
      
   Case 5
      ' save as
      Me.ActiveForm.SaveDocument True
      
   Case 7
      ' page setup
      ' todo
      
   Case 8
      ' print preview
      ' todo
      
   Case 9
      ' print
      ' todo
      
   Case 11
      ' properties
      ' todo
      
   Case 13
      Unload Me
   End Select
   
End Sub

Private Sub mnuHelp_Click(Index As Integer)
   Select Case Index
   Case 0
      ' vbAccelerator on the Web
   Case 2
      ' About
      frmAbout.Show vbModal, Me
   End Select
End Sub

Private Sub mnuView_Click(Index As Integer)
   mnuView(Index).Checked = Not (mnuView(Index).Checked)
   If (Index &lt; 4) Then
      picTools(Index).Visible = mnuView(Index).Checked
   ElseIf Index = 5 Then
      If (mnuView(Index).Checked) Then
         m_cMDITabs.TabAlign = TabAlignBottom
      Else
         m_cMDITabs.TabAlign = TabAlignTop
      End If
   End If
End Sub

</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\libraries\compression\index.html" ><IMG SRC="..\..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Tab Controls</a>&#160;.&#160;<a href="article.html">vbAccelerator MDITabs Control</a>&#160;.&#160;<a href="vb6_mditabs_demonstration.html">VB6 MDITabs Demonstration</a>&#160;.&#160;mfrmMain.frm</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
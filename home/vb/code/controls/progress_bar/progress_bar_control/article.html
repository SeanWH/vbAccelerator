<html lang="en" >
<head>

<title>vbAccelerator - vbAccelerator Progress Bar Control</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="
This control provides a highly flexible Progress Bar control with an array of 
drawing styles, including XP Style, segmented/non-segmented, bitmap bars and 
backgrounds and more.  Alternatively, if you don't want the convenient
packaging and design-time property settings provided by a control, you can also get
the same code as class.
" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Progress Bar</a>&#160;.&#160;vbAccelerator Progress Bar Control</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_progress_bar_control_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Progress Bar Control Demonstration</a> (25K)</p><p class="nav"><a href="vb5_progress_bar_control_source_code.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Progress Bar Control Source Code</a> (61K)</p><p class="nav"><a href="vb5_progress_bar_control.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Progress Bar Control</a> (20K)</p><p /><p class="nav"><a href="vb6_progress_bar_control_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Progress Bar Control Demonstration</a> (24K)</p><p class="nav"><a href="vb6_progress_bar_control_source_code.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Progress Bar Control Source Code</a> (61K)</p><p class="nav"><a href="vb6_progress_bar_control.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Progress Bar Control</a> (20K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:1415</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=1415&type=article&title=vbaccelerator_20progress_20bar_20control.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />19 Dec 2002<br />First Posted</p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator Progress Bar Control</h1><p class="splash">A lightweight progress bar with </p><img src="progressbar.png" width="390" height="277" alt="Progress Bar Demonstration" /><p /><p>
This control provides a highly flexible Progress Bar control with an array of 
drawing styles, including XP Style, segmented/non-segmented, bitmap bars and 
backgrounds and more.  Alternatively, if you don't want the convenient
packaging and design-time property settings provided by a control, you can also get
the same code as class.
</p><h2>Implementing a Progress Bar</h2><p>The progress bar that is normally supplied with Windows is exposed by ComCtl32.DLL.
Whilst this control is fine for the normal progress bar tasks, it isn't very customisable:
for example, it is difficult to draw text on the bar without hacking the <i>WM_PAINT</i>
message, and you only get the standard system colours and a segmented bar unless you
have a newer version of the DLL.</p><p>For this reason, the vbAccelerator Progress Bar control has been implemented from
scratch as a custom VB control. This allows the implementation of all kinds of new drawing
styles and customising whilst still allowing emulation of the system progress bar styles.
</p><h2>vbAccelerator Progress Bar Control</h2><p>The progress bar control has these properties which affect the styles:</p><ul><li>XPStyle<br />When set, the bar draws with the current system XP Theme.  This style
uses the XP Styles API exposed through UxTheme.DLL, which means it will only have an effect
on XP systems.  If the system doesn't support XP styles, or if there is no theme applied,
then the drawing will fall through to the standard drawing techniques.  If a theme is
applied, then all other style settings are overridden.</li><li>Segments<br />Determines whether the bar portion is split into segements or not.</li><li>Appearance and Border<br />Set the style of the border draw around the progress bar.</li></ul><p>If XPStyle is not set, you can then modify the background and foreground properties 
of the progress bar using <i>BackColor</i>, <i>ForeColor</i>, <i>Picture</i> and
<i>BackPictureMode</i> for the background, then equivalently <i>BarColor</i>, 
<i>BarForeColor</i>, <i>BarPicture</i> and <i>BarPictureMode</i> for the foreground.  The
two Mode settings allow you to set whether the picture is stretched or tiled into the 
control.  You can also image process a picture loaded as the background or the bar
to modify its luminance (brightness) or saturation (unsaturated colours are greyer, 
saturated colours are brighter) using <i>ModifyPicture</i> and <i>ModifyBarPicture</i>.</p><p>To show text on the progress bar, set <i>TextAlignX</i> and <i>TextAlignY</i> to set
the horizontal and vertical position of the text, then set the text to display using 
the <i>Text</i> property.</p>.

<h2>No Need For a Control</h2><p>Since the progress bar doesn't particularly interact with a user, it can also be used
as a class module.  The only things you loose by including the code as a class are
persistence of properties and packaging, but you make it easier to distribute your
project.  Check out the article "Progress Bar Class" for a demonstration.</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="javascript:window.alert(&quot;http://vbaccelerator.com/home/include/adredir.asp?url=http://oneandone.co.uk/xml/init?k_id=5791003&image=http://oneandone.co.uk/xml/banner?size=1&number=4\nThis link was not retrieved.&quot;)" ><IMG SRC="..\..\..\..\..\..\..\oneandone_co_uk\xml\banner\size=1&number=4.html" ALT="1&1 Web Hosting" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Progress Bar</a>&#160;.&#160;vbAccelerator Progress Bar Control</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 21 June 2003</p></td><td></td></tr></table>
</body></html>

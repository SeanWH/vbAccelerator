<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: mfrmMain.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: mfrmMain.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Drop Down Tool Windows</a>&#160;.&#160;<a href="article.html">vbAccelerator Drop-Down and Popup Form Control</a>&#160;.&#160;<a href="vb5_drop_down_form_control_demonstration.html">VB5 Drop Down Form Control Demonstration</a>&#160;.&#160;mfrmMain.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_drop_down_form_control_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Drop Down Form Control Binary</a> (18K)</p><p class="nav"><a href="vb5_drop_down_form_control_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Drop Down Form Control Demonstration</a> (44K)</p><p class="nav"><a href="vb5_drop_down_form_control_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Drop Down Form Control Full Source</a> (81K)</p><p /><p class="nav"><a href="vb6_drop_down_form_control_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Drop Down Form Control Binary</a> (19K)</p><p class="nav"><a href="vb6_drop_down_form_control_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Drop Down Form Control Demonstration</a> (48K)</p><p class="nav"><a href="vb6_drop_down_form_control_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Drop Down Form Control Full Source</a> (86K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:1074</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=1074&type=zip&title=vb5_20drop_20down_20form_20control_20demonstration_2ezip_5fmfrmmain.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />21 Mar 2000<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\emulating_modal_forms\article.html">Emulating Modal Forms</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\office_style_table_picker\article.html">Creating drop-down tool windows</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: mfrmMain.frm</h1><pre>VERSION 5.00
Object = "{1E5F146D-5BB9-11D3-8E23-44910FC10000}#6.0#0"; "VBALDDFM.OCX"
Begin VB.MDIForm mfrmTest 
   BackColor       =   &amp;H8000000C&amp;
   Caption         =   "vbAccelerator Floating Tool Window Tester"
   ClientHeight    =   5205
   ClientLeft      =   3720
   ClientTop       =   2460
   ClientWidth     =   7335
   Icon            =   "mfrmMain.frx":0000
   LinkTopic       =   "MDIForm1"
   Begin vbalDropDownForm.vbalTitleBarModifier ctlTitleBarMod 
      Left            =   240
      Top             =   720
      _ExtentX        =   1296
      _ExtentY        =   1085
   End
   Begin VB.PictureBox picToolbar 
      Align           =   1  'Align Top
      BorderStyle     =   0  'None
      Height          =   435
      Left            =   0
      ScaleHeight     =   435
      ScaleWidth      =   7335
      TabIndex        =   0
      Top             =   0
      Width           =   7335
      Begin VB.CheckBox chkDropDown 
         Caption         =   "u"
         BeginProperty Font 
            Name            =   "Marlett"
            Size            =   8.25
            Charset         =   2
            Weight          =   500
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   3180
         Style           =   1  'Graphical
         TabIndex        =   3
         Top             =   60
         Width           =   195
      End
      Begin VB.CommandButton cmdPalette 
         Caption         =   "Palette"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   120
         TabIndex        =   1
         Top             =   60
         Width           =   1035
      End
      Begin VB.TextBox txtDropDown 
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   1200
         Locked          =   -1  'True
         TabIndex        =   2
         Top             =   60
         Width           =   2295
      End
   End
   Begin VB.Menu mnuFileTOP 
      Caption         =   "&amp;File"
      Begin VB.Menu mnuFile 
         Caption         =   "&amp;New"
         Index           =   0
         Shortcut        =   ^N
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu mnuFile 
         Caption         =   "E&amp;xit"
         Index           =   2
      End
   End
   Begin VB.Menu mnuEditTop 
      Caption         =   "&amp;Edit"
      Begin VB.Menu mnuEdit 
         Caption         =   "&amp;Find..."
         Index           =   0
         Shortcut        =   ^F
      End
      Begin VB.Menu mnuEdit 
         Caption         =   "Find &amp;Next"
         Index           =   1
         Shortcut        =   {F3}
      End
      Begin VB.Menu mnuEdit 
         Caption         =   "&amp;Replace..."
         Index           =   2
         Shortcut        =   ^H
      End
      Begin VB.Menu mnuEdit 
         Caption         =   "-"
         Index           =   3
      End
      Begin VB.Menu mnuEdit 
         Caption         =   "&amp;Palette..."
         Index           =   4
      End
   End
   Begin VB.Menu mnuHelpTOP 
      Caption         =   "&amp;Help"
      Begin VB.Menu mnuHelp 
         Caption         =   "&amp;vbAccelerator on the Web..."
         Index           =   0
         Shortcut        =   {F1}
      End
      Begin VB.Menu mnuHelp 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu mnuHelp 
         Caption         =   "&amp;About..."
         Index           =   2
      End
   End
End
Attribute VB_Name = "mfrmTest"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Type RECT
   Left As Long
   Top As Long
   Right As Long
   Bottom As Long
End Type
Private Declare Function GetWindowRect Lib "user32" (ByVal hwnd As Long, lpRect
 As RECT) As Long

Private WithEvents m_fDropDown As frmDropDown
Attribute m_fDropDown.VB_VarHelpID = -1
Private WithEvents m_fFindReplace As frmFindReplace
Attribute m_fFindReplace.VB_VarHelpID = -1
Private m_fPalette As frmPalette

Private Property Get PaletteWindow() As frmPalette
   If m_fPalette Is Nothing Then
      Set m_fPalette = New frmPalette
   End If
   Set PaletteWindow = m_fPalette
End Property

Private Property Get DropDownWIndow() As frmDropDown
   If m_fDropDown Is Nothing Then
      Set m_fDropDown = New frmDropDown
   End If
   Set DropDownWIndow = m_fDropDown
End Property
Private Property Get FindReplaceWIndow() As frmFindReplace
   If m_fFindReplace Is Nothing Then
      Set m_fFindReplace = New frmFindReplace
   End If
   Set FindReplaceWIndow = m_fFindReplace
End Property

Private Sub Position(frmThis As Form, objThis As Object)
Dim tR As RECT
   GetWindowRect objThis.hwnd, tR
   frmThis.Move tR.Left * Screen.TwipsPerPixelX, (tR.Bottom + 1) *
    Screen.TwipsPerPixelY
End Sub
Public Sub ShowFindReplace(ByVal bReplaceMode As Boolean)
   With FindReplaceWIndow
      .Show , Me
      .ShowState = ewssFloating
      If bReplaceMode Then
         .Mode = efrReplace
      Else
         .Mode = efrFind
      End If
   End With
End Sub

Private Sub chkDropDown_Click()
   Position DropDownWIndow, txtDropDown
   With DropDownWIndow
      .Show , Me
      .ShowState = ewssDropped
      .Value = txtDropDown.Text
   End With
End Sub

Private Sub cmdPalette_Click()
   Position PaletteWindow, cmdPalette
   With PaletteWindow
      ' Show the window &amp; set the drop-state
      .Show , Me
      .ShowState = ewssDropped
   End With
End Sub

Private Sub m_fDropDown_Change()
   txtDropDown.Text = DropDownWIndow.Value
End Sub

Private Sub m_fDropDown_CloseUp()
   If Not DropDownWIndow.Cancelled Then
      txtDropDown.Text = DropDownWIndow.Value
      txtDropDown.SelLength = Len(txtDropDown.Text)
   End If
   chkDropDown.Value = Unchecked
   txtDropDown.SetFocus
End Sub

Private Sub MDIForm_Load()

   mnuFile_Click 0
   
   chkDropDown.Move txtDropDown.Left + txtDropDown.Width - chkDropDown.Width -
    2 * Screen.TwipsPerPixelX, txtDropDown.Top + 2 * Screen.TwipsPerPixelY,
    chkDropDown.Width, txtDropDown.Height - 4 * Screen.TwipsPerPixelY
   
   ctlTitleBarMod.Attach Me.hwnd
   
End Sub

Private Sub mnuEdit_Click(Index As Integer)
   
   Select Case Index
   Case 0 'Find
      ShowFindReplace False
   Case 1 'F N
      
   Case 2 'Replace
      ShowFindReplace True
   Case 4 'Palette
   
   End Select
End Sub

Private Sub mnuFile_Click(Index As Integer)
   Select Case Index
   Case 0
      Dim f As New frmMDIChild
      f.Show
   Case 2
      Unload Me
   End Select
End Sub

Private Sub mnuHelp_Click(Index As Integer)
   Select Case Index
   Case 0
      ShellEx "http://vbaccelerator.com/"
   Case 2
      frmAbout.Show vbModal, Me
   End Select
End Sub

Private Sub txtDropDown_KeyDown(KeyCode As Integer, Shift As Integer)
   Select Case KeyCode
   Case vbKeyF4
      chkDropDown_Click
      chkDropDown.Value = Checked
      KeyCode = 0
   Case vbKeyDown
      ' Like extended UI in ComboBox
      chkDropDown_Click
      chkDropDown.Value = Checked
      KeyCode = 0
   Case Else
      ' .
   End Select
End Sub


</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\vbmedia\using_gdi_plus\index.html" ><IMG SRC="..\..\..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Drop Down Tool Windows</a>&#160;.&#160;<a href="article.html">vbAccelerator Drop-Down and Popup Form Control</a>&#160;.&#160;<a href="vb5_drop_down_form_control_demonstration.html">VB5 Drop Down Form Control Demonstration</a>&#160;.&#160;mfrmMain.frm</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
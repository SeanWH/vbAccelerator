<html lang="en" >
<head>

<title>vbAccelerator - vbAccelerator CommandBar Control</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="
The vbAccelerator CommandBar control is a full toolbar/menu control which currently offers
configurable styles, colours and a full-object model for configuring the buttons and menus.  
The control can draw in Office 2003, Office XP, MS Money and System styles, supports icons
with alpha-channels and runs on any Windows system.
The control is currently a pre-release version, and although it can be used now, some important features have not yet been implemented, particularly MDI support, docking container and 
toolbar borders.
" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Command Bar</a>&#160;.&#160;vbAccelerator CommandBar Control</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_commandbar_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 CommandBar Binary</a> (144K)</p><p class="nav"><a href="vb5_commandbar_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 CommandBar Demonstration</a> (31K)</p><p class="nav"><a href="vb5_commandbar_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 CommandBar Full Source</a> (256K)</p><p /><p class="nav"><a href="vb6_commandbar_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 CommandBar Binary</a> (144K)</p><p class="nav"><a href="vb6_commandbar_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 CommandBar Demonstration</a> (30K)</p><p class="nav"><a href="vb6_commandbar_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 CommandBar Full Source</a> (255K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:13695</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=13695&type=article&title=vbaccelerator_20commandbar_20control.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav"><a href="bugtrak.html">BugTrak</a></p><p class="nav"><a href="bugtrak.html#bugs"><img src="..\..\..\..\..\res\btbug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 8 / 8</p><p class="nav"><a href="bugtrak.html#issues"><img src="..\..\..\..\..\res\btissue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 5 / 5</p><p class="nav"><a href="bugtrak.html#questions"><img src="..\..\..\..\..\res\btquestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:11 February 2004</p>
<br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />25 Jan 2004<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator CommandBar Control</h1><img src="commandbar.png" width="366" height="302" alt="CommandBar Demonstration Application" /><p /><p>
The vbAccelerator CommandBar control is a full toolbar/menu control which currently offers
configurable styles, colours and a full-object model for configuring the buttons and menus.  
The control can draw in Office 2003, Office XP, MS Money and System styles, supports icons
with alpha-channels and runs on any Windows system.
The control is currently a <span class="color:#ff0000">pre-release</span> version, and although it can be used now, some important features have not yet been implemented, particularly MDI support, docking container and 
toolbar borders.
</p><h2>Object Model</h2><p>
The Command Bar control contains two main collections: the <span class="code">CommandBars</span>
collection and the <span class="code">Buttons</span> collection.  Once buttons have been
added to the Buttons collection, they can be assigned to any CommandBar, and the same button
can appear in more than one command bar.  Adding drop-down menus to any button is achieved by
assigning a CommandBar to the button.
</p><p>
In order to allow multiple controls access to the same buttons and command bars, these
collections are global.  It is important to note that this means the collections are
global to your <span class="i">project</span>, not just to a particular form that the
command bar is sited on.  This will be most noticable when writing a multiple form
project (article describing this coming soon).
</p><p>
The object model for the control is shown diagrammatically below:
</p><img src="commandbarobjectmodel.png" width="392" height="264" alt="CommandBar Object Model" /><p class="caption">vbalCommandBar control object model</p><h2>Properties, Methods and Events</h2><p>
This section describes the main properties, methods and events of the objects in the CommandBar
control.  The collection objects are not described as they contain the standard Add, Remove, Count
and default Item properties (although note that <span class="code">For..Each</span> 
enumeration is not supported).
</p><h3>1. Buttons</h3><p>
The behaviour of a button in a control is primarily configured by the button's <span class="code">Style</span>, which is set when the button is added.  There are seven styles 
of buttons provided in the control:
</p><ul><li><span class="code">eNormal</span> - A normal push button.  This is the default style.</li><li><span class="code">eSeparator</span> - A group separator.</li><li><span class="code">eSplit</span> - A button which shows a split for the drop-down 
assigned to the button.</li><li><span class="code">ePanel</span> - A panel which holds a control (for example,
a text box or a combo box).  When the toolbar is shown in a vertical orientation,
the panel is hidden unless the object has a valid icon index, in which case it is
displayed as a push button.  This follows the operation of style and font pickers in Word.</li><li><span class="code">eCheck</span> - A checkable button.  The check state is independent
of any other buttons in the group.</li><li><span class="code">eRadio</span> - A checkable button that toggles off any other buttons 
in its group.  At least one button in the group must be checked, i.e. clicking a checked
radio button means it remains checked.</li><li><span class="code">eRadioNullable</span> - same as <span class="code">eRadio</span>
except that all buttons can be unchecked in a group.</li></ul><p>
The other properties in the control can be modified at any time:
</p><ul><li><span class="code">Caption</span> - Gets/sets the button's caption text.</li><li><span class="code">IconIndex</span> - Gets/sets the zero-based index of the icon 
in an ImageList which will be used to render this button.  Set to -1 for no icon.</li><li><span class="code">ColorBox</span> - When <span class="code">IconIndex</span> is -1,
a colour box can be shown instead.  Get/set the colour to draw with this property.  For
no colour box, set the property to <span class="code">CLR_NONE (= -1)</span>.</li><li><span class="code">ToolTip</span> - Gets/sets the tooltip text that will be displayed
when the user hovers over the button with the mouse.</li><li><span class="code">ShortcutKey</span> - Gets/sets the shortcut key to be used to click
the button.  Use in combination with <span class="code">ShortcutModifiers</span>.  Set to 
0 if no shortcut key for the button is wanted.</li><li><span class="code">ShortcutModifiers</span> - Gets/sets the shortcut modifiers (shift key
combination) to be used to click the button.  Use in combination with <span class="code">ShortcutKey</span>.</li><li><span class="code">Bar</span> - Gets/sets the <span class="code">cCommandBar</span> 
that will be shown when the button is clicked (or, if the button's style is 

<span class="code">eSplit</span>, when the split button is clicked).</li><li><span class="code">Checked</span> - Gets/sets whether the button is checked or not. Only
valid for buttons with the <span class="code">eCheck</span>, <span class="code">eRadio</span>
or <span class="code">eRadioNullable</span> styles.</li><li><span class="code">Enabled</span> - Gets/sets whether the button is enabled or not.</li><li><span class="code">Locked</span> - similar to enabled, except the button's image and
text is not greyed out when <span class="code">Locked = True</span>.</li><li><span class="code">Visible</span> - Gets/sets whether this button is visible or not.</li><li><span class="code">ShowCaptionInToolbar</span> - Gets/sets whether the text associated
with the button is displayed when the button is associated with a command bar that is 
being displayed as a Toolbar.  By default, toolbars do not display text unless the toolbar
is configured as the <span class="code">MainMenu</span> for an application.</li><li><span class="code">ShowDropDownInToolbar</span> - Gets/sets whether a drop-down arrow
is shown next to the button when it is displayed in a toolbar.  By default, drop-down
arrows are not shown.  This property has no effect for <span class="code">eSplit</span>
style buttons.</li><li><span class="code">PanelControl</span> - Gets/sets the control associated with this
button. Only valid if the button has the <span class="code">ePanel</span> style.</li><li><span class="code">PanelWidth</span> - Gets/sets the width for the control associated
with this button. Only valid if the button has the <span class="code">ePanel</span> style.</li><li><span class="code">Key</span> - Gets the key for this button.</li><li><span class="code">Tag</span> - Gets/sets a string value associated with this button.</li><li><span class="code">ItemData</span> - Gets/sets a long value associated with this button.</li></ul><h3>2. Bars</h3><p>
A <span class="code">CommandBar</span> has three properties:
</p><ul><li><span class="code">Title</span> - Gets/sets the name of the command bar. This will
be used when the bar is undocked and in customise menus.</li><li><span class="code">Buttons</span> - Gets the <span class="code">cCommandBarButtons</span>
collection of buttons associated with this bar.</li><li><span class="code">Key</span> - Gets the key for the command bar.</li></ul><h3>3. The vbalCommandBar Controls</h3><p>
In addition to providing access to the global button and bar collections, the
command bar control is also responsible for displaying toolbars <span class="i">and menus</span>
on the screen.  As VB lacks a simple way to instantiate a new control and have it added
to its own container from within a control, command bar controls make requests to 
their containers for new instances.  Since controls which display menus also raise click
events, this means it is always best to use command bar controls in a control array.
</p><p>
Once the instance(s) of the CommandBar have been created, you can start setting
the properties and styles of the command bars to display.  There are four style
settings which can be used in the control, and in three of the styles all the colours
that are used can be customised.  Note that styles and colours are global and setting
them in one command bar control instance will affect all others.  The following
images show the different styles of the CommandBar:
</p><ul><li><span class="code">eOffice2003</span> Style<br /><img src="office2003stylexp.png" width="390" height="163" alt="Office 2003 Style with XP Visual Styles" /><p class="caption">Office 2003 Style with XP Visual Styles</p><img src="office2003styleclassic.png" width="390" height="163" alt="Office 2003 Style under Windows Classic" /><p class="caption">Office 2003 Style under Windows Classic</p></li><li><span class="code">eOfficeXP</span> Style<br /><img src="officexpstyle.png" width="390" height="163" alt="Office XP Style" /><p class="caption">Office XP Style</p></li><li><span class="code">eComCtl32</span> Style<br /><img src="comctl32style.png" width="390" height="163" alt="System Common Controls Style" /><p class="caption">System Common Controls Style under XP</p></li><li><span class="code">eMoney</span> Style<br /><img src="msmoneystyle.png" width="390" height="163" alt="MS Money Style" /><p class="caption">MS Money Style</p></li></ul><p>
Styles are set using the <span class="code">Style</span> property, and the colours used
in the style can be customised using the <span class="code">CustomColor</span>, 
<span class="code">StyleColor</span> and <span class="code">UseStyleColor</span> properties.
</p><p>
Each CommandBar has two Image Lists associated with it (note that these are not currently
global properties but probably will be so in the next release), the 
<span class="code">ToolBarImageList</span> and the <span class="code">MenuImageList</span>.
These may be set to point to the same image list if desired.  The properties can be set
to a Microsoft Windows Common Controls ImageList or any ImageList based on ComCtl32.DLL that 
exposes a <span class="code">hImageList</span> property.
</p><p>
If the command bar control is to be used as the main menu in the application, set the
<span class="code">MainMenu</span> property to <span class="code">True</span>.  This
configures the control so it will wrap onto a new line when the form is resized, and
it also changes the background to the toolbar to the correct style for the menu.
</p><p>
Any toolbar can have a background image, and this image can be Image Processed using
the built in image modification properties.  The background image can be set using the
<span class="code">BackgroundImage</span> property and the hue, luminance or saturation
can be modified using <span class="code">AdjustBackgroundImage</span>.  There is also
a method <span class="code">AdjustImage</span> which can apply the same effects 
to any picture.
</p><p>
To set the control to show a particular bar, set the <span class="code">Toolbar</span>
property.  This takes a <span class="code">cCommandBar</span> object, or <span class="code">Nothing</span> to stop the control displaying a bar.  The orientation of the toolbar
is configured using the <span class="code">Orientation</span> property, and the control
can also be <span class="code">Align</span>ed to any side of a form.
</p><h2>To Do List</h2><p>
The following features are due to be implemented for the full release, due at the beginning
of March:
</p><ul><li>Docking container control and chevrons support.</li><li>MDI Form support (Excel- and Word- style).</li><li>Command bar borders.</li><li>Infrequently-used menu items.</li><li>Shadowing of the highlight around a button when a menu is shown (currently only
the menu shadow is shown).</li><li>Menu shadow sometimes renders incorrectly on NT/Win9x/ME systems (it picks up
elements of the previous menu that was displayed).</li><li>Menu open animations.</li><li>Configurable sizing mode and button priority.</li><li>Themed combo box drop-down controls.</li><li>Owner-draw buttons.</li><li>Right-aligned buttons.</li></ul><p>
In the meantime, send any bug reports and I will do my best to fix them.
</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\libraries\compression\index.html" ><IMG SRC="..\..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">Command Bar</a>&#160;.&#160;vbAccelerator CommandBar Control</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2004 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 1 February 2004</p></td><td></td></tr></table>
</body></html>
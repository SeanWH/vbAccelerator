<html lang="en" >
<head>

<title>vbAccelerator - vbAccelerator ListView Control</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="This control provides an alternative to the VB ListView control and adds support for
almost all of the new ComCtl32.DLL v6.0 features that are missing from the VB version: 
ListView grouping, Tile view with configurable sub-items, Multiple Work Areas and more.
" /><link rel="stylesheet" href="..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\index.html">Code</a>&#160;.&#160;<a href="..\index.asp\index.html">Controls</a>&#160;.&#160;vbAccelerator ListView Control</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_listview_control.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 ListView Control</a> (84K)</p><p class="nav"><a href="vb5_listview_demonstration.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 ListView Demonstration</a> (200K)</p><p class="nav"><a href="vb5_listview_full_source.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 ListView Full Source</a> (344K)</p><p /><p class="nav"><a href="vb6_listview_control.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 ListView Control</a> (85K)</p><p class="nav"><a href="vb6_listview_demonstration.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 ListView Demonstration</a> (196K)</p><p class="nav"><a href="vb6_listview_full_source.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 ListView Full Source</a> (341K)</p><br /><br /><img src="..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:4089</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\linkto_asp\id=4089&type=article&title=vbaccelerator_20listview_20control.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav"><a href="bugtrak.html">BugTrak</a></p><p class="nav"><a href="bugtrak.html#bugs"><img src="..\..\..\..\res\btbug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 8 / 16</p><p class="nav"><a href="bugtrak.html#issues"><img src="..\..\..\..\res\btissue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 8 / 11</p><p class="nav"><a href="bugtrak.html#questions"><img src="..\..\..\..\res\btquestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:8 February 2004</p>
<br /><br /><img src="..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\res\update.png" width="8" height="8" alt="Update" />20 Jun 2003<br /><p class="update">Bug fixes and minor enhancements to the control:</p><p class="update">The <span class="code">Selected</span> property of
a ListItem always returned false, meaning it was impossible to 
determine which items were selected in a multi-select ListView.
Corrected. Same problem with the <span class="code">ItemCut</span>
property.</p><p class="update"><span class="code">Icon</span> property of ListItem set
the icon of the next item along in the control.  Fixed.</p><p class="update"><span class="code">Position</span> property added to the 
ColumnHeader object to allow the order of the column headers to be read
and set programmatically.</p><p class="update">Insert before parameter to the <span class="code">Add</span> method
of the ListItems collection was ignored.  Corrected.</p><p class="update">Setting a column alignment to right caused the column to be
centred, and vice-versa. Fixed.</p><p class="update">Mouse Up events were only generated for double-clicks.  Now
corrected.</p><p class="update">A <span class="code">KeyDown</span> event was generated when
a <span class="code">KeyUp</span> should have been.  Fixed</p><p class="update">Option to place the background image at a specified location
rather than tile it added.</p><p class="update"><span class="code">NoColumnHeaders</span> property added to
allow column headers to be hidden in Detail view.</p><p class="update">Added a call to <span class="code">LoadLibrary</span> on 
Shell32.DLL to prevent crashes when using a manifest.</p><p class="update">Thanks to Ben Andersen, Ian Goodwin, Vasanth Raj, Greg Thomson,
Frank Peters for the bug reports and code.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\libraries\xp_visual_styles\making_vb_apply_visual_styles_at_design_and_debug_time\article.html">Making VB Apply XP Visual Styles at Design and Debug Time</a></p><p class="nav"><img src="..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\libraries\xp_visual_styles\using_xp_visual_styles_in_vb\article.html">Adding XP Visual Styles to Your Visual Basic Application</a></p><p class="nav"><img src="..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\type_libraries\ole_guid_and_interface_definitions\article.html">Ole Guid and interface definitions (OleGuids.Tlb) </a></p><p class="nav"><img src="..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\imagelist\vbaccelerator_image_list_control\article.html">vbAccelerator ImageList Control and Class v2.0</a></p><p class="nav"><img src="..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\type_libraries\ishellfolder\article.html">IShellFolder Extended Type Library Version 1.2 (ISHF_Ex.Tlb)</a></p><br /><br /><img src="..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator ListView Control</h1><p class="splash">Use the latest ListView features</p><img src="listview.png" width="288" height="179" alt="ListView Control" /><p /><p>This control provides an alternative to the VB ListView control and adds support for
almost all of the new ComCtl32.DLL v6.0 features that are missing from the VB version: 
ListView grouping, Tile view with configurable sub-items, Multiple Work Areas and more.
</p><h2>ListView Control Features</h2><p>The ListView control object model is shown below:</p><img src="listviewobjectmodel.png" width="278" height="570" /><p><strong><small>ListView Object Model</small></strong></p><p>Here's a brief tour of features of these objects:</p><h3>The Control</h3><p>The <i>vbalListViewCtl</i> control provides access to the various object
collections, raises events and also lets you configure the visual properties of the
control.  Most of these are standard, however some notable features are:</p><ul><li><i>View</i> property supports Tile mode.</li><li><i>ImageList</i> property allows you to associate up to five image lists with
the control: Tile, Large Icon, Small Icon, Header and State images.  If you don't 
specify a Tile ImageList then the LargeIcon image list is used.
Please note that MSCOMCTL.OCX (VB6 Windows Common Controls) ImageLists are 
not supported as the <i>hImageList</i> handle returned by this object is incorrect.  This
may be resolved in the future by an update from Microsoft (see KB).</li></ul><h3>cListItem</h3><p>The <i>cListItem</i> object allows you to configure ListItems.  Notable features are that
you can add items to groups using the <i>Group</i> method.</p><h3>cSubItem</h3><p>The <i>cSubItem</i> object lets you configure the subitem text and image, and whether it
displays in the Tile View using the <i>ShowInTile</i> property.  When adding subitems to a 
tile, the items are displayed in the order that the <i>ShowInTile</i> property is called,
and the number of items that are actually shown is configured using the control's
<i>TileViewItemLines</i> property (whether everything is displayed depends on the 
available size of the tile).</p><h3>cItemGroup</h3><p>The <i>cItemGroup</i> allows you to configure groups added to the ListView.  Once you've
added a group you can specify whether it should be a Header or a Footer by using the 
<i>GroupType</i> property, specify the text alignment using the <i>Align</i> property
and check whether the group is displayed or collapsed using the <i>State</i> property.
Note when using groups that you can specify whether groups are enabled or disabled
using the <i>Enabled</i> property of the <i>cItemGroups</i> collection and that if groups
are enabled, only those items which have been added to groups are displayed.</p><h3>cWorkArea</h3><p>ListView work areas allow you to create multiple regions in the ListView for grouping
objects together.  Once you've added a WorkArea, you can move an item into it either by
dragging or by using the ListItems <i>Left</i> and <i>Top</i> properties to place it
in the region.  Note WorkAreas do not clip the ListItems within them.  This means that
if you place too many items into an area for the size of the region, they just spill out
off the bottom of the WorkArea.</p><h2>Linking to ComCtl32.DLL v6.0</h2><p>If you want to use new features like Tile View and Grouping then you will need
to link your application to ComCtl32.DLL v6.0 using a Manifest.  This is described
in the articles <a href="..\..\libraries\xp_visual_styles\using_xp_visual_styles_in_vb\article.html">Using Visual Styles</a> 
and <a href="..\..\libraries\xp_visual_styles\making_vb_apply_visual_styles_at_design_and_debug_time\article.html">Making Visual Styles apply at design and debug-time</a>.  Note that ComCtl32.DLL is only
available on Windows XP or above.</p><p class="tip"><strong>Important</strong> If you are running on a pre-XP system, then 
    you will need to wrap calls to the <span class="code">Groups</span> collection in 
    an error handler, since this object will return <span class="code">Nothing</span>.    
    </p><h2>EOE</h2><p>There are a few omissions with the control at this point which are still
being researched:</p><ul><li>State Icon Images not supported.</li><li>Should be able to automatically create group headers in a sorted ListView.</li><li>Insertion point marker in an AutoArrange ListView not displayed during dragging.</li><li>Dragging multiple items in a multi-select ListView is not supported.</li><li>Automatic drag-drop mode not automatic.</li><li>Text is currently set using ANSI APIs</li><li>Owner Custom-Draw of items is not provided for.</li></ul><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\vbmedia\using_gdi_plus\index.html" ><IMG SRC="..\..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\index.html">Code</a>&#160;.&#160;<a href="..\index.asp\index.html">Controls</a>&#160;.&#160;vbAccelerator ListView Control</p><br /><p class="nav"><a href="..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 1 July 2003</p></td><td></td></tr></table>
</body></html>

<html lang="en" >
<head>

<title>vbAccelerator - vbAccelerator ImageList Control and Class v2.0</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="As a number of my controls require image list support (Rebar and Toolbar control, Tab Control, S-Grid, Icon Menu Control, 
ActiveX Popup Menu DLL, Owner Drawn ComboEx Control and the Owner Drawn Combo and List box Control), it was about time 
I provided an Image List control to support them, so you don't have to distribute 590kb of COMCTL32.OCX just to get images 
in your app." /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ImageList</a>&#160;.&#160;vbAccelerator ImageList Control and Class v2.0</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="imagelist_class_example__vb5_or_vb6.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />ImageList Class Example, VB5 or VB6</a> (57K)</p><p class="nav"><a href="imagelist_control_documentation.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />ImageList Control Documentation</a> (2K)</p><p /><p class="nav"><a href="vb5_imagelist_control_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 ImageList Control Binary</a> (33K)</p><p class="nav"><a href="vb5_imagelist_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 ImageList Demonstration</a> (89K)</p><p class="nav"><a href="vb5_imagelist_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 ImageList Full Source</a> (153K)</p><p /><p class="nav"><a href="vb6_imagelist_control_binary.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 ImageList Control Binary</a> (32K)</p><p class="nav"><a href="vb6_imagelist_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 ImageList Demonstration</a> (56K)</p><p class="nav"><a href="vb6_imagelist_full_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 ImageList Full Source</a> (121K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:2</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=2&type=article&title=vbaccelerator_20imagelist_20control_20and_20class_20v2_2e0.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav"><a href="bugtrak.html">BugTrak</a></p><p class="nav"><a href="bugtrak.html#bugs"><img src="..\..\..\..\..\res\btbug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 6 / 6</p><p class="nav"><a href="bugtrak.html#issues"><img src="..\..\..\..\..\res\btissue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 0 / 0</p><p class="nav"><a href="bugtrak.html#questions"><img src="..\..\..\..\..\res\btquestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:6 February 2004</p>
<br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />29 Mar 2003<br /><p class="update">Fixed all problems with inconsistent indexes being returned by 
the methods. Indexes returned by the control are now <i>always</i> 1-based.  The
<i>ItemPicture</i> method consequently now works correctly.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\system_image_list\article.html">Using the System Image List with (and without) vbAccelerator Controls</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\displaying_alpha_(32bit)_icons_with_imagelists\article[1].html">Displaying Alpha (32bit) Icons with ImageLists</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator ImageList Control and Class v2.0</h1><p class="splash">Use COMCTL32.DLL directly to create an ImageList and take full control of icons at all colour depths and sizes.</p><img src="ilsiprop.gif" width="206" height="202" alt="ImageList Control Property Page" /><p /><p>As a number of my controls require image list support (Rebar and Toolbar control, Tab Control, S-Grid, Icon Menu Control, 
ActiveX Popup Menu DLL, Owner Drawn ComboEx Control and the Owner Drawn Combo and List box Control), it was about time 
I provided an Image List control to support them, so you don't have to distribute 590kb of COMCTL32.OCX just to get images 
in your app.</p><p>
Well here it is. I completed the control, and it has a full design-time interface (see above) with a number of new features 
which you will probably find very useful if you're used to the MS version. But, having done it I was alarmed to discover 
than my OCX was <i>131kb</i>! The problem is with this control is you need nice serialisation code and property page support 
otherwise it isn't any use. But the penalty of this is that you are bound to end up with something heavier than if you go 
the code-only route. </p><p>Another option if you are interested in lean, serious code is to get all the functionality from a class, which will add 
just 30kb of code to your project. There's no subclassing or hooky API calls, so there's no danger of making your project 
unstable in the IDE by adding it. You can load all the icons in one go from a picture strip containing all the images in series 
(stored as a file or a resource bitmap). The control version lets you create a picture strip and save it and then you ditch 
the control and use the class instead. A bit of an expensive use of a control, but anyway...</p><p>Note that this control isn't a direct replacement for the Common Controls version. You can't directly attach it to a 
MS TreeView or ListView etc and get that to work. It does, however, directly attach to all the vbAccelerator controls that 
require an ImageList (note that they also support the MS ImageList). Just pass the return value of the <i>hIml</i> property to the 
relevant ImageList method.</p><h2>Features</h2><p>The features of this image list control are:</p><ul><li>Add all images at the same time from a picture containing a strip of images. Also, the image list has a method 
which creates a picture strip from icons added in. Images can be loaded easily from files, resources, bitmap handles 
or VB Picture objects.</li><li>No icon size/colour depth restriction. If you have icons that are 24x24 in millions of colours, the ImageList will 
load them, unlike the VB/COM StdPicture object which first stretches them to 32x32, reduces the colour depth to 16 colours 
and then squashes them back to 24x24!<br /><strong>Updated!</strong> the previous version could fail to pick the correct icon size from multi-resource icons, 
leading to stretching or squashing. The closest size match is now used.</li><li>Specify the colour depth the ImageList should run in. Lower colour depths mean less resource usage, higher depths mean better icons!</li><li>At design time, you can clear the images, or change their order without having to add/ remove each one separately.</li><li>Image draw method supports drawing icons in normal, selected, dithered with specified colour and disabled modes.</li><li>Swap or make copies of images in the image list.</li><li>Get a real API hIcon from any image in the image list, regardless of what format it was originally added in. This function 
will make for a great icon editor! Just remember to call <i>DestroyIcon</i> on the <i>hIcon</i> returned when you've finished with it...</li><li><strong>New!</strong> Add .CUR (cursor) and .ANI (animated cursor) files to the Image List. If you import an animated cursor, you get the 
option of importing all frames or just the first one.</li><li><strong>New!</strong> A much better user interface for the control version:<br />
Set up keys at design time - optionally you can have the key automatically set based on the filename of the image you 
are adding, which can be a great time saver.<br /> 
Add multiple files from the File Open dialog.<br />
Choose whether the control automatically determines the transparent colour of bitmaps you are adding, 
or choose the transparent colour using a Colour Picker dialog (rather than having to remember the correct RGB value..) <br /></li></ul><p>To get a feel for the methods and use of the image list, download one 
of the sample files and check it out.</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="javascript:window.alert(&quot;http://vbaccelerator.com/home/include/adredir.asp?url=http://oneandone.co.uk/xml/init?k_id=5791003&image=http://oneandone.co.uk/xml/banner?size=1&number=2\nThis link was not retrieved.&quot;)" ><IMG SRC="..\..\..\..\..\..\..\oneandone_co_uk\xml\banner\size=1&number=2.html" ALT="1&1 Web Hosting" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ImageList</a>&#160;.&#160;vbAccelerator ImageList Control and Class v2.0</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 1 April 2003</p></td><td></td></tr></table>
</body></html>

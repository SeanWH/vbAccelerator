<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: frmIlsEffects.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmIlsEffects.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ImageList</a>&#160;.&#160;<a href="article[1].html">Displaying Alpha (32bit) Icons with ImageLists</a>&#160;.&#160;<a href="image_list_and_alpha_icons[1].html">Image List and Alpha Icons</a>&#160;.&#160;frmIlsEffects.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="image_list_and_alpha_icons[1].html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Image List and Alpha Icons</a> (111K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:3409</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=3409&type=zip&title=image_20list_20and_20alpha_20icons_2ezip_5ffrmilseffects.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />15 Jan 2002<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\xp_visual_styles\making_vb_apply_visual_styles_at_design_and_debug_time\article.html">Making VB Apply XP Visual Styles at Design and Debug Time</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\xp_visual_styles\using_xp_visual_styles_in_vb\article.html">Adding XP Visual Styles to Your Visual Basic Application</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\system_image_list\article.html">Using the System Image List with (and without) vbAccelerator Controls</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\vbaccelerator_image_list_control\article.html">vbAccelerator ImageList Control and Class v2.0</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmIlsEffects.frm</h1><pre>VERSION 5.00
Begin VB.Form frmIlsEffects 
   BackColor       =   &amp;H80000005&amp;
   Caption         =   "Alpha Icon Test"
   ClientHeight    =   5295
   ClientLeft      =   60
   ClientTop       =   450
   ClientWidth     =   7845
   Icon            =   "frmIlsEffects.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   5295
   ScaleWidth      =   7845
   StartUpPosition =   3  'Windows Default
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   495
      Left            =   180
      TabIndex        =   0
      Top             =   4680
      Width           =   1095
   End
End
Attribute VB_Name = "frmIlsEffects"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Type IMAGELISTDRAWPARAMS
    cbSize As Long
    hIml As Long
    i As Long
    hdcDst As Long
    x As Long
    y As Long
    cX As Long
    cY As Long
    xBitmap As Long
    yBitmap As Long
    rgbBk As Long
    rgbFg As Long
    fStyle As Long
    dwRop As Long
    fState As Long
    Frame As Long
    crEffect As Long
End Type

Public Enum ImageListStateConstants
   ILS_NORMAL = &amp;H0&amp; 'The image state is not modified.
   ILS_GLOW = &amp;H1&amp; ' Adds a glow effect to the icon, which causes the icon to
    appear to glow with a given color around the edges. The color for the glow
    effect is passed to the IImageList::Draw method in the crEffect member of
    IMAGELISTDRAWPARAMS.
   ILS_SHADOW = &amp;H2&amp; 'Adds a drop shadow effect to the icon. The color for the
    drop shadow effect is passed to the IImageList::Draw method in the crEffect
    member of IMAGELISTDRAWPARAMS.
   ILS_SATURATE = &amp;H4&amp; ' Saturates the icon by increasing each color component
    of the RGB triplet for each pixel in the icon. The amount to increase is
    indicated by the frame member in the IMAGELISTDRAWPARAMS method.
   ILS_ALPHA = &amp;H8&amp; ' Alpha blends the icon. Alpha blending controls the
    transparency level of an icon, according to the value of its alpha channel.
    The value of the alpha channel is indicated by the frame member in the
    IMAGELISTDRAWP
End Enum

Private Declare Function ImageList_DrawIndirect Lib "COMCTL32.DLL" ( _
    pimldp As IMAGELISTDRAWPARAMS) As Long
    
Private Const ILD_IMAGE = &amp;H20&amp;
Private Const ILD_PRESERVEALPHA = &amp;H1000&amp;
Private Const CLR_NONE = -1

Private m_cIml As cVBALImageList

Private Sub loadIcons()
Dim sDir As String
Dim sStartDir As String
   sStartDir = App.Path
   If (Right$(sStartDir, 1) &lt;&gt; "\") Then sStartDir = sStartDir &amp; "\"
   sDir = Dir(sStartDir &amp; "*.ico", vbNormal)
   Do While (sDir &lt;&gt; "")
      m_cIml.AddFromFile sStartDir &amp; sDir, IMAGE_ICON
      sDir = Dir
   Loop
End Sub

Private Sub Command1_Click()
Dim i As Long
Dim idp As IMAGELISTDRAWPARAMS
   Me.Cls
   
   idp.cbSize = Len(idp)
   idp.hIml = m_cIml.hIml
   idp.hdcDst = Me.hdc
   idp.rgbBk = CLR_NONE
   idp.fState = ILD_PRESERVEALPHA Or ILD_IMAGE
   
   For i = 1 To m_cIml.ImageCount
      
      ' draw standard:
      m_cIml.DrawImage i, Me.hdc, (i - 1) * (m_cIml.IconSizeX + 4) + 4, 4
      
      idp.x = (i - 1) * (m_cIml.IconSizeX + 4) + 4
      idp.y = 4
      idp.i = i - 1
      
      ' saturate (only ever seems to result in unsaturated image?)
      idp.y = idp.y + (m_cIml.IconSizeY + 4)
      idp.fState = ILS_SATURATE
      idp.Frame = -128
      ImageList_DrawIndirect idp
            
      ' glow (does not appear to work)
      'idp.x = idp.x + (m_cIml.IconSizeX + 2)
      'idp.fState = ILS_GLOW
      'idp.crEffect = &amp;HFFFFFF
      'ImageList_DrawIndirect idp
      
      ' shadow (does not appear to work)
      'idp.x = idp.x + (m_cIml.IconSizeX + 2)
      'idp.fState = ILS_SHADOW
      'idp.crEffect = &amp;HFF0000
      'ImageList_DrawIndirect idp
      
      ' alpha (does not appear to work)
      'idp.x = idp.x + (m_cIml.IconSizeX + 2)
      'idp.fState = ILS_ALPHA
      'idp.Frame = 128
      'ImageList_DrawIndirect idp
      
      ' draw selected:
      m_cIml.DrawImage i, Me.hdc, (i - 1) * (m_cIml.IconSizeX + 4) + 4, 4 +
       (m_cIml.IconSizeY + 4) * 2, True
      
      ' draw cut:
      m_cIml.DrawImage i, Me.hdc, (i - 1) * (m_cIml.IconSizeX + 4) + 4, 4 +
       (m_cIml.IconSizeY + 4) * 3, , True
   
   
   Next i
End Sub

Private Sub Form_Load()
   Dim sPic As String
   sPic = App.Path
   If (Right$(sPic, 1) &lt;&gt; "\") Then sPic = sPic &amp; "\"
   sPic = sPic &amp; "droplets.jpg"
   Set Me.Picture = LoadPicture(sPic)
   
   Set m_cIml = New cVBALImageList
   m_cIml.IconSizeX = 48
   m_cIml.IconSizeY = 48
   m_cIml.ColourDepth = ILC_COLOR32
   m_cIml.Create
   
   loadIcons
   
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\..\index.html" ><IMG SRC="..\..\..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">ImageList</a>&#160;.&#160;<a href="article[1].html">Displaying Alpha (32bit) Icons with ImageLists</a>&#160;.&#160;<a href="image_list_and_alpha_icons[1].html">Image List and Alpha Icons</a>&#160;.&#160;frmIlsEffects.frm</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
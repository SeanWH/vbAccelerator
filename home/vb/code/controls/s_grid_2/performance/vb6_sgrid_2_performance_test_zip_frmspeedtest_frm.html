<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: frmSpeedTest.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmSpeedTest.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">S Grid 2</a>&#160;.&#160;<a href="article.html">SGrid 2.0 Performance</a>&#160;.&#160;<a href="vb6_sgrid_2_performance_test.html">VB6 SGrid 2 Performance Test</a>&#160;.&#160;frmSpeedTest.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_sgrid_2_performance_test.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 SGrid 2 Performance Test</a> (24K)</p><p /><p class="nav"><a href="vb6_sgrid_2_performance_test.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 SGrid 2 Performance Test</a> (22K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:14123</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=14123&type=zip&title=vb6_20sgrid_202_20performance_20test_2ezip_5ffrmspeedtest.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />9 Jan 2004<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\s_grid_2\article.html">SGrid 2.0</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\s_grid\article.html">vbAccelerator S-Grid Control</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmSpeedTest.frm</h1><pre>VERSION 5.00
Object = "{DE8CE233-DD83-481D-844C-C07B96589D3A}#1.1#0"; "vbalSGrid6.ocx"
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Object = "{0ECD9B60-23AA-11D0-B351-00A0C9055D8E}#6.0#0"; "MSHFLXGD.OCX"
Begin VB.Form frmSpeedTest 
   Caption         =   "vbAccelerator SGrid 2.0 Performance Tester"
   ClientHeight    =   9495
   ClientLeft      =   3540
   ClientTop       =   2190
   ClientWidth     =   6540
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmSpeedTest.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   9495
   ScaleWidth      =   6540
   Begin VB.CommandButton cmdClear 
      Caption         =   "&amp;Clear"
      Height          =   315
      Left            =   5220
      TabIndex        =   7
      Top             =   7260
      Width           =   1215
   End
   Begin vbAcceleratorSGrid6.vbalGrid grdResults 
      Height          =   1695
      Left            =   120
      TabIndex        =   6
      Top             =   7680
      Width           =   6315
      _ExtentX        =   11139
      _ExtentY        =   2990
      BackgroundPictureHeight=   0
      BackgroundPictureWidth=   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      DisableIcons    =   -1  'True
   End
   Begin MSHierarchicalFlexGridLib.MSHFlexGrid grdMS 
      Height          =   2295
      Left            =   120
      TabIndex        =   4
      Top             =   4920
      Width           =   6315
      _ExtentX        =   11139
      _ExtentY        =   4048
      _Version        =   393216
      _NumberOfBands  =   1
      _Band(0).Cols   =   2
   End
   Begin MSComctlLib.ListView lvwTest 
      Height          =   2295
      Left            =   120
      TabIndex        =   3
      Top             =   120
      Width           =   6315
      _ExtentX        =   11139
      _ExtentY        =   4048
      View            =   3
      LabelWrap       =   -1  'True
      HideSelection   =   -1  'True
      _Version        =   393217
      ForeColor       =   -2147483640
      BackColor       =   -2147483643
      BorderStyle     =   1
      Appearance      =   1
      NumItems        =   0
   End
   Begin vbAcceleratorSGrid6.vbalGrid grdTest 
      Height          =   2295
      Left            =   120
      TabIndex        =   2
      Top             =   2520
      Width           =   6315
      _ExtentX        =   11139
      _ExtentY        =   4048
      BackgroundPictureHeight=   0
      BackgroundPictureWidth=   0
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      DisableIcons    =   -1  'True
   End
   Begin VB.CommandButton cmdTest 
      Caption         =   "&amp;Test"
      Height          =   315
      Left            =   3960
      TabIndex        =   1
      Top             =   7260
      Width           =   1215
   End
   Begin VB.TextBox txtRows 
      Height          =   315
      Left            =   2340
      TabIndex        =   0
      Text            =   "1000"
      Top             =   7260
      Width           =   1515
   End
   Begin VB.Label Label4 
      BackStyle       =   0  'Transparent
      Caption         =   "Number of Rows to Test:"
      Height          =   255
      Left            =   120
      TabIndex        =   5
      Top             =   7320
      Width           =   2415
   End
End
Attribute VB_Name = "frmSpeedTest"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Declare Function timeGetTime Lib "winmm.dll" () As Long
Private Declare Function timeBeginPeriod Lib "winmm.dll" (ByVal uPeriod As
 Long) As Long
Private Declare Function timeEndPeriod Lib "winmm.dll" (ByVal uPeriod As Long)
 As Long

Private Const mcCOLS = 10
Private m_iRows As Long

Private Sub ConfigureListView()
Dim i As Long
   With lvwTest
      .ListItems.Clear
      .ColumnHeaders.Clear
      For i = 1 To mcCOLS
         .ColumnHeaders.Add , , "Col" &amp; i
      Next i
   End With
End Sub

Private Function TestAppendListView() As Long
Dim i As Long
Dim j As Long
Dim lT As Long
Dim itmX As ListItem
   lT = timeGetTime
   With lvwTest
      For i = 1 To m_iRows
         Set itmX = .ListItems.Add(, , "Row" &amp; i &amp; ";Col 1")
         For j = 2 To mcCOLS
            itmX.SubItems(j - 1) = "Row" &amp; i &amp; ";Col" &amp; j - 1
         Next
      Next
   End With
   TestAppendListView = timeGetTime - lT
End Function

Private Function TestInsertListView() As Long
Dim i As Long
Dim j As Long
Dim lT As Long
Dim itmX As ListItem
   lT = timeGetTime
         
   ' Add first row
   With lvwTest
      i = 1
      Set itmX = .ListItems.Add(, , "Row" &amp; i &amp; ";Col 1")
      For j = 2 To mcCOLS
         itmX.SubItems(j - 1) = "Row" &amp; i &amp; ";Col" &amp; j - 1
      Next
      
      For i = 2 To m_iRows
         Set itmX = .ListItems.Add(i, , "Row" &amp; i &amp; ";Col 1")
         For j = 2 To mcCOLS
            itmX.SubItems(j - 1) = "Row" &amp; i &amp; ";Col" &amp; j - 1
         Next
      Next
   End With
   TestInsertListView = timeGetTime - lT
   
End Function

Private Function TestDeleteStartListView() As Long
Dim i As Long
Dim lT As Long
   lT = timeGetTime
   With lvwTest.ListItems
      For i = .Count To 1 Step -1
         .Remove 1
      Next i
   End With
   TestDeleteStartListView = timeGetTime - lT
End Function

Private Function TestDeleteEndListView() As Long
Dim i As Long
Dim lT As Long
   lT = timeGetTime
   With lvwTest.ListItems
      For i = .Count To 1 Step -1
         .Remove i
      Next i
   End With
   TestDeleteEndListView = timeGetTime - lT
End Function

Private Sub ConfigureSGrid()
Dim i As Long
   With grdTest
      .Clear True
      For i = 1 To mcCOLS
         .AddColumn , "Col" &amp; i
      Next i
   End With
End Sub

Private Function TestAppendSGrid() As Long
Dim i As Long
Dim j As Long
Dim lT As Long
   lT = timeGetTime
   With grdTest
      .Redraw = False
      .Rows = m_iRows
      For i = 1 To m_iRows
         For j = 1 To mcCOLS
            .CellText(i, j) = "Row" &amp; i &amp; ";Col" &amp; j
         Next
      Next
      .Redraw = True
   End With
   TestAppendSGrid = timeGetTime - lT
End Function

Private Function TestInsertSGrid() As Long
Dim i As Long
Dim j As Long
Dim lT As Long
   lT = timeGetTime
   With grdTest
      .Redraw = False
      ' Add first row
      .AddRow
      i = 1
      For j = 1 To mcCOLS
         .CellText(i, j) = "Row" &amp; i &amp; ";Col" &amp; j
      Next
      
      For i = 2 To m_iRows
         .AddRow 1
         For j = 1 To mcCOLS
            .CellText(1, j) = "Row" &amp; i &amp; ";Col" &amp; j
         Next
      Next
      .Redraw = True
   End With
   TestInsertSGrid = timeGetTime - lT
End Function

Private Function TestDeleteStartSGrid() As Long
Dim i As Long
Dim lT As Long
   lT = timeGetTime
   With grdTest
      .Redraw = False
      For i = .Rows To 1 Step -1
         .RemoveRow 1
      Next i
      .Redraw = True
   End With
   TestDeleteStartSGrid = timeGetTime - lT
End Function

Private Function TestDeleteEndSGrid() As Long
Dim i As Long
Dim lT As Long
   lT = timeGetTime
   With grdTest
      .Redraw = False
      For i = .Rows To 1 Step -1
         .RemoveRow i
      Next i
      .Redraw = True
   End With
   TestDeleteEndSGrid = timeGetTime - lT
End Function

Private Function configureFlexGrid()
Dim i As Long
   With grdMS
      .Cols = mcCOLS
      .FixedCols = 0
      .FixedRows = 0
      .Rows = m_iRows + 1
      .Row = 0
      For i = 1 To mcCOLS
         .Col = i - 1
         .Text = "Col" &amp; i
      Next i
   End With
End Function

Private Function TestAppendFlexGrid() As Long
Dim i As Long
Dim j As Long
Dim lT As Long
   lT = timeGetTime
   With grdMS
      .Redraw = False
      .Rows = m_iRows
      For i = 2 To m_iRows
         For j = 1 To mcCOLS
            .Row = i - 1
            .Col = j - 1
            .Text = "Row" &amp; i &amp; ";Col" &amp; j
         Next
      Next
      .Redraw = True
   End With
   TestAppendFlexGrid = timeGetTime - lT
End Function
Private Function TestInsertFlexGrid() As Long
Dim lT As Long
Dim i As Long
Dim j As Long

   lT = timeGetTime
   
   With grdMS
      .Redraw = False
      
      ' Add first row:
      .Row = 0
      For i = 1 To mcCOLS
         .Col = i - 1
         .Text = "Col" &amp; i
      Next i
      
      For i = 2 To m_iRows
         .AddItem "Row " &amp; i &amp; ";Col" &amp; j, 0
         For j = 2 To mcCOLS
            .Row = 0
            .Col = j - 1
            .Text = "Row" &amp; i &amp; ";Col" &amp; j
         Next j
      Next i
      
      .Redraw = True
   End With
   
   TestInsertFlexGrid = timeGetTime - lT
   
End Function
Private Function TestDeleteStartFlexGrid() As Long
Dim i As Long
Dim lT As Long
   lT = timeGetTime
   With grdMS
      .Redraw = False
      For i = .Rows To 2 Step -1 ' Cannot delete last row
         .RemoveItem 1
      Next i
      .Redraw = True
   End With
   TestDeleteStartFlexGrid = timeGetTime - lT
End Function
Private Function TestDeleteEndFlexGrid() As Long
Dim i As Long
Dim lT As Long
   lT = timeGetTime
   With grdMS
      .Redraw = False
      For i = .Rows To 1 Step -1 ' Cannot delete last row
         .RemoveItem i
      Next i
      .Redraw = True
   End With
   TestDeleteEndFlexGrid = timeGetTime - lT
End Function

Private Sub cmdClear_Click()
   grdResults.Clear
End Sub

Private Sub cmdTest_Click()
Dim lRow As Long
      
   m_iRows = CLng(txtRows.Text)
   timeBeginPeriod 1
   
   grdResults.AddRow
   lRow = grdResults.Rows
   grdResults.CellText(lRow, 1) = m_iRows
   grdResults.CellText(lRow, 2) = "ListView (MSCOMCTL.OCX)"
   runListViewTests lRow
   
   grdResults.AddRow
   lRow = grdResults.Rows
   grdResults.CellText(lRow, 1) = m_iRows
   grdResults.CellText(lRow, 2) = "SGrid 2.0 (vbalSGrid.OCX)"
   runSGridTests lRow
   
   grdResults.AddRow
   lRow = grdResults.Rows
   grdResults.CellText(lRow, 1) = m_iRows
   grdResults.CellText(lRow, 2) = "Flex Grid (MSHFLXGD.OCX)"
   runFlexGridTests lRow
      
   timeEndPeriod 1
   
End Sub

Private Sub runListViewTests(ByVal lResultRow As Long)
   
   ' Append
   grdResults.CellText(lResultRow, 3) = TestAppendListView()
   ' Delete start
   grdResults.CellText(lResultRow, 6) = TestDeleteStartListView()
   ' Insert
   grdResults.CellText(lResultRow, 4) = TestInsertListView()
   ' Delete end
   grdResults.CellText(lResultRow, 5) = TestDeleteEndListView()
   
End Sub
Private Sub runSGridTests(ByVal lResultRow As Long)
   
   ' Append
   grdResults.CellText(lResultRow, 3) = TestAppendSGrid()
   ' Delete start
   grdResults.CellText(lResultRow, 6) = TestDeleteStartSGrid()
   ' Insert
   grdResults.CellText(lResultRow, 4) = TestInsertSGrid()
   ' Delete end
   grdResults.CellText(lResultRow, 5) = TestDeleteEndSGrid()
   
End Sub
Private Sub runFlexGridTests(ByVal lResultRow As Long)
   
   ' Append
   grdResults.CellText(lResultRow, 3) = TestAppendFlexGrid()
   ' Delete start
   grdResults.CellText(lResultRow, 6) = TestDeleteStartFlexGrid()
   ' Insert
   grdResults.CellText(lResultRow, 4) = TestInsertFlexGrid()
   ' Delete end
   grdResults.CellText(lResultRow, 5) = TestDeleteEndFlexGrid()

End Sub

Private Function ResultsCsv() As String
Dim lRow As Long
Dim lCol As Long
Dim sCSV As String
   With grdResults
      For lRow = 1 To .Rows
         If (lRow &gt; 1) Then
            sCSV = sCSV &amp; vbCrLf
         End If
         For lCol = 1 To .Columns
            If (lCol &gt; 1) Then
               sCSV = sCSV &amp; ","
            End If
            sCSV = sCSV &amp; grdResults.CellText(lRow, lCol)
         Next lCol
      Next lRow
   End With
   ResultsCsv = sCSV
End Function


Private Sub Form_Load()
   
   With grdResults
      
      .AddColumn "Rows", "Rows"
      .AddColumn "Control", "Control"
      .AddColumn "Append", "Append Rows"
      .AddColumn "Insert", "Insert Rows"
      .AddColumn "DeleteEnd", "Delete From End"
      .AddColumn "Delete", "Delete From Start"
                  
      .AllowGrouping = True
      .HideGroupingBox = True
                  
   End With
   
   ConfigureListView
   ConfigureSGrid
   configureFlexGrid
   
End Sub

Private Sub Form_Resize()
On Error Resume Next
   lvwTest.Width = Me.ScaleWidth - lvwTest.Left * 2
   grdTest.Width = Me.ScaleWidth - grdTest.Left * 2
   grdMS.Width = Me.ScaleWidth - grdMS.Left * 2
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\vbmedia\using_gdi_plus\index.html" ><IMG SRC="..\..\..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\index.html">S Grid 2</a>&#160;.&#160;<a href="article.html">SGrid 2.0 Performance</a>&#160;.&#160;<a href="vb6_sgrid_2_performance_test.html">VB6 SGrid 2 Performance Test</a>&#160;.&#160;frmSpeedTest.frm</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2004 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 1 February 2004</p></td><td></td></tr></table>
</body></html>
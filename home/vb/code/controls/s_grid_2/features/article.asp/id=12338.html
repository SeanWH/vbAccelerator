<html lang="en" >
<head>

<title>vbAccelerator - S-Grid 2.0 Features</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="
This article provides a rundown of the new features and updates provided in S-Grid 2.0, 
and also shows samples of the types of displays that can be set up using the control.
" /><link rel="stylesheet" href="../../../../../res/screen.css" codebase="..\..\..\..\..\..\res\"  media="SCREEN" /><link rel="stylesheet" href="../../../../../res/print.css" codebase="..\..\..\..\..\..\res\"  media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\..\index.html">S Grid 2</a>&#160;.&#160;S-Grid 2.0 Features</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:13697</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\..\linkto_asp\id=13697&type=article&title=s_2dgrid_202_2e0_20features.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />24 Jan 2004<br />First Posted</p><br /><br /><img src="..\..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\libraries\hooks\vbaccelerator_hook_library\article.html">Win32 Hooks in VB - The vbAccelerator Hook Library</a></p><p class="nav"><img src="..\..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\performance\article.html">SGrid 2.0 Performance</a></p><p class="nav"><img src="..\..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\techniques\a_fast_index-based_object_collection\article.html">A Fast Index-Based Collection</a></p><p class="nav"><img src="..\..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\s_grid\article.html">vbAccelerator S-Grid Control</a></p><br /><br /><img src="..\..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>S-Grid 2.0 Features</h1><img src="..\tasklist.png" width="314" height="196" alt="S-Grid 2.0 Task List Demonstration" /><p /><p>
This article provides a rundown of the new features and updates provided in S-Grid 2.0, 
and also shows samples of the types of displays that can be set up using the control.
</p><h2>Changes and Bug Fixes Compared to S-Grid 1</h2><p>
S-Grid 2.0 offers a wealth of new features, performance improvements and
fixes some bugs with the previous version.  The changes are as follows:
</p><ol><li><strong>New Features and Behaviours</strong><ul><li><span class="code">AllowGrouping</span> property allows Outlook-style hierarchical
grouping of data, complete with drag-drop grouping using the column headers.
The grouping area can also be made invisible and groupings set up programmatically.</li><li><span class="span">SplitRow</span> property allows one or more rows to be fixed within 
the grid so they always display at the top of the grid.</li><li>Determining when Edit mode is exited is now done using a 
<a href="id=12338.html">Windows Mouse Hook</a>, and
activation loss is detected using the <span class="code">WM_ACTIVATEAPP</span>
message.  This makes entering and exiting edit mode much more robust.</li><li>A <span class="code">PreCancelEdit</span> event is now offered, allowing validation
of data prior to leaving edit mode.</li><li>The new <span class="code">SingleClickEdit</span> property allows the grid to 
automatically enter edit mode whenever a cell is selected.</li><li>Hot-Tracking of grid cells can be enabled using the <span class="code">HotTrack</span>
property.</li><li>Marquee-style selection is now supported for multi-select grids in row-mode.</li><li>MouseWheel scrolling is now supported.</li><li>System colour/display change events are now detected and colours updated 
accordingly.</li><li>Columns can be set to have fixed width using the <span class="code">bFixedWidth</span>
parameter of the <span class="code">AddColumn</span> method which prevents them
from being resized.</li></ul></li><li><strong>Appearance</strong><ul><li>Customised owner-drawn cells can now be created by implementing 
the <span class="code">IGridCellOwnerDraw</span> interface.</li><li>Grid lines are now more customisable: horizontal or vertical grid lines can be
switched of using the <span class="code">NoHorizontalGridLines</span> and 
<span class="code">NoVerticalGridLines</span> properties.</li><li>The <span class="code">GridLineMode</span> can be set to auto-fill grid lines 
in any spaces in the control.</li><li>A separate ImageList can now be specified for the Header.</li><li>VB6 ImageLists are now supported (although not for the header).</li><li>The out-of-focus highlight foreground and background colours can be set.</li><li>The Selection rectangle can be alpha-blended and/or outlined with the
background colour.</li><li>Alternate row background colour can be set.</li><li>XP styles/manifests now supported without needing to use
the <a href="..\..\..\..\libraries\xp_visual_styles\preventing_crashes_at_shutdown\article.html">hack to prevent shutdown crashes</a>.</li></ul></li><li><strong>Performance</strong><p>
The control now allocates row data memory in chunks and 
uses row indirection to the main data in the grid.  Row indexes are 
inserted and deleted from their array using the CopyMemory technique
described <a href="..\..\..\..\techniques\a_fast_index-based_object_collection\article.html">here</a> for performance.  
</p><ul><li>Sorting is 2 - 10x faster as only the row pointers are sorted, not the data.</li><li>Inserting and removing rows is 10x faster as only the row pointers need to be changed.</li><li>Addition of items performs the same if rows are preallocated using the
<span class="code">Rows</span> property, if not it can be up to 100% faster.</li></ul><p>
More performance information, including comparisons with ListViews and FlexGrids, is 
available in the <a href="..\..\performance\article.html">S-Grid 2 Performance</a> article.
</p></li><li><strong>Bug Fixes</strong><ul><li>Scroll bars appear when control is first shown.</li><li>Control now draws correctly when it is wider than a single screen (previously it was
truncated).</li><li>When using the left and right arrow keys in row mode, the control no longer 
tries to scroll when the scroll bars are hidden.</li><li>The display has been tightened up to fix focus rectangle and selection box positioning.</li><li>The grid now fits exactly into the space, rather than having a border between 
its edge and the scroll bars.</li><li>Right clicking in the control used to cause the selection to be cleared. Now the 
control maintains the selection if you right click into it, otherwise the 
new cell is selected. This mirrors the behaviour of Outlook.</li><li>The middle mouse button is now ignored by default (previously it acted as if it 
was the left mouse button).</li><li>Text drawing now uses the Unicode API calls under NT and above.</li><li>The control is no longer an ActiveX Control Container and hence can be used
in applications which do not support these types of controls.</li></ul></li></ol><h2>Display samples</h2><p>
These images show some of the displays you can achieve using S-Grid 2.0:
</p><img src="..\standard.png" width="412" height="170" alt="Standard S-Grid 2.0 Rendering." /><p class="caption">Standard S-Grid 2.0 Rendering</p><br /><img src="..\horizontalgridlines.png" width="412" height="171" alt="Horizontal Grid Lines." /><p class="caption">With Horizontal GridLines only</p><br /><img src="..\verticalgridlines.png" width="412" height="171" alt="Vertical Grid Lines." /><p class="caption">With Vertical GridLines only</p><br /><img src="..\alternaterows.png" width="411" height="167" alt="Alternate Row Colours" /><p class="caption">Using the AlternateRowColour property</p><br /><img src="..\backgroundbitmap.png" width="416" height="170" alt="Background Bitmap" /><p class="caption">With a Background Image</p><br /><img src="..\hierarchicalgrouping.png" width="412" height="185" alt="Outlook-Style Grouping" /><p class="caption">With Outlook-Style Grouping enabled</p><br /><img src="..\fontsandcolours.png" width="257" height="287" alt="Fonts and Colours" /><p class="caption">Each cell can have its own font and/or colours</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\..\..\index.html" ><IMG SRC="..\..\..\..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="..\..\index.html">S Grid 2</a>&#160;.&#160;S-Grid 2.0 Features</p><br /><p class="nav"><a href="..\..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2004 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 1 February 2004</p></td><td></td></tr></table>
</body></html>
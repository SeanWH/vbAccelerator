<html lang="en" >
<head>
<title>vbAccelerator - Sizing SGrid so ScrollBars do now appear</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="The SGrid control is an all-VB grid which can emulate the Outlook messages list, including grouping of messages and message preview. The highly optimised display code makes this grid draw faster than FlexGrid and other VB grids even while it allows more sophisticated displays to be set up. It is also a good replacement for a ListView in report mode." /><link rel="stylesheet" href="..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\res\print.css" media="PRINT" /><link rel="SHORTCUT ICON" href="/home/res/vbaccel.ico" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\index.html">Code</a>&#160;.&#160;<a href="..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="article.html">vbAccelerator S-Grid Control</a>&#160;.&#160;<a href="bugtrak.html">BugTrak Summary</a>&#160;.&#160;Sizing SGrid so ScrollBars do now appear</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="s-grid_documentation.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />S-Grid Documentation</a> (5K)</p><p /><p class="nav"><a href="vb5_control_binary.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Control Binary</a> (103K)</p><p class="nav"><a href="vb5_demonstration_project.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Demonstration Project</a> (87K)</p><p class="nav"><a href="vb5_full_source_code.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Full Source Code</a> (266K)</p><p /><p class="nav"><a href="vb6_control_binary.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Control Binary</a> (103K)</p><p class="nav"><a href="vb6_demonstration_project.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Demonstration Project</a> (66K)</p><p class="nav"><a href="vb6_full_source_code.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Full Source Code</a> (232K)</p><br /><br /><img src="..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:11</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\linkto_asp\id=11&type=article&title=vbaccelerator_20s_2dgrid_20control.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav"><a href="bugtrak.html">BugTrak</a></p><p class="nav"><a href="bugtrak.html#bugs"><img src="..\..\..\..\res\btbug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 6 / 10</p><p class="nav"><a href="bugtrak.html#issues"><img src="..\..\..\..\res\btissue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 4 / 9</p><p class="nav"><a href="bugtrak.html#questions"><img src="..\..\..\..\res\btquestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:7 February 2004</p>
<br /><br /><img src="..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\res\update.png" width="8" height="8" alt="Update" />1 Nov 1999<br />
A new VB6 binary of the control is available, courtesy of Glenn Halbedl. Thanks! Plus a new VB5 compile including 13 minor bug fixes and changes to the control.
    </p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\imagelist\vbaccelerator_image_list_control\article.html">vbAccelerator ImageList Control and Class v2.0</a></p><br /><br /><img src="..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>Sizing SGrid so ScrollBars do now appear</h1><h2>Summary</h2><table class="article"><tr><td>Id:</td><td>11.13</td></tr><tr><td>Type:</td><td><img src="..\..\..\..\res\btissue.png" width="16" height="16" alt="Issue" />&#160;Issue</td></tr><tr><td>Current Status:</td><td>Open</td></tr></table><h2>Detail</h2><table class="article"><tr class="header"><td>15&#160;Mar&#160;2003</td><td>Open</td><td width="100%">Jeff Hedlund</td></tr><tr><td colspan="3"><p>Is there a way to resize the sgrid depending on the presence of a scrollbar?  I did some testing and did not see a way.  What I'm trying to do is display a single row.  This works great without scrollbars. But if the user resizes a column the scroll bars appear and then the row is hidden.</p><p>The alternative is to make room for the scroll bar, but then there is a blank white spot when there is no scroll bar.</p><p>I've also noticed this (which appears to be a bug):  getting rid of the bottom scroll bar *with a right scrollbar* requires me to pad extra width on the control, so you can see a little past the last [visible] column.</p><p>These things are both always something of a problem in controls which may or may not have a scroll bar.  </p></td></tr><tr class="header"><td>9&#160;Nov&#160;2003</td><td>Open</td><td width="100%">Steve McMahon</td></tr><tr><td colspan="3"><p>There isn't currently a method which you can use to ensure that the grid is autosized to display a certain row (or number of rows) regardless of whether the bottom scroll bar is displayed or not. Possible options (other than leaving room for the scroll bar) are:</p><p>1) Prevent the user from resizing columns</p><p>2) Respond to column sizing changes and check if the grid is displaying a scroll bar.  If it is, add the height of the scroll bar to the control, otherwise remove it.  </p><p>The way to do the second is as follows.</p><p>Firstly, you can detect if there is a scroll bar using code like this (really there should be properties which do this automatically):</p><pre>  lStyle = GetWindowLong(grd.hWnd, GWL_STYLE)
  If (lStyle And WS_HSCROLL) = WS_HSCROLL Then
     ' grid has horizontal scroll
  End If
  If (lStyle And WS_VSCROLL) = WS_VSCROLL Then
     ' grid has vertical scroll
End If
 
</pre><p>With that info, you can now determine the extra room in the control required for the scroll bar using the GetSystemMetrics call using SM_CYHSCROLL (vertical size of horizontal scroll bar) and SM_CXVSCROLL (horizontal size of vertical scroll bar).</p><p>As for the second bug, I will look into it.</p></td></tr></table><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\index.html" ><IMG SRC="..\..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\index.html">Code</a>&#160;.&#160;<a href="..\index.asp\index.html">Controls</a>&#160;.&#160;<a href="article.html">vbAccelerator S-Grid Control</a>&#160;.&#160;<a href="bugtrak.html">BugTrak Summary</a>&#160;.&#160;Sizing SGrid so ScrollBars do now appear</p><br /><p class="nav"><a href="..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 9 November 2003</p></td><td></td></tr></table>
</body></html>
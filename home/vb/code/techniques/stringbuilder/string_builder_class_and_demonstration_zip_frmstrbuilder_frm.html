<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: frmStrBuilder.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmStrBuilder.frm" /><link rel="stylesheet" href="..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\index.html">Code</a>&#160;.&#160;<a href="..\index.html">Techniques</a>&#160;.&#160;<a href="article.html">StringBuilder Class for VB</a>&#160;.&#160;<a href="string_builder_class_and_demonstration.html">String Builder Class and Demonstration</a>&#160;.&#160;frmStrBuilder.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="string_builder_class_and_demonstration.html"><img src="..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />String Builder Class and Demonstration</a> (15K)</p><br /><br /><img src="..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:2503</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\linkto_asp\id=2503&type=zip&title=string_20builder_20class_20and_20demonstration_2ezip_5ffrmstrbuilder.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav"><a href="bugtrak.html">BugTrak</a></p><p class="nav"><a href="bugtrak.html#bugs"><img src="..\..\..\..\res\btbug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 0 / 1</p><p class="nav"><a href="bugtrak.html#issues"><img src="..\..\..\..\res\btissue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 2 / 2</p><p class="nav"><a href="bugtrak.html#questions"><img src="..\..\..\..\res\btquestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:12 November 2003</p>
<br /><br /><img src="..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\res\update.png" width="8" height="8" alt="Update" />1 Jan 2003<br />First Posted</p><br /><br /><img src="..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><br /><br /><img src="..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmStrBuilder.frm</h1><pre>VERSION 5.00
Begin VB.Form frmStrBuilder 
   Caption         =   "String Builder Demonstration"
   ClientHeight    =   3345
   ClientLeft      =   3210
   ClientTop       =   2010
   ClientWidth     =   5760
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmStrBuilder.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   3345
   ScaleWidth      =   5760
   Begin VB.CommandButton cmdOtherTest 
      Caption         =   "Other Tests"
      Height          =   435
      Left            =   1080
      TabIndex        =   7
      Top             =   2280
      Width           =   1335
   End
   Begin VB.OptionButton optType 
      Caption         =   "Use String&amp;Builder Class"
      Height          =   255
      Index           =   1
      Left            =   1080
      TabIndex        =   6
      Top             =   1260
      Width           =   2415
   End
   Begin VB.OptionButton optType 
      Caption         =   "&amp;Standard VB Strings"
      Height          =   255
      Index           =   0
      Left            =   1080
      TabIndex        =   5
      Top             =   1020
      Value           =   -1  'True
      Width           =   2415
   End
   Begin VB.CommandButton cmdGo 
      Caption         =   "&amp;Go"
      Default         =   -1  'True
      Height          =   375
      Left            =   1080
      TabIndex        =   4
      Top             =   1620
      Width           =   1335
   End
   Begin VB.TextBox txtAppend 
      Height          =   315
      Left            =   1080
      TabIndex        =   3
      Text            =   "http://vbaccelerator.com"
      Top             =   420
      Width           =   4515
   End
   Begin VB.TextBox txtIterations 
      Height          =   315
      Left            =   1080
      TabIndex        =   1
      Text            =   "1000"
      Top             =   60
      Width           =   1995
   End
   Begin VB.Label lblAppend 
      Caption         =   "&amp;Append:"
      Height          =   255
      Left            =   60
      TabIndex        =   2
      Top             =   480
      Width           =   1635
   End
   Begin VB.Label lblIterations 
      Caption         =   "&amp;Iterations:"
      Height          =   255
      Left            =   60
      TabIndex        =   0
      Top             =   120
      Width           =   1635
   End
End
Attribute VB_Name = "frmStrBuilder"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Declare Function timeGetTime Lib "winmm.dll" () As Long
Private Declare Function timeBeginPeriod Lib "winmm.dll" (ByVal uPeriod As
 Long) As Long
Private Declare Function timeEndPeriod Lib "winmm.dll" (ByVal uPeriod As Long)
 As Long
Private m_lT As Long

Private Sub StandardAppend(ByVal sAppend As String, ByVal lCount As Long)
Dim l As Long
Dim sTheString As String
   StartTiming
   For l = 1 To lCount
      sTheString = sTheString &amp; sAppend
   Next l
   MsgBox "Standard Method:" &amp; EndTiming, vbInformation
   'Debug.Print sTheString
End Sub

Private Sub ClassAppend(ByVal sAppend As String, ByVal lCount As Long)
Dim l As Long
Dim cTheString As New cStringBuilder
   StartTiming
   For l = 1 To lCount
      cTheString.Append sAppend
   Next l
   MsgBox "Class Method:" &amp; EndTiming, vbInformation
   'Debug.Print cTheString.ToString
End Sub

Private Sub StartTiming()
   timeBeginPeriod 1
   m_lT = timeGetTime
End Sub
Private Function EndTiming() As Long
   EndTiming = timeGetTime() - m_lT
   timeEndPeriod 1
End Function

Private Sub cmdGo_Click()
Dim sAppend As String
Dim lAppend As Long
On Error GoTo errorHandler
   sAppend = txtAppend.Text
   lAppend = CLng(txtIterations.Text)
   If optType(0).Value Then
      StandardAppend sAppend, lAppend
   Else
      ClassAppend sAppend, lAppend
   End If
   Exit Sub
errorHandler:
   MsgBox "Error: " &amp; Err.Description, vbInformation
   Exit Sub
End Sub

Private Sub cmdOtherTest_Click()
   Dim buf As New cStringBuilder
   buf.Append "http://vbaccelerator.com/"
   Debug.Print "'" &amp; buf.ToString &amp; "'"
   buf.Insert 7, "www."
   Debug.Print "'" &amp; buf.ToString &amp; "'"
   buf.Remove 7, 4
   Debug.Print "'" &amp; buf.ToString &amp; "'"
   Debug.Print buf.Find(".com")
   Dim i As Integer
   i = 1
   buf.AppendByVal i
   Debug.Print "'" &amp; buf.ToString &amp; "'"
   
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\libraries\compression\index.html" ><IMG SRC="..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\index.html">Code</a>&#160;.&#160;<a href="..\index.html">Techniques</a>&#160;.&#160;<a href="article.html">StringBuilder Class for VB</a>&#160;.&#160;<a href="string_builder_class_and_demonstration.html">String Builder Class and Demonstration</a>&#160;.&#160;frmStrBuilder.frm</p><br /><p class="nav"><a href="..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
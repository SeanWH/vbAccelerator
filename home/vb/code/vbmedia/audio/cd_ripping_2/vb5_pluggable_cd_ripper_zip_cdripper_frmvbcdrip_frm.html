<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: CDRipper_frmVBCDRip.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: CDRipper_frmVBCDRip.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /><link rel="SHORTCUT ICON" href="/home/res/vbaccel.ico" /><link rel="copyright" href="/home/The_Site/Copyright/article.asp" /><link rel="contents" href="./VB5_Pluggable_CD_Ripper.asp" /><link rel="meta" type="application/rdf+xml" href="./VB5 Pluggable CD Ripper.rdf" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">vbMedia</a>&#160;.&#160;<a href="..\index.html">Audio</a>&#160;.&#160;<a href="article.html">CD Ripping in VB Part 2</a>&#160;.&#160;<a href="vb5_pluggable_cd_ripper.html">VB5 Pluggable CD Ripper</a>&#160;.&#160;CDRipper_frmVBCDRip.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="vb5_cd_ripper_plugin_interface.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 CD Ripper Plugin Interface</a> (9K)</p><p class="nav"><a href="vb5_pluggable_cd_ripper.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Pluggable CD Ripper</a> (191K)</p><p /><p class="nav"><a href="vb6_cd_ripper_plugin_interface.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 CD Ripper Plugin Interface</a> (9K)</p><p class="nav"><a href="vb6_pluggable_cd_ripper.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Pluggable CD Ripper</a> (192K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:15192</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=15192&type=zip&title=vb5_20pluggable_20cd_20ripper_2ezip_5fcdripper_5ffrmvbcdrip.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />27 May 2004<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\controls\s_grid_2\s_grid_2\article.html">SGrid 2.0</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\controls\tab_controls\visual_studio_style_tab_control\article.html">vbAccelerator Visual Studio Style Tab Control</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\mp3_encoding_with_lame\article.html">MP3 Encoding with LAME</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\cd_ripping_1\article.html">CD Ripping in VB Part 1</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: CDRipper_frmVBCDRip.frm</h1><p>This file is part of the download <a href="vb5_pluggable_cd_ripper.html">VB5 Pluggable CD Ripper</a>, which is described in the article <a href="article.html">CD Ripping in VB Part 2</a>.</p><pre>VERSION 5.00
Object = "{3D811CB0-6F63-4CA8-BD1E-7858AC6C9A00}#5.6#0"; "vbalSGrid.ocx"
Begin VB.Form frmVBCDRip 
   Caption         =   "VB CD Ripper"
   ClientHeight    =   5865
   ClientLeft      =   3300
   ClientTop       =   2670
   ClientWidth     =   6705
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmVBCDRip.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   5865
   ScaleWidth      =   6705
   Begin VB.TextBox txtEdit 
      Height          =   315
      Left            =   840
      TabIndex        =   14
      Top             =   4980
      Visible         =   0   'False
      Width           =   1695
   End
   Begin VB.PictureBox pnlMain 
      Align           =   1  'Align Top
      BorderStyle     =   0  'None
      Height          =   4935
      Left            =   0
      ScaleHeight     =   4935
      ScaleWidth      =   6705
      TabIndex        =   0
      TabStop         =   0   'False
      Top             =   0
      Width           =   6705
      Begin VB.TextBox txtYear 
         Height          =   315
         Left            =   1140
         TabIndex        =   10
         Top             =   1260
         Width           =   2775
      End
      Begin VB.CheckBox chkCompilation 
         Caption         =   "&amp;Compilation"
         Height          =   255
         Left            =   3960
         TabIndex        =   6
         Top             =   540
         Width           =   1815
      End
      Begin VB.TextBox txtArtist 
         Height          =   315
         Left            =   1140
         TabIndex        =   5
         Top             =   540
         Width           =   2775
      End
      Begin VB.TextBox txtAlbum 
         Height          =   315
         Left            =   1140
         TabIndex        =   8
         Top             =   900
         Width           =   2775
      End
      Begin vbAcceleratorSGrid.vbalGrid grdTracks 
         Height          =   2835
         Left            =   60
         TabIndex        =   11
         Top             =   1620
         Width           =   6555
         _ExtentX        =   11562
         _ExtentY        =   5001
         BackgroundPictureHeight=   0
         BackgroundPictureWidth=   0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Tahoma"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         DisableIcons    =   -1  'True
      End
      Begin VB.ComboBox cboDrives 
         Height          =   315
         Left            =   1140
         Style           =   2  'Dropdown List
         TabIndex        =   2
         Top             =   60
         Width           =   4095
      End
      Begin VB.TextBox txtCDDBQuery 
         Height          =   315
         Left            =   1200
         TabIndex        =   13
         Tag             =   "WAITING"
         Top             =   4560
         Width           =   5295
      End
      Begin VB.CommandButton cmdRefresh 
         Caption         =   "&amp;Refresh"
         Height          =   315
         Left            =   5280
         TabIndex        =   3
         Top             =   60
         Width           =   1155
      End
      Begin VB.Label lblYear 
         Caption         =   "&amp;Year:"
         Height          =   255
         Left            =   60
         TabIndex        =   9
         Top             =   1320
         Width           =   1035
      End
      Begin VB.Label lblArtist 
         Caption         =   "Ar&amp;tist:"
         Height          =   255
         Left            =   60
         TabIndex        =   4
         Top             =   600
         Width           =   1035
      End
      Begin VB.Label lblAlbum 
         Caption         =   "&amp;Album"
         Height          =   255
         Left            =   60
         TabIndex        =   7
         Top             =   960
         Width           =   1035
      End
      Begin VB.Label lblDrives 
         Caption         =   "&amp;Drive:"
         Height          =   255
         Left            =   60
         TabIndex        =   1
         Top             =   120
         Width           =   1035
      End
      Begin VB.Label lblCDDBQuery 
         Caption         =   "CDDB &amp;Query:"
         Height          =   255
         Left            =   120
         TabIndex        =   12
         Top             =   4620
         Width           =   1095
      End
   End
   Begin VB.Menu mnuFileTOP 
      Caption         =   "&amp;File"
      Begin VB.Menu mnuFile 
         Caption         =   "&amp;Rip..."
         Index           =   0
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   1
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&amp;Configure..."
         Index           =   2
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   3
      End
      Begin VB.Menu mnuFile 
         Caption         =   "E&amp;xit"
         Index           =   4
      End
   End
   Begin VB.Menu mnuEditTop 
      Caption         =   "&amp;Edit"
      Begin VB.Menu mnuEdit 
         Caption         =   "&amp;Select All"
         Index           =   0
      End
      Begin VB.Menu mnuEdit 
         Caption         =   "&amp;Invert Selection"
         Index           =   1
      End
   End
   Begin VB.Menu mnuHelpTOP 
      Caption         =   "&amp;Help"
      Begin VB.Menu mnuHelp 
         Caption         =   "&amp;About..."
         Index           =   0
      End
   End
End
Attribute VB_Name = "frmVBCDRip"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private m_cRip As cCDRip
Private m_cToc As cToc

Private Sub ConfigureGrid()
   
   With grdTracks
      .Editable = True
      .SingleClickEdit = True
      .AddColumn "Selected", lColumnWidth:=20
      .AddColumn "Name", "Name"
      .AddColumn "Artist", "Artist"
      .AddColumn "Track", "Track", ecgHdrTextALignRight, sFmtString:="#0"
      .AddColumn "StartTime", "Start Time", ecgHdrTextALignRight
      .AddColumn "Length", "Length", ecgHdrTextALignRight
      .AddColumn "Size", "Size (Mb)", ecgHdrTextALignRight,
       sFmtString:="#0.00MB"
      .GridLines = True
      .GridLineMode = ecgGridFillControl
      .GridLineColor = BlendColor(vbHighlight, vbWindowBackground, 96)
      .GridFillLineColor = .GridLineColor
      .NoHorizontalGridLines = True
      .SelectionAlphaBlend = True
      .DrawFocusRectangle = False
      .SelectionOutline = True
      chkCompilation_Click
   End With
   
End Sub

Private Sub EnableControls(ByVal bState As Boolean)
Dim ctl As Control
Dim txt As TextBox
Dim chk As CheckBox
Dim cbo As ComboBox
Dim pic As PictureBox
Dim mnu As Menu
   
   For Each ctl In Controls
      If TypeOf ctl Is TextBox Then
         Set txt = ctl
         txt.Enabled = bState
         txt.BackColor = IIf(bState, vbWindowBackground, vbButtonFace)
      ElseIf TypeOf ctl Is ComboBox Then
         Set cbo = ctl
         cbo.Enabled = bState
         cbo.BackColor = IIf(bState, vbWindowBackground, vbButtonFace)
      ElseIf TypeOf ctl Is Menu Then
         Set mnu = ctl
         If InStr(mnu.Name, "TOP") = 0 Then
            If Trim(mnu.Caption) &lt;&gt; "-" Then
               mnu.Enabled = bState
            End If
         End If
      ElseIf TypeOf ctl Is Label Then
         ' do nothing
      Else
         ctl.Enabled = bState
      End If
   Next
   
   If (bState) Then
      chkCompilation_Click
   End If
   
End Sub

Private Sub ShowDrives()
Dim i As Long
   
   Set m_cRip = New cCDRip
   m_cRip.Create App.Path &amp; "\cdrip.ini" ' this INI file isn't used currently
   
   For i = 1 To m_cRip.CDDriveCount
      cboDrives.AddItem m_cRip.CDDrive(i).Name
   Next i
   
   If (cboDrives.ListCount &gt; 0) Then
      cboDrives.ListIndex = 0
   Else
      ShowTracks
   End If
      
End Sub

Private Sub ShowTracks()
Dim lIndex As Long
Dim sFnt As New StdFont
Dim bEnable As Boolean
Dim sCDDB As String
   
   lIndex = cboDrives.ListIndex + 1
   If (lIndex &gt; 0) Then
      ' Check if anything has changed:
      Dim cD As cDrive
      Set cD = m_cRip.CDDrive(lIndex)
      If (cD.IsUnitReady) Then
         sCDDB = cD.TOC.CDDBQuery
      End If
   End If
   
   If (sCDDB = txtCDDBQuery.Text) Then
      bEnable = (Len(sCDDB) &gt; 0)
   Else
      txtArtist.Tag = ""
      txtArtist.Text = ""
      txtAlbum.Text = ""
      txtYear.Text = ""
   
      sFnt.Name = "Marlett"
      sFnt.Size = 10
      
      grdTracks.Clear
      EnableControls False
         
      txtCDDBQuery.Text = ""
      Set m_cToc = Nothing
   
      If (lIndex &gt; 0) Then
         If (cD.IsUnitReady) Then
            
            Set m_cToc = cD.TOC
            txtCDDBQuery.Text = m_cToc.CDDBQuery
            
            Dim i As Long
            For i = 1 To m_cToc.Count
               grdTracks.AddRow
               With m_cToc.Entry(i)
                  grdTracks.CellDetails i, 1, "b", oFont:=sFnt, lItemData:=True
                  grdTracks.CellText(i, 2) = "Track " &amp; Format(.TrackNumber,
                   "00")
                  grdTracks.CellText(i, 3) = ""
                  grdTracks.CellDetails i, 4, .TrackNumber, DT_SINGLELINE Or
                   DT_VCENTER Or DT_RIGHT, oForeColor:=&amp;H808080
                  grdTracks.CellDetails i, 5, .FormattedStartTime,
                   DT_SINGLELINE Or DT_VCENTER Or DT_RIGHT, oForeColor:=&amp;H808080
                  grdTracks.CellDetails i, 6, .FormattedLength, DT_SINGLELINE
                   Or DT_VCENTER Or DT_RIGHT, oForeColor:=&amp;H808080
                  grdTracks.CellDetails i, 7, .SizeBytes / (1024&amp; * 1024&amp;),
                   DT_SINGLELINE Or DT_VCENTER Or DT_RIGHT, oForeColor:=&amp;H808080
               End With
               SelectRow i, True
            Next i
            
            bEnable = (m_cToc.Count &gt; 0)
            
         Else
            grdTracks.AddRow
            grdTracks.CellText(1, 2) = "No CD In Drive"
         End If
      Else
         grdTracks.AddRow
         grdTracks.CellText(1, 2) = "No CD Selected"
      End If
   End If
   
   EnableControls bEnable

   If Not (bEnable) Then
      ' Make sure can still access stuff
      pnlMain.Enabled = True
      cboDrives.Enabled = True
      cboDrives.BackColor = vbWindowBackground
      cmdRefresh.Enabled = True
      mnuFile(2).Enabled = True
      mnuHelp(0).Enabled = True
   Else
      If (grdTracks.Rows &gt; 0) Then
         grdTracks.CellSelected(1, 2) = True
      End If
   End If

End Sub

Private Sub cboDrives_Click()
   ShowTracks
End Sub

Private Sub chkCompilation_Click()
   '
   grdTracks.ColumnVisible(3) = (chkCompilation.Value = Checked)
   If (chkCompilation.Value) Then
      txtArtist.Tag = txtArtist.Text
      txtArtist.Text = "Various Artists"
   Else
      txtArtist.Text = txtArtist.Tag
   End If
   '
End Sub

Private Sub Configure()
   Dim fO As New frmOptions
   fO.CRRip = m_cRip
   fO.Show vbModal, Me
   If (cboDrives.ListCount &gt; 0) Then
      ' Reset active CD ROM
      cboDrives_Click
   End If
End Sub

Private Sub cmdRefresh_Click()
   ShowTracks
End Sub

Private Sub Rip()
Dim lIndex As Long
   
   lIndex = cboDrives.ListIndex + 1
   If (lIndex &gt; 0) Then
      
      Dim cD As cDrive
      Set cD = m_cRip.CDDrive(lIndex)
      If (cD.IsUnitReady) Then
   
         Dim fRip As New frmRipDialog
         fRip.Writer = PluginManagerInstance.WaveWriter
         
         fRip.OutputDir = App.Path
         fRip.RipTOC = m_cToc
         
         Dim lRow As Long
         Dim cT As cTrack
         For lRow = 1 To grdTracks.Rows
            If (grdTracks.CellItemData(lRow, 1)) Then
               
               Set cT = New cTrack
               cT.Init grdTracks.CellText(lRow, 4), _
                  grdTracks.CellText(lRow, 2), txtAlbum.Text, txtArtist.Text, _
                  IIf(chkCompilation.Value = vbChecked,
                   grdTracks.CellText(lRow, 3), txtArtist.Text), _
                  grdTracks.CellText(lRow, 4), txtYear.Text, ""
               
               fRip.AddTrack cT
               
            End If
         Next
         fRip.Icon = Me.Icon
         
         EnableControls False
                  
         fRip.Show , Me
         Me.Refresh
         DoEvents
                  
         On Error Resume Next
         fRip.RipSelected
         
         Dim lErr As Long, sErr As String
         lErr = Err.Number
         sErr = Err.Description
         If Not (Err.Number = 0) Then
            Unload fRip
            On Error GoTo 0
            MsgBox "An error occurred during ripping: " &amp; sErr, vbExclamation
         End If
         
         EnableControls True

      End If
      
   End If
End Sub

Private Sub Form_Load()
   
   ConfigureGrid
   
   Me.Show
   Me.Refresh
   
   ' Load default plugins
   With PluginManagerInstance
      .AddPlugin "vbalWaveDataWriter.cWavFileDataWriter"
      .AddPlugin "vbalMp3DataWriter.cMp3FileDataWriter"
      .SelectedPluginIndex = 2
   End With
   
   ShowDrives
   
End Sub

Private Sub Form_Resize()
   pnlMain.Height = Me.ScaleHeight
End Sub

Private Sub grdTracks_CancelEdit()
   '
   txtEdit.Visible = False
   '
End Sub

Private Sub grdTracks_PreCancelEdit(ByVal lRow As Long, ByVal lCol As Long,
 newValue As Variant, bStayInEditMode As Boolean)
   '
   grdTracks.CellText(lRow, lCol) = txtEdit.Text
   '
End Sub

Private Sub grdTracks_RequestEdit(ByVal lRow As Long, ByVal lCol As Long, ByVal
 iKeyAscii As Integer, bCancel As Boolean)
   '
   If (lCol = 2) Or (lCol = 3) Then
      
      Dim lLeft As Long
      Dim lTop As Long
      Dim lWidth As Long
      Dim lHeight As Long
      
      grdTracks.CellBoundary lRow, lCol, lLeft, lTop, lWidth, lHeight
      lLeft = lLeft + Screen.TwipsPerPixelX + grdTracks.Left
      lTop = lTop + 2 * Screen.TwipsPerPixelY + grdTracks.Top
      txtEdit.Move lLeft, lTop, lWidth, lHeight
      If (iKeyAscii &gt;= 32) Then
         txtEdit.Text = Chr(iKeyAscii)
         txtEdit.SelStart = 1
      Else
         txtEdit.Text = grdTracks.CellText(lRow, lCol)
         txtEdit.SelStart = 0
         txtEdit.SelLength = Len(txtEdit.Text)
      End If
      txtEdit.Visible = True
      txtEdit.ZOrder
      txtEdit.SetFocus
      bCancel = False
      
   Else
      If (lCol = 1) Then
         SelectRow lRow, Not (grdTracks.CellItemData(lRow, 1))
      End If
      
      bCancel = True
            
   End If
   '
End Sub

Private Sub SelectRow(ByVal lRow As Long, ByVal bCheck As Boolean)
Dim lCol As Long
Dim oColor As OLE_COLOR
   oColor = BlendColor(vbHighlight, vbWindowBackground, 32)
   grdTracks.Redraw = False
   grdTracks.CellItemData(lRow, 1) = bCheck
   grdTracks.CellText(lRow, 1) = IIf(bCheck, "b", "")
   For lCol = 1 To grdTracks.Columns
      If (bCheck) Then
         grdTracks.CellBackColor(lRow, lCol) = oColor
      Else
         grdTracks.CellBackColor(lRow, lCol) = -1
      End If
   Next lCol
   grdTracks.Redraw = True
End Sub

Private Sub mnuEdit_Click(Index As Integer)
Dim lRow As Long
   Select Case Index
   Case 0
      For lRow = 1 To grdTracks.Rows
         SelectRow lRow, True
      Next lRow
   Case 1
      For lRow = 1 To grdTracks.Rows
         SelectRow lRow, Not (grdTracks.CellItemData(lRow, 1))
      Next lRow
   End Select
End Sub

Private Sub mnuHelp_Click(Index As Integer)
   Select Case Index
   Case 0
      Dim fA As New frmAbout
      Dim sAck As String
      sAck = "This sample uses components from CDEx, Copyright  1999 Albert L.
       Faber and Monty (xiphmont@mit.edu).  "
      sAck = sAck &amp; "CDEx is released under the GNU General Public License and
       the source code is available from "
      sAck = sAck &amp; "http://cdexos.sourceforge.net."
      fA.Acknowledgements = sAck
      fA.Show vbModal, Me
   End Select
End Sub

Private Sub mnuFile_Click(Index As Integer)
   Select Case Index
   Case 0
      Rip
   Case 2
      Configure
   Case 4
      Unload Me
   End Select
End Sub

'Private Sub lvwTracks_Click()
'Dim itm As ListItem
'Dim bSelection As Boolean
'
'   For Each itm In lvwTracks.ListItems
'      If (itm.Selected) Then
'         bSelection = True
'      End If
'   Next
'   cmdRip.Enabled = bSelection
'
'End Sub

Private Sub pnlMain_Resize()
   '
   On Error Resume Next
   Dim lHeight As Long
   lHeight = pnlMain.ScaleHeight - grdTracks.Top - txtCDDBQuery.Height - 4 *
    Screen.TwipsPerPixelY
   grdTracks.Move grdTracks.Left, grdTracks.Top, pnlMain.ScaleWidth -
    grdTracks.Left * 2, lHeight
   cboDrives.Width = pnlMain.ScaleWidth - cboDrives.Left - cmdRefresh.Width - 2
    * Screen.TwipsPerPixelX - grdTracks.Left
   cmdRefresh.Left = cboDrives.Left + cboDrives.Width + 2 *
    Screen.TwipsPerPixelX
   lblCDDBQuery.Top = grdTracks.Top + grdTracks.Height + 2 *
    Screen.TwipsPerPixelY
   txtCDDBQuery.Move txtCDDBQuery.Left, lblCDDBQuery.Top, pnlMain.ScaleWidth -
    txtCDDBQuery.Left - grdTracks.Left
   '
End Sub

Private Sub txtEdit_KeyPress(KeyAscii As Integer)
   txtEdit.Tag = ""
   If (KeyAscii = 13) Then
      KeyAscii = 0
      grdTracks.EndEdit
      Dim lRow As Long
      Dim lCol As Long
      lRow = grdTracks.SelectedRow
      lCol = grdTracks.SelectedCol
      If (chkCompilation.Value = Checked) Then
         If (lCol = 2) Then
            grdTracks.CellSelected(lRow, 3) = True
            Exit Sub
         End If
      End If
      lRow = lRow + 1
      If (lRow &lt;= grdTracks.Rows) Then
         grdTracks.CellSelected(lRow, 2) = True
      End If
   ElseIf (KeyAscii = 27) Then
      grdTracks.CancelEdit
      KeyAscii = 0
   End If
End Sub

Private Sub txtEdit_LostFocus()
   grdTracks.CancelEdit
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\using_gdi_plus\index.html" ><IMG SRC="..\..\..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">vbMedia</a>&#160;.&#160;<a href="..\index.html">Audio</a>&#160;.&#160;<a href="article.html">CD Ripping in VB Part 2</a>&#160;.&#160;<a href="vb5_pluggable_cd_ripper.html">VB5 Pluggable CD Ripper</a>&#160;.&#160;CDRipper_frmVBCDRip.frm</p><br /><table style="font-size: 100%;"><tr><td valign="top"><a href="javascript:window.alert(&quot;http://creativecommons.org/licenses/by/1.0/\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\res\cc.png" width="88" height="31" alt="Creative Commons Licence" /></a></td></a></td><td valign="top"><p class="nav" style="padding-bottom: 4px;">All contents of this web site are licensed under a <a href="javascript:window.alert(&quot;http://creativecommons.org/licenses/by/1.0/\nThis link was not retrieved.&quot;)">Creative Commons Licence</a>, except where otherwise noted.</p><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2004 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>, vbAccelerator Ltd.<br />Last Updated: 12 June 2004</p></td></tr></table></td><td></td></tr></table>
</body></html>
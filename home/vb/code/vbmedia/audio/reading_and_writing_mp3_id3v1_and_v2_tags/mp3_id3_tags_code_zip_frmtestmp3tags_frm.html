<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: frmTestMp3Tags.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmTestMp3Tags.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /><link rel="SHORTCUT ICON" href="/home/res/vbaccel.ico" /><link rel="copyright" href="/home/The_Site/Copyright/article.asp" /><link rel="contents" href="./MP3_ID3_Tags_Code.asp" /><link rel="meta" type="application/rdf+xml" href="./MP3 ID3 Tags Code.rdf" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">vbMedia</a>&#160;.&#160;<a href="..\index.html">Audio</a>&#160;.&#160;<a href="article.html">Reading and Writing MP3 ID3v1 and ID3v2 Tags</a>&#160;.&#160;<a href="mp3_id3_tags_code.html">MP3 ID3 Tags Code</a>&#160;.&#160;frmTestMp3Tags.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="mp3_id3_tags_code.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />MP3 ID3 Tags Code</a> (44K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:15224</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=15224&type=zip&title=mp3_20id3_20tags_20code_2ezip_5ffrmtestmp3tags.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />15 Apr 2004<br /><p class="update">Fixed incorrect download - the ID3v1 tag class incorrectly contained the code
for the ID3v2 tags...</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmTestMp3Tags.frm</h1><p>This file is part of the download <a href="mp3_id3_tags_code.html">MP3 ID3 Tags Code</a>, which is described in the article <a href="article.html">Reading and Writing MP3 ID3v1 and ID3v2 Tags</a>.</p><pre>VERSION 5.00
Begin VB.Form frmTestMp3Tags 
   Caption         =   "vbAccelerator MP3 ID3v1 and ID3v2 Tag Reader and Writer"
   ClientHeight    =   9555
   ClientLeft      =   4155
   ClientTop       =   2220
   ClientWidth     =   8160
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmTestMp3Tags.frx":0000
   LinkTopic       =   "Form1"
   OLEDropMode     =   1  'Manual
   ScaleHeight     =   9555
   ScaleWidth      =   8160
   Begin VB.PictureBox picID3v2 
      BorderStyle     =   0  'None
      Height          =   5715
      Left            =   960
      ScaleHeight     =   5715
      ScaleWidth      =   6735
      TabIndex        =   17
      TabStop         =   0   'False
      Top             =   3240
      Width           =   6735
      Begin VB.ComboBox cboGenreV2 
         Height          =   315
         Left            =   900
         Sorted          =   -1  'True
         TabIndex        =   26
         Top             =   1380
         Width           =   1815
      End
      Begin VB.TextBox txtCommentV2 
         Height          =   1335
         Left            =   900
         MultiLine       =   -1  'True
         ScrollBars      =   2  'Vertical
         TabIndex        =   30
         Top             =   2100
         Width           =   5835
      End
      Begin VB.TextBox txtYearV2 
         Height          =   315
         Left            =   900
         MaxLength       =   4
         TabIndex        =   28
         Top             =   1740
         Width           =   1815
      End
      Begin VB.TextBox txtAlbumV2 
         Height          =   315
         Left            =   900
         TabIndex        =   24
         Top             =   1020
         Width           =   5835
      End
      Begin VB.TextBox txtTitleV2 
         Height          =   315
         Left            =   900
         TabIndex        =   22
         Top             =   660
         Width           =   5835
      End
      Begin VB.TextBox txtArtistV2 
         Height          =   315
         Left            =   900
         TabIndex        =   20
         Top             =   300
         Width           =   5835
      End
      Begin VB.TextBox txtTrack 
         Height          =   315
         Left            =   900
         MaxLength       =   4
         TabIndex        =   32
         Top             =   3480
         Width           =   1875
      End
      Begin VB.TextBox txtOriginalArtist 
         Height          =   315
         Left            =   900
         TabIndex        =   34
         Top             =   3840
         Width           =   5835
      End
      Begin VB.TextBox txtEncodedBy 
         Height          =   315
         Left            =   900
         TabIndex        =   40
         Top             =   4920
         Width           =   5835
      End
      Begin VB.TextBox txtLinkTo 
         Height          =   315
         Left            =   900
         TabIndex        =   42
         Top             =   5280
         Width           =   5835
      End
      Begin VB.TextBox txtComposer 
         Height          =   315
         Left            =   900
         TabIndex        =   36
         Top             =   4200
         Width           =   5835
      End
      Begin VB.TextBox txtCopyright 
         Height          =   315
         Left            =   900
         TabIndex        =   38
         Top             =   4560
         Width           =   5835
      End
      Begin VB.Label lblInfo 
         Caption         =   "Comment:"
         Height          =   255
         Index           =   6
         Left            =   60
         TabIndex        =   29
         Top             =   2160
         Width           =   795
      End
      Begin VB.Label lblInfo 
         Caption         =   "Year:"
         Height          =   255
         Index           =   7
         Left            =   60
         TabIndex        =   27
         Top             =   1800
         Width           =   795
      End
      Begin VB.Label lblInfo 
         Caption         =   "Genre:"
         Height          =   255
         Index           =   8
         Left            =   60
         TabIndex        =   25
         Top             =   1440
         Width           =   795
      End
      Begin VB.Label lblInfo 
         Caption         =   "Album:"
         Height          =   255
         Index           =   9
         Left            =   60
         TabIndex        =   23
         Top             =   1080
         Width           =   795
      End
      Begin VB.Label lblInfo 
         Caption         =   "Title:"
         Height          =   255
         Index           =   10
         Left            =   60
         TabIndex        =   21
         Top             =   720
         Width           =   855
      End
      Begin VB.Label lblInfo 
         Caption         =   "Artist:"
         Height          =   255
         Index           =   11
         Left            =   60
         TabIndex        =   19
         Top             =   360
         Width           =   795
      End
      Begin VB.Label lblInfo 
         Caption         =   "Track:"
         Height          =   255
         Index           =   12
         Left            =   60
         TabIndex        =   31
         Top             =   3540
         Width           =   795
      End
      Begin VB.Label lblInfo 
         Caption         =   "Org. Art.:"
         Height          =   255
         Index           =   13
         Left            =   60
         TabIndex        =   33
         Top             =   3900
         Width           =   795
      End
      Begin VB.Label lblInfo 
         Caption         =   "Encoded:"
         Height          =   255
         Index           =   14
         Left            =   60
         TabIndex        =   39
         Top             =   4980
         Width           =   795
      End
      Begin VB.Label lblInfo 
         Caption         =   "Link To:"
         Height          =   255
         Index           =   15
         Left            =   60
         TabIndex        =   41
         Top             =   5340
         Width           =   795
      End
      Begin VB.Label lblInfo 
         Caption         =   "Composer:"
         Height          =   195
         Index           =   16
         Left            =   60
         TabIndex        =   35
         Top             =   4260
         Width           =   795
      End
      Begin VB.Label lblInfo 
         Caption         =   "Copyright: (Yeah, Right)"
         Height          =   195
         Index           =   17
         Left            =   60
         TabIndex        =   37
         Top             =   4620
         Width           =   795
      End
      Begin VB.Label lblID3V2 
         BackColor       =   &amp;H80000010&amp;
         Caption         =   " ID3 v2 Tag Information"
         ForeColor       =   &amp;H80000014&amp;
         Height          =   255
         Left            =   0
         TabIndex        =   18
         Top             =   0
         Width           =   7515
      End
   End
   Begin VB.PictureBox picID3v1 
      BorderStyle     =   0  'None
      Height          =   2595
      Left            =   960
      ScaleHeight     =   2595
      ScaleWidth      =   6735
      TabIndex        =   3
      TabStop         =   0   'False
      Top             =   480
      Width           =   6735
      Begin VB.TextBox txtArtist 
         Height          =   315
         Left            =   900
         MaxLength       =   30
         TabIndex        =   6
         Top             =   300
         Width           =   5835
      End
      Begin VB.TextBox txtTitle 
         Height          =   315
         Left            =   900
         MaxLength       =   30
         TabIndex        =   8
         Top             =   660
         Width           =   5835
      End
      Begin VB.TextBox txtAlbum 
         Height          =   315
         Left            =   900
         MaxLength       =   30
         TabIndex        =   10
         Top             =   1020
         Width           =   5835
      End
      Begin VB.TextBox txtYear 
         Height          =   315
         Left            =   900
         MaxLength       =   4
         TabIndex        =   14
         Top             =   1740
         Width           =   1815
      End
      Begin VB.TextBox txtComment 
         Height          =   315
         Left            =   900
         MaxLength       =   30
         TabIndex        =   16
         Top             =   2100
         Width           =   5835
      End
      Begin VB.ComboBox cboGenre 
         Height          =   315
         Left            =   900
         Sorted          =   -1  'True
         Style           =   2  'Dropdown List
         TabIndex        =   12
         Top             =   1380
         Width           =   1815
      End
      Begin VB.Label lblInfo 
         Caption         =   "Artist:"
         Height          =   255
         Index           =   0
         Left            =   60
         TabIndex        =   5
         Top             =   360
         Width           =   795
      End
      Begin VB.Label lblInfo 
         Caption         =   "Title:"
         Height          =   255
         Index           =   1
         Left            =   60
         TabIndex        =   7
         Top             =   720
         Width           =   855
      End
      Begin VB.Label lblInfo 
         Caption         =   "Album:"
         Height          =   255
         Index           =   2
         Left            =   60
         TabIndex        =   9
         Top             =   1080
         Width           =   795
      End
      Begin VB.Label lblInfo 
         Caption         =   "Genre:"
         Height          =   255
         Index           =   3
         Left            =   60
         TabIndex        =   11
         Top             =   1440
         Width           =   795
      End
      Begin VB.Label lblInfo 
         Caption         =   "Year:"
         Height          =   255
         Index           =   4
         Left            =   60
         TabIndex        =   13
         Top             =   1800
         Width           =   795
      End
      Begin VB.Label lblInfo 
         Caption         =   "Comment:"
         Height          =   255
         Index           =   5
         Left            =   60
         TabIndex        =   15
         Top             =   2160
         Width           =   795
      End
      Begin VB.Label lblID3v1 
         BackColor       =   &amp;H80000010&amp;
         Caption         =   " ID3 v1 Tag Information"
         ForeColor       =   &amp;H80000014&amp;
         Height          =   255
         Left            =   0
         TabIndex        =   4
         Top             =   0
         Width           =   7515
      End
   End
   Begin VB.CommandButton cmdSet 
      Caption         =   "&amp;Set"
      Enabled         =   0   'False
      Height          =   375
      Left            =   900
      TabIndex        =   43
      Top             =   9060
      Width           =   1155
   End
   Begin VB.CommandButton cmdPick 
      Caption         =   "..."
      Height          =   315
      Left            =   7740
      TabIndex        =   2
      Top             =   60
      Width           =   375
   End
   Begin VB.TextBox txtMp3File 
      BackColor       =   &amp;H8000000F&amp;
      Height          =   315
      Left            =   960
      Locked          =   -1  'True
      OLEDropMode     =   1  'Manual
      TabIndex        =   1
      Top             =   60
      Width           =   6735
   End
   Begin VB.Label lblMp3File 
      Caption         =   "MP3 File"
      Height          =   255
      Left            =   60
      TabIndex        =   0
      Top             =   120
      Width           =   855
   End
   Begin VB.Menu mnuFileTOP 
      Caption         =   "&amp;File"
      Begin VB.Menu mnuFile 
         Caption         =   "&amp;Open..."
         Index           =   0
         Shortcut        =   ^O
      End
      Begin VB.Menu mnuFile 
         Caption         =   "&amp;Save"
         Index           =   1
         Shortcut        =   ^S
      End
      Begin VB.Menu mnuFile 
         Caption         =   "-"
         Index           =   2
      End
      Begin VB.Menu mnuFile 
         Caption         =   "E&amp;xit"
         Index           =   3
      End
   End
End
Attribute VB_Name = "frmTestMp3Tags"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private m_cID3v1 As New cMP3ID3v1
Private m_cID3v2 As New cMP3ID3v2

Private Sub ParseCommand(ByVal sCmd As String)
Dim sC As String
Dim bInQuote As Boolean
Dim bOk As Boolean
Dim sParsed As String
Dim i As Long

   For i = 1 To Len(sCmd)
      sC = Mid(sCmd, i, 1)
      If (sC = """") Then
         If (bInQuote) Then
            bInQuote = False
            bOk = True
            Exit For
         Else
            bInQuote = True
         End If
      ElseIf (sC = " ") Then
         If (bInQuote) Then
            sParsed = sParsed &amp; sC
         Else
            bOk = True
            Exit For
         End If
      Else
         sParsed = sParsed &amp; sC
      End If
   Next i
   
   If (bOk) Or Not (bInQuote) Then
      LoadFile sParsed
   End If
   
End Sub

Private Sub EnableControls(ByVal State As Boolean)
Dim ctl As Control
Dim txt As TextBox
Dim cbo As ComboBox
Dim lst As ComboBox
Dim oCol As OLE_COLOR
   oCol = IIf(State, vbWindowBackground, vbButtonFace)
   For Each ctl In Controls
      If (ctl Is cmdPick) Then
      ElseIf (ctl Is txtMp3File) Then
      ElseIf (TypeOf ctl Is Menu) Then
         If (ctl Is mnuFile(1)) Then
            ctl.Enabled = State
         End If
      ElseIf (TypeOf ctl Is Frame) Then
      ElseIf (TypeOf ctl Is Label) Then
      ElseIf (TypeOf ctl Is TextBox) Then
         Set txt = ctl
         txt.BackColor = oCol
         txt.Enabled = State
      ElseIf (TypeOf ctl Is ComboBox) Then
         Set cbo = ctl
         cbo.BackColor = oCol
         cbo.Enabled = State
      ElseIf (TypeOf ctl Is ListBox) Then
         Set lst = ctl
         lst.BackColor = oCol
         lst.Enabled = False
      Else
         ctl.Enabled = State
      End If
   Next
End Sub

Private Sub showMp3Tags()
   
   ' Get ID3v1 Tag Information:
   With m_cID3v1
      .MP3File = txtMp3File.Text
   
      txtArtist.Text = .Artist
      txtTitle.Text = .Title
      txtAlbum.Text = .Album
      If (.GenreName(m_cID3v1.Genre) = "") Then
         ' not sure why VB doesn't allow .Text to be set
         cboGenre.ListIndex = 0
      Else
         cboGenre.Text = .GenreName(m_cID3v1.Genre)
      End If
      txtYear.Text = .Year
      txtComment.Text = .Comment
   End With
   
   With m_cID3v2
      .MP3File = txtMp3File.Text
      
      txtArtistV2.Text = .Artist
      txtTitleV2.Text = .Title
      txtAlbumV2.Text = .Album
      cboGenreV2.Text = .GenreName(m_cID3v1.Genre)
      txtYearV2.Text = .Year
      txtCommentV2.Text = .Comment
      txtTrack.Text = .Track
      txtOriginalArtist.Text = .OriginalArtist
      txtComposer.Text = .Composer
      txtCopyright.Text = .Copyright
      txtEncodedBy.Text = .EncodedBy
      txtLinkTo.Text = .LinkTo
   End With
   
End Sub

Private Sub cmdPick_Click()
   PickFile
End Sub

Private Sub LoadFile(ByVal sFile As String)
Dim bOk As Boolean

On Error GoTo errorHandler
   txtMp3File.Text = sFile
   showMp3Tags
   bOk = True
   
errorHandler:
   EnableControls bOk
   If Not (Err.Number = 0) Then
      MsgBox "Could not load file '" &amp; sFile &amp; "'" &amp; vbCrLf &amp; vbCrLf &amp;
       Err.Description, vbInformation
   End If
End Sub

Private Sub PickFile()
   Dim sFile As String
   If (VBGetOpenFileName( _
         Filename:=sFile, _
         Filter:="MP3 Files (*.MP3)|*.MP3|All Files (*.*)|*.*", _
         DefaultExt:="MP3", _
         Owner:=Me.hWnd)) Then
      LoadFile sFile
   End If
End Sub

Private Sub cmdSet_Click()
   SetTags
End Sub

Private Sub SetTags()
   
   Dim bFound As Boolean
   Dim i As Long
   
   ' set genre v1:
   If Len(cboGenre.Text) &gt; 0 Then
      For i = 0 To cboGenre.ListCount - 1
         If InStr(cboGenre.List(i), cboGenre.Text) &gt; 0 Then
            cboGenre.ListIndex = i
            bFound = True
            Exit For
         End If
      Next i
   End If
   If Not bFound Then
      cboGenre.ListIndex = 0
   End If
   
   ' set genre v2:
   If Len(cboGenreV2.Text) &gt; 0 Then
      For i = 0 To cboGenreV2.ListCount - 1
         If StrComp(cboGenreV2.List(i), cboGenreV2.Text, vbTextCompare) = 0 Then
            cboGenreV2.ListIndex = i
            Exit For
         End If
      Next i
   End If
   
   
   ' Update ID3 v1 tag:
   With m_cID3v1
      .Artist = txtArtist.Text
      .Title = txtTitle.Text
      .Album = txtAlbum.Text
      .Year = txtYear.Text
      .Comment = txtComment.Text
      .Genre = cboGenre.ItemData(cboGenre.ListIndex)
      .Update
   End With
   
   ' Update ID3 v2 tag:
   With m_cID3v2
      .Artist = txtArtistV2.Text
      .Title = txtTitleV2.Text
      .Album = txtAlbumV2.Text
      .Year = txtYearV2.Text
      .Comment = txtCommentV2.Text
      If (cboGenreV2.ListIndex &gt; -1) Then
         .Genre = cboGenreV2.ItemData(cboGenreV2.ListIndex)
      End If
      .OtherGenreName = cboGenreV2.Text
      .Track = txtTrack.Text
      .OriginalArtist = txtOriginalArtist.Text
      .Composer = txtComposer.Text
      .Copyright = txtCopyright.Text
      .EncodedBy = txtEncodedBy.Text
      .LinkTo = txtLinkTo.Text
      .Update
   End With
   
   
   
End Sub

Private Sub Form_Load()
   
   Set m_cID3v1 = New cMP3ID3v1
   Set m_cID3v2 = New cMP3ID3v2
   
   cboGenre.AddItem ""
   cboGenre.ItemData(cboGenre.NewIndex) = 255
   cboGenreV2.AddItem ""
   cboGenreV2.ItemData(cboGenreV2.NewIndex) = 255
   Dim i As Long
   For i = 0 To 255
      If Len(m_cID3v1.GenreName(i)) &gt; 0 Then
         cboGenre.AddItem m_cID3v1.GenreName(i)
         cboGenre.ItemData(cboGenre.NewIndex) = i
         cboGenreV2.AddItem m_cID3v1.GenreName(i)
         cboGenreV2.ItemData(cboGenreV2.NewIndex) = i
      End If
   Next i
   
   EnableControls False
   
   Me.Show
   Me.Refresh
   
   Dim sCmd As String
   sCmd = Command
   If (Len(sCmd) &gt; 0) Then
      ParseCommand sCmd
   End If
   
End Sub

Private Sub Form_OLEDragDrop(Data As DataObject, Effect As Long, Button As
 Integer, Shift As Integer, X As Single, Y As Single)
   On Error Resume Next
   If (Data.Files.Count &gt; 0) Then
      If (Err.Number = 0) Then
         Effect = vbDropEffectCopy
         LoadFile Data.Files(1)
      End If
   End If
End Sub

Private Sub Form_OLEDragOver(Data As DataObject, Effect As Long, Button As
 Integer, Shift As Integer, X As Single, Y As Single, State As Integer)
   '
   On Error Resume Next
   If (Data.Files.Count &gt; 0) Then
      If (Err.Number = 0) Then
         Effect = vbDropEffectCopy
         Exit Sub
      End If
   End If
   Effect = vbDropEffectNone
   '
End Sub

Private Sub mnuFile_Click(Index As Integer)
   Select Case Index
   Case 0
      PickFile
   Case 1
      SetTags
   Case 3
      Unload Me
   End Select
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\..\..\index.html" ><IMG SRC="..\..\..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">vbMedia</a>&#160;.&#160;<a href="..\index.html">Audio</a>&#160;.&#160;<a href="article.html">Reading and Writing MP3 ID3v1 and ID3v2 Tags</a>&#160;.&#160;<a href="mp3_id3_tags_code.html">MP3 ID3 Tags Code</a>&#160;.&#160;frmTestMp3Tags.frm</p><br /><table style="font-size: 100%;"><tr><td valign="top"><a href="javascript:window.alert(&quot;http://creativecommons.org/licenses/by/1.0/\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\res\cc.png" width="88" height="31" alt="Creative Commons Licence" /></a></td></a></td><td valign="top"><p class="nav" style="padding-bottom: 4px;">All contents of this web site are licensed under a <a href="javascript:window.alert(&quot;http://creativecommons.org/licenses/by/1.0/\nThis link was not retrieved.&quot;)">Creative Commons Licence</a>, except where otherwise noted.</p><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2004 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>, vbAccelerator Ltd.<br />Last Updated: 9 June 2004</p></td></tr></table></td><td></td></tr></table>
</body></html>
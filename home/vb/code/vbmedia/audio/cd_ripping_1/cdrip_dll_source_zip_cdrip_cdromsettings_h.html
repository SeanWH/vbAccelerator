<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: CDRip_CDRomSettings.h</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: CDRip_CDRomSettings.h" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /><link rel="SHORTCUT ICON" href="/home/res/vbaccel.ico" /><link rel="copyright" href="/home/The_Site/Copyright/article.asp" /><link rel="contents" href="./CDRip_DLL_Source.asp" /><link rel="meta" type="application/rdf+xml" href="./CDRip DLL Source.rdf" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">vbMedia</a>&#160;.&#160;<a href="..\index.html">Audio</a>&#160;.&#160;<a href="article.html">CD Ripping in VB Part 1</a>&#160;.&#160;<a href="cdrip_dll_source.html">CDRip DLL Source</a>&#160;.&#160;CDRip_CDRomSettings.h</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="cdrip_dll_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />CDRip DLL Source</a> (87K)</p><p class="nav"><a href="cdrip_dll.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />CDRip DLL</a> (84K)</p><p /><p class="nav"><a href="vb5_cd_ripper.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 CD Ripper</a> (103K)</p><p /><p class="nav"><a href="vb6_cd_ripper.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 CD Ripper</a> (99K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:15102</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=15102&type=zip&title=cdrip_20dll_20source_2ezip_5fcdrip_5fcdromsettings.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />6 May 2004<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\..\resources\links\other\cdex\article.html">CDEx</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\cd_tracklistings\article.html">CD Track Listing Using freedb.org</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: CDRip_CDRomSettings.h</h1><p>This file is part of the download <a href="cdrip_dll_source.html">CDRip DLL Source</a>, which is described in the article <a href="article.html">CD Ripping in VB Part 1</a>.</p><pre>/*
** Copyright (C) 1999 Albert L. Faber
**  
** This program is free software; you can redistribute it and/or modify
** it under the terms of the GNU General Public License as published by
** the Free Software Foundation; either version 2 of the License, or
** (at your option) any later version.
** 
** This program is distributed in the hope that it will be useful,
** but WITHOUT ANY WARRANTY; without even the implied warranty of
** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
** GNU General Public License for more details.
** 
** You should have received a copy of the GNU General Public License
** along with this program; if not, write to the Free Software 
** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
*/

#ifndef CDROMSETTINGS_INCLUDED
#define CDROMSETTINGS_INCLUDED

#include &lt;Windows.h&gt;
#include &lt;Stdio.h&gt;
#include &lt;Stdlib.h&gt;
#include "vector"
#include "CDRip.h"
#include "../Ini.h"

using namespace std ;


#define MAX_TRACKS 100


class CDSETTINGSPARAMS:public CDROMPARAMS
{
public:
   CDSETTINGSPARAMS();
   ~CDSETTINGSPARAMS();
};


class CToc
{
   int      m_nNumTracks;
   BYTE   m_btaFlags[MAX_TRACKS];
   BYTE   m_btaTrackNumber[MAX_TRACKS];
   DWORD   m_dwaStartSector[MAX_TRACKS];

public:
   // CONSTRUCTOR
   CToc();
   // DESTRUCTOR
   ~CToc();

   void   Clear();
   void   FillEntry(BYTE* btStream);
   DWORD   GetStartSector(int nIndex)      const {return
    m_dwaStartSector[nIndex];}
   BYTE   GetFlags(int nIndex)         const {return m_btaFlags[nIndex];}
   BYTE   GetTrackNumber(int nIndex)      const {return
    m_btaTrackNumber[nIndex];}
   INT      GetNumTracks()               const {return m_nNumTracks-1;}
   void   DumpToc(LPBYTE pbtBuffer,int nSize);
   BOOL   IsAudioTrack(int p_track);
   DWORD   GetSize(int nTrack);
};


class CDRomSettings
{
private:
   int                     m_nActive;
   vector&lt;CDSETTINGSPARAMS&gt;   m_CDParams;
   vector&lt;CToc&gt;            m_Toc;
   static CHAR               m_lpszIniFname[255];
   static INT               m_nTransportLayer;
public:
   CToc&amp;   GetToc() {return m_Toc[m_nActive];}

   // Standard constructor
   CDRomSettings();

   // Standard destructor
   virtual ~CDRomSettings();

   void UpdateDriveSettings();

   void LoadSettings();
   void SaveSettings();

   int   GetNumDrives() const {return m_CDParams.size();}
   void LoadCDSettingsEntry( CDSETTINGSPARAMS&amp; cdSettings, const char* lpszKey
    );

   // Set the active CDROM device
   void SetActiveCDROM(BYTE nValue)   {m_nActive=nValue;}
   BYTE GetActiveCDROM() const {return m_nActive;}
   

   // Set the CDRom ID
   void AddCDRom(LPSTR lpszName,BYTE btAdapterID,BYTE btTargetID,BYTE btLunID);
   LPCSTR GetCDROMID() const {return m_CDParams[m_nActive].lpszCDROMID;}
   LPCSTR GetCDROMIDByIndex(int i) const {return m_CDParams[i].lpszCDROMID;}

   // Set SCSI Target ID
   void SetTargetID(BYTE nValue)   {m_CDParams[m_nActive].btTargetID=nValue;}
   BYTE GetTargetID() const {return m_CDParams[m_nActive].btTargetID;}

   // Set SCSI Adapter ID
   void SetAdapterID(BYTE nValue)   {m_CDParams[m_nActive].btAdapterID=nValue;}
   BYTE GetAdapterID() const {return m_CDParams[m_nActive].btAdapterID;}

   // Set SCSI Logical Unit ID
   void SetLunID(BYTE nValue)   {m_CDParams[m_nActive].btLunID=nValue;}
   BYTE GetLunID() const {return m_CDParams[m_nActive].btLunID;}

   // Get the number of overlap sectors for the jitter correction
   void SetNumOverlapSectors(int nValue)  
    {m_CDParams[m_nActive].nNumOverlapSectors=nValue;}
   int GetNumOverlapSectors() const {return
    m_CDParams[m_nActive].nNumOverlapSectors;}

   // Get the number of sectors to read at once
   void SetNumReadSectors(int nValue)  
    {m_CDParams[m_nActive].nNumReadSectors=nValue;}
   int GetNumReadSectors() const {return m_CDParams[m_nActive].nNumReadSectors;}

   // Set the number of sectors that have to be compared for the Jitter
    correction
   void SetNumCompareSectors(int nValue)  
    {m_CDParams[m_nActive].nNumCompareSectors=nValue;}
   int GetNumCompareSectors() const {return
    m_CDParams[m_nActive].nNumCompareSectors;}

   // Boolean value which determines if jitter correction is active
   void SetJitterCorrection(BOOL bValue)  
    {m_CDParams[m_nActive].bJitterCorrection=bValue;}
   BOOL GetJitterCorrection() const {return
    m_CDParams[m_nActive].bJitterCorrection;}

   // Boolean value which determines if left and right chanel have to be swapped
   void SetSwapLefRightChannel(BOOL bValue)  
    {m_CDParams[m_nActive].bSwapLefRightChannel=bValue;}
   BOOL GetSwapLefRightChannel() const {return
    m_CDParams[m_nActive].bSwapLefRightChannel;}

   // Sets the value which offsets the start ripping point with nValue sectors
   void SetOffsetStart(int nValue)  
    {m_CDParams[m_nActive].nOffsetStart=nValue;}
   int GetOffsetStart() const {return m_CDParams[m_nActive].nOffsetStart;}
   
   // Sets the value which offsets the end of the ripping with nValue sectors
   void SetOffsetEnd(int nValue)   {m_CDParams[m_nActive].nOffsetEnd=nValue;}
   int GetOffsetEnd() const {return m_CDParams[m_nActive].nOffsetEnd;}

   // Sets the ripping speed
   void SetSpeed(int nValue)   {m_CDParams[m_nActive].nSpeed=nValue;}
   int GetSpeed() const {return m_CDParams[m_nActive].nSpeed;}

   // Sets the enable flag for the multi read feature
   void SetMultiReadEnable(BOOL nValue)  
    {m_CDParams[m_nActive].bEnableMultiRead=nValue;}
   BOOL GetMultiReadEnable() const {return
    m_CDParams[m_nActive].bEnableMultiRead;}

   // Sets the multiple read compare
   void SetMultiRead(int nValue)  
    {m_CDParams[m_nActive].nMultiReadCount=nValue;}
   int GetMultiRead() const {return m_CDParams[m_nActive].nMultiReadCount;}

   // Sets the multiple read for first block only
   void SetMultiReadFirstOnly(BOOL nValue)  
    {m_CDParams[m_nActive].bMultiReadFirstOnly=nValue;}
   BOOL GetMultiReadFirstOnly() const {return
    m_CDParams[m_nActive].bMultiReadFirstOnly;}

   // Sets the multiple read for first block only
   void SetLockDuringRead(BOOL nValue)  
    {m_CDParams[m_nActive].bLockDuringRead=nValue;}
   BOOL GetLockDuringRead() const {return
    m_CDParams[m_nActive].bLockDuringRead;}

   // Sets the CD-ROM spin up time in seconds
   void SetSpinUpTime(int nValue)   {m_CDParams[m_nActive].nSpinUpTime=nValue;}
   int GetSpinUpTime() const {return m_CDParams[m_nActive].nSpinUpTime;}

   DRIVETABLE   GetDriveTable()   const         {return
    m_CDParams[m_nActive].DriveTable;}
   void      SetDriveTable(DRIVETABLE&amp; newDrive)  
    {m_CDParams[m_nActive].DriveTable=newDrive;}

   void      SetDriveType(DRIVETYPE cdType)  
    {m_CDParams[m_nActive].DriveTable.DriveType=cdType;}
   DRIVETYPE   GetDriveType() const         {return
    m_CDParams[m_nActive].DriveTable.DriveType;}

   // Use APSI posting or polling
   void SetAspiPosting(BOOL bValue)  
    {m_CDParams[m_nActive].bAspiPosting=bValue;}
   BOOL GetAspiPosting() const {return m_CDParams[m_nActive].bAspiPosting;}

   // Use APSI posting or polling
   void SetParanoiaMode( INT nValue )   {m_CDParams[m_nActive].nParanoiaMode =
    nValue;}
   INT GetParanoiaMode() const {return m_CDParams[m_nActive].nParanoiaMode;}

   // Set Paranoia ripping mode
   void SetRippingMode( INT nValue)   {m_CDParams[m_nActive].nRippingMode =
    nValue;}
   INT GetRippingMode() const {return m_CDParams[m_nActive].nRippingMode;}

   void      Clear()   {m_nActive=0;m_CDParams.clear();}


   // Set SCSI Logical Unit ID
   void SetAtapi(BOOL nValue)  
    {m_CDParams[m_nActive].DriveTable.bAtapi=nValue;}
   BOOL GetAtapi() const      {return m_CDParams[m_nActive].DriveTable.bAtapi;}

   void SetEnableMode(ENABLEMODE nValue)  
    {m_CDParams[m_nActive].DriveTable.EnableMode=nValue;}
   ENABLEMODE GetEnableMode() const      {return
    m_CDParams[m_nActive].DriveTable.EnableMode;}

   void   SetDensity(INT nValue)  
    {m_CDParams[m_nActive].DriveTable.nDensity=nValue;}
   INT      GetDensity() const      {return
    m_CDParams[m_nActive].DriveTable.nDensity;}
//   DRIVETYPE   GetDriveType() const         {return (DRIVETYPE)m_CDDrive;}
//   void      SetDriveType(DRIVETYPE nValue)   {m_nReadMethod=(int)nValue;}

   void      SetSpeedMethod(SETSPEED   nValue)  
    {m_CDParams[m_nActive].DriveTable.SetSpeed=nValue;}
   SETSPEED   GetSpeedMethod() const      {return
    m_CDParams[m_nActive].DriveTable.SetSpeed;}

   void      SetReadMethod(READMETHOD   nValue)  
    {m_CDParams[m_nActive].DriveTable.ReadMethod=nValue;}
   READMETHOD   GetReadMethod() const      {return
    m_CDParams[m_nActive].DriveTable.ReadMethod;}

   void      SetEndian(ENDIAN   nValue)  
    {m_CDParams[m_nActive].DriveTable.Endian=nValue;}
   ENDIAN      GetEndian() const         {return
    m_CDParams[m_nActive].DriveTable.Endian;}

   void SetAspiRetries(int nValue)  
    {m_CDParams[m_nActive].nAspiRetries=nValue;}
   int GetAspiRetries() const {return m_CDParams[m_nActive].nAspiRetries;}

   void SetAspiTimeOut(int nValue)  
    {m_CDParams[m_nActive].nAspiTimeOut=nValue;}
   int GetAspiTimeOut() const {return m_CDParams[m_nActive].nAspiTimeOut;}

   static int   GetTransportLayer() ;
   static void   SetTransportLayer( int nValue );

   static void SetIniFileName( LPCSTR lpszIniFname);
   static char* GetIniFileName() { return m_lpszIniFname;}
};

#endif
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\using_gdi_plus\index.html" ><IMG SRC="..\..\..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">vbMedia</a>&#160;.&#160;<a href="..\index.html">Audio</a>&#160;.&#160;<a href="article.html">CD Ripping in VB Part 1</a>&#160;.&#160;<a href="cdrip_dll_source.html">CDRip DLL Source</a>&#160;.&#160;CDRip_CDRomSettings.h</p><br /><table style="font-size: 100%;"><tr><td valign="top"><a href="javascript:window.alert(&quot;http://creativecommons.org/licenses/by/1.0/\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\res\cc.png" width="88" height="31" alt="Creative Commons Licence" /></a></td></a></td><td valign="top"><p class="nav" style="padding-bottom: 4px;">All contents of this web site are licensed under a <a href="javascript:window.alert(&quot;http://creativecommons.org/licenses/by/1.0/\nThis link was not retrieved.&quot;)">Creative Commons Licence</a>, except where otherwise noted.</p><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2004 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>, vbAccelerator Ltd.<br />Last Updated: 12 June 2004</p></td></tr></table></td><td></td></tr></table>
</body></html>
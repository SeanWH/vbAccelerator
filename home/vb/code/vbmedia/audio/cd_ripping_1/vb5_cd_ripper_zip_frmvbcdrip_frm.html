<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: frmVBCDRip.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmVBCDRip.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /><link rel="SHORTCUT ICON" href="/home/res/vbaccel.ico" /><link rel="copyright" href="/home/The_Site/Copyright/article.asp" /><link rel="contents" href="./VB5_CD_Ripper.asp" /><link rel="meta" type="application/rdf+xml" href="./VB5 CD Ripper.rdf" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">vbMedia</a>&#160;.&#160;<a href="..\index.html">Audio</a>&#160;.&#160;<a href="article.html">CD Ripping in VB Part 1</a>&#160;.&#160;<a href="vb5_cd_ripper.html">VB5 CD Ripper</a>&#160;.&#160;frmVBCDRip.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="cdrip_dll_source.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />CDRip DLL Source</a> (87K)</p><p class="nav"><a href="cdrip_dll.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />CDRip DLL</a> (84K)</p><p /><p class="nav"><a href="vb5_cd_ripper.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 CD Ripper</a> (103K)</p><p /><p class="nav"><a href="vb6_cd_ripper.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 CD Ripper</a> (99K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:15149</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=15149&type=zip&title=vb5_20cd_20ripper_2ezip_5ffrmvbcdrip.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />6 May 2004<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\..\resources\links\other\cdex\article.html">CDEx</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\cd_tracklistings\article.html">CD Track Listing Using freedb.org</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmVBCDRip.frm</h1><p>This file is part of the download <a href="vb5_cd_ripper.html">VB5 CD Ripper</a>, which is described in the article <a href="article.html">CD Ripping in VB Part 1</a>.</p><pre>VERSION 5.00
Object = "{6B7E6392-850A-101B-AFC0-4210102A8DA7}#1.3#0"; "COMCTL32.OCX"
Begin VB.Form frmVBCDRip 
   Caption         =   "VB CD Ripper"
   ClientHeight    =   5865
   ClientLeft      =   2820
   ClientTop       =   1785
   ClientWidth     =   6705
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmVBCDRip.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   5865
   ScaleWidth      =   6705
   Begin VB.PictureBox pnlMain 
      Align           =   1  'Align Top
      BorderStyle     =   0  'None
      Height          =   4935
      Left            =   0
      ScaleHeight     =   4935
      ScaleWidth      =   6705
      TabIndex        =   4
      Top             =   0
      Width           =   6705
      Begin VB.ComboBox cboDrives 
         Height          =   315
         Left            =   1140
         Style           =   2  'Dropdown List
         TabIndex        =   8
         Top             =   60
         Width           =   4095
      End
      Begin VB.TextBox txtCDDBQuery 
         Height          =   315
         Left            =   1200
         TabIndex        =   6
         Top             =   4560
         Width           =   5295
      End
      Begin VB.CommandButton cmdRefresh 
         Caption         =   "&amp;Refresh"
         Height          =   315
         Left            =   5280
         TabIndex        =   5
         Top             =   60
         Width           =   1155
      End
      Begin ComctlLib.ListView lvwTracks 
         Height          =   4035
         Left            =   60
         TabIndex        =   7
         Top             =   480
         Width           =   6435
         _ExtentX        =   11351
         _ExtentY        =   7117
         View            =   3
         LabelEdit       =   1
         MultiSelect     =   -1  'True
         LabelWrap       =   -1  'True
         HideSelection   =   0   'False
         _Version        =   327682
         ForeColor       =   -2147483640
         BackColor       =   -2147483643
         Appearance      =   1
         NumItems        =   0
      End
      Begin VB.Label lblDrives 
         Caption         =   "Drives:"
         Height          =   255
         Left            =   60
         TabIndex        =   10
         Top             =   120
         Width           =   1035
      End
      Begin VB.Label lblCDDBQuery 
         Caption         =   "CDDB &amp;Query:"
         Height          =   255
         Left            =   120
         TabIndex        =   9
         Top             =   4620
         Width           =   1095
      End
   End
   Begin VB.PictureBox pnlCommands 
      Align           =   2  'Align Bottom
      BorderStyle     =   0  'None
      Height          =   495
      Left            =   0
      ScaleHeight     =   495
      ScaleWidth      =   6705
      TabIndex        =   0
      Top             =   5370
      Width           =   6705
      Begin VB.CommandButton cmdRip 
         Caption         =   "&amp;Rip..."
         Enabled         =   0   'False
         Height          =   435
         Left            =   3420
         TabIndex        =   3
         Top             =   0
         Width           =   1275
      End
      Begin VB.CommandButton cmdConfigure 
         Caption         =   "&amp;Configure..."
         Height          =   435
         Left            =   2040
         TabIndex        =   2
         Top             =   0
         Width           =   1275
      End
      Begin VB.CommandButton cmdAbout 
         Caption         =   "&amp;About..."
         Height          =   435
         Left            =   5220
         TabIndex        =   1
         Top             =   0
         Width           =   1275
      End
   End
End
Attribute VB_Name = "frmVBCDRip"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Declare Function SendMessageByLong Lib "user32" Alias "SendMessageA"
 (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As
 Long) As Long
Private Const LVM_FIRST = &amp;H1000                   '// ListView messages
Private Const LVM_GETEXTENDEDLISTVIEWSTYLE = (LVM_FIRST + 55)
Private Const LVM_SETEXTENDEDLISTVIEWSTYLE = (LVM_FIRST + 54) '// optional
 wParam == mask
Private Const LVS_EX_FULLROWSELECT = &amp;H20         '// applies to report mode
 only

Private m_cRip As cCDRip
Private m_cToc As cToc

Private Sub ConfigureListView()
   With lvwTracks
      .View = lvwReport
      .ColumnHeaders.Add , "Name", "Name"
      .ColumnHeaders.Add , "Track", "Track", 48 * Screen.TwipsPerPixelX,
       lvwColumnRight
      .ColumnHeaders.Add , "StartTime", "Start Time", 64 *
       Screen.TwipsPerPixelX, lvwColumnRight
      .ColumnHeaders.Add , "Length", "Length", 64 * Screen.TwipsPerPixelX,
       lvwColumnRight
      .ColumnHeaders.Add , "Size", "Size (Mb)", 64 * Screen.TwipsPerPixelX,
       lvwColumnRight
   
      Dim lStyle As Long
      lStyle = SendMessageByLong(.hWnd, LVM_GETEXTENDEDLISTVIEWSTYLE, 0, 0)
      lStyle = lStyle Or LVS_EX_FULLROWSELECT
      SendMessageByLong .hWnd, LVM_SETEXTENDEDLISTVIEWSTYLE, 0, lStyle

   End With
End Sub

Private Sub ShowDrives()
Dim i As Long
   
   Set m_cRip = New cCDRip
   m_cRip.Create App.Path &amp; "\cdrip.ini" ' this INI file isn't used currently
   
   For i = 1 To m_cRip.CDDriveCount
      cboDrives.AddItem m_cRip.CDDrive(i).Name
   Next i
   
   If (cboDrives.ListCount &gt; 0) Then
      cboDrives.ListIndex = 0
   Else
      ShowTracks
   End If
      
End Sub

Private Sub ShowTracks()
Dim lIndex As Long
   
   lvwTracks.ListItems.Clear
   lvwTracks.Enabled = False
   txtCDDBQuery.Text = ""
   cmdRip.Enabled = False
   Set m_cToc = Nothing

   lIndex = cboDrives.ListIndex + 1
   If (lIndex &gt; 0) Then
      
      Dim cD As cDrive
      Set cD = m_cRip.CDDrive(lIndex)
      If (cD.IsUnitReady) Then
         
         Set m_cToc = cD.TOC
         txtCDDBQuery.Text = m_cToc.CDDBQuery
         
         Dim itm As ListItem
         Dim i As Long
         For i = 1 To m_cToc.Count
            With m_cToc.Entry(i)
               Set itm = lvwTracks.ListItems.Add(, "T" &amp; i, "Track " &amp;
                Format(.TrackNumber, "00"))
               itm.SubItems(1) = .TrackNumber
               itm.SubItems(2) = .FormattedStartTime
               itm.SubItems(3) = .FormattedLength
               itm.SubItems(4) = Format(.SizeBytes / (1024&amp; * 1024&amp;), "##0.00")
                &amp; "MB"
               itm.Selected = True
            End With
         Next i
         
         lvwTracks.Enabled = (m_cToc.Count &gt; 0)
         cmdRip.Enabled = (m_cToc.Count &gt; 0)
         
      Else
         lvwTracks.ListItems.Add , , "No CD In Drive"
      End If
   Else
      lvwTracks.ListItems.Add , , "No CD Selected"
   End If

End Sub

Private Sub cboDrives_Click()
   ShowTracks
End Sub

Private Sub cmdAbout_Click()
Dim fA As New frmAbout
Dim sAck As String
   sAck = "This sample uses components from CDEx, Copyright  1999 Albert L.
    Faber and Monty (xiphmont@mit.edu).  "
   sAck = sAck &amp; "CDEx is released under the GNU General Public License and the
    source code is available from "
   sAck = sAck &amp; "http://cdexos.sourceforge.net."
   fA.Acknowledgements = sAck
   fA.Show vbModal, Me
End Sub

Private Sub cmdConfigure_Click()
   Dim fO As New frmOptions
   fO.CRRip = m_cRip
   fO.Show vbModal, Me
   If (cboDrives.ListCount &gt; 0) Then
      ' Reset active CD ROM
      cboDrives_Click
   End If
End Sub

Private Sub cmdRefresh_Click()
   ShowTracks
End Sub

Private Sub cmdRip_Click()
Dim lIndex As Long
   
   lIndex = cboDrives.ListIndex + 1
   If (lIndex &gt; 0) Then
      
      Dim cD As cDrive
      Set cD = m_cRip.CDDrive(lIndex)
      If (cD.IsUnitReady) Then
   
         Dim fRip As New frmRipDialog
         
         fRip.OutputDir = App.Path
         fRip.RipTOC = m_cToc
         Dim itm As ListItem
         For Each itm In lvwTracks.ListItems
            If (itm.Selected) Then
               fRip.RipTrack(CLng(Mid(itm.Key, 2))) = True
            End If
         Next
         fRip.Icon = Me.Icon
         
         pnlMain.Enabled = False
         pnlCommands.Enabled = False
         
         fRip.Show , Me
         Me.Refresh
         DoEvents
         
         On Error Resume Next
         fRip.RipSelected
         
         Dim lErr As Long, sErr As String
         lErr = Err.Number
         sErr = Err.Description
         If Not (Err.Number = 0) Then
            Unload fRip
            On Error GoTo 0
            MsgBox "An error occurred during ripping: " &amp; sErr, vbExclamation
         End If
         pnlMain.Enabled = True
         pnlCommands.Enabled = True
         
      End If
      
   End If
End Sub

Private Sub Form_Load()
   
   ConfigureListView
   
   Me.Show
   Me.Refresh
   
   ShowDrives
   
End Sub

Private Sub Form_Resize()
   On Error Resume Next
   pnlMain.Height = Me.ScaleHeight - pnlCommands.Height
End Sub

Private Sub lvwTracks_Click()
Dim itm As ListItem
Dim bSelection As Boolean
   
   For Each itm In lvwTracks.ListItems
      If (itm.Selected) Then
         bSelection = True
      End If
   Next
   cmdRip.Enabled = bSelection
   
End Sub

Private Sub pnlCommands_Resize()
   '
   cmdAbout.left = pnlCommands.ScaleWidth - cmdAbout.Width - 4 *
    Screen.TwipsPerPixelX
   cmdRip.left = cmdAbout.left - cmdRip.Width - 24 * Screen.TwipsPerPixelX
   cmdConfigure.left = cmdRip.left - cmdConfigure.Width - 4 *
    Screen.TwipsPerPixelX
   '
End Sub

Private Sub pnlMain_Resize()
   '
   On Error Resume Next
   Dim lHeight As Long
   lHeight = pnlMain.ScaleHeight - lvwTracks.top * 2
   lvwTracks.Move lvwTracks.left, lvwTracks.top, pnlMain.ScaleWidth -
    lvwTracks.left * 2, lHeight
   cboDrives.Width = pnlMain.ScaleWidth - cboDrives.left - cmdRefresh.Width - 2
    * Screen.TwipsPerPixelX - lvwTracks.left
   cmdRefresh.left = cboDrives.left + cboDrives.Width + 2 *
    Screen.TwipsPerPixelX
   lblCDDBQuery.top = lvwTracks.top + lvwTracks.Height + 2 *
    Screen.TwipsPerPixelY
   txtCDDBQuery.Move txtCDDBQuery.left, lblCDDBQuery.top, pnlMain.ScaleWidth -
    txtCDDBQuery.left - lvwTracks.left
   '
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\using_gdi_plus\index.html" ><IMG SRC="..\..\..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">vbMedia</a>&#160;.&#160;<a href="..\index.html">Audio</a>&#160;.&#160;<a href="article.html">CD Ripping in VB Part 1</a>&#160;.&#160;<a href="vb5_cd_ripper.html">VB5 CD Ripper</a>&#160;.&#160;frmVBCDRip.frm</p><br /><table style="font-size: 100%;"><tr><td valign="top"><a href="javascript:window.alert(&quot;http://creativecommons.org/licenses/by/1.0/\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\res\cc.png" width="88" height="31" alt="Creative Commons Licence" /></a></td></a></td><td valign="top"><p class="nav" style="padding-bottom: 4px;">All contents of this web site are licensed under a <a href="javascript:window.alert(&quot;http://creativecommons.org/licenses/by/1.0/\nThis link was not retrieved.&quot;)">Creative Commons Licence</a>, except where otherwise noted.</p><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2004 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>, vbAccelerator Ltd.<br />Last Updated: 9 June 2004</p></td></tr></table></td><td></td></tr></table>
</body></html>
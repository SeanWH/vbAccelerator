<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: cLogoButton.cls</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: cLogoButton.cls" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">vbMedia</a>&#160;.&#160;<a href="..\index.html">DIB Sections</a>&#160;.&#160;<a href="article.html">Alpha DIBSections</a>&#160;.&#160;<a href="vb6_alpha_dib_section_demonstration.html">VB6 Alpha DIB Section Demonstration</a>&#160;.&#160;cLogoButton.cls</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="simple_alpha_sample.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Simple Alpha Sample</a> (26K)</p><p /><p class="nav"><a href="vb5_alpha_dib_section_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Alpha DIB Section Demonstration</a> (101K)</p><p /><p class="nav"><a href="vb6_alpha_dib_section_demonstration.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Alpha DIB Section Demonstration</a> (97K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:3056</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=3056&type=zip&title=vb6_20alpha_20dib_20section_20demonstration_2ezip_5fclogobutton.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />13 Jan 2003<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\graphics_and_gdi\changing_window_shapes\window_shapes_using_layering\article.html">Window Shapes Using Layering</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\256_colour_dibsection\article.html">256 Colour DIBSections </a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\true_colour_dibsection\article.html">True Colour DIBSection</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\tips\replace_one_colour_with_another_in_a_picture\article.html">Replace one Colour with another in a Picture using BitBlt</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: cLogoButton.cls</h1><pre>VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
  Persistable = 0  'NotPersistable
  DataBindingBehavior = 0  'vbNone
  DataSourceBehavior  = 0  'vbNone
  MTSTransactionMode  = 0  'NotAnMTSObject
END
Attribute VB_Name = "cAlphaButton"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Option Explicit

Private Declare Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" ( _
    lpvDest As Any, lpvSource As Any, ByVal cbCopy As Long)

Private Type SAFEARRAYBOUND
    cElements As Long
    lLbound As Long
End Type
Private Type SAFEARRAY2D
    cDims As Integer
    fFeatures As Integer
    cbElements As Long
    cLocks As Long
    pvData As Long
    Bounds(0 To 1) As SAFEARRAYBOUND
End Type
Private Declare Function VarPtrArray Lib "msvbvm60.dll" Alias "VarPtr" (Ptr()
 As Any) As Long

Private Type RECT
   Left As Long
   Top As Long
   Right As Long
   Bottom As Long
End Type
Private Declare Function LoadImageLong Lib "user32" Alias "LoadImageA" (ByVal
 hInst As Long, ByVal lpsz As Long, ByVal uType As Long, ByVal cx As Long,
 ByVal cy As Long, ByVal uFlags As Long) As Long
Private Declare Function LoadImageString Lib "user32" Alias "LoadImageA" (ByVal
 hInst As Long, ByVal lpsz As String, ByVal uType As Long, ByVal cx As Long,
 ByVal cy As Long, ByVal uFlags As Long) As Long
Private Const IMAGE_BITMAP = 0
Private Const IMAGE_ICON = 1
Private Const IMAGE_CURSOR = 2
Private Const LR_DEFAULTCOLOR = &amp;H0
Private Const LR_MONOCHROME = &amp;H1
Private Const LR_COLOR = &amp;H2
Private Const LR_COPYRETURNORG = &amp;H4
Private Const LR_COPYDELETEORG = &amp;H8
Private Const LR_LOADFROMFILE = &amp;H10
Private Const LR_LOADTRANSPARENT = &amp;H20
Private Const LR_DEFAULTSIZE = &amp;H40
Private Const LR_VGACOLOR = &amp;H80
Private Const LR_LOADMAP3DCOLORS = &amp;H1000&amp;
Private Const LR_CREATEDIBSECTION = &amp;H2000&amp;
Private Const LR_COPYFROMRESOURCE = &amp;H4000&amp;
Private Const LR_SHARED = &amp;H8000&amp;

Private Declare Function DeleteObject Lib "gdi32" (ByVal hObject As Long) As
 Long
Private Declare Function GetSysColor Lib "user32" (ByVal nIndex As Long) As Long

Private m_cAlphaLogo As cAlphaDibSection
Private m_cAlphaLogoDown As cAlphaDibSection
Private m_cDisabledLogo As cAlphaDibSection

Private m_lAlphaLogoId As Long
Private m_sAlphaLogoFileName As String
Private m_lAlphaLogoDownId As Long
Private m_sAlphaLogoDownFileName As String
Private m_hInst As Long

Private m_tR As RECT
Private m_objDraw As Object

Private m_bOver As Boolean
Private m_bPressed As Boolean

Private WithEvents m_cMouseTrack As cMouseTrack
Attribute m_cMouseTrack.VB_VarHelpID = -1

Private m_bEnabled As Boolean

Public Event Click()

Public Property Get Top() As Long
   Top = m_tR.Top
End Property
Public Property Let Top(ByVal value As Long)
   m_tR.Top = value
End Property
Public Property Get Left() As Long
   Left = m_tR.Left
End Property
Public Property Let Left(ByVal value As Long)
   m_tR.Left = value
End Property
Public Property Get Width() As Long
   Width = m_cAlphaLogo.Width
End Property
Public Property Get Height() As Long
   Height = m_cAlphaLogo.Height
End Property
Public Sub LoadImages()
   '
   Set m_cMouseTrack = New cMouseTrack
   m_cMouseTrack.AttachMouseTracking m_objDraw
   Set m_cAlphaLogo = New cAlphaDibSection
   Set m_cAlphaLogoDown = New cAlphaDibSection
   Dim hBmp As Long
   If (m_hInst = 0) Then
      
      hBmp = LoadImageString(App.hInstance, m_sAlphaLogoFileName, 0, 0, 0,
       LR_LOADFROMFILE)
      m_cAlphaLogo.CreateFromHBitmap hBmp
      DeleteObject hBmp
           
      hBmp = LoadImageString(App.hInstance, m_sAlphaLogoDownFileName, 0, 0, 0,
       LR_LOADFROMFILE)
      m_cAlphaLogoDown.CreateFromHBitmap hBmp
      DeleteObject hBmp
           
   Else
      
      hBmp = LoadImageLong(m_hInst, m_lAlphaLogoId, IMAGE_BITMAP, 0, 0, 0)
      'MsgBox "Alpha Logo" &amp; vbCrLf &amp; hBmp &amp; vbCrLf &amp; m_hInst &amp; vbCrLf &amp;
       m_lAlphaLogoId
      m_cAlphaLogo.CreateFromHBitmap hBmp
      DeleteObject hBmp
            
      hBmp = LoadImageLong(m_hInst, m_lAlphaLogoDownId, IMAGE_BITMAP, 0, 0, 0)
      'MsgBox "Alpha Down Logo" &amp; vbCrLf &amp; hBmp &amp; vbCrLf &amp; m_hInst &amp; vbCrLf &amp;
       m_lAlphaLogoId
      m_cAlphaLogoDown.CreateFromHBitmap hBmp
      DeleteObject hBmp
            
   End If
   
   '
End Sub
Public Property Get DrawObject() As Object
   Set DrawObject = m_objDraw
End Property
Public Property Let DrawObject(obj As Object)
   Set m_objDraw = obj
   Draw
End Property
Public Property Set DrawObject(obj As Object)
   Set m_objDraw = obj
   Draw
End Property
Public Sub Draw()
Dim lhDC As Long
   If Not m_objDraw Is Nothing Then
      m_objDraw.Cls
      If Not m_bEnabled Then
         If Not m_cDisabledLogo Is Nothing Then
            lhDC = m_objDraw.hdc
            m_cDisabledLogo.AlphaPaintPicture lhDC, m_tR.Left, m_tR.Top,
             lConstantAlpha:=192
         End If
      Else
         If Not m_cAlphaLogo Is Nothing Then
            lhDC = m_objDraw.hdc
            If (m_bPressed) Then
               If (m_bOver) Then
                  m_cAlphaLogoDown.AlphaPaintPicture lhDC, m_tR.Left + 2,
                   m_tR.Top + 2
               Else
                  m_cAlphaLogo.AlphaPaintPicture lhDC, m_tR.Left, m_tR.Top,
                   lConstantAlpha:=230
               End If
            Else
               If (m_bOver) Then
                  m_cAlphaLogo.AlphaPaintPicture lhDC, m_tR.Left, m_tR.Top,
                   lConstantAlpha:=230
               Else
                  m_cAlphaLogo.AlphaPaintPicture lhDC, m_tR.Left, m_tR.Top,
                   lConstantAlpha:=192
               End If
            End If
         End If
      End If
      m_objDraw.Refresh
   End If
End Sub
Public Sub Colourise(ByVal hue As Single)
   
   If Not (m_cAlphaLogo Is Nothing) Then
      Dim tImage As SAFEARRAY2D
      Dim bImage() As Byte
      
      With tImage
         .cbElements = 1
         .cDims = 2
         .Bounds(0).lLbound = 0
         .Bounds(0).cElements = m_cAlphaLogo.Height
         .Bounds(1).lLbound = 0
         .Bounds(1).cElements = m_cAlphaLogo.BytesPerScanLine()
         .pvData = m_cAlphaLogo.DIBSectionBitsPtr
      End With
      CopyMemory ByVal VarPtrArray(bImage()), VarPtr(tImage), 4
       
      Dim r As Long, g As Long, b As Long
      Dim x As Long, y As Long
      Dim h As Single, s As Single, l As Single
      For x = 0 To m_cAlphaLogo.BytesPerScanLine - 4 Step 4
         For y = 0 To m_cAlphaLogo.Height - 1
            RGBToHSL bImage(x, y), bImage(x + 1, y), bImage(x + 2, y), h, s, l
            HLSToRGB hue, s, l, r, g, b
            bImage(x + 2, y) = r
            bImage(x + 1, y) = g
            bImage(x, y) = b
         Next y
      Next x
       
      CopyMemory ByVal VarPtrArray(bImage), 0&amp;, 4
   End If
   
   If Not (m_cAlphaLogoDown Is Nothing) Then
      
      With tImage
         .cbElements = 1
         .cDims = 2
         .Bounds(0).lLbound = 0
         .Bounds(0).cElements = m_cAlphaLogoDown.Height
         .Bounds(1).lLbound = 0
         .Bounds(1).cElements = m_cAlphaLogoDown.BytesPerScanLine()
         .pvData = m_cAlphaLogoDown.DIBSectionBitsPtr
      End With
      CopyMemory ByVal VarPtrArray(bImage()), VarPtr(tImage), 4
       
      For x = 0 To m_cAlphaLogoDown.BytesPerScanLine - 4 Step 4
         For y = 0 To m_cAlphaLogoDown.Height - 1
            RGBToHSL bImage(x, y), bImage(x + 1, y), bImage(x + 2, y), h, s, l
            HLSToRGB hue, s, l, r, g, b
            bImage(x + 2, y) = r
            bImage(x + 1, y) = g
            bImage(x, y) = b
         Next y
      Next x
       
      CopyMemory ByVal VarPtrArray(bImage), 0&amp;, 4
   End If
      
   Draw
   
End Sub
Public Property Get Enabled() As Boolean
   Enabled = m_bEnabled
End Property
Public Property Let Enabled(ByVal bState As Boolean)
   m_bEnabled = bState
   createDisabled
   Draw
End Property
Private Sub createDisabled()
   Set m_cDisabledLogo = New cAlphaDibSection
   m_cDisabledLogo.Create m_cAlphaLogo.Width, m_cAlphaLogo.Height
   m_cAlphaLogo.PaintPicture m_cDisabledLogo.hdc
   
      Dim tImage As SAFEARRAY2D
      Dim bImage() As Byte
      
      With tImage
         .cbElements = 1
         .cDims = 2
         .Bounds(0).lLbound = 0
         .Bounds(0).cElements = m_cAlphaLogo.Height
         .Bounds(1).lLbound = 0
         .Bounds(1).cElements = m_cAlphaLogo.BytesPerScanLine()
         .pvData = m_cAlphaLogo.DIBSectionBitsPtr
      End With
      CopyMemory ByVal VarPtrArray(bImage()), VarPtr(tImage), 4
       
      Dim tDisabled As SAFEARRAY2D
      Dim bDisabled() As Byte
      
      With tDisabled
         .cbElements = 1
         .cDims = 2
         .Bounds(0).lLbound = 0
         .Bounds(0).cElements = m_cDisabledLogo.Height
         .Bounds(1).lLbound = 0
         .Bounds(1).cElements = m_cDisabledLogo.BytesPerScanLine()
         .pvData = m_cDisabledLogo.DIBSectionBitsPtr
      End With
      CopyMemory ByVal VarPtrArray(bDisabled()), VarPtr(tDisabled), 4
       
      Dim r As Long, g As Long, b As Long
      Dim x As Long, y As Long
      Dim h As Single, s As Single, l As Single
      Dim hue As Single, saturation As Single, luminance As Single
      Dim lC As Long
      lC = GetSysColor(vbButtonFace And &amp;H1F&amp;)
      r = (lC And &amp;HFF&amp;)
      g = (lC And &amp;HFF00&amp;) \ &amp;H100&amp;
      b = (lC And &amp;HFF0000) \ &amp;H10000
      RGBToHSL r, g, b, hue, saturation, luminance
      saturation = saturation * 0.1
      For x = 0 To m_cAlphaLogo.BytesPerScanLine - 4 Step 4
         For y = 0 To m_cAlphaLogo.Height - 1
            RGBToHSL bImage(x, y), bImage(x + 1, y), bImage(x + 2, y), h, s, l
            If (l &gt; luminance) Then luminance = l
            HLSToRGB hue, saturation, l, r, g, b
            bDisabled(x + 2, y) = r
            bDisabled(x + 1, y) = g
            bDisabled(x, y) = b
         Next y
      Next x
       
      CopyMemory ByVal VarPtrArray(bImage), 0&amp;, 4
   
End Sub
Public Function hitTest(ByVal x As Single, ByVal y As Single) As Boolean
   If m_bEnabled Then
      x = x + 1
      y = y + 1
      If (x &gt;= 0 And x &lt;= m_cAlphaLogo.Width - 1) Then
         If (y &gt;= 0 And y &lt;= m_cAlphaLogo.Height - 1) Then
   
            ' check in alpha logo where we are:
            Dim tImage As SAFEARRAY2D
            Dim bImage() As Byte
            
            With tImage
               .cbElements = 1
               .cDims = 2
               .Bounds(0).lLbound = 0
               .Bounds(0).cElements = m_cAlphaLogo.Height
               .Bounds(1).lLbound = 0
               .Bounds(1).cElements = m_cAlphaLogo.BytesPerScanLine()
               .pvData = m_cAlphaLogo.DIBSectionBitsPtr
            End With
            CopyMemory ByVal VarPtrArray(bImage()), VarPtr(tImage), 4
             
            If bImage(x * 4 + 3, y) &gt; 0 Then
               ' not an alpha area, register a hit:
               hitTest = True
            End If
             
            CopyMemory ByVal VarPtrArray(bImage), 0&amp;, 4
         End If
      End If
   End If
End Function

Public Sub MouseDown(ByVal Button As MouseButtonConstants, ByVal Shift As
 ShiftConstants, ByVal x As Single, ByVal y As Single)
   '
   Dim bOver As Boolean
   bOver = hitTest(x, y)
   If (bOver) Then
      m_bPressed = True
      m_bOver = True
      Draw
   Else
      If Not (bOver = m_bOver) Then
         m_bOver = bOver
         Draw
      End If
   End If
   '
End Sub

Public Sub MouseMove(ByVal Button As MouseButtonConstants, ByVal Shift As
 ShiftConstants, ByVal x As Single, ByVal y As Single)
   '
   Dim bOver As Boolean
   bOver = hitTest(x, y)
   If Not (bOver = m_bOver) Then
      m_bOver = bOver
      Draw
   End If
   If Not m_cMouseTrack Is Nothing Then
      If Not m_cMouseTrack.Tracking Then
         m_cMouseTrack.StartMouseTracking
      End If
   End If
   '
End Sub

Public Sub MouseUp(ByVal Button As MouseButtonConstants, ByVal Shift As
 ShiftConstants, ByVal x As Single, ByVal y As Single)
   '
   m_bPressed = False
   m_bOver = hitTest(x, y)
   Draw
   If (m_bOver) Then
      RaiseEvent Click
   End If
   m_cMouseTrack.StartMouseTracking
   '
End Sub


Public Property Get hInstance() As Long
   hInstance = m_hInst
End Property
Public Property Let hInstance(ByVal hInst As Long)
   m_hInst = hInst
End Property
Public Property Get AlphaLogoId() As Long
   AlphaLogoId = m_lAlphaLogoId
End Property
Public Property Let AlphaLogoId(ByVal lId As Long)
   m_lAlphaLogoId = lId
End Property
Public Property Get AlphaLogoFileName() As String
   AlphaLogoFileName = m_sAlphaLogoFileName
End Property
Public Property Let AlphaLogoFileName(ByVal sFileName As String)
   m_sAlphaLogoFileName = sFileName
End Property
Public Property Get AlphaLogoDownId() As Long
   AlphaLogoDownId = m_lAlphaLogoDownId
End Property
Public Property Let AlphaLogoDownId(ByVal lId As Long)
   m_lAlphaLogoDownId = lId
End Property
Public Property Get AlphaLogoDownFileName() As String
   AlphaLogoDownFileName = m_sAlphaLogoDownFileName
End Property
Public Property Let AlphaLogoDownFileName(ByVal sFileName As String)
   m_sAlphaLogoDownFileName = sFileName
End Property

Private Sub RGBToHSL( _
      ByVal r As Long, ByVal g As Long, ByVal b As Long, _
      h As Single, s As Single, l As Single _
   )
Dim Max As Single
Dim Min As Single
Dim delta As Single
Dim rR As Single, rG As Single, rB As Single

   rR = r / 255: rG = g / 255: rB = b / 255

'{Given: rgb each in [0,1].
' Desired: h in [0,360] and s in [0,1], except if s=0, then h=UNDEFINED.}
        Max = Maximum(rR, rG, rB)
        Min = Minimum(rR, rG, rB)
        l = (Max + Min) / 2    '{This is the lightness}
        '{Next calculate saturation}
        If Max = Min Then
            'begin {Acrhomatic case}
            s = 0
            h = 0
           'end {Acrhomatic case}
        Else
           'begin {Chromatic case}
                '{First calculate the saturation.}
           If l &lt;= 0.5 Then
               s = (Max - Min) / (Max + Min)
           Else
               s = (Max - Min) / (2 - Max - Min)
            End If
            '{Next calculate the hue.}
            delta = Max - Min
           If rR = Max Then
                h = (rG - rB) / delta    '{Resulting color is between yellow
                 and magenta}
           ElseIf rG = Max Then
                h = 2 + (rB - rR) / delta '{Resulting color is between cyan and
                 yellow}
           ElseIf rB = Max Then
                h = 4 + (rR - rG) / delta '{Resulting color is between magenta
                 and cyan}
            End If
            'Debug.Print h
            'h = h * 60
           'If h &lt; 0# Then
           '     h = h + 360            '{Make degrees be nonnegative}
           'End If
        'end {Chromatic Case}
      End If
'end {RGB_to_HLS}
End Sub

Private Sub HLSToRGB( _
      h As Single, s As Single, l As Single, _
      r As Long, g As Long, b As Long _
   )
Dim rR As Single, rG As Single, rB As Single
Dim Min As Single, Max As Single

   If s = 0 Then
      ' Achromatic case:
      rR = l: rG = l: rB = l
   Else
      ' Chromatic case:
      ' delta = Max-Min
      If l &lt;= 0.5 Then
         's = (Max - Min) / (Max + Min)
         ' Get Min value:
         Min = l * (1 - s)
      Else
         's = (Max - Min) / (2 - Max - Min)
         ' Get Min value:
         Min = l - s * (1 - l)
      End If
      ' Get the Max value:
      Max = 2 * l - Min
      
      ' Now depending on sector we can evaluate the h,l,s:
      If (h &lt; 1) Then
         rR = Max
         If (h &lt; 0) Then
            rG = Min
            rB = rG - h * (Max - Min)
         Else
            rB = Min
            rG = h * (Max - Min) + rB
         End If
      ElseIf (h &lt; 3) Then
         rG = Max
         If (h &lt; 2) Then
            rB = Min
            rR = rB - (h - 2) * (Max - Min)
         Else
            rR = Min
            rB = (h - 2) * (Max - Min) + rR
         End If
      Else
         rB = Max
         If (h &lt; 4) Then
            rR = Min
            rG = rR - (h - 4) * (Max - Min)
         Else
            rG = Min
            rR = (h - 4) * (Max - Min) + rG
         End If
         
      End If
            
   End If
   r = rR * 255: g = rG * 255: b = rB * 255
End Sub
Private Function Maximum(rR As Single, rG As Single, rB As Single) As Single
   If (rR &gt; rG) Then
      If (rR &gt; rB) Then
         Maximum = rR
      Else
         Maximum = rB
      End If
   Else
      If (rB &gt; rG) Then
         Maximum = rB
      Else
         Maximum = rG
      End If
   End If
End Function
Private Function Minimum(rR As Single, rG As Single, rB As Single) As Single
   If (rR &lt; rG) Then
      If (rR &lt; rB) Then
         Minimum = rR
      Else
         Minimum = rB
      End If
   Else
      If (rB &lt; rG) Then
         Minimum = rB
      Else
         Minimum = rG
      End If
   End If
End Function

Private Sub Class_Initialize()
   m_bEnabled = True
End Sub

Private Sub m_cMouseTrack_MouseHover(Button As MouseButtonConstants, Shift As
 ShiftConstants, x As Single, y As Single)
   '
   m_cMouseTrack.StartMouseTracking
   '
End Sub

Private Sub m_cMouseTrack_MouseLeave()
   '
   If (m_bOver) Then
      m_bOver = False
      Draw
   End If
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\libraries\compression\index.html" ><IMG SRC="..\..\..\..\..\res\compress.png" ALT="Create and read Zip files and compress your data using Zlib" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">vbMedia</a>&#160;.&#160;<a href="..\index.html">DIB Sections</a>&#160;.&#160;<a href="article.html">Alpha DIBSections</a>&#160;.&#160;<a href="vb6_alpha_dib_section_demonstration.html">VB6 Alpha DIB Section Demonstration</a>&#160;.&#160;cLogoButton.cls</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
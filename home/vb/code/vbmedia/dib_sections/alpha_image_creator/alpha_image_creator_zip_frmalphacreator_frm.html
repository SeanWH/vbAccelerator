<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: frmAlphaCreator.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmAlphaCreator.frm" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">vbMedia</a>&#160;.&#160;<a href="..\index.html">DIB Sections</a>&#160;.&#160;<a href="article.asp\index.html">Alpha Image Creator</a>&#160;.&#160;<a href="alpha_image_creator.html">Alpha Image Creator</a>&#160;.&#160;frmAlphaCreator.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="alpha_image_creator.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Alpha Image Creator</a> (55K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:12800</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=12800&type=zip&title=alpha_20image_20creator_2ezip_5ffrmalphacreator.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />5 Sep 2003<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\adding_scroll_bars_to_forms__pictureboxes_and_usercontrols\article.html">Adding Scroll Bars to Forms, PictureBoxes and User Controls</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\alpha_dibsection\article.html">Alpha DIBSections</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmAlphaCreator.frm</h1><pre>VERSION 5.00
Begin VB.Form frmAlphaCreator 
   Caption         =   "Alpha Image Creator"
   ClientHeight    =   8790
   ClientLeft      =   2835
   ClientTop       =   2235
   ClientWidth     =   7755
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmAlphaCreator.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   8790
   ScaleWidth      =   7755
   Begin VB.CommandButton cmdSaveResult 
      Caption         =   "&amp;Save Result..."
      Enabled         =   0   'False
      Height          =   435
      Left            =   180
      TabIndex        =   8
      Top             =   8040
      Width           =   1455
   End
   Begin VB.CommandButton cmdAlpha 
      Caption         =   "Load Al&amp;pha..."
      Height          =   435
      Left            =   3900
      TabIndex        =   7
      Top             =   3300
      Width           =   1455
   End
   Begin VB.CommandButton cmdSource 
      Caption         =   "Load I&amp;mage..."
      Height          =   435
      Left            =   120
      TabIndex        =   6
      Top             =   3300
      Width           =   1455
   End
   Begin VB.PictureBox picResult 
      Height          =   3735
      Left            =   180
      ScaleHeight     =   245
      ScaleMode       =   3  'Pixel
      ScaleWidth      =   493
      TabIndex        =   5
      Top             =   4260
      Width           =   7455
   End
   Begin VB.PictureBox picAlpha 
      Height          =   2775
      Left            =   3900
      ScaleHeight     =   181
      ScaleMode       =   3  'Pixel
      ScaleWidth      =   241
      TabIndex        =   3
      Top             =   480
      Width           =   3675
   End
   Begin VB.PictureBox picSource 
      Height          =   2775
      Left            =   120
      ScaleHeight     =   181
      ScaleMode       =   3  'Pixel
      ScaleWidth      =   241
      TabIndex        =   2
      Top             =   480
      Width           =   3675
   End
   Begin VB.Label lblResult 
      BackColor       =   &amp;H80000010&amp;
      Caption         =   " Result"
      ForeColor       =   &amp;H80000014&amp;
      Height          =   255
      Left            =   180
      TabIndex        =   4
      Top             =   3900
      Width           =   7455
   End
   Begin VB.Label Label1 
      BackColor       =   &amp;H80000010&amp;
      Caption         =   " Alpha Channel"
      ForeColor       =   &amp;H80000014&amp;
      Height          =   255
      Left            =   3900
      TabIndex        =   1
      Top             =   120
      Width           =   3675
   End
   Begin VB.Label lblSource 
      BackColor       =   &amp;H80000010&amp;
      Caption         =   " Source Image"
      ForeColor       =   &amp;H80000014&amp;
      Height          =   255
      Left            =   120
      TabIndex        =   0
      Top             =   120
      Width           =   3675
   End
End
Attribute VB_Name = "frmAlphaCreator"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private m_cAlphaCreator As New cAlphaImageCreator

Private WithEvents m_scrSource As cScrollBars
Attribute m_scrSource.VB_VarHelpID = -1
Private WithEvents m_scrAlpha As cScrollBars
Attribute m_scrAlpha.VB_VarHelpID = -1
Private WithEvents m_scrResult As cScrollBars
Attribute m_scrResult.VB_VarHelpID = -1

Private Sub createResult()
   m_cAlphaCreator.createAlphaImage
   setScrollBars m_scrResult, m_cAlphaCreator.AlphaImage, picResult
   picResult.Refresh
   cmdSaveResult.Enabled = (m_cAlphaCreator.AlphaChannel.Width &gt; 0)
End Sub

Private Sub setScrollBars( _
      scr As cScrollBars, _
      dib As cAlphaDibSection, _
      pic As PictureBox _
   )
Dim xDiff As Long
Dim yDiff As Long
   xDiff = dib.Width - pic.ScaleWidth
   yDiff = dib.Height - pic.ScaleHeight
   If (xDiff &gt; 0) Then
      scr.SmallChange(efsHorizontal) = 8
      scr.LargeChange(efsHorizontal) = pic.ScaleHeight \ 2
      scr.Max(efsHorizontal) = xDiff
      scr.Visible(efsHorizontal) = True
   Else
      scr.Value(efsHorizontal) = 0
      scr.Visible(efsHorizontal) = False
   End If
   If (yDiff &gt; 0) Then
      scr.SmallChange(efsVertical) = 8
      scr.LargeChange(efsVertical) = pic.ScaleHeight \ 2
      scr.Max(efsVertical) = yDiff
      scr.Visible(efsVertical) = True
   Else
      scr.Value(efsVertical) = 0
      scr.Visible(efsVertical) = False
   End If
End Sub

Private Sub ShowPic( _
      dib As cAlphaDibSection, _
      scr As cScrollBars, _
      pic As PictureBox, _
      ByVal bUseAlphaChannel As Boolean _
   )
Dim left As Long
Dim top As Long
   If (dib.Width &gt; 0) Then
      If (scr.Visible(efsHorizontal)) Then
         left = scr.Value(efsHorizontal)
      End If
      If (scr.Visible(efsVertical)) Then
         top = scr.Value(efsVertical)
      End If
      If (bUseAlphaChannel) Then
         dib.AlphaPaintPicture pic.hdc, 0, 0, pic.ScaleWidth, pic.ScaleHeight,
          left, top
      Else
         dib.PaintPicture pic.hdc, 0, 0, pic.ScaleWidth, pic.ScaleHeight, left,
          top
      End If
   End If
End Sub

Private Sub cmdAlpha_Click()
On Error GoTo ErrorHandler
   Dim c As New cCommonDialog
   Dim sFile As String
   If c.VBGetOpenFileName(sFile, Filter:="Picture Files
    (*.GIF;*.JPG;*.BMP)|*.GIF;*.JPG;*.BMP|All Files (*.*)|*.*",
    DefaultExt:="BMP", Owner:=Me.hwnd) Then
      Dim sPic As StdPicture
      Set sPic = LoadPicture(sFile)
      m_cAlphaCreator.AlphaChannel.CreateFromPicture sPic
      createResult
      setScrollBars m_scrAlpha, m_cAlphaCreator.AlphaChannel, picAlpha
      picAlpha.Refresh
   End If
   Exit Sub
ErrorHandler:
   MsgBox "Problem getting source image: [" &amp; Err.Description &amp; "]",
    vbExclamation
   Exit Sub
End Sub

Private Sub cmdSaveResult_Click()
On Error GoTo ErrorHandler
   Dim c As New cCommonDialog
   Dim sFile As String
   If c.VBGetSaveFileName(sFile, Filter:="Bitmaps (*.BMP)|*.BMP|All Files
    (*.*)|*.*", DefaultExt:="BMP", Owner:=Me.hwnd) Then
      If Not (m_cAlphaCreator.AlphaImage.SavePicture(sFile)) Then
         MsgBox "Failed to save the picture.", vbExclamation
      End If
   End If
   Exit Sub
ErrorHandler:
   MsgBox "Problem saving result image: [" &amp; Err.Description &amp; "]",
    vbExclamation
   Exit Sub
End Sub

Private Sub cmdSource_Click()
On Error GoTo ErrorHandler
   Dim c As New cCommonDialog
   Dim sFile As String
   If c.VBGetOpenFileName(sFile, Filter:="Picture Files
    (*.GIF;*.JPG;*.BMP)|*.GIF;*.JPG;*.BMP|All Files (*.*)|*.*",
    DefaultExt:="BMP", Owner:=Me.hwnd) Then
      Dim sPic As StdPicture
      Set sPic = LoadPicture(sFile)
      m_cAlphaCreator.Image.CreateFromPicture sPic
      createResult
      setScrollBars m_scrSource, m_cAlphaCreator.Image, picSource
      picSource.Refresh
   End If
   Exit Sub
ErrorHandler:
   MsgBox "Problem getting source image: [" &amp; Err.Description &amp; "]",
    vbExclamation
   Exit Sub
End Sub

Private Sub Form_Load()
   Set m_scrSource = New cScrollBars
   m_scrSource.Create picSource.hwnd
   Set m_scrAlpha = New cScrollBars
   m_scrAlpha.Create picAlpha.hwnd
   Set m_scrResult = New cScrollBars
   m_scrResult.Create picResult.hwnd
End Sub

Private Sub m_scrAlpha_Change(eBar As EFSScrollBarConstants)
   picAlpha.Refresh
End Sub

Private Sub m_scrAlpha_Scroll(eBar As EFSScrollBarConstants)
   picAlpha.Refresh
End Sub

Private Sub m_scrResult_Change(eBar As EFSScrollBarConstants)
   picResult.Refresh
End Sub

Private Sub m_scrResult_Scroll(eBar As EFSScrollBarConstants)
   picResult.Refresh
End Sub

Private Sub m_scrSource_Change(eBar As EFSScrollBarConstants)
   picSource.Refresh
End Sub

Private Sub m_scrSource_Scroll(eBar As EFSScrollBarConstants)
   picSource.Refresh
End Sub

Private Sub picAlpha_Paint()
   '
   ShowPic m_cAlphaCreator.AlphaChannel, m_scrAlpha, picAlpha, False
   '
End Sub

Private Sub picResult_Paint()
   '
   ShowPic m_cAlphaCreator.AlphaImage, m_scrResult, picResult, True
   '
End Sub

Private Sub picSource_Paint()
   '
   ShowPic m_cAlphaCreator.Image, m_scrSource, picSource, False
   '
End Sub
</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="javascript:window.alert(&quot;http://vbaccelerator.com/home/include/adredir.asp?url=http://oneandone.co.uk/xml/init?k_id=5791003&image=http://oneandone.co.uk/xml/banner?size=1&number=3\nThis link was not retrieved.&quot;)" ><IMG SRC="..\..\..\..\..\..\..\oneandone_co_uk\xml\banner\size=1&number=3.html" ALT="1&1 Web Hosting" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">vbMedia</a>&#160;.&#160;<a href="..\index.html">DIB Sections</a>&#160;.&#160;<a href="article.asp\index.html">Alpha Image Creator</a>&#160;.&#160;<a href="alpha_image_creator.html">Alpha Image Creator</a>&#160;.&#160;frmAlphaCreator.frm</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 8 September 2003</p></td><td></td></tr></table>
</body></html>
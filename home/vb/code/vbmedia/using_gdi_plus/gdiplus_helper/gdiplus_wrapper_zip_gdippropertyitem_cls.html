<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: GDIPPropertyItem.cls</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: GDIPPropertyItem.cls" /><link rel="stylesheet" href="..\..\..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">vbMedia</a>&#160;.&#160;<a href="..\index.html">Using GDI Plus</a>&#160;.&#160;<a href="article.html">GDI+ Wrapper</a>&#160;.&#160;<a href="gdiplus_wrapper.html">GDIPlus Wrapper</a>&#160;.&#160;GDIPPropertyItem.cls</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="gdiplus_wrapper.html"><img src="..\..\..\..\..\res\get.png" width="8" height="8" alt="Download Page" />GDIPlus Wrapper</a> (57K)</p><br /><br /><img src="..\..\..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:5064</p><p class="nav">&#160;&#160;<a href="..\..\..\..\..\..\linkto_asp\id=5064&type=zip&title=gdiplus_20wrapper_2ezip_5fgdippropertyitem.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><p class="nav">&#160;&#160;<a href="mailto:dseaman@cyberactivex.com">Dana Seaman</a></p><br /><br /><img src="..\..\..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav"><a href="bugtrak.html">BugTrak</a></p><p class="nav"><a href="bugtrak.html#bugs"><img src="..\..\..\..\..\res\btbug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 1 / 1</p><p class="nav"><a href="bugtrak.html#issues"><img src="..\..\..\..\..\res\btissue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 0 / 0</p><p class="nav"><a href="bugtrak.html#questions"><img src="..\..\..\..\..\res\btquestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:8 September 2003</p>
<br /><br /><img src="..\..\..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\..\..\res\update.png" width="8" height="8" alt="Update" />28 Mar 2003<br />First Posted</p><br /><br /><img src="..\..\..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\..\..\type_libraries\gdiplus_type_library\article.html">GDI+ Type Library (GDIPlus.TLB)</a></p><br /><br /><img src="..\..\..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\..\..\the_site\newsite\article.html"><img src="..\..\..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: GDIPPropertyItem.cls</h1><pre>VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
  Persistable = 0  'NotPersistable
  DataBindingBehavior = 0  'vbNone
  DataSourceBehavior  = 0  'vbNone
  MTSTransactionMode  = 0  'NotAnMTSObject
END
Attribute VB_Name = "GDIPPropertyItem"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = True
Option Explicit

Private m_lId As Long
Private m_lLength As Long
Private m_itemType As PropertyTagType
Private m_bData() As Byte

Public Property Get Id() As Long
   Id = m_lId
End Property

Public Property Get ItemType() As PropertyTagType
   ItemType = m_itemType
End Property

Public Property Get Length() As Long
   Length = m_lLength
End Property

Public Property Get Name() As String
   Select Case m_lId
   Case PropertyTagExifIFD
      Name = "ExifIFD"
   Case PropertyTagsIFD
      Name = "IFD"
   Case PropertyTagNewSubfileType
      Name = "NewSubfileType"
   Case PropertyTagSubfileType
      Name = "TagSubFileType"
   Case PropertyTagImageWidth
      Name = "ImageWidth"
   Case PropertyTagImageHeight
      Name = "ImageHeight"
   Case PropertyTagBitsPerSample
      Name = "BitsPerSample"
   Case PropertyTagCompression
Name = "Compression"
Case PropertyTagPhotometricInterp
Name = "PhotometricInterp"
Case PropertyTagThreshHolding
Name = "ThreshHolding"
Case PropertyTagCellWidth
Name = "CellWidth"
Case PropertyTagCellHeight
Name = "CellHeight"
Case PropertyTagFillOrder
Name = "FillOrder"
Case PropertyTagDocumentName
Name = "DocumentName"
Case PropertyTagImageDescription
Name = "ImageDescription"
Case PropertyTagEquipMake
Name = "EquipMake"
Case PropertyTagEquipModel
Name = "EquipModel"
Case PropertyTagStripOffsets
Name = "StripOffsets"
Case PropertyTagOrientation
Name = "Orientation"
Case PropertyTagSamplesPerPixel
Name = "SamplesPerPixel"
Case PropertyTagRowsPerStrip
Name = "RowsPerStrip"
Case PropertyTagStripBytesCount
Name = "StripBytesCount"
Case PropertyTagMinSampleValue
Name = "MinSampleValue"
Case PropertyTagMaxSampleValue
Name = "MaxSampleValue"
Case PropertyTagXResolution
Name = "XResolution"
Case PropertyTagYResolution
Name = "YResolution"
Case PropertyTagPlanarConfig
Name = "PlanarConfig"
Case PropertyTagPageName
Name = "PageName"
Case PropertyTagXPosition
Name = "XPosition"
Case PropertyTagYPosition
Name = "YPosition"
Case PropertyTagFreeOffset
Name = "FreeOffset"
Case PropertyTagFreeByteCounts
Name = "FreeByteCounts"
Case PropertyTagGrayResponseUnit
Name = "GrayResponseUnit"
Case PropertyTagGrayResponseCurve
Name = "GrayResponseCurve"
Case PropertyTagT4Option
Name = "T4Option"
Case PropertyTagT6Option
Name = "T6Option"
Case PropertyTagResolutionUnit
Name = "ResolutionUnit"
Case PropertyTagPageNumber
Name = "PageNumber"
Case PropertyTagTransferFuncition
Name = "TransferFuncition"
Case PropertyTagSoftwareUsed
Name = "SoftwareUsed"
Case PropertyTagDateTime
Name = "DateTime"
Case PropertyTagArtist
Name = "Artist"
Case PropertyTagHostComputer
Name = "HostComputer"
Case PropertyTagPredictor
Name = "Predictor"
Case PropertyTagWhitePoint
Name = "WhitePoint"
Case PropertyTagPrimaryChromaticities
Name = "PrimaryChromaticities"
Case PropertyTagColorMap
Name = "ColorMap"
Case PropertyTagHalftoneHints
Name = "HalftoneHints"
Case PropertyTagTileWidth
Name = "TileWidth"
Case PropertyTagTileLength
Name = "TileLength"
Case PropertyTagTileOffset
Name = "TileOffset"
Case PropertyTagTileByteCounts
Name = "TileByteCounts"
Case PropertyTagInkSet
Name = "InkSet"
Case PropertyTagInkNames
Name = "InkNames"
Case PropertyTagNumberOfInks
Name = "NumberOfInks"
Case PropertyTagDotRange
Name = "DotRange"
Case PropertyTagTargetPrinter
Name = "TargetPrinter"
Case PropertyTagExtraSamples
Name = "ExtraSamples"
Case PropertyTagSampleFormat
Name = "SampleFormat"
Case PropertyTagSMinSampleValue
Name = "SMinSampleValue"
Case PropertyTagSMaxSampleValue
Name = "SMaxSampleValue"
Case PropertyTagTransferRange
Name = "TransferRange"
Case PropertyTagJPEroc
Name = "JPEroc"
Case PropertyTagJPEGInterFormat
Name = "JPEGInterFormat"
Case PropertyTagJPEGInterLength
Name = "JPEGInterLength"
Case PropertyTagJPEGRestartInterval
Name = "JPEGRestartInterval"
Case PropertyTagJPEGLosslessPredictors
Name = "JPEGLosslessPredictors"
Case PropertyTagJPEointTransforms
Name = "JPEointTransforms"
Case PropertyTagJPEGQTables
Name = "JPEGQTables"
Case PropertyTagJPEGDCTables
Name = "JPEGDCTables"
Case PropertyTagJPEGACTables
Name = "JPEGACTables"
Case PropertyTagYCbCrCoefficients
Name = "YCbCrCoefficients"
Case PropertyTagYCbCrSubsampling
Name = "YCbCrSubsampling"
Case PropertyTagYCbCrPositioning
Name = "YCbCrPositioning"
Case PropertyTagREFBlackWhite
Name = "REFBlackWhite"
Case PropertyTagICCProfile
Name = "ICCProfile"
Case PropertyTagGamma
Name = "Gamma"
Case PropertyTagICCProfileDescriptor
Name = "ICCProfileDescriptor"
Case PropertyTagSRGBRenderingIntent
Name = "SRGBRenderingIntent"
Case PropertyTagImageTitle
Name = "ImageTitle"
Case PropertyTagCopyright
Name = "Copyright"
Case PropertyTagResolutionXUnit
Name = "ResolutionXUnit"
Case PropertyTagResolutionYUnit
Name = "ResolutionYUnit"
Case PropertyTagResolutionXLengthUnit
Name = "ResolutionXLengthUnit"
Case PropertyTagResolutionYLengthUnit
Name = "ResolutionYLengthUnit"
Case PropertyTagPrintFlags
Name = "PrintFlags"
Case PropertyTagPrintFlagsVersion
Name = "PrintFlagsVersion"
Case PropertyTagPrintFlagsCrop
Name = "PrintFlagsCrop"
Case PropertyTagPrintFlagsBleedWidth
Name = "PrintFlagsBleedWidth"
Case PropertyTagPrintFlagsBleedWidthScale
Name = "PrintFlagsBleedWidthScale"
Case PropertyTagHalftoneLPI
Name = "HalftoneLPI"
Case PropertyTagHalftoneLPIUnit
Name = "HalftoneLPIUnit"
Case PropertyTagHalftoneDegree
Name = "HalftoneDegree"
Case PropertyTagHalftoneShape
Name = "HalftoneShape"
Case PropertyTagHalftoneMisc
Name = "HalftoneMisc"
Case PropertyTagHalftoneScreen
Name = "HalftoneScreen"
Case PropertyTagJPEGQuality
Name = "JPEGQuality"
Case PropertyTagGridSize
Name = "GridSize"
Case PropertyTagThumbnailFormat
Name = "ThumbnailFormat"
Case PropertyTagThumbnailWidth
Name = "ThumbnailWidth"
Case PropertyTagThumbnailHeight
Name = "ThumbnailHeight"
Case PropertyTagThumbnailColorDepth
Name = "ThumbnailColorDepth"
Case PropertyTagThumbnailPlanes
Name = "ThumbnailPlanes"
Case PropertyTagThumbnailRawBytes
Name = "ThumbnailRawBytes"
Case PropertyTagThumbnailSize
Name = "ThumbnailSize"
Case PropertyTagThumbnailCompressedSize
Name = "ThumbnailCompressedSize"
Case PropertyTagColorTransferFunction
Name = "ColorTransferFunction"
Case PropertyTagThumbnailData
Name = "ThumbnailData"
Case PropertyTagThumbnailImageWidth
Name = "ThumbnailImageWidth"
Case PropertyTagThumbnailImageHeight
Name = "ThumbnailImageHeight"
Case PropertyTagThumbnailBitsPerSample
Name = "ThumbnailBitsPerSample"
Case PropertyTagThumbnailCompression
Name = "ThumbnailCompression"
Case PropertyTagThumbnailPhotometricInterp
Name = "ThumbnailPhotometricInterp"
Case PropertyTagThumbnailImageDescription
Name = "ThumbnailImageDescription"
Case PropertyTagThumbnailEquipMake
Name = "ThumbnailEquipMake"
Case PropertyTagThumbnailEquipModel
Name = "ThumbnailEquipModel"
Case PropertyTagThumbnailStripOffsets
Name = "ThumbnailStripOffsets"
Case PropertyTagThumbnailOrientation
Name = "ThumbnailOrientation"
Case PropertyTagThumbnailSamplesPerPixel
Name = "ThumbnailSamplesPerPixel"
Case PropertyTagThumbnailRowsPerStrip
Name = "ThumbnailRowsPerStrip"
Case PropertyTagThumbnailStripBytesCount
Name = "ThumbnailStripBytesCount"
Case PropertyTagThumbnailResolutionX
Name = "ThumbnailResolutionX"
Case PropertyTagThumbnailResolutionY
Name = "ThumbnailResolutionY"
Case PropertyTagThumbnailPlanarConfig
Name = "ThumbnailPlanarConfig"
Case PropertyTagThumbnailResolutionUnit
Name = "ThumbnailResolutionUnit"
Case PropertyTagThumbnailTransferFunction
Name = "ThumbnailTransferFunction"
Case PropertyTagThumbnailSoftwareUsed
Name = "ThumbnailSoftwareUsed"
Case PropertyTagThumbnailDateTime
Name = "ThumbnailDateTime"
Case PropertyTagThumbnailArtist
Name = "ThumbnailArtist"
Case PropertyTagThumbnailWhitePoint
Name = "ThumbnailWhitePoint"
Case PropertyTagThumbnailPrimaryChromaticities
Name = "ThumbnailPrimaryChromaticities"
Case PropertyTagThumbnailYCbCrCoefficients
Name = "ThumbnailYCbCrCoefficients"
Case PropertyTagThumbnailYCbCrSubsampling
Name = "ThumbnailYCbCrSubsampling"
Case PropertyTagThumbnailYCbCrPositioning
Name = "ThumbnailYCbCrPositioning"
Case PropertyTagThumbnailRefBlackWhite
Name = "ThumbnailRefBlackWhite"
Case PropertyTagThumbnailCopyRight
Name = "ThumbnailCopyRight"
Case PropertyTagLuminanceTable
Name = "LuminanceTable"
Case PropertyTagChrominanceTable
Name = "ChrominanceTable"
Case PropertyTagFrameDelay
Name = "FrameDelay"
Case PropertyTagLoopCount
Name = "LoopCount"
Case PropertyTagPixelUnit
Name = "PixelUnit"
Case PropertyTagPixelPerUnitX
Name = "PixelPerUnitX"
Case PropertyTagPixelPerUnitY
Name = "PixelPerUnitY"
Case PropertyTagPaletteHistogram
Name = "PaletteHistogram"
Case PropertyTagExifExposureTime
Name = "ExifExposureTime"
Case PropertyTagExifFNumber
Name = "ExifFNumber"
Case PropertyTagExifExposureProg
Name = "ExifExposureProg"
Case PropertyTagExifSpectralSense
Name = "ExifSpectralSense"
Case PropertyTagExifISOSpeed
Name = "ExifISOSpeed"
Case PropertyTagExifOECF
Name = "ExifOECF"
Case PropertyTagExifVer
Name = "ExifVer"
Case PropertyTagExifDTOrig
Name = "ExifDTOrig"
Case PropertyTagExifDTDigitized
Name = "ExifDTDigitized"
Case PropertyTagExifCompConfig
Name = "ExifCompConfig"
Case PropertyTagExifCompBPP
Name = "ExifCompBPP"
Case PropertyTagExifShutterSpeed
Name = "ExifShutterSpeed"
Case PropertyTagExifAperture
Name = "ExifAperture"
Case PropertyTagExifBrightness
Name = "ExifBrightness"
Case PropertyTagExifExposureBias
Name = "ExifExposureBias"
Case PropertyTagExifMaxAperture
Name = "ExifMaxAperture"
Case PropertyTagExifSubjectDist
Name = "ExifSubjectDist"
Case PropertyTagExifMeteringMode
Name = "ExifMeteringMode"
Case PropertyTagExifLightSource
Name = "ExifLightSource"
Case PropertyTagExifFlash
Name = "ExifFlash"
Case PropertyTagExifFocalLength
Name = "ExifFocalLength"
Case PropertyTagExifMakerNote
Name = "ExifMakerNote"
Case PropertyTagExifUserComment
Name = "ExifUserComment"
Case PropertyTagExifDTSubsec
Name = "ExifDTSubsec"
Case PropertyTagExifDTOrigSS
Name = "ExifDTOrigSS"
Case PropertyTagExifDTDigSS
Name = "ExifDTDigSS"
Case PropertyTagExifFPXVer
Name = "ExifFPXVer"
Case PropertyTagExifColorSpace
Name = "ExifColorSpace"
Case PropertyTagExifPixXDim
Name = "ExifPixXDim"
Case PropertyTagExifPixYDim
Name = "ExifPixYDim"
Case PropertyTagExifRelatedWav
Name = "ExifRelatedWav"
Case PropertyTagExifInterop
Name = "ExifInterop"
Case PropertyTagExifFlashEnergy
Name = "ExifFlashEnergy"
Case PropertyTagExifSpatialFR
Name = "ExifSpatialFR"
Case PropertyTagExifFocalXRes
Name = "ExifFocalXRes"
Case PropertyTagExifFocalYRes
Name = "ExifFocalYRes"
Case PropertyTagExifFocalResUnit
Name = "ExifFocalResUnit"
Case PropertyTagExifSubjectLoc
Name = "ExifSubjectLoc"
Case PropertyTagExifExposureIndex
Name = "ExifExposureIndex"
Case PropertyTagExifSensingMethod
Name = "ExifSensingMethod"
Case PropertyTagExifFileSource
Name = "ExifFileSource"
Case PropertyTagExifSceneType
Name = "ExifSceneType"
Case PropertyTagExifCfaPattern
Name = "ExifCfaPattern"
Case PropertyTagGpsVer
Name = "GpsVer"
Case PropertyTagGpsLatitudeRef
Name = "GpsLatitudeRef"
Case PropertyTagGpsLatitude
Name = "GpsLatitude"
Case PropertyTagGpsLongitudeRef
Name = "GpsLongitudeRef"
Case PropertyTagGpsLongitude
Name = "GpsLongitude"
Case PropertyTagGpsAltitudeRef
Name = "GpsAltitudeRef"
Case PropertyTagGpsAltitude
Name = "GpsAltitude"
Case PropertyTagGpsGpsTime
Name = "GpsGpsTime"
Case PropertyTagGpsGpsSatellites
Name = "GpsGpsSatellites"
Case PropertyTagGpsGpsStatus
Name = "GpsGpsStatus"
Case PropertyTagGpsGpsMeasureMode
Name = "GpsGpsMeasureMode"
Case PropertyTagGpsGpsDop
Name = "GpsGpsDop"
Case PropertyTagGpsSpeedRef
Name = "GpsSpeedRef"
Case PropertyTagGpsSpeed
Name = "GpsSpeed"
Case PropertyTagGpsTrackRef
Name = "GpsTrackRef"
Case PropertyTagGpsTrack
Name = "GpsTrack"
Case PropertyTagGpsImgDirRef
Name = "GpsImgDirRef"
Case PropertyTagGpsImgDir
Name = "GpsImgDir"
Case PropertyTagGpsMapDatum
Name = "GpsMapDatum"
Case PropertyTagGpsDestLatRef
Name = "GpsDestLatRef"
Case PropertyTagGpsDestLat
Name = "GpsDestLat"
Case PropertyTagGpsDestLongRef
Name = "GpsDestLongRef"
Case PropertyTagGpsDestLong
Name = "GpsDestLong"
Case PropertyTagGpsDestBearRef
Name = "GpsDestBearRef"
Case PropertyTagGpsDestBear
Name = "GpsDestBear"
Case PropertyTagGpsDestDistRef
Name = "GpsDestDistRef"
Case PropertyTagGpsDestDist
Name = "GpsDestDist"

   End Select
End Property

Public Function ValueCount() As Long
   Select Case ItemType
   Case PropertyTagTypeASCII
      ' each item is 1 byte:
      ValueCount = 1
   
   Case PropertyTagTypeUndefined, PropertyTagTypeByte, 6 ' sbyte
      ValueCount = m_lLength
      
   Case PropertyTagTypeShort, 8 ' schar
      ' each item is 2 bytes:
      ValueCount = m_lLength / 2
      
   Case PropertyTagTypeRational, PropertyTagTypeSRational, 12 ' double
      ' each item is 8 bytes:
      ValueCount = m_lLength / 8
      
   Case PropertyTagTypeLong, PropertyTagTypeSLONG, 11 ' float
      ' each item is 4 bytes:
      ValueCount = m_lLength / 4
      
   End Select

End Function

Public Property Get ParseString() As String
   ParseString = StrConv(m_bData, vbUnicode)
End Property
Public Property Get ParseRational(ByVal lItem As Long) As Variant
Dim lStart As Long
   If (lItem &gt; 0) And (lItem &lt;= ValueCount) Then
      lStart = (lItem - 1) * 8
      ReDim lValue(1 To 2) As Long
      RtlMoveMemory lValue(1), m_bData(lStart), 4
      RtlMoveMemory lValue(2), m_bData(lStart + 4), 4
      ParseRational = lValue
   Else
      SetStatusHelper InvalidParameter
   End If
End Property
Public Property Get ParseShort(ByVal lItem As Long) As Integer
Dim lStart As Long
   If (lItem &gt; 0) And (lItem &lt;= ValueCount) Then
      lStart = (lItem - 1) * 2
      Dim iRet As Integer
      RtlMoveMemory iRet, m_bData(lStart), 2
      ParseShort = iRet
   Else
      SetStatusHelper InvalidParameter
   End If
End Property
Public Property Get ParseLong(ByVal lItem As Long) As Long
Dim lStart As Long
   If (lItem &gt; 0) And (lItem &lt;= ValueCount) Then
      lStart = (lItem - 1) * 4
      Dim iRet As Long
      RtlMoveMemory iRet, m_bData(lStart), 4
      ParseLong = iRet
   Else
      SetStatusHelper InvalidParameter
   End If
End Property

Public Sub GetData(ByRef b() As Byte)
Dim i As Long
   If (m_lLength &gt; 0) Then
      For i = LBound(b) To UBound(b)
         b(i) = m_bData(i - LBound(b))
      Next i
   End If
End Sub

Public Property Get DataBufferSize() As Long
   DataBufferSize = ElementDataSize() * m_lLength
End Property

Public Property Get ElementDataSize() As Long
Dim lSize As Long
   Select Case ItemType
   Case PropertyTagTypeASCII, PropertyTagTypeUndefined, PropertyTagTypeByte, 6
    ' sbyte
      ' each item is 1 byte:
      lSize = 1
   Case PropertyTagTypeShort, 8 ' schar
      ' each item is 2 bytes:
      lSize = 2
   Case PropertyTagTypeRational, PropertyTagTypeSRational, 12 ' double
      ' each item is 8 bytes:
      lSize = 8
   Case PropertyTagTypeLong, PropertyTagTypeSLONG, 11 ' float
      ' each item is 4 bytes:
      lSize = 4
   End Select
   ElementDataSize = lSize
End Property

Public Sub Create( _
      ByVal lId As Long, _
      ByVal lLength As Long, _
      ByVal eItemType As PropertyTagType, _
      ByRef b() As Byte _
   )
Dim i As Long
   m_lId = lId
   m_lLength = lLength
   m_itemType = eItemType
   If (m_lLength &gt; 0) Then
      ReDim m_bData(LBound(b) To UBound(b))
      For i = LBound(b) To UBound(b)
         m_bData(i - LBound(b)) = b(i)
      Next i
   End If
End Sub


Friend Sub fInit( _
      ByVal lId As Long, _
      ByVal lLength As Long, _
      ByVal eItemType As PropertyTagType, _
      ByVal lPtr As Long, _
      ByVal lSize As Long _
   )
   m_lId = lId
   m_lLength = lLength
   m_itemType = eItemType
   If Not (lPtr = 0) And (lLength &gt; 0) Then
      Dim lDataSize As Long
      lDataSize = lSize - 16
      If (lDataSize &gt; 0) Then
         ReDim m_bData(0 To lDataSize - 1) As Byte
         RtlMoveMemory m_bData(0), ByVal lPtr, lDataSize
      End If
   End If
End Sub

</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\index.html" ><IMG SRC="..\..\..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\..\..\index.html"><img width="125" height="25" src="..\..\..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\..\..\index.html">VB</a>&#160;.&#160;<a href="..\..\..\index.html">Code</a>&#160;.&#160;<a href="..\..\index.html">vbMedia</a>&#160;.&#160;<a href="..\index.html">Using GDI Plus</a>&#160;.&#160;<a href="article.html">GDI+ Wrapper</a>&#160;.&#160;<a href="gdiplus_wrapper.html">GDIPlus Wrapper</a>&#160;.&#160;GDIPPropertyItem.cls</p><br /><p class="nav"><a href="..\..\..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
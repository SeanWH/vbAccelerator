<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: mWinGeneral.bas</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: mWinGeneral.bas" /><link rel="stylesheet" href="..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\index.html"><img width="125" height="25" src="..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\index.html">VB</a>&#160;.&#160;<a href="..\index.html">Utilities</a>&#160;.&#160;<a href="article.html">ActiveX Documenter</a>&#160;.&#160;<a href="activex_documenter_source.html">ActiveX Documenter Source</a>&#160;.&#160;mWinGeneral.bas</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="activex_documenter_source.html"><img src="..\..\..\res\get.png" width="8" height="8" alt="Download Page" />ActiveX Documenter Source</a> (349K)</p><p /><p class="nav"><a href="vb5_activex_documenter.html"><img src="..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 ActiveX Documenter</a> (148K)</p><p /><p class="nav"><a href="vb6_activex_documenter.html"><img src="..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 ActiveX Documenter</a> (138K)</p><br /><br /><img src="..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:1990</p><p class="nav">&#160;&#160;<a href="..\..\..\..\linkto_asp\id=1990&type=zip&title=activex_20documenter_20source_2ezip_5fmwingeneral.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav"><a href="bugtrak.html">BugTrak</a></p><p class="nav"><a href="bugtrak.html#bugs"><img src="..\..\..\res\btbug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 2 / 2</p><p class="nav"><a href="bugtrak.html#issues"><img src="..\..\..\res\btissue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 0 / 0</p><p class="nav"><a href="bugtrak.html#questions"><img src="..\..\..\res\btquestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:4 August 2003</p>
<br /><br /><img src="..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\res\update.png" width="8" height="8" alt="Update" />23 Feb 2003<br /><p class="update">Fixed hacks to determine default interface and events; you can
      now generate documentation for any TLB</p><p class="update">Types exposed by Type Libraries are now documented correctly;
      previously types appeared as Classes with constant members.</p><p class="update">Documentation associated with Types or enumerated members in 
      Type Libraries now included.</p><p class="update">Documentation generation now 100x quicker for large type
      libraries.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\code\techniques\stringbuilder\article.html">StringBuilder Class for VB</a></p><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\code\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\code\libraries\common_dialogs\code_only_common_dialogs\article.html">Two code only solutions for displaying Common/Dialogs</a></p><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\code\controls\status_bar\status_bar_control\article.html">vbAccelerator Status Bar Control</a></p><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\type_libraries\ole_guid_and_interface_definitions\article.html">Ole Guid and interface definitions (OleGuids.Tlb) </a></p><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\code\libraries\registry_and_ini_files\complete_registry_control\article.html">Complete Registry control</a></p><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\code\controls\menus\popup_menu_activex_dll\article.html">PopupMenu DLL - Create Unlimited Popup Menus</a></p><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\code\controls\toolbar\vbaccelerator_toolbar_and_coolmenu_control\article.html">vbAccelerator Toolbar and CoolMenu Control v3.5</a></p><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\code\controls\tab_controls\vbaccelerator_comctl32_tab_control\article.asp\index.html">vbAccelerator TabStrip Control</a></p><br /><br /><img src="..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\the_site\newsite\article.html"><img src="..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: mWinGeneral.bas</h1><pre>Attribute VB_Name = "mWinGeneral"
Option Explicit

' Types
Public Type RECT
    left As Long
    tOp As Long
    Right As Long
    Bottom As Long
End Type
Public Type POINTAPI
    x As Long
    y As Long
End Type
Public Type MINMAXINFO
    ptReserved As POINTAPI
    ptMaxSize As POINTAPI
    ptMaxPosition As POINTAPI
    ptMinTrackSize As POINTAPI
    ptMaxTrackSize As POINTAPI
End Type
Public Type NMHDR
    hwndFrom As Long
    idfrom As Long
    code As Long
End Type
Public Type msg
    hwnd As Long
    message As Long
    wParam As Long
    lParam As Long
    Time As Long
    pt As POINTAPI
End Type
Public Type WINDOWPOS
   hwnd As Long
   hWndInsertAfter As Long
   x As Long
   y As Long
   cX As Long
   cY As Long
   flags As Long
End Type
Public Type NCCALCSIZE_PARAMS
   rgrc(0 To 2) As RECT
   lppos As Long 'WINDOWPOS
End Type
Public Type DRAWITEMSTRUCT
   CtlType As Long
   CtlID As Long
   itemID As Long
   itemAction As Long
   itemState As Long
   hwndItem As Long
   hdc As Long
   rcItem As RECT
   ItemData As Long
End Type

' Messages:
Public Const WM_DESTROY = &amp;H2
Public Const WM_SIZE = &amp;H5
Public Const WM_ACTIVATE = &amp;H6
Public Const WM_SETFOCUS = &amp;H7
Public Const WM_KILLFOCUS = &amp;H8
Public Const WM_SETREDRAW = &amp;HB
Public Const WM_GETTEXTLENGTH = &amp;HE
Public Const WM_PAINT = &amp;HF
Public Const WM_CLOSE = &amp;H10
Public Const WM_ERASEBKGND = &amp;H14
Public Const WM_SHOWWINDOW = &amp;H18
Public Const WM_ACTIVATEAPP = &amp;H1C
Public Const WM_CANCELMODE = &amp;H1F
Public Const WM_SETCURSOR = &amp;H20
Public Const WM_MOUSEACTIVATE = &amp;H21
Public Const WM_GETMINMAXINFO = &amp;H24
Public Const WM_DRAWITEM = &amp;H2B
Public Const WM_WINDOWPOSCHANGING = &amp;H46
Public Const WM_WINDOWPOSCHANGED = &amp;H47
Public Const WM_NOTIFY = &amp;H4E
Public Const WM_NCHITTEST = &amp;H84
Public Const WM_KEYDOWN = &amp;H100
Public Const WM_KEYUP = &amp;H101
Public Const WM_CHAR = &amp;H102
Public Const WM_COMMAND = &amp;H111
Public Const WM_HSCROLL = &amp;H114
Public Const WM_VSCROLL = &amp;H115
Public Const WM_SYSCOMMAND = &amp;H112
Public Const WM_INITMENUPOPUP = &amp;H117
Public Const WM_MENUSELECT = &amp;H11F
Public Const WM_MENUCHAR = &amp;H120
Public Const WM_MOUSEMOVE = &amp;H200
Public Const WM_LBUTTONDOWN = &amp;H201
Public Const WM_LBUTTONUP = &amp;H202
Public Const WM_LBUTTONDBLCLK = &amp;H203
Public Const WM_RBUTTONDOWN = &amp;H204
Public Const WM_RBUTTONUP = &amp;H205
Public Const WM_RBUTTONDBLCLK = &amp;H206
Public Const WM_MBUTTONDOWN = &amp;H207
Public Const WM_MBUTTONUP = &amp;H208
Public Const WM_PARENTNOTIFY = &amp;H210
Public Const WM_ENTERMENULOOP = &amp;H211
Public Const WM_EXITMENULOOP = &amp;H212
Public Const WM_MDIACTIVATE = &amp;H222
Public Const WM_MDIRESTORE = &amp;H223
Public Const WM_MDIMAXIMIZE = &amp;H225
Public Const WM_MDIGETACTIVE = &amp;H229
Public Const WM_MDISETMENU = &amp;H230
Public Const WM_EXITSIZEMOVE = &amp;H232
Public Const WM_UNDO = &amp;H304&amp;
Public Const WM_CUT = &amp;H300&amp;
Public Const WM_COPY = &amp;H301&amp;
Public Const WM_PASTE = &amp;H302&amp;
Public Const WM_USER = &amp;H400

' Syscommand values:
Public Const SC_MOVE = &amp;HF012&amp;
Public Const SC_MINIMIZE = &amp;HF020&amp;
Public Const SC_CLOSE = &amp;HF060&amp;
Public Const SC_KEYMENU = &amp;HF100&amp;

' Memory functions:
Public Declare Function GlobalAlloc Lib "kernel32" (ByVal wFlags As Long, ByVal
 dwBytes As Long) As Long
Public Declare Function GlobalFree Lib "kernel32" (ByVal hMem As Long) As Long
Public Declare Function GlobalLock Lib "kernel32" (ByVal hMem As Long) As Long
Public Declare Function GlobalReAlloc Lib "kernel32" (ByVal hMem As Long, ByVal
 dwBytes As Long, ByVal wFlags As Long) As Long
Public Declare Function GlobalSize Lib "kernel32" (ByVal hMem As Long) As Long
Public Declare Function GlobalUnlock Lib "kernel32" (ByVal hMem As Long) As Long
Public Const GMEM_DDESHARE = &amp;H2000
Public Const GMEM_DISCARDABLE = &amp;H100
Public Const GMEM_DISCARDED = &amp;H4000
Public Const GMEM_FIXED = &amp;H0
Public Const GMEM_INVALID_HANDLE = &amp;H8000
Public Const GMEM_LOCKCOUNT = &amp;HFF
Public Const GMEM_MODIFY = &amp;H80
Public Const GMEM_MOVEABLE = &amp;H2
Public Const GMEM_NOCOMPACT = &amp;H10
Public Const GMEM_NODISCARD = &amp;H20
Public Const GMEM_NOT_BANKED = &amp;H1000
Public Const GMEM_NOTIFY = &amp;H4000
Public Const GMEM_SHARE = &amp;H2000
Public Const GMEM_VALID_FLAGS = &amp;H7F72
Public Const GMEM_ZEROINIT = &amp;H40
Public Const GPTR = (GMEM_FIXED Or GMEM_ZEROINIT)
Public Const GMEM_LOWER = GMEM_NOT_BANKED
Public Declare Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" ( _
    lpvDest As Any, lpvSource As Any, ByVal cbCopy As Long)
Public Declare Sub CopyMemoryStr Lib "kernel32" Alias "RtlMoveMemory" ( _
    lpvDest As Any, ByVal lpvSource As String, ByVal cbCopy As Long)
Public Declare Sub CopyMemoryToStr Lib "kernel32" Alias "RtlMoveMemory" ( _
    ByVal lpvDest As String, pvSource As Any, ByVal cbCopy As Long)

Public Declare Function InflateRect Lib "user32" (lpRect As RECT, ByVal x As
 Long, ByVal y As Long) As Long
Public Declare Function OffsetRect Lib "user32" (lpRect As RECT, ByVal x As
 Long, ByVal y As Long) As Long
Public Declare Function CreateSolidBrush Lib "gdi32" (ByVal crColor As Long) As
 Long
Public Declare Function DeleteObject Lib "gdi32" (ByVal hObject As Long) As Long
Public Declare Function FillRect Lib "user32" (ByVal hdc As Long, lpRect As
 RECT, ByVal hBrush As Long) As Long
Public Declare Function UnionRect Lib "user32" (lpDestRect As RECT, lpSrc1Rect
 As RECT, lpSrc2Rect As RECT) As Long

' General WinAPI functions:
Public Declare Function timeBeginPeriod Lib "winmm.dll" (ByVal uPeriod As Long)
 As Long
Public Declare Function timeEndPeriod Lib "winmm.dll" (ByVal uPeriod As Long)
 As Long
Public Declare Function timeGetTime Lib "winmm.dll" () As Long
Public Declare Function WindowFromDC Lib "user32" (ByVal hdc As Long) As Long
Public Declare Function SendMessage Lib "user32" Alias "SendMessageA" (ByVal
 hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any) As Long
Public Declare Function SendMessageLong Lib "user32" Alias "SendMessageA"
 (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As
 Long) As Long
Public Declare Function SendMessageStr Lib "user32" Alias "SendMessageA" (ByVal
 hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As
 String) As Long
Public Declare Function SendMessageAsAny Lib "user32" Alias "SendMessageA"
 (ByVal hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, lParam As Any)
 As Long
Public Declare Function PostMessage Lib "user32" Alias "PostMessageA" (ByVal
 hwnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As Long)
 As Long
Public Declare Function ShowWindow Lib "user32" (ByVal hwnd As Long, ByVal
 nCmdShow As Long) As Long
Public Declare Function MoveWindow Lib "user32" (ByVal hwnd As Long, ByVal x As
 Long, ByVal y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal
 bRepaint As Long) As Long
Public Declare Function UpdateWindow Lib "user32" (ByVal hwnd As Long) As Long
Public Declare Function DestroyWindow Lib "user32" (ByVal hwnd As Long) As Long
Public Declare Function EnableWindow Lib "user32" (ByVal hwnd As Long, ByVal
 fEnable As Long) As Long
Public Declare Function FindWindowEx Lib "user32" Alias "FindWindowExA" (ByVal
 hWnd1 As Long, ByVal hWnd2 As Long, ByVal lpsz1 As String, ByVal lpsz2 As
 String) As Long
Public Declare Function GetActiveWindow Lib "user32" () As Long
Public Declare Function GetParent Lib "user32" (ByVal hwnd As Long) As Long
Public Declare Function SetParent Lib "user32" (ByVal hWndCHild As Long, ByVal
 hWndNewParent As Long) As Long
Public Declare Function GetWindow Lib "user32" (ByVal hwnd As Long, ByVal wCmd
 As Long) As Long
Public Declare Function GetClassName Lib "user32" Alias "GetClassNameA" (ByVal
 hwnd As Long, ByVal lpClassName As String, ByVal nMaxCount As Long) As Long
Public Declare Function GetWindowRect Lib "user32" (ByVal hwnd As Long, lpRect
 As RECT) As Long
Public Declare Function GetClientRect Lib "user32" (ByVal hwnd As Long, lpRect
 As RECT) As Long
Public Declare Function GetProp Lib "user32" Alias "GetPropA" (ByVal hwnd As
 Long, ByVal lpString As String) As Long
Public Declare Function SetProp Lib "user32" Alias "SetPropA" (ByVal hwnd As
 Long, ByVal lpString As String, ByVal hData As Long) As Long
Public Declare Function RemoveProp Lib "user32" Alias "RemovePropA" (ByVal hwnd
 As Long, ByVal lpString As String) As Long
Public Declare Function WindowFromPointXY Lib "user32" Alias "WindowFromPoint"
 (ByVal xPoint As Long, ByVal yPoint As Long) As Long
Public Declare Function ScreenToClient Lib "user32" (ByVal hwnd As Long,
 lpPoint As POINTAPI) As Long
Public Declare Function ClientToScreen Lib "user32" (ByVal hwnd As Long,
 lpPoint As POINTAPI) As Long
Public Declare Function MapWindowPoints Lib "user32" (ByVal hwndFrom As Long,
 ByVal hwndTo As Long, lppt As Any, ByVal cPoints As Long) As Long
Public Declare Function SetCapture Lib "user32" (ByVal hwnd As Long) As Long
Public Declare Function ReleaseCapture Lib "user32" () As Long
Public Declare Function GetCursorPos Lib "user32" (lpPoint As POINTAPI) As Long
Public Declare Function InvalidateRect Lib "user32" (ByVal hwnd As Long, lpRect
 As RECT, ByVal bErase As Long) As Long
Public Declare Function InvalidateRectAsNull Lib "user32" Alias
 "InvalidateRect" (ByVal hwnd As Long, ByVal lpRect As Long, ByVal bErase As
 Long) As Long
Public Declare Function CreateWindowEX Lib "user32" Alias "CreateWindowExA"
 (ByVal dwExStyle As Long, ByVal lpClassName As String, ByVal lpWindowName As
 String, ByVal dwStyle As Long, ByVal x As Long, ByVal y As Long, ByVal nWidth
 As Long, ByVal nHeight As Long, ByVal hWndParent As Long, ByVal hMenu As Long,
 ByVal hInstance As Long, lpParam As Any) As Long
Public Declare Function CallWindowProc Lib "user32" Alias "CallWindowProcA"
 (ByVal lpPrevWndFunc As Long, ByVal hwnd As Long, ByVal msg As Long, ByVal
 wParam As Long, ByVal lParam As Long) As Long
Public Declare Function SetWindowLong Lib "user32" Alias "SetWindowLongA"
 (ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Any) As Long
Public Declare Function GetWindowLong Lib "user32" Alias "GetWindowLongA"
 (ByVal hwnd As Long, ByVal nIndex As Long) As Long
Public Declare Function SetWindowPos Lib "user32" (ByVal hwnd As Long, ByVal
 hWndInsertAfter As Long, ByVal x As Long, ByVal y As Long, ByVal cX As Long,
 ByVal cY As Long, ByVal wFlags As Long) As Long
Public Declare Function GetFocus Lib "user32" () As Long
Public Declare Function LockWindowUpdate Lib "user32" (ByVal hwndLock As Long)
 As Long
Public Declare Function IsWindowVisible Lib "user32" (ByVal hwnd As Long) As
 Long
Public Declare Function WindowFromPoint Lib "user32" (ByVal xPoint As Long,
 ByVal yPoint As Long) As Long
Public Declare Function IsZoomed Lib "user32" (ByVal hwnd As Long) As Long
' SetWIndowPos
Public Const HWND_TOPMOST = -1
Public Const HWND_DESKTOP = 0
Public Const SWP_NOSIZE = &amp;H1
Public Const SWP_NOMOVE = &amp;H2
Public Const SWP_NOREDRAW = &amp;H8
Public Const SWP_SHOWWINDOW = &amp;H40
Public Const SWP_FRAMECHANGED = &amp;H20        '  The frame changed: send
 WM_NCCALCSIZE
Public Const SWP_DRAWFRAME = SWP_FRAMECHANGED
Public Const SWP_HIDEWINDOW = &amp;H80
Public Const SWP_NOACTIVATE = &amp;H10
Public Const SWP_NOCOPYBITS = &amp;H100
Public Const SWP_NOOWNERZORDER = &amp;H200      '  Don't do owner Z ordering
Public Const SWP_NOREPOSITION = SWP_NOOWNERZORDER
Public Const SWP_NOZORDER = &amp;H4

Public Declare Function SetFocusAPI Lib "user32" Alias "SetFocus" (ByVal hwnd
 As Long) As Long
Public Declare Function LoadLibrary Lib "kernel32" Alias "LoadLibraryA" (ByVal
 lpLibFileName As String) As Long
Public Declare Function FreeLibrary Lib "kernel32" (ByVal hLibModule As Long)
 As Long

' Graphics sort of functions
Public Declare Function GetSysColor Lib "user32" (ByVal nIndex As Long) As Long
Public Declare Function DrawEdgeAPI Lib "user32" Alias "DrawEdge" (ByVal hdc As
 Long, qrc As RECT, ByVal edge As Long, ByVal grfFlags As Long) As Long
Public Declare Function OleTranslateColor Lib "oleaut32.dll" (ByVal lOleColor
 As Long, ByVal lHPalette As Long, lColorRef As Long) As Long
Public Declare Function LoadImage Lib "user32" Alias "LoadImageA" (ByVal hInst
 As Long, ByVal lpsz As String, ByVal un1 As Long, ByVal n1 As Long, ByVal n2
 As Long, ByVal un2 As Long) As Long
Public Declare Function LoadImageLong Lib "user32" Alias "LoadImageA" (ByVal
 hInst As Long, ByVal lpsz As Long, ByVal un1 As Long, ByVal n1 As Long, ByVal
 n2 As Long, ByVal un2 As Long) As Long
Public Const CF_BITMAP = 2
Public Const LR_LOADMAP3DCOLORS = &amp;H1000
Public Const LR_LOADFROMFILE = &amp;H10
Public Const LR_LOADTRANSPARENT = &amp;H20
Declare Function GetDeviceCaps Lib "gdi32" (ByVal hdc As Long, ByVal nIndex As
 Long) As Long
Public Const HORZRES = 8            '  Horizontal width in pixels
Public Const VERTRES = 10           '  Vertical width in pixels
Public Const BITSPIXEL = 12
Public Const LOGPIXELSX = 88        '  Logical pixels/inch in X
Public Const LOGPIXELSY = 90        '  Logical pixels/inch in Y
Public Const PHYSICALOFFSETX = 112 '  Physical Printable Area x margin
Public Const PHYSICALOFFSETY = 113 '  Physical Printable Area y margin
Public Const PHYSICALHEIGHT = 111 '  Physical Height in device units
Public Const PHYSICALWIDTH = 110 '  Physical Width in device units
Declare Function SetMapMode Lib "gdi32" (ByVal hdc As Long, ByVal nMapMode As
 Long) As Long
Declare Function StartDoc Lib "gdi32" Alias "StartDocA" (ByVal hdc As Long,
 lpdi As DOCINFO) As Long
Declare Function StartPage Lib "gdi32" (ByVal hdc As Long) As Long
Declare Function EndPage Lib "gdi32" (ByVal hdc As Long) As Long
Declare Function EndDoc Lib "gdi32" (ByVal hdc As Long) As Long
Declare Function DeleteDC Lib "gdi32" (ByVal hdc As Long) As Long
Public Const MM_TEXT = 1
' Pen functions:
Public Declare Function CreatePen Lib "gdi32" (ByVal nPenStyle As Long, ByVal
 nWidth As Long, ByVal crColor As Long) As Long
    Public Const PS_DASH = 1
    Public Const PS_DASHDOT = 3
    Public Const PS_DASHDOTDOT = 4
    Public Const PS_DOT = 2
    Public Const PS_SOLID = 0
    Public Const PS_NULL = 5
Public Declare Function LineTo Lib "gdi32" (ByVal hdc As Long, ByVal x As Long,
 ByVal y As Long) As Long
Public Declare Function MoveToEx Lib "gdi32" (ByVal hdc As Long, ByVal x As
 Long, ByVal y As Long, lpPoint As POINTAPI) As Long


Private Const MAX_PATH = 255

' Printing support:

' VB API VIEWER VERSION OF DOCINFO STRUCTURE IS WRONG!
Type DOCINFO
    cbSize As Long
    lpszDocName As Long
    lpszOutput As Long
End Type
Type PrintDlg
    lStructSize As Long
    hWndOwner As Long
    hDevMode As Long
    hDevNames As Long
    hdc As Long
    flags As Long
    nFromPage As Integer
    nToPage As Integer
    nMinPage As Integer
    nMaxPage As Integer
    nCopies As Integer
    hInstance As Long
    lCustData As Long
    lpfnPrintHook As Long
    lpfnSetupHook As Long
    lpPrintTemplateName As String
    lpSetupTemplateName As String
    hPrintTemplate As Long
    hSetupTemplate As Long
End Type
Public Declare Function PrintDlg Lib "COMDLG32.DLL" _
    Alias "PrintDlgA" (prtdlg As PrintDlg) As Long

'Window Styles:
Public Const WS_CHILD = &amp;H40000000
Public Const WS_HSCROLL = &amp;H100000
Public Const WS_VSCROLL = &amp;H200000
Public Const WS_VISIBLE = &amp;H10000000
Public Const WS_CLIPCHILDREN = &amp;H2000000
Public Const WS_CLIPSIBLINGS = &amp;H4000000
Public Const WS_BORDER = &amp;H800000
Public Const WS_TABSTOP = &amp;H10000
Public Const WS_POPUP = &amp;H80000000
Public Const WS_SYSMENU = &amp;H80000
Public Const WS_THICKFRAME = &amp;H40000
Public Const WS_MINIMIZEBOX = &amp;H20000
Public Const WS_MAXIMIZEBOX = &amp;H10000
Public Const WS_DLGFRAME = &amp;H400000

Public Const WS_EX_TOPMOST = &amp;H8&amp;
Public Const WS_EX_CLIENTEDGE = &amp;H200&amp;
Public Const WS_EX_TRANSPARENT = &amp;H20&amp;
Public Const WS_EX_STATICEDGE = &amp;H20000
Public Const WS_EX_TOOLWINDOW = &amp;H80&amp;
Public Const WS_EX_RIGHT = &amp;H1000&amp;
Public Const WS_EX_RTLREADING = &amp;H2000&amp;


Public Const GWL_STYLE = (-16)
Public Const GWL_EXSTYLE = (-20)
Public Const GWL_USERDATA = (-21)
Public Const GWL_WNDPROC = -4
Public Const GWL_HWNDPARENT = (-8)

Public Const SW_SHOW = 5
Public Const SW_HIDE = 0
Public Const SW_SHOWNORMAL = 1
Public Const GW_CHILD = 5
Public Const GW_HWNDNEXT = 2
Public Const CW_USEDEFAULT  As Long = &amp;H80000000
Public Const GDI_ERROR = &amp;HFFFF

' mouse activate responses
Public Const MA_ACTIVATE = 1
Public Const MA_ACTIVATEANDEAT = 2
Public Const MA_NOACTIVATE = 3
Public Const MA_NOACTIVATEANDEAT = 4

 
Private Declare Function ShellExecute Lib "shell32.dll" Alias "ShellExecuteA"
 (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile As String,
 ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As
 Long) As Long
Private Declare Function ShellExecuteForExplore Lib "shell32.dll" Alias
 "ShellExecuteA" (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile
 As String, lpParameters As Any, lpDirectory As Any, ByVal nShowCmd As Long) As
 Long
Public Enum EShellShowConstants
    essSW_HIDE = 0
    essSW_MAXIMIZE = 3
    essSW_MINIMIZE = 6
    essSW_SHOWMAXIMIZED = 3
    essSW_SHOWMINIMIZED = 2
    essSW_SHOWNORMAL = 1
    essSW_SHOWNOACTIVATE = 4
    essSW_SHOWNA = 8
    essSW_SHOWMINNOACTIVE = 7
    essSW_SHOWDEFAULT = 10
    essSW_RESTORE = 9
    essSW_SHOW = 5
End Enum
Private Const ERROR_FILE_NOT_FOUND = 2&amp;
Private Const ERROR_PATH_NOT_FOUND = 3&amp;
Private Const ERROR_BAD_FORMAT = 11&amp;
Private Const SE_ERR_ACCESSDENIED = 5        ' access denied
Private Const SE_ERR_ASSOCINCOMPLETE = 27
Private Const SE_ERR_DDEBUSY = 30
Private Const SE_ERR_DDEFAIL = 29
Private Const SE_ERR_DDETIMEOUT = 28
Private Const SE_ERR_DLLNOTFOUND = 32
Private Const SE_ERR_FNF = 2                ' file not found
Private Const SE_ERR_NOASSOC = 31
Private Const SE_ERR_PNF = 3                ' path not found
Private Const SE_ERR_OOM = 8                ' out of memory
Private Const SE_ERR_SHARE = 26

Public Declare Function GetAsyncKeyState Lib "user32" (ByVal vKey As Long) As
 Integer
' Virtual key code constants:
Public Const VK_SHIFT = &amp;H10&amp;
Public Const VK_CONTROL = &amp;H11&amp;
Public Const VK_MENU = &amp;H12&amp; ' Alt key

Declare Sub mouse_event Lib "user32" (ByVal dwFlags As Long, ByVal dx As Long,
 ByVal dy As Long, ByVal cButtons As Long, ByVal dwExtraInfo As Long)
Public Const MOUSEEVENTF_ABSOLUTE = &amp;H8000 '  absolute move
Public Const MOUSEEVENTF_LEFTDOWN = &amp;H2 '  left button down
Public Const MOUSEEVENTF_LEFTUP = &amp;H4 '  left button up
Public Const MOUSEEVENTF_MIDDLEDOWN = &amp;H20 '  middle button down
Public Const MOUSEEVENTF_MIDDLEUP = &amp;H40 '  middle button up
Public Const MOUSEEVENTF_MOVE = &amp;H1 '  mouse move
Public Const MOUSEEVENTF_RIGHTDOWN = &amp;H8 '  right button down
Public Const MOUSEEVENTF_RIGHTUP = &amp;H10 '  right button up

Public Type OVERLAPPED
    Internal As Long
    InternalHigh As Long
    offset As Long
    OffsetHigh As Long
    hEvent As Long
End Type
Public Const OFS_MAXPATHNAME = 128
Public Type OFSTRUCT
    cBytes As Byte
    fFixedDisk As Byte
    nErrCode As Integer
    Reserved1 As Integer
    Reserved2 As Integer
    szPathName(OFS_MAXPATHNAME) As Byte
End Type
' Streaming support:
Public Declare Function WriteFile Lib "kernel32" (ByVal hFile As Long, lpBuffer
 As Any, ByVal nNumberOfBytesToWrite As Long, lpNumberOfBytesWritten As Long,
 ByVal lpOverlapped As Long) As Long 'lpOverlapped As OVERLAPPED) As Long
Public Declare Function OpenFile Lib "kernel32" (ByVal lpFileName As String,
 lpReOpenBuff As OFSTRUCT, ByVal wStyle As Long) As Long
Public Declare Function ReadFile Lib "kernel32" (ByVal hFile As Long, lpBuffer
 As Any, ByVal nNumberOfBytesToRead As Long, lpNumberOfBytesRead As Long, ByVal
 lpOverlapped As Long) As Long 'lpOverlapped As OVERLAPPED) As Long
Public Declare Function CloseHandle Lib "kernel32" (ByVal hObject As Long) As
 Long
Public Const OF_CANCEL = &amp;H800
Public Const OF_CREATE = &amp;H1000
Public Const OF_DELETE = &amp;H200
Public Const OF_EXIST = &amp;H4000
Public Const OF_PARSE = &amp;H100
Public Const OF_PROMPT = &amp;H2000
Public Const OF_REOPEN = &amp;H8000
Public Const OF_SHARE_COMPAT = &amp;H0
Public Const OF_SHARE_DENY_NONE = &amp;H40
Public Const OF_SHARE_DENY_READ = &amp;H30
Public Const OF_SHARE_DENY_WRITE = &amp;H20
Public Const OF_SHARE_EXCLUSIVE = &amp;H10
Public Const OF_VERIFY = &amp;H400
Public Const OF_WRITE = &amp;H1
Public Const OF_READ = &amp;H0
Public Const OF_READWRITE = &amp;H2

Public Enum EShellFolderTypes
     CSIDL_DESKTOP = &amp;H0
     CSIDL_INTERNET = &amp;H1
     CSIDL_PROGRAMS = &amp;H2
     CSIDL_CONTROLS = &amp;H3
     CSIDL_PRINTERS = &amp;H4
     CSIDL_PERSONAL = &amp;H5
     CSIDL_FAVORITES = &amp;H6
     CSIDL_STARTUP = &amp;H7
     CSIDL_RECENT = &amp;H8
     CSIDL_SENDTO = &amp;H9
     CSIDL_BITBUCKET = &amp;HA
     CSIDL_STARTMENU = &amp;HB
     CSIDL_DESKTOPDIRECTORY = &amp;H10
     CSIDL_DRIVES = &amp;H11
     CSIDL_NETWORK = &amp;H12
     CSIDL_NETHOOD = &amp;H13
     CSIDL_FONTS = &amp;H14
     CSIDL_TEMPLATES = &amp;H15
     CSIDL_COMMON_STARTMENU = &amp;H16
     CSIDL_COMMON_PROGRAMS = &amp;H17
     CSIDL_COMMON_STARTUP = &amp;H18
     CSIDL_COMMON_DESKTOPDIRECTORY = &amp;H19
     CSIDL_APPDATA = &amp;H1A
     CSIDL_PRINTHOOD = &amp;H1B
     CSIDL_ALTSTARTUP = &amp;H1D                         ' // DBCS
     CSIDL_COMMON_ALTSTARTUP = &amp;H1E                  ' // DBCS
     CSIDL_COMMON_FAVORITES = &amp;H1F
     CSIDL_INTERNET_CACHE = &amp;H20
     CSIDL_COOKIES = &amp;H21
     CSIDL_HISTORY = &amp;H22
End Enum

' IE4+ only
Private Declare Function SHGetSpecialFolderPath Lib "Shell32" Alias
 "SHGetSpecialFolderPathA" _
    (ByVal hWndOwner As Long, ByVal lpszPath As String, ByVal nFolder As Long,
     ByVal fCreate As Long) As Long

Declare Function GetSystemMetrics Lib "user32" (ByVal nIndex As Long) As Long


Public Type TPMPARAMS
    cbSize As Long
    rcExclude As RECT
End Type

Public Declare Function GetMenu Lib "user32" (ByVal hwnd As Long) As Long
Public Declare Function SetMenu Lib "user32" (ByVal hwnd As Long, ByVal hMenu
 As Long) As Long
Public Declare Function GetSubMenu Lib "user32" (ByVal hMenu As Long, ByVal
 nPos As Long) As Long
Public Declare Function TrackPopupMenu Lib "user32" (ByVal hMenu As Long, ByVal
 wFlags As Long, ByVal x As Long, ByVal y As Long, ByVal nReserved As Long,
 ByVal hwnd As Long, lprc As Any) As Long
Public Declare Function TrackPopupMenuEx Lib "user32" (ByVal hMenu As Long,
 ByVal un As Long, ByVal n1 As Long, ByVal n2 As Long, ByVal hwnd As Long,
 lpTPMParams As TPMPARAMS) As Long
Public Declare Function PtInRect Lib "user32" (lpRect As RECT, ByVal x As Long,
 ByVal y As Long) As Long
Public Declare Function GetMenuItemCount Lib "user32" (ByVal hMenu As Long) As
 Long
Public Declare Function GetSystemMenu Lib "user32" (ByVal hwnd As Long, ByVal
 bRevert As Long) As Long

Public Const TPM_CENTERALIGN = &amp;H4&amp;
Public Const TPM_LEFTALIGN = &amp;H0&amp;
Public Const TPM_LEFTBUTTON = &amp;H0&amp;
Public Const TPM_RIGHTALIGN = &amp;H8&amp;
Public Const TPM_RIGHTBUTTON = &amp;H2&amp;
Public Const TPM_TOPALIGN = &amp;H0
Public Const TPM_VCENTERALIGN = &amp;H10
Public Const TPM_BOTTOMALIGN = &amp;H20
Public Const TPM_HORIZONTAL = &amp;H0             '/* Horz alignment matters more */
Public Const TPM_VERTICAL = &amp;H40              '/* Vert alignment matters more */
Public Const TPM_NONOTIFY = &amp;H80              '/* Don't send any notification
 msgs */
Public Const TPM_RETURNCMD = &amp;H100
Public Const TPM_NOANIMATION = &amp;H4000&amp;

Public Type BITMAP
    bmType As Long
    bmWidth As Long
    bmHeight As Long
    bmWidthBytes As Long
    bmPlanes As Long
    bmBitsPixel As Integer
    bmBits As Long
End Type
Public Declare Function GetObjectAPI Lib "gdi32" Alias "GetObjectA" (ByVal
 hObject As Long, ByVal nCount As Long, lpObject As Any) As Long
Public Declare Function GetDC Lib "user32" (ByVal hwnd As Long) As Long
Public Declare Function CreateDCAsNull Lib "gdi32" Alias "CreateDCA" (ByVal
 lpDriverName As String, lpDeviceName As Any, lpOutput As Any, lpInitData As
 Any) As Long
Public Declare Function CreateCompatibleDC Lib "gdi32" (ByVal hdc As Long) As
 Long
Public Declare Function CreateCompatibleBitmap Lib "gdi32" (ByVal hdc As Long,
 ByVal nWidth As Long, ByVal nHeight As Long) As Long
Public Declare Function GetWindowDC Lib "user32" (ByVal hwnd As Long) As Long
Public Declare Function ReleaseDC Lib "user32" (ByVal hwnd As Long, ByVal hdc
 As Long) As Long
Public Declare Function DestroyIcon Lib "user32" (ByVal hIcon As Long) As Long
Public Declare Function CreateRectRgn Lib "gdi32" (ByVal X1 As Long, ByVal y1
 As Long, ByVal x2 As Long, ByVal y2 As Long) As Long
Public Declare Function DrawIconEx Lib "user32" (ByVal hdc As Long, ByVal xLeft
 As Long, ByVal yTop As Long, ByVal hIcon As Long, ByVal cxWidth As Long, ByVal
 cyWidth As Long, ByVal istepIfAniCur As Long, ByVal hbrFlickerFreeDraw As
 Long, ByVal diFlags As Long) As Long
Public Const DI_NORMAL = &amp;H3
Public Declare Function DrawFrameControl Lib "user32" (ByVal lHDC As Long, tR
 As RECT, ByVal eFlag As Long, ByVal eStyle As Long) As Long
Public Declare Function DrawCaption Lib "user32" (ByVal hwnd As Long, ByVal hdc
 As Long, pcRect As RECT, ByVal un As Long) As Long
Public Declare Function GetSysColorBrush Lib "user32" (ByVal nIndex As Long) As
 Long
Public Declare Function SelectObject Lib "gdi32" (ByVal hdc As Long, ByVal
 hObject As Long) As Long
Public Declare Function BitBlt Lib "gdi32" (ByVal hDestDC As Long, ByVal x As
 Long, ByVal y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal
 hSrcDC As Long, ByVal xSrc As Long, ByVal ySrc As Long, ByVal dwRop As Long)
 As Long
Public Declare Function SetTextColor Lib "gdi32" (ByVal hdc As Long, ByVal
 crColor As Long) As Long
Public Declare Function SetBkMode Lib "gdi32" (ByVal hdc As Long, ByVal nBkMode
 As Long) As Long
    Public Const OPAQUE = 2
    Public Const TRANSPARENT = 1
Public Declare Function SetBkColor Lib "gdi32" (ByVal hdc As Long, ByVal
 crColor As Long) As Long
Public Declare Function ImageList_SetBkColor Lib "COMCTL32.DLL" ( _
        ByVal hIml As Long, _
        ByVal clrBk As Long _
    ) As Long
' General Win declares:
' Sys colours:
    Public Const COLOR_ACTIVEBORDER = 10
    Public Const COLOR_ACTIVECAPTION = 2
    Public Const COLOR_ADJ_MAX = 100
    Public Const COLOR_ADJ_MIN = -100
    Public Const COLOR_APPWORKSPACE = 12
    Public Const COLOR_BACKGROUND = 1
    Public Const COLOR_BTNFACE = 15
    Public Const COLOR_BTNHIGHLIGHT = 20
    Public Const COLOR_BTNSHADOW = 16
    Public Const COLOR_BTNTEXT = 18
    Public Const COLOR_CAPTIONTEXT = 9
    Public Const COLOR_GRAYTEXT = 17
    Public Const COLOR_HIGHLIGHT = 13
    Public Const COLOR_HIGHLIGHTTEXT = 14
    Public Const COLOR_INACTIVEBORDER = 11
    Public Const COLOR_INACTIVECAPTION = 3
    Public Const COLOR_INACTIVECAPTIONTEXT = 19
    Public Const COLOR_MENU = 4
    Public Const COLOR_MENUTEXT = 7
    Public Const COLOR_SCROLLBAR = 0
    Public Const COLOR_WINDOW = 5
    Public Const COLOR_WINDOWFRAME = 6
    Public Const COLOR_WINDOWTEXT = 8
    Public Const COLORONCOLOR = 3
Public Declare Function DrawText Lib "user32" Alias "DrawTextA" (ByVal hdc As
 Long, ByVal lpStr As String, ByVal nCount As Long, lpRect As RECT, ByVal
 wFormat As Long) As Long
    Public Const DT_BOTTOM = &amp;H8
    Public Const DT_CENTER = &amp;H1
    Public Const DT_LEFT = &amp;H0
    Public Const DT_CALCRECT = &amp;H400
    Public Const DT_WORDBREAK = &amp;H10
    Public Const DT_VCENTER = &amp;H4
    Public Const DT_TOP = &amp;H0
    Public Const DT_TABSTOP = &amp;H80
    Public Const DT_SINGLELINE = &amp;H20
    Public Const DT_RIGHT = &amp;H2
    Public Const DT_NOCLIP = &amp;H100
    Public Const DT_INTERNAL = &amp;H1000
    Public Const DT_EXTERNALLEADING = &amp;H200
    Public Const DT_EXPANDTABS = &amp;H40
    Public Const DT_CHARSTREAM = 4
Declare Function ImageList_GetImageCount Lib "COMCTL32.DLL" ( _
        ByVal hIml As Long _
    ) As Long
Declare Function ImageList_GetImageRect Lib "COMCTL32.DLL" ( _
        ByVal hIml As Long, _
        ByVal i As Long, _
        prcImage As RECT _
    ) As Long


Declare Function ImageList_Draw Lib "COMCTL32.DLL" ( _
        ByVal hIml As Long, _
        ByVal i As Long, _
        ByVal hdcDst As Long, _
        ByVal x As Long, _
        ByVal y As Long, _
        ByVal fStyle As Long _
    ) As Long
Public Const ILD_NORMAL = 0
Public Const ILD_TRANSPARENT = 1
Public Const ILD_BLEND25 = 2
Public Const ILD_SELECTED = 4
Public Const ILD_FOCUS = 4
Public Const ILD_MASK = &amp;H10&amp;
Public Const ILD_IMAGE = &amp;H20&amp;
Public Const ILD_ROP = &amp;H40&amp;
Public Const ILD_OVERLAYMASK = 3840
Declare Function ImageList_GetIcon Lib "COMCTL32.DLL" ( _
        ByVal hIml As Long, _
        ByVal i As Long, _
        ByVal diIgnore As Long _
    ) As Long
Declare Function DrawState Lib "user32" Alias "DrawStateA" _
   (ByVal hdc As Long, _
   ByVal hBrush As Long, _
   ByVal lpDrawStateProc As Long, _
   ByVal lParam As Long, _
   ByVal wParam As Long, _
   ByVal x As Long, _
   ByVal y As Long, _
   ByVal cX As Long, _
   ByVal cY As Long, _
   ByVal fuFlags As Long) As Long
'/* Image type */
Public Const DST_COMPLEX = &amp;H0
Public Const DST_TEXT = &amp;H1
Public Const DST_PREFIXTEXT = &amp;H2
Public Const DST_ICON = &amp;H3
Public Const DST_BITMAP = &amp;H4
' /* State type */
Public Const DSS_NORMAL = &amp;H0
Public Const DSS_UNION = &amp;H10         ' /* Gray string appearance */
Public Const DSS_DISABLED = &amp;H20
Public Const DSS_MONO = &amp;H80
Public Const DSS_RIGHT = &amp;H8000

' DrawEdge:
Public Const BDR_RAISEDOUTER = &amp;H1
Public Const BDR_SUNKENOUTER = &amp;H2
Public Const BDR_RAISEDINNER = &amp;H4
Public Const BDR_SUNKENINNER = &amp;H8

Public Const BDR_OUTER = &amp;H3
Public Const BDR_INNER = &amp;HC
Public Const BDR_RAISED = &amp;H5
Public Const BDR_SUNKEN = &amp;HA

Public Const EDGE_RAISED = (BDR_RAISEDOUTER Or BDR_RAISEDINNER)
Public Const EDGE_SUNKEN = (BDR_SUNKENOUTER Or BDR_SUNKENINNER)
Public Const EDGE_ETCHED = (BDR_SUNKENOUTER Or BDR_RAISEDINNER)
Public Const EDGE_BUMP = (BDR_RAISEDOUTER Or BDR_SUNKENINNER)

Public Const BF_LEFT = &amp;H1
Public Const BF_TOP = &amp;H2
Public Const BF_RIGHT = &amp;H4
Public Const BF_BOTTOM = &amp;H8

Public Const BF_TOPLEFT = (BF_TOP Or BF_LEFT)
Public Const BF_TOPRIGHT = (BF_TOP Or BF_RIGHT)
Public Const BF_BOTTOMLEFT = (BF_BOTTOM Or BF_LEFT)
Public Const BF_BOTTOMRIGHT = (BF_BOTTOM Or BF_RIGHT)
Public Const BF_RECT = (BF_LEFT Or BF_TOP Or BF_RIGHT Or BF_BOTTOM)


Public Const DFCS_CAPTIONCLOSE = &amp;H0
Public Const DFCS_CAPTIONMIN = &amp;H1
Public Const DFCS_CAPTIONMAX = &amp;H2
Public Const DFCS_CAPTIONRESTORE = &amp;H3
Public Const DFCS_CAPTIONHELP = &amp;H4

Public Const DFCS_INACTIVE = &amp;H100
Public Const DFCS_PUSHED = &amp;H200
Public Const DFCS_CHECKED = &amp;H400

Public Enum DFCMenuTypeFlags
   ' Menu types:
   DFCS_MENUARROW = &amp;H0&amp;
   DFCS_MENUCHECK = &amp;H1&amp;
   DFCS_MENUBULLET = &amp;H2&amp;
   DFCS_MENUARROWRIGHT = &amp;H4&amp;
End Enum

'/* flags for DrawFrameControl */
Public Enum DFCFlags
   DFC_CAPTION = 1
   DFC_MENU = 2
   DFC_SCROLL = 3
   DFC_BUTTON = 4
   'Win98/2000 only
   DFC_POPUPMENU = 5
End Enum


Declare Function SaveDC Lib "gdi32" (ByVal hdc As Long) As Long
Declare Function RestoreDC Lib "gdi32" (ByVal hdc As Long, ByVal nSavedDC As
 Long) As Long
Declare Function SetViewportOrgEx Lib "gdi32" (ByVal hdc As Long, ByVal nX As
 Long, ByVal nY As Long, lpPoint As Any) As Long
Declare Function MulDiv Lib "kernel32" (ByVal nNumber As Long, ByVal nNumerator
 As Long, ByVal nDenominator As Long) As Long
Public Type PAINTSTRUCT
   hdc As Long
   fErase As Long
   rcPaint As RECT
   fRestore As Long
   fIncUpdate As Long
   rgbReserved(0 To 31) As Byte
End Type
Public Declare Function BeginPaint Lib "user32" (ByVal hwnd As Long, lpPaint As
 PAINTSTRUCT) As Long
Public Declare Function EndPaint Lib "user32" (ByVal hwnd As Long, lpPaint As
 PAINTSTRUCT) As Long
Public Declare Function GetDesktopWindow Lib "user32" () As Long

Public Declare Function IsWindow Lib "user32" (ByVal hwnd As Long) As Long
Public Const CLR_INVALID = -1


#Const DEBUGMSGBOX = 0
 
Public Sub debugmsg(ByVal smsg As String)
#If DEBUGMSGBOX = 1 Then
   MsgBox smsg, vbInformation
#Else
   Debug.Print smsg
#End If
End Sub

Public Function ShellEx( _
        ByVal sFile As String, _
        Optional ByVal eShowCmd As EShellShowConstants = essSW_SHOWDEFAULT, _
        Optional ByVal sParameters As String = "", _
        Optional ByVal sDefaultDir As String = "", _
        Optional sOperation As String = "open", _
        Optional Owner As Long = 0 _
    ) As Boolean
Dim lR As Long
Dim lErr As Long, sErr As Long
    If (InStr(UCase$(sFile), ".EXE") &lt;&gt; 0) Then
        eShowCmd = 0
    End If
    On Error Resume Next
    If (sParameters = "") And (sDefaultDir = "") Then
        lR = ShellExecuteForExplore(Owner, sOperation, sFile, 0, 0,
         essSW_SHOWNORMAL)
    Else
        lR = ShellExecute(Owner, sOperation, sFile, sParameters, sDefaultDir,
         eShowCmd)
    End If
    If (lR &lt; 0) Or (lR &gt; 32) Then
        ShellEx = True
    Else
        ' raise an appropriate error:
        lErr = vbObjectError + 1048 + lR
        Select Case lR
        Case 0
            lErr = 7: sErr = "Out of memory"
        Case ERROR_FILE_NOT_FOUND
            lErr = 53: sErr = "File not found"
        Case ERROR_PATH_NOT_FOUND
            lErr = 76: sErr = "Path not found"
        Case ERROR_BAD_FORMAT
            sErr = "The executable file is invalid or corrupt"
        Case SE_ERR_ACCESSDENIED
            lErr = 75: sErr = "Path/file access error"
        Case SE_ERR_ASSOCINCOMPLETE
            sErr = "This file type does not have a valid file association."
        Case SE_ERR_DDEBUSY
            lErr = 285: sErr = "The file could not be opened because the target
             application is busy. Please try again in a moment."
        Case SE_ERR_DDEFAIL
            lErr = 285: sErr = "The file could not be opened because the DDE
             transaction failed. Please try again in a moment."
        Case SE_ERR_DDETIMEOUT
            lErr = 286: sErr = "The file could not be opened due to time out.
             Please try again in a moment."
        Case SE_ERR_DLLNOTFOUND
            lErr = 48: sErr = "The specified dynamic-link library was not
             found."
        Case SE_ERR_FNF
            lErr = 53: sErr = "File not found"
        Case SE_ERR_NOASSOC
            sErr = "No application is associated with this file type."
        Case SE_ERR_OOM
            lErr = 7: sErr = "Out of memory"
        Case SE_ERR_PNF
            lErr = 76: sErr = "Path not found"
        Case SE_ERR_SHARE
            lErr = 75: sErr = "A sharing violation occurred."
        Case Else
            sErr = "An error occurred occurred whilst trying to open or print
             the selected file."
        End Select
                
        Err.Raise lErr, , App.EXEName &amp; ".GShell", sErr
        ShellEx = False
    End If

End Function
Public Property Get ShellFolder(ByVal eFolder As EShellFolderTypes) As String
Dim sBuf As String, lR As Long
Dim iPos As Long
    sBuf = String$(MAX_PATH, 0)
    On Error Resume Next
    lR = SHGetSpecialFolderPath(0, sBuf, eFolder, 1)
    If (Err.Number &lt;&gt; 0) Then
        Err.Raise Err.Number, App.EXEName, ".GSystemFolders", "Incorrect Shell
         Version - Internet Explorer 4.0 or higher required."
    Else
        iPos = InStr(sBuf, Chr$(0))
        If (iPos &lt;&gt; 0) Then
            ShellFolder = Mid$(sBuf, iPos - 1)
        Else
            ShellFolder = sBuf
        End If
    End If

End Property

Public Sub ThinBorder(ByVal hwnd As Long)
Dim lStyle As Long

    lStyle = GetWindowLong(hwnd, GWL_EXSTYLE)
    lStyle = lStyle And Not WS_EX_CLIENTEDGE
    lStyle = lStyle Or WS_EX_STATICEDGE
    SetWindowLong hwnd, GWL_EXSTYLE, lStyle
    SetWindowPos hwnd, 0, 0, 0, 0, 0, SWP_NOMOVE Or SWP_NOSIZE Or
     SWP_FRAMECHANGED

End Sub
Public Function giGetShiftState() As Integer
Dim iR As Integer
Dim lR As Long
Dim lKey As Long
    iR = iR Or (-vbShiftMask * gbKeyIsPressed(VK_SHIFT))
    iR = iR Or (-vbAltMask * gbKeyIsPressed(VK_MENU))
    iR = iR Or (-vbCtrlMask * gbKeyIsPressed(VK_CONTROL))
    giGetShiftState = iR

End Function
Public Function gbKeyIsPressed( _
        ByVal nVirtKeyCode As KeyCodeConstants _
    ) As Boolean
Dim lR As Long
    lR = GetAsyncKeyState(nVirtKeyCode)
    If (lR And &amp;H8000&amp;) = &amp;H8000&amp; Then
        gbKeyIsPressed = True
    End If
End Function


Public Function TranslateColor(ByVal clr As OLE_COLOR, _
                        Optional hPal As Long = 0) As Long
    If OleTranslateColor(clr, hPal, TranslateColor) Then
        TranslateColor = -1
    End If
End Function


</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\..\index.html" ><IMG SRC="..\..\..\res\vbaccelad.png" ALT="vbAccelerator - Faster VB Code" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\index.html"><img width="125" height="25" src="..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\index.html">VB</a>&#160;.&#160;<a href="..\index.html">Utilities</a>&#160;.&#160;<a href="article.html">ActiveX Documenter</a>&#160;.&#160;<a href="activex_documenter_source.html">ActiveX Documenter Source</a>&#160;.&#160;mWinGeneral.bas</p><br /><p class="nav"><a href="..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
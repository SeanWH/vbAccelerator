<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: cVBProjectGroup.cls</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: cVBProjectGroup.cls" /><link rel="stylesheet" href="..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\index.html"><img width="125" height="25" src="..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\index.html">VB</a>&#160;.&#160;<a href="..\index.html">Utilities</a>&#160;.&#160;<a href="article.html">Visual Basic Project Zip Utility</a>&#160;.&#160;<a href="vbpzip_source_code.html">VBPZip Source Code</a>&#160;.&#160;cVBProjectGroup.cls</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="info-zip_unzip_dll_(renamed_vbuzip10_dll).html"><img src="..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Info-ZIP Unzip DLL (Renamed vbuzip10.dll)</a> (63K)</p><p /><p class="nav"><a href="vbpzip_source_code.html"><img src="..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VBPZip Source Code</a> (152K)</p><p class="nav"><a href="vbpzip_vb5_executable.html"><img src="..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VBPZip VB5 Executable</a> (69K)</p><p class="nav"><a href="vbpzip_vb6_executable.html"><img src="..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VBPZip VB6 Executable</a> (62K)</p><br /><br /><img src="..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:2150</p><p class="nav">&#160;&#160;<a href="..\..\..\..\linkto_asp\id=2150&type=zip&title=vbpzip_20source_20code_2ezip_5fcvbprojectgroup.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav"><a href="bugtrak.html">BugTrak</a></p><p class="nav"><a href="bugtrak.html#bugs"><img src="..\..\..\res\btbug.png" width="16" height="16" alt="Bug" />&#160;Bugs:</a> 1 / 1</p><p class="nav"><a href="bugtrak.html#issues"><img src="..\..\..\res\btissue.png" width="16" height="16" alt="Issue" />&#160;Issues:</a> 0 / 0</p><p class="nav"><a href="bugtrak.html#questions"><img src="..\..\..\res\btquestion.png" width="16" height="16" alt="Question" />&#160;Questions:</a> 0 / 0</a></p><p class="nav">Updated:3 July 2003</p>
<br /><br /><img src="..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\res\update.png" width="8" height="8" alt="Update" />3 Mar 2003<br /><p class="update">Previous version failed on Windows 2000 because the
	version check in the NoStatusBar component was incorrect. Now fixed.</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\code\libraries\compression\zipping_files\article.html">Zipping files using the free Info-Zip Zip DLL (now with encryption support)</a></p><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\code\libraries\subclassing\ssubtimer\article.html">Subclassing Without The Crashes</a></p><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\code\libraries\compression\introduction_to_the_info-zip_libraries\article.html">Introduction to the freeware Info-ZIP libraries</a></p><br /><br /><img src="..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\the_site\newsite\article.html"><img src="..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: cVBProjectGroup.cls</h1><pre>VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "cVBProjectGroup"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Option Explicit

Private m_bFakeGroup As Boolean
Private m_cVBP() As cVBProject
Private m_iCount As Long
Private m_sPath As String
Private m_sFile As String
Private m_bFixPaths As Boolean

Public Property Get FixPaths() As Boolean
   FixPaths = m_bFixPaths
End Property
Public Property Let FixPaths(ByVal bState As Boolean)
   m_bFixPaths = bState
End Property

Public Sub Zip(ByRef cZ As cZip)
Dim i As Long
   If Not m_bFakeGroup Then
      cZ.AddFileSpec NormalizePath(m_sPath) &amp; m_sFile
   End If
   For i = 1 To m_iCount
      Project(i).Zip cZ
   Next i
End Sub

Public Property Get FakeGroup() As Boolean
   FakeGroup = m_bFakeGroup
End Property
Public Property Get Path() As String
   Path = m_sPath
End Property
Public Property Get FileName() As String
   FileName = m_sFile
End Property

Public Property Get Count() As Long
   Count = m_iCount
End Property
Public Property Get Project(ByVal nIndex As Long) As cVBProject
   Set Project = m_cVBP(nIndex)
End Property

Public Sub Show( _
      lstThis As ListBox, _
      cODList As cSimpleODListBox, _
      cSysILS As cVBALSysImageList, _
      ByVal bShowFolders As Boolean _
   )
Dim lIndent As Long
Dim i As Long
   lstThis.Clear
   If Not m_bFakeGroup Then
      cODList.AddItem lstThis, m_sFile &amp; vbTab &amp; "&lt;ProjectGroup&gt;&lt;FileName&gt;" &amp;
       m_sFile &amp; "&lt;/Name&gt;&lt;/ProjectGroup&gt;", cSysILS.ItemIndex("C:\Junk.VBG"), 0
      lIndent = 1
   End If
   For i = 1 To m_iCount
      m_cVBP(i).Show lstThis, cODList, cSysILS, lIndent, bShowFolders
   Next i
End Sub

Public Sub Load(ByVal sCmd As String)
Dim iPos As Long
Dim sText As String
Dim sThis As String
Dim sType As String
Dim sItem As String
Dim sLine As String
Dim bStartup As Boolean

   sCmd = ReplaceSection(sCmd, """", "")

   iPos = InstrRev(sCmd, "\")
   If iPos &gt; 0 Then
      m_sPath = Left$(sCmd, iPos - 1)
      m_sFile = Mid$(sCmd, iPos + 1)
   Else
      m_sPath = App.Path
      m_sFile = sCmd
   End If
   If UCase$(Right$(sCmd, 3)) = "VBG" Then
      m_bFakeGroup = False
      If ReadFileText(sCmd, sText) Then
         Dim cS As New cSplitString
         cS.Splitter(1) = vbCrLf
         cS.Splitter(2) = "="
         cS.TheString = sText
         sText = ""
         
         Do
            sThis = cS.NextItem
            If cS.SplitItem = 2 Then
               sType = sThis
            Else
               If sType = "StartupProject" Then
                  bStartup = True
                  sItem = sThis
               ElseIf sType = "Project" Then
                  bStartup = False
                  sItem = sThis
               Else
                  sItem = ""
               End If
               
               If Not sItem = "" Then
                  ' Fix up dumb paths:
                  sItem = RelativePath(m_sPath, AddFileToPath(m_sPath, sItem))
               
                  m_iCount = m_iCount + 1
                  ReDim Preserve m_cVBP(1 To m_iCount) As cVBProject
                  Set m_cVBP(m_iCount) = New cVBProject
                  m_cVBP(m_iCount).FixPaths = m_bFixPaths
                  m_cVBP(m_iCount).Load m_sPath, sItem, bStartup
                  sThis = sItem
               End If

            End If
                        
            sText = sText &amp; sThis
            If cS.SplitItem = 2 Then
               sText = sText &amp; "="
            Else
               sText = sText &amp; vbCrLf
            End If
            
         Loop While cS.More
         If m_bFixPaths Then
            ReplaceFileText sCmd, sText
         End If
            
      End If
   Else
      m_bFakeGroup = True
      m_iCount = 1
      ReDim m_cVBP(1 To 1) As cVBProject
      Set m_cVBP(1) = New cVBProject
      m_cVBP(1).FixPaths = m_bFixPaths
      m_cVBP(1).Load m_sPath, m_sFile, True
   End If
End Sub


</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\code\vbmedia\using_gdi_plus\index.html" ><IMG SRC="..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\index.html"><img width="125" height="25" src="..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\index.html">VB</a>&#160;.&#160;<a href="..\index.html">Utilities</a>&#160;.&#160;<a href="article.html">Visual Basic Project Zip Utility</a>&#160;.&#160;<a href="vbpzip_source_code.html">VBPZip Source Code</a>&#160;.&#160;cVBProjectGroup.cls</p><br /><p class="nav"><a href="..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
<html lang="en" >
<head>

<title>vbAccelerator - VB Type Library Registration Utility</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="Whilst all systems are provided with the regsvr32 tool for register 
ActiveX controls and DLLs, there is not an equivalent tool available for Type Libraries. 
This page provides a Type Library registration utility that allows you to register 
Type Libraries more reliably than using VB's Project->References dialog. 
It also allows you to unregister Type Libraries and browse through all the 
type libraries installed on the system, including deleting entries for old and deleted items." /><link rel="stylesheet" href="..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\index.html"><img width="125" height="25" src="..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\index.html">VB</a>&#160;.&#160;<a href="..\index.html">Utilities</a>&#160;.&#160;VB Type Library Registration Utility</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="register_typelib_source_code.html"><img src="..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Register TypeLib Source Code</a> (61K)</p><p /><p class="nav"><a href="vb5_register_typelib_utility.html"><img src="..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB5 Register TypeLib Utility</a> (29K)</p><p /><p class="nav"><a href="vb6_register_typelib_utility.html"><img src="..\..\..\res\get.png" width="8" height="8" alt="Download Page" />VB6 Register TypeLib Utility</a> (26K)</p><br /><br /><img src="..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Article:1431</p><p class="nav">&#160;&#160;<a href="..\..\..\..\linkto_asp\id=1431&type=article&title=vb_20type_20library_20registration_20utility.html">Link to this page</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\res\update.png" width="8" height="8" alt="Update" />19 Dec 2002<br /><p class="update">More usable UI</p><p class="update">VB6 Version</p><p class="update">Ability to save all registered TypeLibs as XML file</p></p><p class="update"><a href="updates.html">Update History &gt;</a></p><br /><br /><img src="..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><p class="nav"><img src="..\..\..\res\rel.png" width="8" height="8" alt="Related Item" /><a href="..\..\type_libraries\ishellfolder\article.html">IShellFolder Extended Type Library Version 1.2 (ISHF_Ex.Tlb)</a></p><br /><br /><img src="..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\the_site\newsite\article.html"><img src="..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>VB Type Library Registration Utility</h1><p class="splash">Register, Unregister and Manage Type Libraries on your system</p><img src="vbregtypelib.png" width="336" height="344" alt="VB Register Type Lib Utility" /><p /><p>Whilst all systems are provided with the <i>regsvr32</i> tool for register 
ActiveX controls and DLLs, there is not an equivalent tool available for Type Libraries. 
This page provides a Type Library registration utility that allows you to register 
Type Libraries more reliably than using VB's Project-&gt;References dialog. 
It also allows you to unregister Type Libraries and browse through all the 
type libraries installed on the system, including deleting entries for old and deleted items.</p><p>The site source code used in this sample includes:</p><ul><li>Complete Registry control</li><li>Common Dialogs without COMDLG32.OCX</li><li>Set Left and Right Margin of Text Boxes and Combo Boxes</li><li>Using ShellExecute from Visual Basic - start any document from its filename only</li><li>Store Objects against a Control's Tag or ItemData property.</li></ul><h2>Calling Unicode Functions in DLLs with String Parameter</h2><p>The code also demonstrates how to make the following calls from Visual Basic:</p><ul><li>LoadTypeLib</li><li>RegisterTypeLib</li><li>UnRegisterTypeLib</li><li>CLSIDFromString</li></ul><p>These calls are interesting because they only have a Unicode implementation, 
even under Win9x. Visual Basic coders are used to calling ANSI functions in DLLs, 
and setting up all string parameters to DLL calls as (for example)</p><pre>    ByVal lpszPath As String</pre>. 
<p>When ever you use <i>ByVal</i> with a string parameter in a declare, you are 
telling VB to convert its internal Unicode representation of the string 
into an ANSI version, and then to pass a pointer to the ANSI string to the function. 
When the function returns, VB converts the ANSI string back to unicode and puts the 
data back into your string.</p><p>When you are using a Unicode function, however, you need to ensure 
Visual Basic never makes the ANSI conversion. That means you can't use the 
<i>As String</i> construct in Unicode function declares. So when a Unicode function 
call requires a String variable parameter, you have three possibilities:</p><ol><li>Modify ByVal .. As String to ByRef .. As Byte and pass the first element of a 
byte array containing the Unicode (double byte) representation to the parameter:
<pre>
' 1. - Using Byte Arrays:
' 
Private Declare Function LoadTypeLib Lib "oleaut32.dll" ( _
    pFileName As Byte, pptlib As Object) As Long

Dim sLib As String
Dim suLib() As Byte
Dim errOK As Long
Dim tlb As Object

   sLib = "C:\Windows\System\ISHF_Ex.TLB"
' Basic automatically translates strings to Unicode Byte arrays
' but doesn't null-terminate, so you must do it yourself
   suLib = sLib &amp; vbNullChar

' Pass first byte of array
   errOK = LoadTypeLib(suLib(0), tlb)
</pre></li><li>Modify ByVal .. As String to ByVal .. As Long and pass StrPtr(sThis) where 
sThis is your string to the Long parameter.
<pre>
' 2. - Using String Pointers:
' 
Private Declare Function LoadTypeLib Lib "oleaut32.dll" ( _
    ByVal pFileName As Long, pptlib As Object) As Long

Dim sLib As String
Dim errOK As Long
Dim tlb As Object

   sLib = "C:\Windows\System\ISHF_Ex.TLB"

' Pass StrPtr to the String argument:
   errOK = LoadTypeLib(StrPtr(sLib), tlb)
</pre></li><li>Write a Type Library. Then you can specify that the parameter is of the 
BSTR Automation type, which happens to be the native VB implementation for 
strings.  You can refer to the ODL and IDL source code in the Type Libraries section for
 more details on building your own Type Libraries containing API declares.</li></ol><p>With Win2000 Microsoft have announced that new function prototypes on the system 
will not have a corresponding ANSI version, and therefore there will be an 
increasing number of calls which need to be made with direct Unicode strings.</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\code\vbmedia\using_gdi_plus\index.html" ><IMG SRC="..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\index.html"><img width="125" height="25" src="..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\index.html">VB</a>&#160;.&#160;<a href="..\index.html">Utilities</a>&#160;.&#160;VB Type Library Registration Utility</p><br /><p class="nav"><a href="..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 1999-2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 23 December 2002</p></td><td></td></tr></table>
</body></html>

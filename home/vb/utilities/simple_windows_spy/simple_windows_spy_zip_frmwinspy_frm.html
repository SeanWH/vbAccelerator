<html lang="en" >
<head>
<title>vbAccelerator - Contents of code file: frmWinSpy.frm</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta name="AUTHOR" content="Steve McMahon" /><meta name="KEYWORDS" content=".NET, .NET Framework, C#, CSharp, VB, Visual Basic, VB5, VB6, Visual Basic, Active X, Controls, Components" /><meta name="DESCRIPTION" content="vbAccelerator - Contents of code file: frmWinSpy.frm" /><link rel="stylesheet" href="..\..\..\res\screen.css" media="SCREEN" /><link rel="stylesheet" href="..\..\..\res\print.css" media="PRINT" /></head><body>
<table>
<tr class="adbar" bgcolor="#83726a"><td colspan="3">
<!-- TF 468x60 JScript HORIZ NoPop code -->
<script language=javascript><!--
document.write('<scr'+'ipt language=javascript src="http://a.tribalfusion.com/j.ad?site=VBAcceleratorcom&adSpace=ROS&size=468x60&type=horiz&pop=0&requestID='+((new Date()).getTime() % 2147483648) + Math.random()+'"></scr'+'ipt>');
//-->
</script>
<noscript>
   <a href="javascript:window.alert(&quot;http://a.tribalfusion.com/i.click?site=VBAcceleratorcom&adSpace=ROS&size=468x60&requestID=1423477941\nThis link was not retrieved.&quot;)" target=_blank>
   <img src="http://cdn5.tribalfusion.com/media/493786.gif" 
                  width=468 height=60 border=0 alt="Click Here"></a>
</noscript>
<!-- TF 468x60 JScript HORIZ NoPop code -->
</td></tr><tr class="navbar"><td><a href="..\..\..\index.html"><img width="125" height="25" src="..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\index.html">VB</a>&#160;.&#160;<a href="..\index.html">Utilities</a>&#160;.&#160;<a href="article.html">Simple Windows Spy Utility</a>&#160;.&#160;<a href="simple_windows_spy.html">Simple Windows Spy</a>&#160;.&#160;frmWinSpy.frm</p></td><td></td></tr><tr class="navbar"><td colspan="3"><hr /></td></tr><tr valign="top"><td class="sidebar"><img src="..\..\..\res\download.png" width="125" height="21" alt="Downloads" /><p class="nav"><a href="simple_windows_spy.html"><img src="..\..\..\res\get.png" width="8" height="8" alt="Download Page" />Simple Windows Spy</a> (13K)</p><br /><br /><img src="..\..\..\res\information.png" width="125" height="21" alt="Information" /><p class="nav">Zip:2510</p><p class="nav">&#160;&#160;<a href="..\..\..\..\linkto_asp\id=2510&type=zip&title=simple_20windows_20spy_2ezip_5ffrmwinspy.html">Link to code Zip</a></p><p class="nav">Applies To:</p><p class="nav">&#160;&#160;VB5</p><p class="nav">&#160;&#160;VB6</p><p class="nav">Author:</p><p class="nav">&#160;&#160;<a href="mailto:steve@vbaccelerator.com">Steve McMahon</a></p><br /><br /><img src="..\..\..\res\bugtrak.png" width="125" height="21" alt="BugTrak System" /><p class="nav">No logged bugs.</p><br /><br /><img src="..\..\..\res\updates.png" width="125" height="21" alt="Updates" /><p class="nav"><img src="..\..\..\res\update.png" width="8" height="8" alt="Update" />2 Jan 2003<br />First Posted</p><br /><br /><img src="..\..\..\res\related.png" width="125" height="21" alt="Related Items" /><br /><br /><img src="..\..\..\res\search.png" width="125" height="21" alt="Search" />
<!-- Search Google -->
<form method="GET" action="http://www.google.com/custom">
<a href="javascript:window.alert(&quot;http://www.google.com/search\nThis link was not retrieved.&quot;)"><img src="..\..\..\..\..\www_google_com\logos\logo_40wht.gif" alt="Google" /></A><br />
<input type="text" name="q" size="31" maxlength="255" value="" class="search" /><br />
<input type="submit" name="sa" value="Search Google" class="search" />
<input type="hidden" name="cof" value="T:black;LW:330;ALC:990000;L:http://www.vbaccelerator.com/images/accl9.gif;LC:660000;LH:66;BGC:white;AH:left;VLC:999966;S:http://vbaccelerator.com/;GALT:999966;AWFID:67c7759ff27e5395;" />
<input type="hidden" name="domains" value="vbaccelerator.com" /><br />
<p class="nav"><input type="radio" name="sitesearch" value="" />Search WWW<br /></p>
<p class="nav"><input type="radio" name="sitesearch" value="vbaccelerator.com" checked="true" />vbAccelerator<br /></p>
</FORM>
<!-- Search Google -->
<br /><br />

<a href="..\..\..\the_site\newsite\article.html"><img src="..\..\..\res\newsite.png" width="125" height="129" alt="The New Site" /></a>
<br /><br />
</td><td width="100%" valign="top"><h1>vbAccelerator - Contents of code file: frmWinSpy.frm</h1><pre>VERSION 5.00
Begin VB.Form frmSimpleWinSpy 
   Caption         =   "Simple Windows Spy"
   ClientHeight    =   3840
   ClientLeft      =   4140
   ClientTop       =   2325
   ClientWidth     =   7080
   BeginProperty Font 
      Name            =   "Tahoma"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "frmWinSpy.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   3840
   ScaleWidth      =   7080
   Begin VB.TextBox txtParenthWnd 
      Height          =   375
      Left            =   1080
      TabIndex        =   12
      Top             =   480
      Width           =   2415
   End
   Begin VB.TextBox txtExStyles 
      Height          =   2295
      Left            =   4620
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   10
      Top             =   960
      Width           =   2415
   End
   Begin VB.TextBox txtStyles 
      Height          =   2235
      Left            =   1080
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   8
      Top             =   960
      Width           =   2415
   End
   Begin VB.CheckBox chkEnabled 
      Caption         =   "&amp;Enabled"
      Height          =   195
      Left            =   60
      TabIndex        =   7
      Top             =   3300
      Value           =   1  'Checked
      Width           =   3435
   End
   Begin VB.CommandButton cmdOK 
      Caption         =   "OK"
      Default         =   -1  'True
      Height          =   375
      Left            =   5760
      TabIndex        =   6
      Top             =   3360
      Width           =   1215
   End
   Begin VB.Frame fraInfo 
      Height          =   75
      Left            =   -480
      TabIndex        =   5
      Top             =   3120
      Width           =   7515
   End
   Begin VB.CheckBox chkAlwaysOnTop 
      Caption         =   "&amp;Always On Top"
      Height          =   255
      Left            =   60
      TabIndex        =   4
      Top             =   3540
      Width           =   3435
   End
   Begin VB.TextBox txtClassName 
      Height          =   375
      Left            =   4620
      TabIndex        =   2
      Top             =   60
      Width           =   2415
   End
   Begin VB.TextBox txthWnd 
      Height          =   375
      Left            =   1080
      TabIndex        =   0
      Top             =   60
      Width           =   2415
   End
   Begin VB.Timer tmrhWnd 
      Enabled         =   0   'False
      Interval        =   200
      Left            =   4560
      Top             =   3300
   End
   Begin VB.Label lblParent 
      Caption         =   "Parent hWnd"
      Height          =   195
      Left            =   60
      TabIndex        =   13
      Top             =   540
      Width           =   975
   End
   Begin VB.Label lblExStyles 
      Caption         =   "E&amp;x Styles:"
      Height          =   195
      Left            =   3600
      TabIndex        =   11
      Top             =   1020
      Width           =   975
   End
   Begin VB.Label lblStyles 
      Caption         =   "&amp;Styles:"
      Height          =   195
      Left            =   60
      TabIndex        =   9
      Top             =   1020
      Width           =   975
   End
   Begin VB.Label Label1 
      Caption         =   "&amp;Class:"
      Height          =   195
      Left            =   3600
      TabIndex        =   3
      Top             =   120
      Width           =   975
   End
   Begin VB.Label lblhWnd 
      Caption         =   "&amp;hWnd:"
      Height          =   195
      Left            =   60
      TabIndex        =   1
      Top             =   120
      Width           =   975
   End
End
Attribute VB_Name = "frmSimpleWinSpy"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Type POINTAPI
   x As Long
   y As Long
End Type
Private Declare Function SetWindowPos Lib "user32" (ByVal hwnd As Long, ByVal
 hWndInsertAfter As Long, ByVal x As Long, ByVal y As Long, ByVal cx As Long,
 ByVal cy As Long, ByVal wFlags As Long) As Long
Private Declare Function GetClassName Lib "user32" Alias "GetClassNameA" (ByVal
 hwnd As Long, ByVal lpClassName As String, ByVal nMaxCount As Long) As Long
Private Declare Function WindowFromPoint Lib "user32" (ByVal xPoint As Long,
 ByVal yPoint As Long) As Long
Private Declare Function GetCursorPos Lib "user32" (lpPoint As POINTAPI) As Long
Private Declare Function GetWindowLong Lib "user32" Alias "GetWindowLongA"
 (ByVal hwnd As Long, ByVal nIndex As Long) As Long
Private Declare Function GetWindow Lib "user32" (ByVal hwnd As Long, ByVal wCmd
 As Long) As Long
Private Const GW_OWNER = 4
Private Const GW_CHILD = 5

Private Const GWL_STYLE = (-16)
Private Const GWL_EXSTYLE = (-20)
Private Const GWL_USERDATA = (-21)
Private Const GWL_WNDPROC = -4
Private Const GWL_HWNDPARENT = (-8)

Private Const WS_OVERLAPPED = &amp;H0&amp;
Private Const WS_POPUP = &amp;H80000000
Private Const WS_CHILD = &amp;H40000000
Private Const WS_MINIMIZE = &amp;H20000000
Private Const WS_VISIBLE = &amp;H10000000
Private Const WS_DISABLED = &amp;H8000000
Private Const WS_CLIPSIBLINGS = &amp;H4000000
Private Const WS_CLIPCHILDREN = &amp;H2000000
Private Const WS_MAXIMIZE = &amp;H1000000
Private Const WS_CAPTION = &amp;HC00000                ' /* WS_BORDER | WS_DLGFRAME
  */
Private Const WS_BORDER = &amp;H800000
Private Const WS_DLGFRAME = &amp;H400000
Private Const WS_VSCROLL = &amp;H200000
Private Const WS_HSCROLL = &amp;H100000
Private Const WS_SYSMENU = &amp;H80000
Private Const WS_THICKFRAME = &amp;H40000
Private Const WS_GROUP = &amp;H20000
Private Const WS_TABSTOP = &amp;H10000

Private Const WS_MINIMIZEBOX = &amp;H20000
Private Const WS_MAXIMIZEBOX = &amp;H10000

'' /*
' * Extended Window Styles
' */
Private Const WS_EX_DLGMODALFRAME = &amp;H1&amp;
Private Const WS_EX_NOPARENTNOTIFY = &amp;H4&amp;
Private Const WS_EX_TOPMOST = &amp;H8&amp;
Private Const WS_EX_ACCEPTFILES = &amp;H10&amp;
Private Const WS_EX_TRANSPARENT = &amp;H20&amp;
'#if(WINVER &gt;= =&amp;H0400)
Private Const WS_EX_MDICHILD = &amp;H40&amp;
Private Const WS_EX_TOOLWINDOW = &amp;H80&amp;
Private Const WS_EX_WINDOWEDGE = &amp;H100&amp;
Private Const WS_EX_CLIENTEDGE = &amp;H200&amp;
Private Const WS_EX_CONTEXTHELP = &amp;H400&amp;

Private Const WS_EX_RIGHT = &amp;H1000&amp;
Private Const WS_EX_LEFT = &amp;H0&amp;
Private Const WS_EX_RTLREADING = &amp;H2000&amp;
Private Const WS_EX_LTRREADING = &amp;H0&amp;
Private Const WS_EX_LEFTSCROLLBAR = &amp;H4000&amp;
Private Const WS_EX_RIGHTSCROLLBAR = &amp;H0&amp;

Private Const WS_EX_CONTROLPARENT = &amp;H10000
Private Const WS_EX_STATICEDGE = &amp;H20000
Private Const WS_EX_APPWINDOW = &amp;H40000

'#endif ' /* WINVER &gt;= =&amp;H0400 */

Private Const HWND_TOPMOST = -1
Private Const HWND_NOTOPMOST = -2
Private Const SWP_NOMOVE = &amp;H2
Private Const SWP_NOSIZE = &amp;H1

Private Sub chkAlwaysOnTop_Click()
   If chkAlwaysOnTop.Value = Checked Then
      SetWindowPos Me.hwnd, HWND_TOPMOST, 0, 0, 0, 0, SWP_NOSIZE Or SWP_NOMOVE
   Else
      SetWindowPos Me.hwnd, HWND_NOTOPMOST, 0, 0, 0, 0, SWP_NOSIZE Or SWP_NOMOVE
   End If
End Sub

Private Sub chkEnabled_Click()
   tmrhWnd.Enabled = (chkEnabled.Value = Checked)
End Sub


Private Sub cmdOK_Click()
   Unload Me
End Sub

Private Sub Form_Load()
   tmrhWnd.Enabled = True
End Sub

Private Sub tmrhWnd_Timer()
Dim tP As POINTAPI
Dim lhWnd As Long
Dim iPos As Long
Dim sBuf As String
Dim lR As Long
   GetCursorPos tP
   lhWnd = WindowFromPoint(tP.x, tP.y)
   txthWnd = Hex$(lhWnd)
   txtClassName = ""
   txtStyles = ""
   txtParenthWnd = ""
   If lhWnd &lt;&gt; 0 Then
      txtParenthWnd = GetWindow(lhWnd, GW_OWNER)
      sBuf = String$(255, 0)
      lR = GetClassName(lhWnd, sBuf, 255)
      If lR &gt; 0 Then
         iPos = InStr(sBuf, vbNullChar)
         If (iPos &gt; 0) Then
            txtClassName = Left$(sBuf, iPos - 1)
         Else
            txtClassName = sBuf
         End If
      End If
      lR = GetWindowLong(lhWnd, GWL_STYLE)
      txtStyles = Hex$(lR) &amp; ShowStyles(lR)
      lR = GetWindowLong(lhWnd, GWL_EXSTYLE)
      txtExStyles = Hex$(lR) &amp; ShowExStyles(lR)
   End If
End Sub
Private Function ShowStyles(ByVal lR As Long) As String
Dim sOut As String
   Style sOut, lR, WS_POPUP, "WS_POPUP"
   Style sOut, lR, WS_CHILD, "WS_CHILD"
   Style sOut, lR, WS_MINIMIZE, "WS_MINIMIZE "
   Style sOut, lR, WS_VISIBLE, "WS_VISIBLE"
   Style sOut, lR, WS_DISABLED, "WS_DISABLED "
   Style sOut, lR, WS_CLIPSIBLINGS, "WS_CLIPSIBLINGS"
   Style sOut, lR, WS_CLIPCHILDREN, "WS_CLIPCHILDREN"
   Style sOut, lR, WS_MAXIMIZE, "WS_MAXIMIZE"
   Style sOut, lR, WS_CAPTION, "WS_CAPTION"
   Style sOut, lR, WS_BORDER, "WS_BORDER"
   Style sOut, lR, WS_DLGFRAME, "WS_DLGFRAME"
   Style sOut, lR, WS_VSCROLL, "WS_VSCROLL"
   Style sOut, lR, WS_HSCROLL, "WS_HSCROLL"
   Style sOut, lR, WS_SYSMENU, "WS_SYSMENU"
   Style sOut, lR, WS_THICKFRAME, "WS_THICKFRAME"
   Style sOut, lR, WS_GROUP, "WS_GROUP"
   Style sOut, lR, WS_TABSTOP, "WS_TABSTOP"
   Style sOut, lR, WS_MINIMIZEBOX, "WS_MINIMIZEBOX"
   Style sOut, lR, WS_MAXIMIZEBOX, "WS_MAXIMIZEBOX"
   ShowStyles = sOut
End Function
Private Function ShowExStyles(ByVal lR As Long)
Dim sOut As String
   Style sOut, lR, WS_EX_DLGMODALFRAME, "WS_EX_DLGMODALFRAME"
   Style sOut, lR, WS_EX_NOPARENTNOTIFY, "WS_EX_NOPARENTNOTIFY"
   Style sOut, lR, WS_EX_TOPMOST, "WS_EX_TOPMOST"
   Style sOut, lR, WS_EX_ACCEPTFILES, "WS_EX_ACCEPTFILES"
   Style sOut, lR, WS_EX_TRANSPARENT, "WS_EX_TRANSPARENT"
'#if(WINVER &gt;= =&amp;H0400)
   Style sOut, lR, WS_EX_MDICHILD, "WS_EX_MDICHILD"
   Style sOut, lR, WS_EX_TOOLWINDOW, "WS_EX_TOOLWINDOW"
   Style sOut, lR, WS_EX_WINDOWEDGE, "WS_EX_WINDOWEDGE"
   Style sOut, lR, WS_EX_CLIENTEDGE, "WS_EX_CLIENTEDGE"
   Style sOut, lR, WS_EX_CONTEXTHELP, "WS_EX_CONTEXTHELP"
   
   Style sOut, lR, WS_EX_RIGHT, "WS_EX_RIGHT"
   Style sOut, lR, WS_EX_LEFT, "WS_EX_LEFT"
   Style sOut, lR, WS_EX_RTLREADING, "WS_EX_RTLREADING"
   Style sOut, lR, WS_EX_LTRREADING, "WS_EX_LTRREADING"
   Style sOut, lR, WS_EX_LEFTSCROLLBAR, "WS_EX_LEFTSCROLLBAR"
   Style sOut, lR, WS_EX_RIGHTSCROLLBAR, "WS_EX_RIGHTSCROLLBAR"

   Style sOut, lR, WS_EX_CONTROLPARENT, "WS_EX_CONTROLPARENT"
   Style sOut, lR, WS_EX_STATICEDGE, "WS_EX_STATICEDGE"
   Style sOut, lR, WS_EX_APPWINDOW, "WS_EX_APPWINDOW"

   ShowExStyles = sOut
End Function
Private Sub Style( _
      ByRef s As String, _
      ByVal lAll As Long, _
      ByVal lBit As Long, _
      ByVal sString As String _
   )
   If (lAll And lBit) = lBit Then
      s = s &amp; vbCrLf &amp; sString
   End If
End Sub

</pre><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p><p>&#160;</p></td><td class="rightbar" valign="top" bgcolor="#C2BEB1">
<!-- No right bar content currently defined -->
</td></tr><tr class="footer"><td></td>
<td>
<p class="center">

<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_ad_type = "text_image";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<A HREF="..\..\code\vbmedia\using_gdi_plus\index.html" ><IMG SRC="..\..\..\res\gdiplus.png" ALT="A GDI+ Library for VB - read and write PNG, JPG, TIF and GIF files, and manipulate bitmaps quickly" WIDTH=468 HEIGHT=60 BORDER=0></A>
</noscript>

</p>
</td>
<td></td>
</tr><tr><td colspan="3"><hr /></td></tr><tr class="footer"><td valign="top"><a href="..\..\..\index.html"><img width="125" height="25" src="..\..\..\res\vbaccelerator.png" alt="vbAccelerator Logo" /></a></td><td valign="bottom"><p class="nav"><a href="..\..\..\index.html">Home</a>&#160;.&#160;<a href="..\..\index.html">VB</a>&#160;.&#160;<a href="..\index.html">Utilities</a>&#160;.&#160;<a href="article.html">Simple Windows Spy Utility</a>&#160;.&#160;<a href="simple_windows_spy.html">Simple Windows Spy</a>&#160;.&#160;frmWinSpy.frm</p><br /><p class="nav"><a href="..\..\..\the_site\copyright\article.html">Copyright</a> &#169; 2003 Steve McMahon <a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>.  All rights reserved.<br />Last Updated: 12 April 2003</p></td><td></td></tr></table>
</body></html>
<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="Author" content="Steve McMahon">
<meta name="KeyWords"
content="VB, VB6, Visual Basic, Visual Basic 5, Visual Basic 6, Dynamic HTML, DHTML, IE4, Internet Explorer, Internet Explorer 4, Active X, Active X Controls, Visual Basic Controls">
<meta name="GENERATOR" content="vbAccelerator Site Robot v0.5.1">
<title>vbAccelerator Tips - Compact a Long Path Name to fit a given space</title>
</head>

<body bgcolor="#FFFFFF" topmargin="0" leftmargin="0" link="#660000" vlink="#999966" LEFTMARGIN="0" TOPMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0">

<!-- AD:START -->
<table bgcolor="#336699" border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr>
<td width="468">
<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<a href="..\home\index.html"><img src="..\home\res\vbaccelad.png" width="468" height="60" 
border="0" alt="vbAccelerator - Faster VB and .NET Code" /></a>
</noscript>
</td>
<td>
<a href="..\home\index.html"><img src="..\home\res\vbaccelnew.png" width="125" height="60" 
border="0" alt="The new vbAccelerator Site - more VB and .NET Code and Controls" /></a>
</td>
</tr>
</table>
<!-- AD:END -->



<a name="sectop"></a>

<table border="0" width="100%" cellspacing="0" cellpadding="0" height="25">
<tr bgcolor="#663333" height="25">
	<td>
	<img src="..\images\vbatips.gif" width="368" height="12" border="0">
	</font>
	</td>
</tr>
</table>

<table border="0" width="100%" cellspacing="0" cellpadding="4">
<tr bgcolor="#FFFFFF">
	<td width="72" rowspan="5" valign="top"><img src="..\images\vbatipim.gif" height="64" width="64" border="0" hspace="6" halign="center"></td>
	<td colspan="3">
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<br>
	<p><b>Compact a Long Path Name to fit a given space</b></p>
	</font>
	</td>
</tr>
<tr>
	<td valign="top">
	<font color="#663333" face="verdana,arial,helvetica" size="1">
	<p><img src="..\images\vbatipbt.gif" height="8" width="8" border="0" hspace="4" halign="center">Author: 
	</td>
	<td valign="top" width="100%">
	<font color="#000000" face="verdana,arial,helvetica" size="1">
	<!-- AUTHORS: Begin -->
	<p>Steve McMahon(<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>)</p>
	<!-- AUTHORS: End -->
	</font>
	</td>
	<td><img src="..\images\pixel.gif" width="256" height="1" border="0"></td>
</tr>
<tr>
	<td valign="top">
	<font color="#663333" face="verdana,arial,helvetica" size="1">
	<p><img src="..\images\pixel.gif" height="1" width="8" border="0" hspace="4" halign="center">Keywords: 
	</td>
	<td valign="top">
	<font color="#000000" face="verdana,arial,helvetica" size="1">
	<p><a href="index9.htm">API</a>,<a href="index3.htm">GDI</a>,<a href="index10.htm">Graphics</a></p>
	</font>
	</td>
	<td><img src="..\images\pixel.gif" width="256" height="1" border="0"></td>
</tr>
<tr>
	<td  valign="top">
	<font color="#663333" face="verdana,arial,helvetica" size="1">
	<p><img src="..\images\pixel.gif" height="1" width="8" border="0" hspace="4" halign="center">Updated:
	</td>
	<td  valign="top">
	<font color="#000000" face="verdana,arial,helvetica" size="1">
	<p>17/08/99</p>
	</font>
	</td>
	<td><img src="..\images\pixel.gif" width="256" height="1" border="0"></td>
</tr>
<tr>
	<td colspan=3 bgcolor="#663333">
	<!-- <img src="../images/bpixel.gif" width="100%" height="1" border="0"> -->
	</td>
	<td></td>
</tr>
<tr>
	<td valign="top">
	<font face="verdana,arial,helvetica" size="1">
	<p>
	Other Tips<br>
	<a href="index.htm">All Tips</a><br>
	<a href="indexd.htm">By Date</a><br>
	<a href="indext.htm">By Subject</a><br>
	<br><br>
	<a href="index9.htm">API (33)</a><br>
<a href="index21.htm">Bit<br>Manipulation (3)</a><br>
<a href="index11.htm">Clipboard (3)</a><br>
<a href="index18.htm">Combo<br>Box (5)</a><br>
<a href="index1.htm">Desktop (3)</a><br>
<a href="index3.htm">GDI (13)</a><br>
<a href="index10.htm">Graphics (13)</a><br>
<a href="index22.htm">Internet (2)</a><br>
<a href="index8.htm">Interprocess<br>Comms (3)</a><br>
<a href="index6.htm">Keyboard (2)</a><br>
<a href="index2.htm">Mouse (1)</a><br>
<a href="index4.htm">Shell (1)</a><br>
<a href="index14.htm">Sprites (1)</a><br>
<a href="index12.htm">Subclassing (3)</a><br>
<a href="index20.htm">Text<br>Box (2)</a><br>
<a href="index17.htm">Windows (11)</a><br>
<a href="index15.htm">Windows<br>Controls (10)</a><br>
	<br><br>
	<a href="submitt.htm">Submit</a><br>
	</p>
	</font>
	</td>
	<td colspan=3>
	<br>
	<!-- TIPHTML: Begin -->
		<font color="#000000" face="verdana,arial,helvetica" size="2">
	<p>
	Often there is not enough room to display all of a long path name.  A neat way to format
	a path name in a given space is to show some of the beginning of the path and the filename
	itself, whilst missing out some of the central folders and replacing them with ellipses (..)
	This method is used in many Microsoft applications.
	<br><br>
	This tip shows how to use the either the <i>DrawText</i> or the <i>PathCompactPath</i> API
	functions to get this effect.
	<br><br>
	Start a new project in VB.  Add a new module, and add the following code:
	</p>
</font>
<p>
<font color="#999999" face="Lucida Console,courier new" size="1">
<br>
Private Type RECT<br>
&nbsp;&nbsp;   left As Long<br>
&nbsp;&nbsp;   top As Long<br>
&nbsp;&nbsp;   right As Long<br>
&nbsp;&nbsp;   bottom As Long<br>
End Type<br>
Private Declare Function DrawText Lib "user32" Alias "DrawTextA" (ByVal hDC As Long, ByVal lpStr As String, ByVal nCount As Long, lpRect As RECT, ByVal wFormat As Long) As Long<br>
&nbsp;&nbsp;    Private Const DT_BOTTOM = &H8&<br>
&nbsp;&nbsp;    Private Const DT_CENTER = &H1&<br>
&nbsp;&nbsp;    Private Const DT_LEFT = &H0&<br>
&nbsp;&nbsp;    Private Const DT_CALCRECT = &H400&<br>
&nbsp;&nbsp;    Private Const DT_WORDBREAK = &H10&<br>
&nbsp;&nbsp;    Private Const DT_VCENTER = &H4&<br>
&nbsp;&nbsp;    Private Const DT_TOP = &H0&<br>
&nbsp;&nbsp;    Private Const DT_TABSTOP = &H80&<br>
&nbsp;&nbsp;    Private Const DT_SINGLELINE = &H20&<br>
&nbsp;&nbsp;    Private Const DT_RIGHT = &H2&<br>
&nbsp;&nbsp;    Private Const DT_NOCLIP = &H100&<br>
&nbsp;&nbsp;    Private Const DT_INTERNAL = &H1000&<br>
&nbsp;&nbsp;    Private Const DT_EXTERNALLEADING = &H200&<br>
&nbsp;&nbsp;    Private Const DT_EXPANDTABS = &H40&<br>
&nbsp;&nbsp;    Private Const DT_CHARSTREAM = 4&<br>
&nbsp;&nbsp;    Private Const DT_NOPREFIX = &H800&<br>
&nbsp;&nbsp;    Private Const DT_EDITCONTROL = &H2000&<br>
&nbsp;&nbsp;    Private Const DT_PATH_ELLIPSIS = &H4000&<br>
&nbsp;&nbsp;    Private Const DT_END_ELLIPSIS = &H8000&<br>
&nbsp;&nbsp;    Private Const DT_MODIFYSTRING = &H10000<br>
&nbsp;&nbsp;    Private Const DT_RTLREADING = &H20000<br>
&nbsp;&nbsp;    Private Const DT_WORD_ELLIPSIS = &H40000<br>
<br>
Private Declare Function PathCompactPath Lib "shlwapi" Alias "PathCompactPathA" ( _<br>
&nbsp;&nbsp;ByVal hDC As Long, ByVal lpszPath As String, ByVal dx As Long) As Long<br>
<br>
Public Function CompactedPath( _<br>
&nbsp;&nbsp;&nbsp;&nbsp;      ByVal sPath As String, _<br>
&nbsp;&nbsp;&nbsp;&nbsp;      ByVal lMaxPixels As Long, _<br>
&nbsp;&nbsp;&nbsp;&nbsp;      ByVal hDC As Long _<br>
&nbsp;&nbsp;   ) As String<br>
Dim tR As RECT<br>
&nbsp;&nbsp;   tR.right = lMaxPixels<br>
&nbsp;&nbsp;   DrawText hDC, sPath, -1, tR, DT_PATH_ELLIPSIS Or DT_SINGLELINE Or DT_MODIFYSTRING<br>
&nbsp;&nbsp;   CompactedPath = sPath<br>
End Function<br>
<br>
Public Function CompactedPathSh( _<br>
&nbsp;&nbsp;&nbsp;&nbsp;      ByVal sPath As String, _<br>
&nbsp;&nbsp;&nbsp;&nbsp;      ByVal lMaxPixels As Long, _<br>
&nbsp;&nbsp;&nbsp;&nbsp;      ByVal hDC As Long _<br>
&nbsp;&nbsp;   ) As String<br>
Dim lR As Long<br>
Dim iPos As Long<br>
&nbsp;&nbsp;   lR = PathCompactPath(hDC, sPath, lMaxPixels)<br>
&nbsp;&nbsp;   iPos = InStr(sPath, Chr$(0))<br>
&nbsp;&nbsp;   If iPos <> 0 Then<br>
&nbsp;&nbsp;&nbsp;&nbsp;      CompactedPathSh = left$(sPath, iPos - 1)<br>
&nbsp;&nbsp;   Else<br>
&nbsp;&nbsp;&nbsp;&nbsp;      CompactedPathSh = sPath<br>
&nbsp;&nbsp;   End If<br>
End Function<br>
<br>
</font>
</p>
<font color="#000000" face="verdana,arial,helvetica" size="2">
<p>
	To try out the code, add a command button to your test project's main
	form.  Then add a two label controls to the form, sizing the second
	one to the size you'd like the path to appear as.  Type an obnoxiously long path
	containing spaces into the caption of the first label control, for example:<br><br>
	C:\Program Files\Microsoft DevStudio\Visual Basic\Samples\Unsupported Samples\Etc
	<br><br>
	Then add the following code to demonstrate the path compacting:
	</p>
	</font>
<p>
<font color="#000000" face="Lucida Console,courier new" size="1">
Private Sub Command1_Click() <br>
<font color="#CCCCCC">&nbsp;&nbsp;' Use either the CompactedPath or CompactedPathSh functions - they
&nbsp;&nbsp;' work exactly the same.<font color="#000000">
&nbsp;&nbsp;Label2.Caption = CompactedPathSh(Label1.Caption, Label2.Width \ Screen.TwipsPerPixelX, Me.hDC)
End Sub<br>
 <br>
</font>
</p>
<font color="#000000" face="verdana,arial,helvetica" size="2">
<p>
Run the project. When you click the command button, the second label control will display a neatly compacted
version of the original path.
</p>
	<!-- TIPHTML: End -->
	<br>
	</td>
</tr>
<tr>
	<td></td>
	<td colspan=3 bgcolor="#663333">
	<!-- <img src="../images/bpixel.gif" width="100%" height="1" border="0"> -->
	</td>
	<td></td>
</tr>
<tr>
	<td>&nbsp</td>
	<td valign="top">
	<font color="#663333" face="verdana,arial,helvetica" size="1">
	<p>Related Tips and Articles:
	</td>
	<td>
	<font color="#000000" face="verdana,arial,helvetica" size="1">
	<p>
	<!-- RELATEDARTICLES: Begin -->
	None.
	<!-- RELATEDARTICLES: End -->
	</p>
	</font>
	</td>
	<td><img src="..\images\pixel.gif" width="256" height="1" border="0"></td>
	<td>&nbsp</td>
</tr>
</table>	

<!-- BODY:END -->

<!-- FOOTER:START -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 1998-1999, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 17/08/99</font></p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>
g="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 1998-1999, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 17/08/99</font></p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>

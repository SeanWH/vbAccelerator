<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="Author" content="Steve McMahon">
<meta name="KeyWords"
content="VB, VB6, Visual Basic, Visual Basic 5, Visual Basic 6, Dynamic HTML, DHTML, IE4, Internet Explorer, Internet Explorer 4, Active X, Active X Controls, Visual Basic Controls">
<meta name="GENERATOR" content="vbAccelerator Site Robot v0.5.1">
<title>vbAccelerator Tips - Show and Hide a Form's Titlebar at run-time</title>
</head>

<body bgcolor="#FFFFFF" topmargin="0" leftmargin="0" link="#660000" vlink="#999966" LEFTMARGIN="0" TOPMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0">

<!-- AD:START -->
<table bgcolor="#336699" border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr>
<td width="468">
<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<a href="..\home\index.html"><img src="..\home\res\vbaccelad.png" width="468" height="60" 
border="0" alt="vbAccelerator - Faster VB and .NET Code" /></a>
</noscript>
</td>
<td>
<a href="..\home\index.html"><img src="..\home\res\vbaccelnew.png" width="125" height="60" 
border="0" alt="The new vbAccelerator Site - more VB and .NET Code and Controls" /></a>
</td>
</tr>
</table>
<!-- AD:END -->



<a name="sectop"></a>

<table border="0" width="100%" cellspacing="0" cellpadding="0" height="25">
<tr bgcolor="#663333" height="25">
	<td>
	<img src="..\images\vbatips.gif" width="368" height="12" border="0">
	</font>
	</td>
</tr>
</table>

<table border="0" width="100%" cellspacing="0" cellpadding="4">
<tr bgcolor="#FFFFFF">
	<td width="72" rowspan="5" valign="top"><img src="..\images\vbatipim.gif" height="64" width="64" border="0" hspace="6" halign="center"></td>
	<td colspan="3">
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<br>
	<p><b>Show and Hide a Form's Titlebar at run-time</b></p>
	</font>
	</td>
</tr>
<tr>
	<td valign="top">
	<font color="#663333" face="verdana,arial,helvetica" size="1">
	<p><img src="..\images\vbatipbt.gif" height="8" width="8" border="0" hspace="4" halign="center">Author: 
	</td>
	<td valign="top" width="100%">
	<font color="#000000" face="verdana,arial,helvetica" size="1">
	<!-- AUTHORS: Begin -->
	<p>Steve McMahon(<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>)</p>
	<!-- AUTHORS: End -->
	</font>
	</td>
	<td><img src="..\images\pixel.gif" width="256" height="1" border="0"></td>
</tr>
<tr>
	<td valign="top">
	<font color="#663333" face="verdana,arial,helvetica" size="1">
	<p><img src="..\images\pixel.gif" height="1" width="8" border="0" hspace="4" halign="center">Keywords: 
	</td>
	<td valign="top">
	<font color="#000000" face="verdana,arial,helvetica" size="1">
	<p><a href="index9.htm">API</a>,<a href="index17.htm">Windows</a></p>
	</font>
	</td>
	<td><img src="..\images\pixel.gif" width="256" height="1" border="0"></td>
</tr>
<tr>
	<td  valign="top">
	<font color="#663333" face="verdana,arial,helvetica" size="1">
	<p><img src="..\images\pixel.gif" height="1" width="8" border="0" hspace="4" halign="center">Updated:
	</td>
	<td  valign="top">
	<font color="#000000" face="verdana,arial,helvetica" size="1">
	<p>09/08/98</p>
	</font>
	</td>
	<td><img src="..\images\pixel.gif" width="256" height="1" border="0"></td>
</tr>
<tr>
	<td colspan=3 bgcolor="#663333">
	<!-- <img src="../images/bpixel.gif" width="100%" height="1" border="0"> -->
	</td>
	<td></td>
</tr>
<tr>
	<td valign="top">
	<font face="verdana,arial,helvetica" size="1">
	<p>
	Other Tips<br>
	<a href="index.htm">All Tips</a><br>
	<a href="indexd.htm">By Date</a><br>
	<a href="indext.htm">By Subject</a><br>
	<br><br>
	<a href="index9.htm">API (33)</a><br>
<a href="index21.htm">Bit<br>Manipulation (3)</a><br>
<a href="index11.htm">Clipboard (3)</a><br>
<a href="index18.htm">Combo<br>Box (5)</a><br>
<a href="index1.htm">Desktop (3)</a><br>
<a href="index3.htm">GDI (13)</a><br>
<a href="index10.htm">Graphics (13)</a><br>
<a href="index22.htm">Internet (2)</a><br>
<a href="index8.htm">Interprocess<br>Comms (3)</a><br>
<a href="index6.htm">Keyboard (2)</a><br>
<a href="index2.htm">Mouse (1)</a><br>
<a href="index4.htm">Shell (1)</a><br>
<a href="index14.htm">Sprites (1)</a><br>
<a href="index12.htm">Subclassing (3)</a><br>
<a href="index20.htm">Text<br>Box (2)</a><br>
<a href="index17.htm">Windows (11)</a><br>
<a href="index15.htm">Windows<br>Controls (10)</a><br>
	<br><br>
	<a href="submitt.htm">Submit</a><br>
	</p>
	</font>
	</td>
	<td colspan=3>
	<br>
	<!-- TIPHTML: Begin -->
		<font color="#000000" face="verdana,arial,helvetica" size="2">
<p>
	This tip shows you how to show and hide the title bar of a window at run-time.
	To make a window's title bar disappear, you have to remove the control box, the 
	maximise box and the minimise box as well as set the caption of the form to blank.
	Unfortunately, 	VB's ControlBox, MinButton and MaxButton properties of a form are read-only so
	you can normally only do this at design time.  However, by manipulating the style of the
	window using API calls, you can get the same thing to happen at run-time.
	<br><br>
	Start a new project in VB.  Add the following code to the project's form:
</p>
<p>
<font color="#000000" face="Lucida Console,courier new" size="1">
Private Declare Function SetWindowLong Lib "user32" Alias "SetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long, ByVal dwNewLong As Long) As Long <br>
Private Declare Function GetWindowLong Lib "user32" Alias "GetWindowLongA" (ByVal hwnd As Long, ByVal nIndex As Long) As Long <br>
Private Const GWL_STYLE = (-16) <br>
&nbsp &nbsp Private Const WS_CAPTION = &HC00000&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
  '  WS_BORDER Or WS_DLGFRAME <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
Private Const WS_MAXIMIZEBOX = &H10000 <br>
Private Const WS_MINIMIZEBOX = &H20000 <br>
Private Const WS_SYSMENU = &H80000 <br>
 <br>
Private Declare Function SetWindowPos Lib "user32" (ByVal hwnd As Long, ByVal hWndInsertAfter As Long, ByVal x As Long, ByVal y As Long, ByVal cx As Long, ByVal cy As Long, ByVal wFlags As Long) As Long <br>
Private Enum ESetWindowPosStyles <br>
&nbsp &nbsp SWP_SHOWWINDOW = &H40 <br>
&nbsp &nbsp SWP_HIDEWINDOW = &H80 <br>
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
SWP_FRAMECHANGED = &H20 ' The frame changed: send WM_NCCALCSIZE <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp SWP_NOACTIVATE = &H10 <br>
&nbsp &nbsp SWP_NOCOPYBITS = &H100 <br>
&nbsp &nbsp SWP_NOMOVE = &H2 <br>
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
SWP_NOOWNERZORDER = &H200 ' Don't do owner Z ordering <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp SWP_NOREDRAW = &H8 <br>
&nbsp &nbsp SWP_NOREPOSITION = SWP_NOOWNERZORDER <br>
&nbsp &nbsp SWP_NOSIZE = &H1 <br>
&nbsp &nbsp SWP_NOZORDER = &H4 <br>
&nbsp &nbsp SWP_DRAWFRAME = SWP_FRAMECHANGED <br>
&nbsp &nbsp HWND_NOTOPMOST = -2 <br>
End Enum <br>
 <br>
Private Declare Function GetWindowRect Lib "user32" (ByVal hwnd As Long, lpRect As RECT) As Long <br>
Private Type RECT <br>
&nbsp &nbsp Left As Long <br>
&nbsp &nbsp Top As Long <br>
&nbsp &nbsp Right As Long <br>
&nbsp &nbsp Bottom As Long <br>
End Type <br>
 <br>
Private Function ShowTitleBar(ByVal bState As Boolean) <br>
Dim lStyle As Long <br>
Dim tR As RECT <br>
 <br>
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Get the window's position: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp GetWindowRect Me.hwnd, tR <br>
 <br>
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Modify whether title bar will be visible: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp lStyle = GetWindowLong(Me.hwnd, GWL_STYLE) <br>
&nbsp &nbsp If (bState) Then <br>
&nbsp &nbsp   Me.Caption = Me.Tag <br>
&nbsp &nbsp   If Me.ControlBox Then <br>
&nbsp &nbsp &nbsp &nbsp  lStyle = lStyle Or WS_SYSMENU <br>
&nbsp &nbsp   End If <br>
&nbsp &nbsp   If Me.MaxButton Then <br>
&nbsp &nbsp &nbsp &nbsp  lStyle = lStyle Or WS_MAXIMIZEBOX <br>
&nbsp &nbsp   End If <br>
&nbsp &nbsp   If Me.MinButton Then <br>
&nbsp &nbsp &nbsp &nbsp  lStyle = lStyle Or WS_MINIMIZEBOX <br>
&nbsp &nbsp   End If <br>
&nbsp &nbsp   If Me.Caption <> "" Then <br>
&nbsp &nbsp &nbsp &nbsp  lStyle = lStyle Or WS_CAPTION <br>
&nbsp &nbsp   End If <br>
&nbsp &nbsp Else <br>
&nbsp &nbsp   Me.Tag = Me.Caption <br>
&nbsp &nbsp   Me.Caption = "" <br>
&nbsp &nbsp   lStyle = lStyle And Not WS_SYSMENU <br>
&nbsp &nbsp   lStyle = lStyle And Not WS_MAXIMIZEBOX <br>
&nbsp &nbsp   lStyle = lStyle And Not WS_MINIMIZEBOX <br>
&nbsp &nbsp   lStyle = lStyle And Not WS_CAPTION <br>
   End If <br>
   SetWindowLong Me.hwnd, GWL_STYLE, lStyle <br>
    <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
   ' Ensure the style takes and make the window the <br>
   ' same size, regardless that the title bar etc <br>
   ' is now a different size: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
   SetWindowPos Me.hwnd, 0, tR.Left, tR.Top, tR.Right - tR.Left, tR.Bottom - tR.Top, SWP_NOREPOSITION Or SWP_NOZORDER Or SWP_FRAMECHANGED <br>
   Me.Refresh <br>
    <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
   ' Ensure that your resize code is fired, as the client area <br>
   ' has changed: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
   Form_Resize <br>
    <br>
End Function <br>
 <br>
</font>
</p>
<font color="#000000" face="verdana,arial,helvetica" size="2">
<p>
	To try out the hiding and showing the title bar, add a CheckBox to the project's form.
	Set the check box's Value property to 1 (Checked).  Then put the
	following code under the Check box's click event:
</p>
<p>
<font color="#000000" face="Lucida Console,courier new" size="1">
Private Sub Check1_Click() <br>
&nbsp &nbsp If (Check1.Value = Checked) Then <br>
&nbsp &nbsp   ShowTitleBar True <br>
&nbsp &nbsp Else <br>
&nbsp &nbsp   ShowTitleBar False <br>
   End If <br>
End Sub <br>
</font>
</p>
<font color="#000000" face="verdana,arial,helvetica" size="2">
<p>
	When you click on the check box, the form's titlebar will be alternately hidden and
	shown.
</p>
	<!-- TIPHTML: End -->
	<br>
	</td>
</tr>
<tr>
	<td></td>
	<td colspan=3 bgcolor="#663333">
	<!-- <img src="../images/bpixel.gif" width="100%" height="1" border="0"> -->
	</td>
	<td></td>
</tr>
<tr>
	<td>&nbsp</td>
	<td valign="top">
	<font color="#663333" face="verdana,arial,helvetica" size="1">
	<p>Related Tips and Articles:
	</td>
	<td>
	<font color="#000000" face="verdana,arial,helvetica" size="1">
	<p>
	<!-- RELATEDARTICLES: Begin -->
	None.
	<!-- RELATEDARTICLES: End -->
	</p>
	</font>
	</td>
	<td><img src="..\images\pixel.gif" width="256" height="1" border="0"></td>
	<td>&nbsp</td>
</tr>
</table>	

<!-- BODY:END -->

<!-- FOOTER:START -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 1998-1999, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 09/08/98</font></p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>
g="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 1998-1999, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 09/08/98</font></p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>

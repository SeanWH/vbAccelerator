<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="Author" content="Steve McMahon">
<meta name="KeyWords"
content="VB, VB6, Visual Basic, Visual Basic 5, Visual Basic 6, Dynamic HTML, DHTML, IE4, Internet Explorer, Internet Explorer 4, Active X, Active X Controls, Visual Basic Controls">
<meta name="GENERATOR" content="vbAccelerator Site Robot v0.5.1">
<title>vbAccelerator Tips - Replace one Colour with another in a Picture using BitBlt</title>
</head>

<body bgcolor="#FFFFFF" topmargin="0" leftmargin="0" link="#660000" vlink="#999966" LEFTMARGIN="0" TOPMARGIN="0" MARGINHEIGHT="0" MARGINWIDTH="0">

<!-- AD:START -->
<table bgcolor="#336699" border="0" cellpadding="0" cellspacing="0" width="100%" >
<tr>
<td width="468">
<script type="text/javascript"><!--
google_ad_client = "pub-4690375644913255";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<noscript>
<a href="..\home\index.html"><img src="..\home\res\vbaccelad.png" width="468" height="60" 
border="0" alt="vbAccelerator - Faster VB and .NET Code" /></a>
</noscript>
</td>
<td>
<a href="..\home\index.html"><img src="..\home\res\vbaccelnew.png" width="125" height="60" 
border="0" alt="The new vbAccelerator Site - more VB and .NET Code and Controls" /></a>
</td>
</tr>
</table>
<!-- AD:END -->



<a name="sectop"></a>

<table border="0" width="100%" cellspacing="0" cellpadding="0" height="25">
<tr bgcolor="#663333" height="25">
	<td>
	<img src="..\images\vbatips.gif" width="368" height="12" border="0">
	</font>
	</td>
</tr>
</table>

<table border="0" width="100%" cellspacing="0" cellpadding="4">
<tr bgcolor="#FFFFFF">
	<td width="72" rowspan="5" valign="top"><img src="..\images\vbatipim.gif" height="64" width="64" border="0" hspace="6" halign="center"></td>
	<td colspan="3">
	<font color="#000000" face="verdana,arial,helvetica" size="2">
	<br>
	<p><b>Replace one Colour with another in a Picture using BitBlt</b></p>
	</font>
	</td>
</tr>
<tr>
	<td valign="top">
	<font color="#663333" face="verdana,arial,helvetica" size="1">
	<p><img src="..\images\vbatipbt.gif" height="8" width="8" border="0" hspace="4" halign="center">Author: 
	</td>
	<td valign="top" width="100%">
	<font color="#000000" face="verdana,arial,helvetica" size="1">
	<!-- AUTHORS: Begin -->
	<p>Steve McMahon(<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>)</p>
	<!-- AUTHORS: End -->
	</font>
	</td>
	<td><img src="..\images\pixel.gif" width="256" height="1" border="0"></td>
</tr>
<tr>
	<td valign="top">
	<font color="#663333" face="verdana,arial,helvetica" size="1">
	<p><img src="..\images\pixel.gif" height="1" width="8" border="0" hspace="4" halign="center">Keywords: 
	</td>
	<td valign="top">
	<font color="#000000" face="verdana,arial,helvetica" size="1">
	<p><a href="index9.htm">API</a>,<a href="index3.htm">GDI</a>,<a href="index10.htm">Graphics</a></p>
	</font>
	</td>
	<td><img src="..\images\pixel.gif" width="256" height="1" border="0"></td>
</tr>
<tr>
	<td  valign="top">
	<font color="#663333" face="verdana,arial,helvetica" size="1">
	<p><img src="..\images\pixel.gif" height="1" width="8" border="0" hspace="4" halign="center">Updated:
	</td>
	<td  valign="top">
	<font color="#000000" face="verdana,arial,helvetica" size="1">
	<p>09/08/98</p>
	</font>
	</td>
	<td><img src="..\images\pixel.gif" width="256" height="1" border="0"></td>
</tr>
<tr>
	<td colspan=3 bgcolor="#663333">
	<!-- <img src="../images/bpixel.gif" width="100%" height="1" border="0"> -->
	</td>
	<td></td>
</tr>
<tr>
	<td valign="top">
	<font face="verdana,arial,helvetica" size="1">
	<p>
	Other Tips<br>
	<a href="index.htm">All Tips</a><br>
	<a href="indexd.htm">By Date</a><br>
	<a href="indext.htm">By Subject</a><br>
	<br><br>
	<a href="index9.htm">API (33)</a><br>
<a href="index21.htm">Bit<br>Manipulation (3)</a><br>
<a href="index11.htm">Clipboard (3)</a><br>
<a href="index18.htm">Combo<br>Box (5)</a><br>
<a href="index1.htm">Desktop (3)</a><br>
<a href="index3.htm">GDI (13)</a><br>
<a href="index10.htm">Graphics (13)</a><br>
<a href="index22.htm">Internet (2)</a><br>
<a href="index8.htm">Interprocess<br>Comms (3)</a><br>
<a href="index6.htm">Keyboard (2)</a><br>
<a href="index2.htm">Mouse (1)</a><br>
<a href="index4.htm">Shell (1)</a><br>
<a href="index14.htm">Sprites (1)</a><br>
<a href="index12.htm">Subclassing (3)</a><br>
<a href="index20.htm">Text<br>Box (2)</a><br>
<a href="index17.htm">Windows (11)</a><br>
<a href="index15.htm">Windows<br>Controls (10)</a><br>
	<br><br>
	<a href="submitt.htm">Submit</a><br>
	</p>
	</font>
	</td>
	<td colspan=3>
	<br>
	<!-- TIPHTML: Begin -->
		<font color="#000000" face="verdana,arial,helvetica" size="2">
<p>
	This tip shows you how to replace one colour with another in a bitmap.  This method
	uses BitBlt to ensure the operation is as speedy as possible, and will run very quickly.
	<br><br>
	Start a new project in VB.  Add a new module, then add the following
	code to it:
</p>
<p>
<font color="#000000" face="Lucida Console,courier new" size="1">
Option Explicit <br>
 <br>
Private Type RECT <br>
&nbsp &nbsp left As Long <br>
&nbsp &nbsp Top As Long <br>
&nbsp &nbsp Right As Long <br>
&nbsp &nbsp Bottom As Long <br>
End Type <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Creates a memory DC <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
Private Declare Function CreateCompatibleDC Lib "gdi32" ( _ <br>
&nbsp &nbsp ByVal hDC As Long _ <br>
&nbsp &nbsp ) As Long <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Creates a bitmap in memory: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
Private Declare Function CreateCompatibleBitmap Lib "gdi32" ( _ <br>
&nbsp &nbsp ByVal hDC As Long, _ <br>
&nbsp &nbsp ByVal nWidth As Long, ByVal nHeight As Long _ <br>
&nbsp &nbsp ) As Long <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Places a GDI Object into DC, returning the previous one: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
Private Declare Function SelectObject Lib "gdi32" _ <br>
&nbsp &nbsp (ByVal hDC As Long, ByVal hObject As Long _ <br>
&nbsp &nbsp ) As Long <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Deletes a GDI Object: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
Private Declare Function DeleteObject Lib "gdi32" _ <br>
&nbsp &nbsp (ByVal hObject As Long _ <br>
&nbsp &nbsp ) As Long <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Copies Bitmaps from one DC to another, can also perform <br>
' raster operations during the transfer: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
Private Declare Function BitBlt Lib "gdi32" ( _ <br>
&nbsp &nbsp ByVal hDestDC As Long, _ <br>
&nbsp &nbsp ByVal x As Long, ByVal y As Long, _ <br>
&nbsp &nbsp ByVal nWidth As Long, ByVal nHeight As Long, _ <br>
&nbsp &nbsp ByVal hSrcDC As Long, _ <br>
&nbsp &nbsp ByVal xSrc As Long, ByVal ySrc As Long, _ <br>
&nbsp &nbsp ByVal dwRop As Long _ <br>
&nbsp &nbsp ) As Long <br>
Private Const SRCCOPY = &HCC0020 <br>
Private Const SRCAND = &H8800C6 <br>
Private Const SRCPAINT = &HEE0086 <br>
Private Const SRCINVERT = &H660046 <br>
 <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Sets the backcolour of a device context: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
Private Declare Function SetBkColor Lib "gdi32" (ByVal hDC As Long, ByVal crColor As Long) As Long <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Create a brush of a given colour: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
Declare Function CreateSolidBrush Lib "gdi32" ( _ <br>
&nbsp &nbsp ByVal crColor As Long _ <br>
&nbsp &nbsp ) As Long <br>
</font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Fills a RECT in a DC with a specified brush <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
Declare Function FillRect Lib "user32" ( _ <br>
&nbsp &nbsp ByVal hDC As Long, _ <br>
&nbsp &nbsp lpRect As RECT, _ <br>
&nbsp &nbsp ByVal hBrush As Long _ <br>
&nbsp &nbsp ) As Long <br>
 <br>
Public Sub ReplaceColor( _ <br>
&nbsp &nbsp &nbsp &nbsp ByRef picThis As PictureBox, _ <br>
&nbsp &nbsp &nbsp &nbsp ByVal lFromColour As Long, _ <br>
&nbsp &nbsp &nbsp &nbsp ByVal lToColor As Long _ <br>
&nbsp &nbsp ) <br>
Dim lW As Long <br>
Dim lH As Long <br>
Dim lMaskDC As Long, lMaskBMP As Long, lMaskBMPOLd As Long <br>
Dim lCopyDC As Long, lCopyBMP As Long, lCopyBMPOLd As Long <br>
Dim tR As RECT <br>
Dim hBr As Long <br>
&nbsp &nbsp  <br>
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Cache the width & height of the picture: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp lW = picThis.ScaleWidth \ Screen.TwipsPerPixelX <br>
&nbsp &nbsp lH = picThis.ScaleHeight \ Screen.TwipsPerPixelY <br>
 <br>
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Create a Mono DC & Bitmap <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp If (CreateDC(picThis, lW, lH, lMaskDC, lMaskBMP, lMaskBMPOLd, True)) Then <br>
&nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Create a DC & Bitmap with the same colour depth <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' as the picture: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp If (CreateDC(picThis, lW, lH, lCopyDC, lCopyBMP, lCopyBMPOLd)) Then <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Make a mask from the picture which is white in the <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' replace colour area: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp SetBkColor picThis.hDC, lFromColour <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp BitBlt lMaskDC, 0, 0, lW, lH, picThis.hDC, 0, 0, SRCCOPY <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp  <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Fill the colour DC with the colour we want to replace with <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp tR.Right = lW: tR.Bottom = lH <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp hBr = CreateSolidBrush(lToColor) <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp FillRect lCopyDC, tR, hBr <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp DeleteObject hBr <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Turn the colour DC black except where the mask is white: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp BitBlt lCopyDC, 0, 0, lW, lH, lMaskDC, 0, 0, SRCAND <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp  <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Create an inverted mask, so it is black where the <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' colour is to be replaced but white otherwise: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp hBr = CreateSolidBrush(&HFFFFFF) <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp FillRect lMaskDC, tR, hBr <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp DeleteObject hBr <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp BitBlt lMaskDC, 0, 0, lW, lH, picThis.hDC, 0, 0, SRCINVERT <br>
 <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' AND the inverted mask with the picture.  The picture <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' goes black where the colour is to be replaced, but is <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' unaffected otherwise. <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp SetBkColor picThis.hDC, &HFFFFFF <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp BitBlt picThis.hDC, 0, 0, lW, lH, lMaskDC, 0, 0, SRCAND <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp  <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Finally, OR the coloured item with the picture.  Where <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' the picture is black and the coloured DC isn't, <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' the colour will be transferred: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp BitBlt picThis.hDC, 0, 0, lW, lH, lCopyDC, 0, 0, SRCPAINT <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp picThis.Refresh <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp  <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Clear up the colour DC: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp SelectObject lCopyDC, lCopyBMPOLd <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp DeleteObject lCopyBMP <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp DeleteObject lCopyDC <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp  <br>
&nbsp &nbsp &nbsp &nbsp End If <br>
&nbsp &nbsp &nbsp &nbsp  <br>
&nbsp &nbsp &nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Clear up the mask DC: <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp &nbsp &nbsp SelectObject lMaskDC, lMaskBMPOLd <br>
&nbsp &nbsp &nbsp &nbsp DeleteObject lMaskBMP <br>
&nbsp &nbsp &nbsp &nbsp DeleteObject lMaskDC <br>
&nbsp &nbsp End If <br>
End Sub <br>
 <br>
Public Function CreateDC( _ <br>
&nbsp &nbsp &nbsp &nbsp ByRef picThis As PictureBox, _ <br>
&nbsp &nbsp &nbsp &nbsp ByVal lW As Long, ByVal lH As Long, _ <br>
&nbsp &nbsp &nbsp &nbsp ByRef lhDC As Long, ByRef lhBmp As Long, ByRef lhBmpOld As Long, _ <br>
&nbsp &nbsp &nbsp &nbsp Optional ByVal bMono As Boolean = False _ <br>
&nbsp &nbsp ) As Boolean <br>
&nbsp &nbsp  <br>
&nbsp &nbsp If (bMono) Then <br>
&nbsp &nbsp &nbsp &nbsp lhDC = CreateCompatibleDC(0) <br>
&nbsp &nbsp Else <br>
&nbsp &nbsp &nbsp &nbsp lhDC = CreateCompatibleDC(picThis.hDC) <br>
&nbsp &nbsp End If <br>
&nbsp &nbsp If (lhDC <> 0) Then <br>
&nbsp &nbsp &nbsp &nbsp If (bMono) Then <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp lhBmp = CreateCompatibleBitmap(lhDC, lW, lH) <br>
&nbsp &nbsp &nbsp &nbsp Else <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp lhBmp = CreateCompatibleBitmap(picThis.hDC, lW, lH) <br>
&nbsp &nbsp &nbsp &nbsp End If <br>
&nbsp &nbsp &nbsp &nbsp If (lhBmp <> 0) Then <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp lhBmpOld = SelectObject(lhDC, lhBmp) <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp CreateDC = True <br>
&nbsp &nbsp &nbsp &nbsp Else <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp DeleteObject lhDC <br>
&nbsp &nbsp &nbsp &nbsp &nbsp &nbsp lhDC = 0 <br>
&nbsp &nbsp &nbsp &nbsp End If <br>
&nbsp &nbsp End If <br>
&nbsp &nbsp  <br>
End Function <br>
 <br>
 <br>
</font>
</p>
<font color="#000000" face="verdana,arial,helvetica" size="2">
<p>
	To test out the function, add a Command button and a Picture Boxes to the project's form.
	Set the Autoredraw property on the Picture boxe to True.  Then paste the code below
	into the form:<br><br>
</p>
</font>
<p>
<font color="#000000" face="Lucida Console,courier new" size="1">
 <br>
Private Sub Command1_Click() <br>
Static i As Integer <br>
&nbsp &nbsp ReplaceColor Picture1, QBColor(i), &HFFFF& <br>
&nbsp &nbsp i = i + 1 <br>
&nbsp &nbsp If (i > 15) Then <br>
&nbsp &nbsp &nbsp &nbsp MsgBox "All colours replaced." <br>
&nbsp &nbsp End If <br>
End Sub <br>
 <br>
Private Sub Form_Load() <br>
Dim i As Long <br>
Dim x As Long, y As Long, w As Long, h As Long <br>
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Draw something in the from picture box. <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' Alternatively, you could load a picture <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' into it and set the BackColor to the <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp </font>
<font color="#999999" face="Lucida Console,courier new" size="1">
' colour you want to make transparent. <br>
</font>
<font color="#000000" face="Lucida Console,courier new" size="1">
&nbsp &nbsp Picture1.BackColor = &HFFFF00 <br>
&nbsp &nbsp For i = 1 To 200 <br>
&nbsp &nbsp &nbsp &nbsp x = Rnd * Picture1.ScaleWidth: y = Rnd * Picture1.ScaleHeight <br>
&nbsp &nbsp &nbsp &nbsp w = Rnd * Picture1.ScaleWidth: h = Rnd * Picture1.ScaleHeight <br>
&nbsp &nbsp &nbsp &nbsp Picture1.Line (x, y)-(x + w, y + h), QBColor(Rnd * 15), BF <br>
&nbsp &nbsp &nbsp &nbsp Picture1.CurrentX = x: Picture1.CurrentY = y <br>
&nbsp &nbsp &nbsp &nbsp Picture1.Print "vbAccelerator Mask Demo" <br>
&nbsp &nbsp Next i <br>
End Sub <br>
</font>
</p>
<font color="#000000" face="verdana,arial,helvetica" size="2">
<p>
	During Form_Load, a random pattern of multi coloured squares and text is added.
	When you click the button, one of the colours will be replaced using the BitBlt method.
</p>
</font>
	<!-- TIPHTML: End -->
	<br>
	</td>
</tr>
<tr>
	<td></td>
	<td colspan=3 bgcolor="#663333">
	<!-- <img src="../images/bpixel.gif" width="100%" height="1" border="0"> -->
	</td>
	<td></td>
</tr>
<tr>
	<td>&nbsp</td>
	<td valign="top">
	<font color="#663333" face="verdana,arial,helvetica" size="1">
	<p>Related Tips and Articles:
	</td>
	<td>
	<font color="#000000" face="verdana,arial,helvetica" size="1">
	<p>
	<!-- RELATEDARTICLES: Begin -->
	<UL><LI><a href="vba0015.htm">Create a mask image (all black for the transparent colour otherwise white) from a bitmap</a>
<LI><a href="vba0018.htm">Get an RGB Colour from an OLE_COLOR</a>
</UL>
	<!-- RELATEDARTICLES: End -->
	</p>
	</font>
	</td>
	<td><img src="..\images\pixel.gif" width="256" height="1" border="0"></td>
	<td>&nbsp</td>
</tr>
</table>	

<!-- BODY:END -->

<!-- FOOTER:START -->
<table border="0" cellpadding="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 1998-1999, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 09/08/98</font></p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>
g="0" cellspacing="0" width="100%">
    <tr>
        <td colspan="2">
        <IMG SRC="..\images\grpixel.gif" height="1" width="100%" border="0" ALT="">
        </td>
    </tr>
    <tr>
	<td width="16">&nbsp;</td>
        <td>
	<font size="1" face="Verdana, Arial, Helvetica">
	<p>
	<a href="..\mission.htm">About</a>&nbsp;&nbsp;<a 
	href="..\contrib.htm">Contribute</a>&nbsp;&nbsp;<a 
	href="mailto:steve@vbaccelerator.com">Send Feedback</a>&nbsp;&nbsp;<a 
	href="..\privacy.html">Privacy</a>
	<br><br>
        Copyright &copy; 1998-1999, Steve McMahon (
	<a href="mailto:steve@vbaccelerator.com">steve@vbaccelerator.com</a>). All Rights Reserved.<br>
	Last updated: 09/08/98</font></p>
        </td>
    </tr>
</table>
<!-- FOOTER:END -->

</body>
</html>
